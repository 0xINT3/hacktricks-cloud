# Dom√≠nios do Cloudflare

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou se quiser acessar a **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no github.

</details>

Em cada TLD configurado no Cloudflare, existem algumas **configura√ß√µes e servi√ßos gerais** que podem ser configurados. Nesta p√°gina, vamos **analisar as configura√ß√µes relacionadas √† seguran√ßa de cada se√ß√£o:**

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## Vis√£o geral

* [ ] Obtenha uma ideia de **quanto** os servi√ßos da conta s√£o **usados**
* [ ] Encontre tamb√©m o **ID da zona** e o **ID da conta**

## An√°lise

* [ ] Em **`Seguran√ßa`**, verifique se h√° algum **limite de taxa**

## DNS

* [ ] Verifique os dados **interessantes** (sens√≠veis?) nos **registros** DNS
* [ ] Verifique os **subdom√≠nios** que podem conter **informa√ß√µes sens√≠veis** apenas com base no **nome** (como admin173865324.domin.com)
* [ ] Verifique as p√°ginas da web que **n√£o est√£o** **protegidas**
* [ ] Verifique as p√°ginas da web **protegidas** que podem ser **acessadas diretamente** por CNAME ou endere√ßo IP
* [ ] Verifique se o **DNSSEC** est√° **ativado**
* [ ] Verifique se o **CNAME Flattening** √© **usado** em **todos os CNAMEs**
  * Isso pode ser √∫til para **ocultar vulnerabilidades de takeover de subdom√≠nio** e melhorar os tempos de carregamento
* [ ] Verifique se os dom√≠nios [**n√£o s√£o vulner√°veis a spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)\*\*\*\*

## **Email**

TODO

## Spectrum

TODO

## SSL/TLS

### **Vis√£o geral**

* [ ] A criptografia **SSL/TLS** deve ser **Completa** ou **Completa (estrita)**. Qualquer outra enviar√° tr√°fego em **texto claro** em algum momento.
* [ ] O **Recomendador SSL/TLS** deve estar ativado

### Certificados de borda

* [ ] **Sempre use HTTPS** deve estar **ativado**
* [ ] **HTTP Strict Transport Security (HSTS)** deve estar **ativado**
* [ ] A **vers√£o m√≠nima do TLS deve ser 1.2**
* [ ] O **TLS 1.3 deve estar ativado**
* [ ] **Redirecionamentos autom√°ticos HTTPS** devem estar **ativados**
* [ ] O **Monitoramento de Transpar√™ncia de Certificado** deve estar **ativado**

## **Seguran√ßa**

* [ ] Na se√ß√£o **`WAF`**, √© interessante verificar se as regras de **Firewall** e **limite de taxa s√£o usadas** para evitar abusos.
  * A a√ß√£o **`Bypass`** ir√° **desativar as funcionalidades de seguran√ßa do Cloudflare** para uma solicita√ß√£o. N√£o deve ser usada.
* [ ] Na se√ß√£o **`Page Shield`**, √© recomend√°vel verificar se est√° **ativado** se alguma p√°gina for usada
* [ ] Na se√ß√£o **`API Shield`**, √© recomend√°vel verificar se est√° **ativado** se alguma API for exposta no Cloudflare
* [ ] Na se√ß√£o **`DDoS`**, √© recomend√°vel ativar as **prote√ß√µes DDoS**
* [ ] Na se√ß√£o **`Configura√ß√µes`**:
  * [ ] Verifique se o **`N√≠vel de Seguran√ßa`** √© **m√©dio** ou superior
  * [ ] Verifique se a **`Passagem de Desafio`** √© de no m√°ximo 1 hora
  * [ ] Verifique se a **`Verifica√ß√£o de Integridade do Navegador`** est√° **ativada**
  * [ ] Verifique se o **`Suporte de Passe de Privacidade`** est√° **ativado**

### **Prote√ß√£o DDoS do CloudFlare**

* Se poss√≠vel, ative o **Modo de Luta contra Bots**. Se voc√™ estiver protegendo alguma API acessada programaticamente (de uma p√°gina front-end JS, por exemplo), talvez n√£o seja poss√≠vel ativ√°-lo sem interromper esse acesso.
* No **WAF**: Voc√™ pode criar **limites de taxa por caminho de URL** (regras de limita√ß√£o de taxa) ou **bloquear o acesso** com base no IP, cookie, referenciador...). Portanto, voc√™ pode bloquear solicita√ß√µes que n√£o v√™m de uma p√°gina da web ou n√£o t√™m um cookie.
  * Voc√™ tamb√©m pode **listar permiss√µes** de endere√ßos IP, intervalos de endere√ßos IP, pa√≠ses ou ASNs nas **Ferramentas** no WAF.
* No DDoS, voc√™ pode **anular algumas regras para torn√°-las mais restritivas**.
* **Configura√ß√µes**: Defina o **N√≠vel de Seguran√ßa** como **Alto** e como **Sob Ataque** se estiver sob ataque.

## Acesso

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Velocidade

_N√£o consegui encontrar nenhuma op√ß√£o relacionada √† seguran√ßa_

## Armazenamento em cache

* [ ] Na se√ß√£o **`Configura√ß√£o`**, considere ativar a **Ferramenta de Verifica√ß√£o de CSAM**

## **Rotas dos Trabalhadores**

_Voc√™ j√° deveria ter verificado_ [_os trabalhadores do Cloudflare_](./#workers)\_\_

## Regras

TODO

## Rede

* [ ] Se o **`HTTP/2`** estiver **ativado**, o **`HTTP/2 para Origem`** deve estar **ativado**
* [ ] O **`HTTP/3 (com QUIC)`** deve estar **ativado**
* [ ] Se a **privacidade** de seus **usu√°rios** for importante, certifique-se de que o **`Roteamento de Cebola`** esteja **ativado**

## **Tr√°fego**

TODO

## P√°ginas personalizadas

* [ ] √â opcional configurar p√°ginas personalizadas quando um erro relacionado √† seguran√ßa √© acionado (como um bloqueio, limita√ß√£o de taxa ou modo "Estou sob ataque")

## Aplicativos

TODO

## Prote√ß√£o contra raspagem

* [ ] Verifique se a **Oculta√ß√£o de Endere√ßo de Email** est√° **ativada**
* [ ] Verifique se os **Exclus√µes do Lado do Servidor** est√£o **ativadas**

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou se quiser acessar a **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks)