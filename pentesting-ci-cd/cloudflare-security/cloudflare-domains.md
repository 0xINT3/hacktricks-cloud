# Domini Cloudflare

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguimi** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di github.

</details>

In ogni TLD configurato in Cloudflare ci sono alcune **impostazioni generali e servizi** che possono essere configurati. In questa pagina andremo ad **analizzare le impostazioni relative alla sicurezza di ogni sezione:**

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## Panoramica

* [ ] Avere un'idea di **quanto** vengono utilizzati i servizi dell'account
* [ ] Trovare anche l'**ID della zona** e l'**ID dell'account**

## Analisi

* [ ] In **`Sicurezza`** controllare se √® presente un **limite di velocit√†**

## DNS

* [ ] Controllare i dati **interessanti** (sensibili?) nei **record DNS**
* [ ] Controllare la presenza di **sottodomini** che potrebbero contenere **informazioni sensibili** basandosi solo sul **nome** (come admin173865324.domin.com)
* [ ] Controllare le pagine web che **non sono** **proxy**
* [ ] Controllare le pagine web **proxy** che possono essere **accessibili direttamente** tramite CNAME o indirizzo IP
* [ ] Verificare che **DNSSEC** sia **abilitato**
* [ ] Verificare che **CNAME Flattening** sia **utilizzato** in **tutti i CNAME**
* Questo potrebbe essere utile per **nascondere vulnerabilit√† di takeover dei sottodomini** e migliorare i tempi di caricamento
* [ ] Verificare che i domini [**non siano vulnerabili al spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

## **Email**

TODO

## Spectrum

TODO

## SSL/TLS

### **Panoramica**

* [ ] La crittografia **SSL/TLS** dovrebbe essere **Completa** o **Completa (Rigorosa)**. Qualsiasi altra opzione invier√† il traffico in **testo normale** in qualche momento.
* [ ] Il **Consigliere SSL/TLS** dovrebbe essere abilitato

### Certificati Edge

* [ ] **Usa sempre HTTPS** dovrebbe essere **abilitato**
* [ ] **HTTP Strict Transport Security (HSTS)** dovrebbe essere **abilitato**
* [ ] La **Versione minima di TLS** dovrebbe essere 1.2
* [ ] **TLS 1.3** dovrebbe essere abilitato
* [ ] **Riscritture automatiche HTTPS** dovrebbero essere **abilitate**
* [ ] Il **Monitoraggio della trasparenza del certificato** dovrebbe essere **abilitato**

## **Sicurezza**

* [ ] Nella sezione **`WAF`** √® interessante verificare che vengano utilizzate **regole di firewall** e **limitazione della velocit√†** per prevenire abusi.
* L'azione **`Bypass`** disabiliter√† le funzionalit√† di sicurezza di Cloudflare per una richiesta. Non dovrebbe essere utilizzata.
* [ ] Nella sezione **`Page Shield`** √® consigliabile verificare che sia **abilitato** se viene utilizzata una pagina
* [ ] Nella sezione **`API Shield`** √® consigliabile verificare che sia **abilitato** se viene esposta un'API in Cloudflare
* [ ] Nella sezione **`DDoS`** √® consigliabile abilitare le **protezioni DDoS**
* [ ] Nella sezione **`Impostazioni`**:
* [ ] Verificare che il **`Livello di sicurezza`** sia **medio** o superiore
* [ ] Verificare che il **`Passaggio della sfida`** sia al massimo di 1 ora
* [ ] Verificare che il **`Controllo dell'integrit√† del browser`** sia **abilitato**
* [ ] Verificare che il **`Supporto a Privacy Pass`** sia **abilitato**

### **Protezione DDoS di CloudFlare**

* Se possibile, abilitare la modalit√† **Bot Fight** o **Super Bot Fight**. Se si sta proteggendo un'API a cui si accede programmaticamente (da una pagina front-end JS ad esempio), potrebbe non essere possibile abilitare questa opzione senza interrompere tale accesso.
* In **WAF**: √à possibile creare **limiti di velocit√† per percorso URL** o per **bot verificati** (regole di limitazione della velocit√†), o per **bloccare l'accesso** in base all'IP, al cookie, al referrer...). In questo modo √® possibile bloccare le richieste che non provengono da una pagina web o che non hanno un cookie.
* Se l'attacco proviene da un **bot verificato**, aggiungere almeno un **limite di velocit√†** per i bot.
* Se l'attacco √® rivolto a un **percorso specifico**, come meccanismo di prevenzione, aggiungere un **limite di velocit√†** in questo percorso.
* √à anche possibile **inserire nella whitelist** indirizzi IP, intervalli di indirizzi IP, paesi o ASNs dalle **Strumenti** in WAF.
* Verificare se le **regole gestite** possono aiutare a prevenire l'utilizzo di vulnerabilit√†.
* Nella sezione **Strumenti** √® possibile **bloccare o sfidare specifici IP** e **user agent**.
* In DDoS √® possibile **sovrascrivere alcune regole per renderle pi√π restrittive**.
* **Impostazioni**: Impostare il **Livello di sicurezza** su **Alto** e su **Sotto attacco** se si √® sotto attacco e verificare che il **Controllo dell'integrit√† del browser sia abilitato**.
* In Cloudflare Domains -> Analytics -> Security -> Verificare se √® abilitato il **limite di velocit√†**
* In Cloudflare Domains -> Security -> Eventi -> Verificare la presenza di **eventi malevoli rilevati**

## Accesso

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Velocit√†

_Non ho trovato alcuna opzione relativa alla sicurezza_

## Caching

* [ ] Nella sezione **`Configurazione`** considerare l'abilitazione dello **Strumento di scansione CSAM**

## **Percorsi dei Workers**

_Dovresti aver gi√† controllato_ [_cloudflare workers_](./#workers)

## Regole

TODO

## Rete

* [ ] Se **`HTTP/2`** √® **abilitato**, **`HTTP/2 verso l'origine`** dovrebbe essere **abilitato**
* [ ] **`HTTP/3 (con QUIC)`** dovrebbe essere **abilitato**
* [ ] Se la **privacy** dei tuoi **utenti** √® importante, assicurati che sia abilitato **`Onion Routing`**

## **Traffico**

TODO

## Pagine personalizzate

* [ ] √à facoltativo configurare pagine personalizzate quando viene attivato un errore legato alla sicurezza (come un blocco, limitazione della velocit√† o modalit√† "Sono sotto attacco")
## Applicazioni

TODO

## Scrape Shield

* [ ] Verifica che l'**Obfuscamento dell'indirizzo email** sia **abilitato**
* [ ] Verifica che le **Esclusioni lato server** siano **abilitate**

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF**, controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguimi** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>
