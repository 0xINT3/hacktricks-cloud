# Cloudflare 域名

<details>

<summary><strong>从零开始学习 AWS 黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS 红队专家）</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想看到您的**公司在 HackTricks 中做广告**或**下载 PDF 版本的 HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 探索[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或在 **Twitter** 上关注我 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>

在 Cloudflare 中配置的每个 TLD 中都有一些可以配置的**常规设置和服务**。在本页中，我们将**分析每个部分与安全相关的设置**：

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

## 概述

* [ ] 了解账户中服务的**使用情况**
* [ ] 查找**区域 ID** 和**账户 ID**

## 分析

* [ ] 在**`安全性`**中检查是否有任何**速率限制**

## DNS

* [ ] 检查 DNS **记录**中的**有趣**（敏感？）数据
* [ ] 检查可能包含**敏感信息**的**子域**，仅基于**名称**（如 admin173865324.domin.com）
* [ ] 检查**未**被**代理**的网页
* [ ] 检查可以通过 CNAME 或 IP 地址**直接访问**的**代理网页**
* [ ] 检查**是否启用**了**DNSSEC**
* [ ] 检查所有 CNAME 中是否**使用了 CNAME 平铺**
* 这可能对**隐藏子域接管漏洞**和改善加载时间有用
* [ ] 检查域名是否**容易受到欺骗**的

## **电子邮件**

待办事项

## Spectrum

待办事项

## SSL/TLS

### **概述**

* [ ] **SSL/TLS 加密**应为**完整**或**完全（严格）**。其他任何选项都会在某个时候发送**明文流量**。
* [ ] 应启用**SSL/TLS 推荐器**

### 边缘证书

* [ ] 应启用**始终使用 HTTPS**
* [ ] 应启用**HTTP 严格传输安全性 (HSTS)**
* [ ] **最低 TLS 版本**应为 1.2
* [ ] 应启用**TLS 1.3**
* [ ] 应启用**自动 HTTPS 重写**
* [ ] 应启用**证书透明监控**

## **安全性**

* [ ] 在**`WAF`**部分，检查是否使用**防火墙**和**速率限制规则**以防止滥用。
* **`绕过`**操作将为请求**禁用 Cloudflare 安全**功能。不应使用此功能。
* [ ] 在**`页面防护`**部分，建议检查是否**已启用**，如果使用了任何页面
* [ ] 在**`API 防护`**部分，建议检查是否**已启用**，如果在 Cloudflare 中公开了任何 API
* [ ] 在**`DDoS`**部分，建议启用**DDoS 保护**
* [ ] 在**`设置`**部分：
* [ ] 检查**`安全级别`**是否为**中等**或更高
* [ ] 检查**`挑战通过`**最多为 1 小时
* [ ] 检查**`浏览器完整性检查`**是否**已启用**
* [ ] 检查**`隐私通行证支持`**是否**已启用**

### **CloudFlare DDoS 保护**

* 如果可以，启用**机器人对抗模式**或**超级机器人对抗模式**。如果您正在保护某些通过程序访问的 API（例如从 JS 前端页面），您可能无法在不破坏该访问的情况下启用此功能。
* 在**WAF**中：您可以根据 URL 路径或**已验证的机器人**（速率限制规则）创建**速率限制**，或者根据 IP、Cookie、引荐来源等**阻止访问**。因此，您可以阻止不来自网页或没有 cookie 的请求。
* 如果攻击来自**已验证的机器人**，至少**向机器人添加速率限制**。
* 如果攻击针对**特定路径**，作为预防机制，在此路径中添加**速率限制**。
* 您还可以在 WAF 中的**工具**中**白名单**IP 地址、IP 范围、国家或 ASNs。
* 检查**托管规则**是否还有助于防止漏洞利用。
* 在**工具**部分，您可以**阻止特定 IP**和**用户代理**，或对其进行**挑战**。
* 在 DDoS 中，您可以**覆盖某些规则以使其更严格**。
* **设置**：将**安全级别**设置为**高**，如果您受到攻击，则设置为**受到攻击**，并确保**已启用浏览器完整性检查**。
* 在 Cloudflare 域名 -> 分析 -> 安全性 -> 检查是否已启用**速率限制**
* 在 Cloudflare 域名 -> 安全性 -> 事件 -> 检查是否有**检测到的恶意事件**

## 访问

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## 速度

_我找不到与安全相关的任何选项_

## 缓存

* [ ] 在**`配置`**部分考虑启用**CSAM 扫描工具**

## **工作程序路由**

_您应该已经检查了_ [_cloudflare 工作程序_](./#workers)

## 规则

待办事项

## 网络

* [ ] 如果**启用了 `HTTP/2`**，应**启用 `HTTP/2 到源`**
* [ ] 应**启用 `HTTP/3（使用 QUIC）`**
* [ ] 如果您的**用户**的**隐私**很重要，请确保**已启用 `洋葱路由`**

## **流量**

待办事项

## 自定义页面

* [ ] 可选择在触发与安全相关的错误时配置自定义页面（如阻止、速率限制或我受到攻击模式）

## 应用

待办事项
## **屏蔽爬虫**

* [ ] 检查**电子邮件地址混淆**是否**已启用**
* [ ] 检查**服务器端排除**是否**已启用**

## **Zaraz**

待办事项

## **Web3**

待办事项

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想看到您的**公司在HackTricks中做广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks周边产品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或在**Twitter**上关注我 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
