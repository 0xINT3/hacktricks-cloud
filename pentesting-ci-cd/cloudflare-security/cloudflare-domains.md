# Cloudflare ドメイン

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もし **HackTricks で会社を宣伝したい**場合や、**最新版の PEASS を入手したい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式の PEASS & HackTricks スワッグ**](https://peass.creator-spring.com) を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を見つけて、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを発見しましょう
* 💬 [**Discord グループ**](https://discord.gg/hRep4RUj7f) または [**telegram グループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) をフォローしましょう。
* **HackTricks** と **HackTricks Cloud** の GitHub リポジトリに **PR を提出**して、あなたのハッキングテクニックを共有しましょう。

</details>

Cloudflare で構成された各 TLD には、設定できる **一般的な設定とサービス** があります。このページでは、各セクションの **セキュリティ関連の設定** を分析します。

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## 概要

* [ ] アカウントのサービスの使用状況を **把握**する
* [ ] ゾーン ID とアカウント ID も取得する

## アナリティクス

* [ ] **`セキュリティ`** で **レート制限** が設定されているか確認する

## DNS

* [ ] DNS の **レコード** には、**興味深い**（機密情報？）データが含まれていないか確認する
* [ ] **名前** に基づいて、**機密情報** を含む可能性のある **サブドメイン** をチェックする（例：admin173865324.domin.com）
* [ ] **プロキシされていない** ウェブページをチェックする
* [ ] CNAME や IP アドレスで **直接アクセスできる** **プロキシされたウェブページ** をチェックする
* [ ] **DNSSEC** が **有効** になっているか確認する
* [ ] **CNAME フラットニング** が **すべての CNAME で使用** されているか確認する
* これは、**サブドメインの乗っ取りの脆弱性を隠す**のに役立ち、読み込み時間を改善することができます
* [ ] ドメインが [**スプーフィングの脆弱性に対して脆弱ではない**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)ことを確認する

## **Email**

TODO

## Spectrum

TODO

## SSL/TLS

### **概要**

* [ ] **SSL/TLS 暗号化** は **Full** または **Full (Strict)** に設定する必要があります。それ以外の設定では、ある時点で **クリアテキストのトラフィック** が送信されます。
* [ ] **SSL/TLS 推奨者** を有効にする必要があります

### エッジ証明書

* [ ] **常に HTTPS を使用** する必要があります
* [ ] **HTTP Strict Transport Security (HSTS)** を **有効** にする必要があります
* [ ] **最小 TLS バージョン** は 1.2 に設定する必要があります
* [ ] **TLS 1.3** を有効にする必要があります
* [ ] **自動 HTTPS リライト** を **有効** にする必要があります
* [ ] **証明書透明性モニタリング** を **有効** にする必要があります

## **セキュリティ**

* [ ] **`WAF`** セクションでは、**ファイアウォール** と **レート制限ルール** が使用されているか確認することが重要です。
* **`Bypass`** アクションは、リクエストのために Cloudflare のセキュリティ機能を **無効化** します。使用しないでください。
* [ ] **`Page Shield`** セクションでは、ページが使用されている場合に **有効** になっているか確認することをおすすめします。
* [ ] **`API Shield`** セクションでは、Cloudflare で公開されている API がある場合に **有効** になっているか確認することをおすすめします。
* [ ] **`DDoS`** セクションでは、**DDoS 保護** を有効にすることをおすすめします。
* [ ] **`Settings`** セクションでは：
* [ ] **`セキュリティレベル`** が **中程度以上** であることを確認する
* [ ] **`チャレンジパッセージ`** が最大で 1 時間であることを確認する
* [ ] **`ブラウザの整合性チェック`** が **有効** であることを確認する
* [ ] **`プライバシーパスサポート`** が **有効** であることを確認する

### **CloudFlare DDoS Protection**

* もしプログラムからアクセスされる API を保護している場合（例：JS フロントエンドページからアクセスされる場合）は、**Bot Fight Mode** を有効にすることができます。これを有効にすると、そのアクセスが壊れることなく、ブロックすることができます。
* **WAF** では、URL パスごとに **レート制限ルール** を作成したり、IP、Cookie、リファラに基づいて **アクセスをブロック** したりすることができます。したがって、ウェブページからのリクエストでない場合や、Cookie がない場合などのリクエストをブロックすることができます。
* WAF の **ツール** から IP アドレス、IP レンジ、国、ASNs を **ホワイトリスト** に登録することもできます。
* DDoS では、いくつかのルールを **より制限的にオーバーライド** することができます。
* **設定**：**セキュリティレベル** を **High** に設定し、攻撃を受けている場合は **Under Attack** に設定します。

## アクセス

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## 速度

_セキュリティに関連するオプションは見つかりませんでした_

## キャッシュ

* [ ] **`Configuration`** セクションで **CSAM スキャンツール** を有効にすることを検討してください

## **Workers ルート**

_すでに_ [_cloudflare workers_](./#workers)\_\_ をチェックしているはずです

## ルール

TODO

## ネットワーク

* [ ] **`HTTP/2`** が **有効** になっている場合、**`HTTP/2 to Origin`** も **有効** にする必要があります
* [ ] **`HTTP/3 (with QUIC)`** を **有効** にする必要があります
* [ ] ユーザーの **プライバシー** が重要な場合は、**`Onion Routing`** が **有効** になっていることを確認してください

## **トラフィック**

TODO

## カスタムページ

* [ ] セキュリティに関連するエラーが発生した場合（ブロック、レート制限、攻撃を受けているモードなど）、カスタムページを設定することもできます（オプション）
## アプリ

TODO

## スクレイプシールド

* [ ] **メールアドレスの書き換え**が**有効**になっているかを確認する
* [ ] **サーバーサイドの除外**が**有効**になっているかを確認する

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* もし、あなたの**会社をHackTricksで宣伝したい**場合や、**最新バージョンのPEASSにアクセスしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを発見する
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で私をフォローする🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)
* **ハッキングのトリックを共有するために、PRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) **および** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **のGitHubリポジトリに提出してください。**

</details>
