# Domeny Cloudflare

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** mnie na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów GitHub.

</details>

W każdej skonfigurowanej domenie TLD w Cloudflare można skonfigurować pewne **ogólne ustawienia i usługi**. Na tej stronie będziemy **analizować ustawienia związane z bezpieczeństwem w każdej sekcji:**

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## Przegląd

* [ ] Zdobądź poczucie, **jak bardzo** usługi konta są **używane**
* [ ] Znajdź również **ID strefy** i **ID konta**

## Analiza

* [ ] W sekcji **`Bezpieczeństwo`** sprawdź, czy istnieje jakieś **Ograniczenie częstotliwości**

## DNS

* [ ] Sprawdź **interesujące** (wrażliwe?) dane w rekordach **DNS**
* [ ] Sprawdź, czy istnieją **subdomeny**, które mogą zawierać **wrażliwe informacje** tylko na podstawie **nazwy** (np. admin173865324.domin.com)
* [ ] Sprawdź strony internetowe, które **nie są** **proxy**
* [ ] Sprawdź, czy istnieją **strony internetowe przekierowane** , do których można uzyskać **bezpośredni dostęp** za pomocą CNAME lub adresu IP
* [ ] Sprawdź, czy **DNSSEC** jest **włączony**
* [ ] Sprawdź, czy **CNAME Flattening** jest **używane** we wszystkich CNAME
* Może to być przydatne do **ukrywania podatności na przejęcie subdomeny** i poprawy czasów ładowania
* [ ] Sprawdź, czy domeny [**nie są podatne na podszywanie się**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

## **Email**

TODO

## Spectrum

TODO

## SSL/TLS

### **Przegląd**

* [ ] Szyfrowanie **SSL/TLS** powinno być **Pełne** lub **Pełne (Ścisłe)**. Każde inne spowoduje wysyłanie **tekstu jawnego** w pewnym momencie.
* [ ] Zaleca się włączenie **Rekomendacji SSL/TLS**

### Certyfikaty Edge

* [ ] Powinno być włączone **Zawsze używaj protokołu HTTPS**
* [ ] Powinno być włączone **Ścisłe zabezpieczenia transportu HTTP (HSTS)**
* [ ] Minimalna wersja TLS powinna wynosić 1.2
* [ ] Powinno być włączone TLS 1.3
* [ ] Powinno być włączone **Automatyczne przepisywanie HTTPS**
* [ ] Powinno być włączone **Monitorowanie przejrzystości certyfikatów**

## **Bezpieczeństwo**

* [ ] W sekcji **`WAF`** warto sprawdzić, czy są używane **reguły zapory ogniowej** i **ograniczenia częstotliwości** w celu zapobiegania nadużyciom.
* Działanie **`Bypass`** wyłączy funkcje bezpieczeństwa Cloudflare dla żądania. Nie powinno się go używać.
* [ ] W sekcji **`Page Shield`** zaleca się sprawdzenie, czy jest **włączony**, jeśli używana jest jakaś strona
* [ ] W sekcji **`API Shield`** zaleca się sprawdzenie, czy jest **włączony**, jeśli jakieś API jest wystawione w Cloudflare
* [ ] W sekcji **`DDoS`** zaleca się włączenie **ochrony przed atakami DDoS**
* [ ] W sekcji **`Ustawienia`**:
* [ ] Sprawdź, czy **`Poziom bezpieczeństwa`** wynosi co najmniej **średni**
* [ ] Sprawdź, czy **`Przejście wyzwania`** wynosi maksymalnie 1 godzinę
* [ ] Sprawdź, czy **`Sprawdzanie integralności przeglądarki`** jest **włączone**
* [ ] Sprawdź, czy **`Wsparcie dla Privacy Pass`** jest **włączone**

### **Ochrona przed DDoS w CloudFlare**

* Jeśli to możliwe, włącz **Tryb walki z botami** lub **Tryb super walki z botami**. Jeśli chronisz jakieś API dostępne programowo (na przykład z strony front-endowej JS), możliwe, że nie będziesz w stanie tego włączyć bez przerwania tego dostępu.
* W **WAF**: Możesz tworzyć **limity częstotliwości według ścieżki URL** lub dla **zweryfikowanych botów** (reguły ograniczania częstotliwości) lub do **blokowania dostępu** na podstawie adresu IP, pliku cookie, odwołania...). Możesz więc blokować żądania, które nie pochodzą ze strony internetowej lub nie mają pliku cookie.
* Jeśli atak pochodzi od **zweryfikowanego bota**, dodaj przynajmniej **limit częstotliwości** dla botów.
* Jeśli atak jest na **konkretną ścieżkę**, jako mechanizm zapobiegawczy dodaj **limit częstotliwości** na tej ścieżce.
* Możesz również **uwzględnić na białej liście** adresy IP, zakresy adresów IP, kraje lub ASN w **narzędziach** w WAF.
* Sprawdź, czy **zarządzane reguły** mogą również pomóc w zapobieganiu wykorzystywaniu podatności.
* W sekcji **Narzędzia** możesz **blokować lub wyzwalać wyzwanie dla określonych adresów IP** i **agentów użytkownika**.
* W DDoS możesz **nadpisać niektóre reguły, aby były bardziej restrykcyjne**.
* **Ustawienia**: Ustaw **Poziom bezpieczeństwa** na **Wysoki** i na **Atakowany**, jeśli jesteś atakowany, oraz sprawdź, czy jest włączone **Sprawdzanie integralności przeglądarki**.
* W Cloudflare Domains -> Analytics -> Security -> Sprawdź, czy jest włączony **limit częstotliwości**
* W Cloudflare Domains -> Security -> Events -> Sprawdź, czy są wykrywane **zdarzenia złośliwe**

## Dostęp

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Szybkość

_Nie znalazłem żadnej opcji związanej z bezpieczeństwem_

## Pamięć podręczna

* [ ] W sekcji **`Konfiguracja`** rozważ włączenie **Narzędzia skanowania CSAM**

## **Trasy pracowników**

_Już powinieneś sprawdzić_ [_pracowników Cloudflare_](./#workers)

## Reguły

TODO

## Sieć

* [ ] Jeśli **`HTTP/2`** jest **włączone**, **`HTTP/2 do źródła`** powinno być **włączone**
* [ ] Powinno być włączone **`HTTP/3 (z protokołem QUIC)`**
* [ ] Jeśli prywatność twoich użytkowników jest ważna, upewnij się, że **`Onion Routing`** jest **
## Aplikacje

TODO

## Scrape Shield

* [ ] Sprawdź, czy **Zaciemnianie adresu e-mail** jest **włączone**
* [ ] Sprawdź, czy **Wyłączanie na serwerze** jest **włączone**

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** mnie na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
