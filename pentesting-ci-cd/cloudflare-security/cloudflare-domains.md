# Cloudflare ドメイン

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* **HackTricks** で **会社の広告を見たい**場合や、**PEASSの最新バージョンを入手**したい場合、または **HackTricksをPDFでダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式のPEASS＆HackTricksグッズ**](https://peass.creator-spring.com) を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を見つけて、独占的な [**NFT**](https://opensea.io/collection/the-peass-family) のコレクションを見つけましょう
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f) または [**telegramグループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) をフォローしましょう。
* **HackTricks** と **HackTricks Cloud** の github リポジトリに **PRを提出**して、あなたのハッキングトリックを共有しましょう。

</details>

Cloudflare で構成された各 TLD には、設定できる **一般的な設定とサービス** があります。このページでは、各セクションの **セキュリティ関連の設定** を分析します。

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## 概要

* [ ] アカウントのサービスの使用状況を **把握**する
* [ ] ゾーン ID とアカウント ID も **見つける**

## アナリティクス

* [ ] **`セキュリティ`** で **レート制限** があるかどうかを確認する

## DNS

* [ ] DNS **レコード** に **興味深い**（機密情報？）データがないか確認する
* [ ] 名前に基づいて、**機密情報** を含む可能性のある **サブドメイン** をチェックする（例：admin173865324.domin.com）
* [ ] **プロキシされていない** ウェブページをチェックする
* [ ] CNAME または IP アドレスで **直接アクセスできる** **プロキシされたウェブページ** をチェックする
* [ ] **DNSSEC** が **有効** であることを確認する
* [ ] **CNAME フラット化** が **すべての CNAME** で **使用されている** ことを確認する
* これは、**サブドメインの乗っ取りの脆弱性を隠す** のに役立ち、読み込み時間を改善することができます
* [ ] ドメインが [**スプーフィングの脆弱性に対して脆弱ではない**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing) ことを確認する

## **Email**

TODO

## Spectrum

TODO

## SSL/TLS

### **概要**

* [ ] **SSL/TLS 暗号化** は **Full** または **Full (Strict)** である必要があります。それ以外の場合、ある時点で **クリアテキストトラフィック** が送信されます。
* [ ] **SSL/TLS 推奨者** が有効になっていることを確認する

### エッジ証明書

* [ ] **常に HTTPS を使用** することが **有効** になっていることを確認する
* [ ] **HTTP Strict Transport Security (HSTS)** が **有効** になっていることを確認する
* [ ] **最小 TLS バージョン** は 1.2 であることを確認する
* [ ] **TLS 1.3** が有効になっていることを確認する
* [ ] **自動 HTTPS リライト** が **有効** になっていることを確認する
* [ ] **証明書透明性モニタリング** が **有効** になっていることを確認する

## **セキュリティ**

* [ ] **`WAF`** セクションでは、**ファイアウォール** と **レート制限ルール** が **濫用を防ぐために使用されている** ことを確認する。
* **`バイパス`** アクションは、リクエストのために Cloudflare のセキュリティ機能を **無効にします**。使用しないでください。
* [ ] **`ページシールド`** セクションでは、**ページが使用されている場合に有効** であることを確認することをお勧めします
* [ ] **`APIシールド`** セクションでは、**Cloudflare で公開されている API がある場合に有効** であることを確認することをお勧めします
* [ ] **`DDoS`** セクションでは、**DDoS 保護** を有効にすることをお勧めします
* [ ] **`設定`** セクションでは：
* [ ] **`セキュリティレベル`** が **中程度以上** であることを確認する
* [ ] **`チャレンジパッセージ`** が最大で 1 時間であることを確認する
* [ ] **`ブラウザの整合性チェック`** が **有効** であることを確認する
* [ ] **`プライバシーパスサポート`** が **有効** であることを確認する

### **CloudFlare DDoS Protection**

* 可能であれば、**Bot Fight Mode** または **Super Bot Fight Mode** を有効にします。プログラムからアクセスされるいくつかの API を保護している場合（たとえば、JS フロントエンドページから）、これを有効にすることはできません。
* **WAF** では、URL パスごとに **レート制限** を作成したり、IP、Cookie、リファラに基づいて **アクセスをブロック** したりすることができます。したがって、ウェブページからのリクエストやクッキーを持たないリクエストをブロックすることができます。
* すべてのボットをブロックすることはできなくても、ボットに対してレート制限を追加することができます。
* ツールセクションの WAF で IP アドレス、IP レンジ、国、または ASNs を **ホワイトリスト** に登録することもできます。
* **管理されたルール** も脆弱性の悪用を防ぐのに役立つかもしれません。
* ツールセクションでは、特定の IP に対して **ブロックまたはチャレンジ** を与えることができます。
* DDoS では、いくつかのルールを **より制限的にオーバーライド** することができます。
* **設定**：**セキュリティレベル** を **High** に設定し、攻撃を受けている場合は **Under Attack** に設定し、**ブラウザの整合性チェックが有効** であることを確認します。
* Cloudflare ドメイン -> アナリティクス -> セキュリティ -> **レート制限** が有効かどうかを確認します
* Cloudflare ドメイン -> セキュリティ -> イベント -> **検出された悪意のあるイベント** を確認します

## アクセス

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## 速度

_セキュリティに関連するオプションは見つかりませんでした_

## キャッシュ

* [ ] **`構成`** セクションで **CSAM スキャンツール** を有効にすることを検討してください

## **ワーカールート**

_すでに_ [_cloudflare workers_](./#workers) _をチェックしているはずです_

## ルール

TODO
## ネットワーク

* [ ] **`HTTP/2`** が **有効** である場合、**`HTTP/2 to Origin`** も **有効** にする
* [ ] **`HTTP/3 (with QUIC)`** を **有効** にする
* [ ] ユーザーの **プライバシー** が重要な場合、**`Onion Routing`** を **有効** にする

## **トラフィック**

TODO

## カスタムページ

* [ ] セキュリティに関連するエラーが発生した場合（ブロック、レート制限、攻撃モードなど）、カスタムページの設定はオプションです。

## アプリ

TODO

## スクレイプシールド

* [ ] **Email Address Obfuscation** が **有効** であることを確認する
* [ ] **Server-side Excludes** が **有効** であることを確認する

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もし **HackTricks で会社を宣伝したい** または **PEASS の最新バージョンにアクセスしたい** または **HackTricks を PDF でダウンロードしたい** 場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式の PEASS & HackTricks スワッグ**](https://peass.creator-spring.com) を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を見つけてください。独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションです
* 💬 [**Discord グループ**](https://discord.gg/hRep4RUj7f) または [**telegram グループ**](https://t.me/peass) に **参加** するか、 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) を **フォロー** してください。
* **HackTricks** と **HackTricks Cloud** の github リポジトリに **PR を提出** して、あなたのハッキングトリックを共有してください。

</details>
