# Cloudflare 도메인

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* HackTricks에서 **회사 광고를 보거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요. 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

Cloudflare에서 구성된 각 TLD에는 구성할 수 있는 일부 **일반 설정 및 서비스**가 있습니다. 이 페이지에서는 각 섹션의 **보안 관련 설정을 분석**하겠습니다.

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## 개요

* [ ] 계정의 서비스가 **얼마나 사용되는지** 파악하세요.
* [ ] **존 ID**와 **계정 ID**도 찾으세요.

## 분석

* [ ] **`보안`**에서 **Rate limiting**이 있는지 확인하세요.

## DNS

* [ ] DNS **레코드**에서 **흥미로운** (민감한?) 데이터를 확인하세요.
* [ ] 이름에 기반하여 **민감한 정보**를 포함할 수 있는 **하위 도메인**을 확인하세요. (예: admin173865324.domin.com)
* [ ] **프록시되지 않는** 웹 페이지를 확인하세요.
* [ ] CNAME 또는 IP 주소로 **직접 액세스할 수 있는** **프록시된 웹 페이지**를 확인하세요.
* [ ] **DNSSEC**가 **활성화**되어 있는지 확인하세요.
* [ ] **CNAME 플래닝**이 **모든 CNAME**에서 **사용**되는지 확인하세요.
* 이는 **하위 도메인 탈취 취약점을 숨기고** 로드 시간을 개선하는 데 유용할 수 있습니다.
* [ ] 도메인이 [**스푸핑 취약점에 취약하지 않은지**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing) 확인하세요.

## **이메일**

TODO

## Spectrum

TODO

## SSL/TLS

### **개요**

* [ ] **SSL/TLS 암호화**는 **Full** 또는 **Full (Strict)** 여야 합니다. 다른 경우 어느 시점에서 **평문 트래픽**을 전송합니다.
* [ ] **SSL/TLS 추천자**가 활성화되어 있어야 합니다.

### Edge Certificates

* [ ] **항상 HTTPS 사용**이 **활성화**되어 있어야 합니다.
* [ ] **HTTP Strict Transport Security (HSTS)**가 **활성화**되어 있어야 합니다.
* [ ] **최소 TLS 버전은 1.2**여야 합니다.
* [ ] **TLS 1.3이 활성화**되어 있어야 합니다.
* [ ] **자동 HTTPS Rewrites**가 **활성화**되어 있어야 합니다.
* [ ] **인증서 투명성 모니터링**이 **활성화**되어 있어야 합니다.

## **보안**

* [ ] **`WAF`** 섹션에서 **방화벽** 및 **Rate limiting rules**이 악용을 방지하기 위해 사용되는지 확인하는 것이 흥미로울 수 있습니다.
* **`Bypass`** 동작은 요청에 대해 **Cloudflare 보안 기능을 비활성화**합니다. 사용해서는 안 됩니다.
* [ ] **`Page Shield`** 섹션에서는 페이지를 사용하는 경우 **활성화**되어 있는지 확인하는 것이 좋습니다.
* [ ] **`API Shield`** 섹션에서는 Cloudflare에서 노출된 API가 있는지 **활성화**되어 있는지 확인하는 것이 좋습니다.
* [ ] **`DDoS`** 섹션에서 **DDoS 보호**를 활성화하는 것이 좋습니다.
* [ ] **`Settings`** 섹션에서:
* [ ] **`보안 수준`**이 **중간** 이상인지 확인하세요.
* [ ] **`도전 통과`**가 최대 1시간인지 확인하세요.
* [ ] **`브라우저 무결성 검사`**가 **활성화**되어 있는지 확인하세요.
* [ ] **`Privacy Pass Support`**가 **활성화**되어 있는지 확인하세요.

### **CloudFlare DDoS 보호**

* 가능하다면 **Bot Fight Mode** 또는 **Super Bot Fight Mode**를 활성화하세요. 프로그래밍 방식으로 액세스되는 일부 API를 보호하는 경우 (예: JS 프론트 엔드 페이지에서). 이를 활성화하지 않고는 해당 액세스를 중단할 수 없을 수도 있습니다.
* **WAF**에서: URL 경로 또는 **검증된 봇** (Rate limiting rules)에 대한 **속도 제한**을 생성하거나 IP, Cookie, referrer를 기반으로 **액세스 차단**을 할 수 있습니다. 따라서 웹 페이지에서 오지 않거나 쿠키가 없는 요청을 차단할 수 있습니다.
* 공격이 **검증된 봇**에서 발생하는 경우, 적어도 봇에 대한 **속도 제한**을 추가하세요.
* 공격이 **특정 경로**로 이루어진다면 예방 메커니즘으로 이 경로에 **속도 제한**을 추가하세요.
* **도구**에서 IP 주소, IP 범위, 국가 또는 ASNs를 **화이트리스트**로 지정할 수 있습니다.
* **관리되는 규칙**이 취약점 공격을 방지하는 데 도움이 될 수 있는지 확인하세요.
* **도구** 섹션에서 특정 IP 및 사용자 에이전트에 대해 **차단 또는 도전**을 줄 수 있습니다.
* DDoS에서 일부 규칙을 **보다 제한적으로 재정의**할 수 있습니다.
* **설정**: **보안 수준**을 **높음**으로 설정하고 **공격을 받고 있다면** **Under Attack**로 설정하고 **브라우저 무결성 검사가 활성화**되어 있는지 확인하세요.
* Cloudflare 도메인 -> 분석 -> 보안 -> **속도 제한**이 활성화되어 있는지 확인하세요.
* Cloudflare 도메인 -> 보안 -> 이벤트 -> **감지된 악성 이벤트**를 확인하세요.

## 액세스

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## 속도

_보안과 관련된 옵션을 찾을 수 없었습니다._

## 캐싱

* [ ] **`구성`** 섹션에서 **CSAM 스캐닝 도구**를 활성화하는 것을 고려하세요.

## **워커 경로**

_이미_ [_cloudflare workers_](./#workers)를 확인했어야 합니다.

## 규칙

TODO

## 네트워크

* [ ] **`HTTP/2`**가 **활성화**되어 있다면 **`HTTP/2 to Origin`**도 **활성화**되어야 합니다.
* [ ] **`HTTP/3 (with QUIC)`**가 **활성화**되어야 합니다.
* [ ] 사용자의 **개인 정보**가 중요한 경우 **`Onion Routing`**이 **활성화**되어 있는지 확인하세요.

## **트래픽**

TODO

## 사용자 정의 페이지

* [ ] 보안과 관련된 오류가 발생할
## 앱

TODO

## 스크래이프 쉴드

* [ ] **이메일 주소 은닉화**가 **활성화**되어 있는지 확인
* [ ] **서버 측 제외**가 **활성화**되어 있는지 확인

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* HackTricks에서 **회사 광고를 보거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**를** **팔로우**하세요.
* **HackTricks**와 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>
