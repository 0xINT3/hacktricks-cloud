# Cloudflare 도메인

<details>

<summary><strong>제로부터 영웅이 될 때까지 AWS 해킹을 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나 PDF로 HackTricks를 다운로드하고 싶다면** [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 굿즈**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [디스코드 그룹](https://discord.gg/hRep4RUj7f)** 또는 [텔레그램 그룹](https://t.me/peass)에 **가입**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* **해킹 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소로 PR을 제출하세요.

</details>

Cloudflare에 구성된 각 TLD에는 구성할 수 있는 **일반 설정 및 서비스**가 있습니다. 이 페이지에서는 각 섹션의 **보안 관련 설정을 분석**할 것입니다.

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

## 개요

* [ ] 계정의 서비스 **사용량을 파악**해보세요
* [ ] **존 ID** 및 **계정 ID**도 찾아보세요

## 분석

* [ ] **`보안`**에서 **Rate limiting**이 있는지 확인하세요

## DNS

* [ ] DNS **레코드**에서 **흥미로운** (민감한?) 데이터를 확인하세요
* [ ] **이름**에 기반한 **민감한 정보**가 포함될 수 있는 **하위 도메인**을 확인하세요 (예: admin173865324.domin.com)
* [ ] **프록시되지 않는** 웹 페이지를 확인하세요
* [ ] CNAME 또는 IP 주소로 **직접 액세스할 수 있는 프록시된 웹 페이지**를 확인하세요
* [ ] **DNSSEC**가 **활성화**되어 있는지 확인하세요
* [ ] **모든 CNAME**에서 **CNAME Flattening**이 **사용**되었는지 확인하세요
* 이것은 **하위 도메인 탈취 취약점을 숨기고** 로드 시간을 개선하는 데 유용할 수 있습니다
* [ ] 도메인이 [**스푸핑에 취약하지 않은지**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing) 확인하세요

## **이메일**

TODO

## Spectrum

TODO

## SSL/TLS

### **개요**

* [ ] **SSL/TLS 암호화**는 **Full** 또는 **Full (Strict)**이어야 합니다. 그 외의 경우 언젠가는 **평문 트래픽**을 보낼 것입니다.
* [ ] **SSL/TLS 추천자**가 활성화되어 있어야 합니다

### Edge Certificates

* [ ] **항상 HTTPS 사용**이 **활성화**되어 있어야 합니다
* [ ] **HTTP Strict Transport Security (HSTS)**가 **활성화**되어 있어야 합니다
* [ ] **최소 TLS 버전은 1.2**여야 합니다
* [ ] **TLS 1.3가 활성화**되어 있어야 합니다
* [ ] **자동 HTTPS Rewrites**가 **활성화**되어 있어야 합니다
* [ ] **인증서 투명성 모니터링**이 **활성화**되어 있어야 합니다

## **보안**

* [ ] **`WAF`** 섹션에서 **악용을 방지**하기 위해 **방화벽** 및 **Rate limiting 규칙이 사용**되었는지 확인하는 것이 흥미로울 것입니다.
* **`Bypass`** 작업은 요청에 대해 **Cloudflare 보안 기능을 비활성화**합니다. 사용해서는 안 됩니다.
* [ ] **`Page Shield`** 섹션에서 사용 중인 페이지가 있다면 **활성화**되어 있는지 확인하는 것이 좋습니다
* [ ] **`API Shield`** 섹션에서 노출된 API가 있다면 **활성화**되어 있는지 확인하는 것이 좋습니다
* [ ] **`DDoS`** 섹션에서 **DDoS 보호**를 활성화하는 것이 좋습니다
* [ ] **`설정`** 섹션에서:
* [ ] **`보안 수준`**이 **중간** 이상인지 확인하세요
* [ ] **`도전 통과`**가 최대 1시간인지 확인하세요
* [ ] **`브라우저 무결성 확인`**이 **활성화**되어 있는지 확인하세요
* [ ] **`개인 정보 보호 패스 지원`**이 **활성화**되어 있는지 확인하세요

### **CloudFlare DDoS 보호**

* 가능하다면 **Bot Fight Mode** 또는 **Super Bot Fight Mode**를 활성화하세요. 예를 들어 JS 프론트 엔드 페이지에서 프로그래밍 방식으로 액세스하는 API를 보호하는 경우 이를 활성화하지 않고는 해당 액세스를 중단할 수 없을 수도 있습니다.
* **WAF**에서: **URL 경로별로 rate limit** 또는 **확인된 봇에 대한 rate limit**을 생성하거나 IP, Cookie, referrer를 기반으로 액세스를 차단할 수 있습니다). 웹 페이지에서 오지 않거나 쿠키가 없는 요청을 차단할 수 있습니다.
* 공격이 **확인된 봇**에서 발생하는 경우, 적어도 봇에 대한 **rate limit**을 추가하세요.
* 공격이 **특정 경로**로 이루어지는 경우, 예방 메커니즘으로 이 경로에 **rate limit**을 추가하세요.
* **도구**에서 **IP 주소, IP 범위, 국가 또는 ASNs를 화이트리스트**로 지정할 수 있습니다.
* **관리되는 규칙**이 취약점 악용을 방지하는 데 도움이 될 수 있는지 확인하세요.
* **도구** 섹션에서 **특정 IP** 및 **사용자 에이전트에 대해 차단**하거나 **도전을 제공**할 수 있습니다.
* DDoS에서 **일부 규칙을 더 제한적으로 설정**할 수 있습니다.
* **설정**: **보안 수준**을 **높음**으로 설정하고 **공격을 받고 있다면 공격을 받고 있다고 설정**하고 **브라우저 무결성 확인이 활성화**되어 있는지 확인하세요.
* Cloudflare 도메인 -> 분석 -> 보안 -> **rate limit**이 활성화되어 있는지 확인하세요
* Cloudflare 도메인 -> 보안 -> 이벤트 -> **감지된 악성 이벤트**를 확인하세요

## 액세스

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## 속도

_보안과 관련된 옵션을 찾을 수 없었습니다_

## 캐싱

* [ ] **`구성`** 섹션에서 **CSAM 스캔 도구**를 활성화하는 것을 고려해보세요

## **워커 라우트**

_이미_ [_cloudflare workers_](./#workers)를 확인했어야 합니다

## 규칙

TODO

## 네트워크

* [ ] **`HTTP/2`**가 **활성화**되어 있다면 **`HTTP/2 to Origin`**도 **활성화**되어 있어야 합니다
* [ ] **`HTTP/3 (with QUIC)`**가 **활성화**되어 있어야 합니다
* 사용자의 **개인 정보**가 중요한 경우 **`Onion Routing`**이 **활성화**되어 있는지 확인하세요

## **트래픽**

TODO

## 사용자 정의 페이지

* [ ] 보안과 관련된 오류가 발생할 때 사용자 정의 페이지를 구성하는 것이 선택 사항입니다 (차단, rate limiting 또는 공격 받고 있다는 모드와 관련된 오류) 

## 앱

TODO
## 스크레이프 쉴드

* [ ] **이메일 주소 숨김**이 **활성화**되어 있는지 확인
* [ ] **서버 측 제외**가 **활성화**되어 있는지 확인

## **Zaraz**

할 일

## **Web3**

할 일

<details>

<summary><strong>제로부터 히어로가 되는 AWS 해킹을 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나** **PDF 형식의 HackTricks를 다운로드**하려면 [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**디스코드 그룹**](https://discord.gg/hRep4RUj7f)에 가입하거나 [**텔레그램 그룹**](https://t.me/peass)에 가입하거나** 트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우하세요.**
* **해킹 트릭을 공유하려면 PR을 제출하여** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 기여하세요.

</details>
