# Dominios de Cloudflare

<details>

<summary><strong>¬°Apoya a HackTricks y obt√©n beneficios!</strong></summary>

* Si quieres ver tu **empresa anunciada en HackTricks** o si quieres acceder a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**, ¬°consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>

En cada TLD configurado en Cloudflare, hay algunas **configuraciones y servicios generales** que se pueden configurar. En esta p√°gina vamos a **analizar las configuraciones relacionadas con la seguridad de cada secci√≥n**:

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## Resumen

* [ ] Obt√©n una idea de **cu√°nto se utilizan** los servicios de la cuenta
* [ ] Encuentra tambi√©n el **ID de zona** y el **ID de cuenta**

## Anal√≠ticas

* [ ] En **`Seguridad`**, verifica si hay alg√∫n **l√≠mite de velocidad**

## DNS

* [ ] Verifica si hay datos **interesantes** (¬øsensibles?) en los **registros DNS**
* [ ] Verifica si hay **subdominios** que podr√≠an contener **informaci√≥n sensible** bas√°ndose solo en el **nombre** (como admin173865324.domin.com)
* [ ] Verifica si hay p√°ginas web que **no est√°n** **proxyfied**
* [ ] Verifica si hay p√°ginas web **proxyfied** que se pueden **acceder directamente** mediante CNAME o direcci√≥n IP
* [ ] Verifica si **DNSSEC** est√° **habilitado**
* [ ] Verifica si **CNAME Flattening** se **utiliza** en **todos los CNAMEs**
* Esto podr√≠a ser √∫til para **ocultar vulnerabilidades de apropiaci√≥n de subdominios** y mejorar los tiempos de carga
* [ ] Verifica si los dominios [**no son vulnerables a la suplantaci√≥n de identidad**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

## **Correo electr√≥nico**

TODO

## Spectrum

TODO

## SSL/TLS

### **Resumen**

* [ ] El cifrado **SSL/TLS** debe ser **Completo** o **Completo (estricto)**. Cualquier otro enviar√° tr√°fico en **texto claro** en alg√∫n momento.
* [ ] El **Recomendador SSL/TLS** debe estar habilitado

### Certificados de borde

* [ ] Debe estar habilitada la opci√≥n **Usar siempre HTTPS**
* [ ] Debe estar habilitada la opci√≥n **HTTP Strict Transport Security (HSTS)**
* [ ] La **Versi√≥n m√≠nima de TLS** debe ser 1.2
* [ ] Debe estar habilitado **TLS 1.3**
* [ ] Debe estar habilitada la opci√≥n **Reescritura autom√°tica de HTTPS**
* [ ] Debe estar habilitada la opci√≥n **Monitorizaci√≥n de transparencia de certificados**

## **Seguridad**

* [ ] En la secci√≥n **`WAF`**, es interesante verificar que se utilizan reglas de **Firewall** y **l√≠mites de velocidad** para prevenir abusos.
* La acci√≥n **`Bypass`** deshabilitar√° las funciones de seguridad de Cloudflare para una solicitud. No se debe utilizar.
* [ ] En la secci√≥n **`Page Shield`**, se recomienda verificar que est√© **habilitado** si se utiliza alguna p√°gina
* [ ] En la secci√≥n **`API Shield`**, se recomienda verificar que est√© **habilitado** si se expone alguna API en Cloudflare
* [ ] En la secci√≥n **`DDoS`**, se recomienda habilitar las **protecciones DDoS**
* [ ] En la secci√≥n **`Configuraci√≥n`**:
* [ ] Verifica que el **`Nivel de seguridad`** sea **medio** o superior
* [ ] Verifica que el **`Paso del desaf√≠o`** sea de m√°ximo 1 hora
* [ ] Verifica que la **`Comprobaci√≥n de integridad del navegador`** est√© **habilitada**
* [ ] Verifica que el **`Soporte de Privacy Pass`** est√© **habilitado**

### **Protecci√≥n DDoS de CloudFlare**

* Si es posible, habilita el modo **Bot Fight** o **Super Bot Fight**. Si est√°s protegiendo alguna API a la que se accede program√°ticamente (desde una p√°gina de frontend de JS, por ejemplo), es posible que no puedas habilitar esto sin interrumpir ese acceso.
* En **WAF**: Puedes crear **l√≠mites de velocidad por ruta de URL** (reglas de l√≠mite de velocidad) o **bloquear el acceso** seg√∫n la IP, la cookie, el referente, etc. Por lo tanto, podr√≠as bloquear solicitudes que no provengan de una p√°gina web o que no tengan una cookie.
* Si no puedes bloquear todos los bots, al menos agrega un l√≠mite de velocidad para los bots.
* Tambi√©n puedes **poner en lista blanca** direcciones IP, rangos de IP, pa√≠ses o ASNs desde las **Herramientas** en WAF.
* Verifica si las **reglas administradas** tambi√©n pueden ayudar a prevenir la explotaci√≥n de vulnerabilidades.
* En la secci√≥n de Herramientas, puedes **bloquear o desafiar a IPs espec√≠ficas**
* En DDoS, puedes **anular algunas reglas para hacerlas m√°s restrictivas**.
* **Configuraci√≥n**: Establece el **Nivel de seguridad** en **Alto** y en **Bajo ataque** si est√°s bajo ataque, y verifica que la **Comprobaci√≥n de integridad del navegador est√© habilitada**.
* En Cloudflare Domains -> Anal√≠ticas -> Seguridad -> Verifica si est√° habilitado el **l√≠mite de velocidad**
* En Cloudflare Domains -> Seguridad -> Eventos -> Verifica los **eventos maliciosos detectados**

## Acceso

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Velocidad

_No pude encontrar ninguna opci√≥n relacionada con la seguridad_

## Cach√©

* [ ] En la secci√≥n **`Configuraci√≥n`**, considera habilitar la **Herramienta de escaneo CSAM**

## **Rutas de los workers**

_Ya deber√≠as haber verificado_ [_los workers de Cloudflare_](./#workers)

## Reglas

TODO
## Red

* [ ] Si **`HTTP/2`** est√° **habilitado**, se debe habilitar **`HTTP/2 to Origin`**
* [ ] Se debe habilitar **`HTTP/3 (con QUIC)`**
* [ ] Si la **privacidad** de tus **usuarios** es importante, aseg√∫rate de que est√© habilitado el **enrutamiento de cebolla (Onion Routing)**

## **Tr√°fico**

TODO

## P√°ginas personalizadas

* [ ] Es opcional configurar p√°ginas personalizadas cuando se produce un error relacionado con la seguridad (como un bloqueo, l√≠mite de velocidad o modo "Estoy bajo ataque")

## Aplicaciones

TODO

## Protecci√≥n contra scraping

* [ ] Verificar que la **obfuscaci√≥n de direcciones de correo electr√≥nico** est√© **habilitada**
* [ ] Verificar que las **exclusiones del lado del servidor** est√©n **habilitadas**

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>¬°Apoya a HackTricks y obt√©n beneficios!</strong></summary>

* Si quieres ver tu **empresa anunciada en HackTricks** o si quieres acceder a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop).
* Obt√©n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>
