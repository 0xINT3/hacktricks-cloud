# Dominios de Cloudflare

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs exclusivos**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

En cada TLD configurado en Cloudflare hay algunos **ajustes y servicios generales** que se pueden configurar. En esta p√°gina vamos a **analizar los ajustes relacionados con la seguridad de cada secci√≥n:**

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## Resumen

* [ ] Tener una idea de **cu√°nto** se utilizan los servicios de la cuenta
* [ ] Encontrar tambi√©n el **ID de zona** y el **ID de cuenta**

## Anal√≠ticas

* [ ] En **`Seguridad`** verificar si hay alg√∫n **L√≠mite de tasa**

## DNS

* [ ] Verificar datos **interesantes** (¬øsensibles?) en los **registros DNS**
* [ ] Buscar **subdominios** que podr√≠an contener **informaci√≥n sensible** solo por el **nombre** (como admin173865324.domin.com)
* [ ] Buscar p√°ginas web que **no est√©n** **proxyficadas**
* [ ] Verificar p√°ginas web **proxyficadas** que se puedan **acceder directamente** por CNAME o direcci√≥n IP
* [ ] Verificar que **DNSSEC** est√© **habilitado**
* [ ] Verificar que se **utilice CNAME Flattening** en **todos los CNAMEs**
* Esto podr√≠a ser √∫til para **ocultar vulnerabilidades de toma de subdominios** y mejorar los tiempos de carga
* [ ] Verificar que los dominios [**no sean vulnerables al spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

## **Correo Electr√≥nico**

TODO

## Spectrum

TODO

## SSL/TLS

### **Resumen**

* [ ] La **encriptaci√≥n SSL/TLS** debe ser **Completa** o **Completa (Estricta)**. Cualquier otra enviar√° **tr√°fico en texto claro** en alg√∫n momento.
* [ ] El **Recomendador SSL/TLS** debe estar habilitado

### Certificados Edge

* [ ] **Usar siempre HTTPS** debe estar **habilitado**
* [ ] **HTTP Strict Transport Security (HSTS)** debe estar **habilitado**
* [ ] **La versi√≥n m√≠nima de TLS debe ser 1.2**
* [ ] **TLS 1.3 debe estar habilitado**
* [ ] **Reescrituras autom√°ticas de HTTPS** deben estar **habilitadas**
* [ ] **Monitoreo de Transparencia de Certificados** debe estar **habilitado**

## **Seguridad**

* [ ] En la secci√≥n **`WAF`** es interesante verificar que se utilicen **reglas de Firewall** y de **l√≠mite de tasa** para prevenir abusos.
* La acci√≥n **`Bypass`** **deshabilitar√° las funciones de seguridad de Cloudflare** para una solicitud. No se debe usar.
* [ ] En la secci√≥n **`Page Shield`** se recomienda verificar que est√© **habilitado** si se utiliza alguna p√°gina
* [ ] En la secci√≥n **`API Shield`** se recomienda verificar que est√© **habilitado** si alguna API est√° expuesta en Cloudflare
* [ ] En la secci√≥n **`DDoS`** se recomienda habilitar las **protecciones DDoS**
* [ ] En la secci√≥n **`Ajustes`**:
* [ ] Verificar que el **`Nivel de Seguridad`** sea **medio** o superior
* [ ] Verificar que el **`Paso de Desaf√≠o`** sea de 1 hora como m√°ximo
* [ ] Verificar que la **`Verificaci√≥n de Integridad del Navegador`** est√© **habilitada**
* [ ] Verificar que el **`Soporte de Privacy Pass`** est√© **habilitado**

### **Protecci√≥n DDoS de CloudFlare**

* Si puedes, habilita **Modo de Lucha contra Bots** o **Modo de Lucha contra Super Bots**. Si est√°s protegiendo alguna API accedida program√°ticamente (desde una p√°gina frontal de JS, por ejemplo). Puede que no puedas habilitar esto sin romper ese acceso.
* En **WAF**: Puedes crear **l√≠mites de tasa por ruta de URL** o para **bots verificados** (reglas de l√≠mite de tasa), o para **bloquear el acceso** basado en IP, Cookie, referente...). As√≠ podr√≠as bloquear solicitudes que no provengan de una p√°gina web o que no tengan una cookie.
* Si el ataque es de un **bot verificado**, al menos **a√±ade un l√≠mite de tasa** a los bots.
* Si el ataque es a una **ruta espec√≠fica**, como mecanismo de prevenci√≥n, a√±ade un **l√≠mite de tasa** en esta ruta.
* Tambi√©n puedes **poner en lista blanca** direcciones IP, rangos de IP, pa√≠ses o ASNs desde las **Herramientas** en WAF.
* Verifica si las **Reglas gestionadas** tambi√©n podr√≠an ayudar a prevenir la explotaci√≥n de vulnerabilidades.
* En la secci√≥n **Herramientas** puedes **bloquear o dar un desaf√≠o a IPs espec√≠ficas** y **agentes de usuario.**
* En DDoS podr√≠as **sobrescribir algunas reglas para hacerlas m√°s restrictivas**.
* **Ajustes**: Establece el **Nivel de Seguridad** a **Alto** y a **Bajo Ataque** si est√°s bajo ataque y que la **Verificaci√≥n de Integridad del Navegador est√© habilitada**.
* En Dominios de Cloudflare -> Anal√≠ticas -> Seguridad -> Verificar si el **l√≠mite de tasa** est√° habilitado
* En Dominios de Cloudflare -> Seguridad -> Eventos -> Verificar **Eventos maliciosos detectados**

## Acceso

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}
## Velocidad

_No pude encontrar ninguna opci√≥n relacionada con la seguridad_

## Cach√©

* [ ] En la secci√≥n **`Configuraci√≥n`** considera habilitar la **Herramienta de Escaneo CSAM**

## **Rutas de Workers**

_Ya deber√≠as haber revisado_ [_cloudflare workers_](./#workers)

## Reglas

TODO

## Red

* [ ] Si **`HTTP/2`** est√° **habilitado**, **`HTTP/2 hacia el Origen`** deber√≠a estar **habilitado**
* [ ] **`HTTP/3 (con QUIC)`** deber√≠a estar **habilitado**
* [ ] Si la **privacidad** de tus **usuarios** es importante, aseg√∫rate de que **`Enrutamiento Onion`** est√© **habilitado**

## **Tr√°fico**

TODO

## P√°ginas Personalizadas

* [ ] Es opcional configurar p√°ginas personalizadas cuando se activa un error relacionado con la seguridad (como un bloqueo, limitaci√≥n de tasa o modo de ataque)

## Aplicaciones

TODO

## Escudo Anti-Scraping

* [ ] Verifica que la **Ofuscaci√≥n de Direcciones de Correo Electr√≥nico** est√© **habilitada**
* [ ] Verifica que los **Excluyentes del Lado del Servidor** est√©n **habilitados**

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
