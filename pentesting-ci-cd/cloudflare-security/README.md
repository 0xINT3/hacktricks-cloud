# Sicurezza di Cloudflare

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di github.

</details>

In un account Cloudflare ci sono alcune **impostazioni generali e servizi** che possono essere configurati. In questa pagina andremo ad **analizzare le impostazioni relative alla sicurezza di ogni sezione:**

<figure><img src="../../.gitbook/assets/image (85) (1).png" alt=""><figcaption></figcaption></figure>

## Siti web

Esamina ognuno con:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Registrazione del dominio

* [ ] In **`Trasferimento domini`** verifica che non sia possibile trasferire alcun dominio.

Esamina ognuno con:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analisi

_Non ho trovato nulla da controllare per una revisione della configurazione di sicurezza._

## Pagine

Su ogni pagina di Cloudflare:

* [ ] Controlla la presenza di **informazioni sensibili** nel **`Registro di compilazione`**.
* [ ] Controlla la presenza di **informazioni sensibili** nel repository **Github** assegnato alle pagine.
* [ ] Controlla la possibilit√† di compromettere il repository Github tramite **iniezione di comandi nel workflow** o compromissione di `pull_request_target`. Ulteriori informazioni nella [**pagina di sicurezza di Github**](../github-security/).
* [ ] Controlla la presenza di **funzioni vulnerabili** nella directory `/fuctions` (se presente), controlla i **reindirizzamenti** nel file `_redirects` (se presente) e gli **header mal configurati** nel file `_headers` (se presente).
* [ ] Controlla la presenza di **vulnerabilit√†** nella **pagina web** tramite **blackbox** o **whitebox** se puoi **accedere al codice**
* [ ] Nei dettagli di ogni pagina `/<page_id>/pages/view/blocklist/settings/functions`. Controlla la presenza di **informazioni sensibili** nelle **`Variabili di ambiente`**.
* [ ] Nella pagina dei dettagli controlla anche il **comando di compilazione** e la **directory principale** per **possibili iniezioni** per compromettere la pagina.

## **Workers**

Su ogni worker di Cloudflare controlla:

* [ ] I trigger: Cosa fa scattare il worker? Un **utente pu√≤ inviare dati** che verranno **utilizzati** dal worker?
* [ ] Nelle **`Impostazioni`**, controlla le **`Variabili`** che contengono **informazioni sensibili**
* [ ] Controlla il **codice del worker** e cerca **vulnerabilit√†** (soprattutto nei punti in cui l'utente pu√≤ gestire l'input)
* Controlla gli SSRF restituendo la pagina indicata che puoi controllare
* Controlla gli XSS eseguendo JS all'interno di un'immagine svg

{% hint style="warning" %}
Nota che per impostazione predefinita a un **Worker viene assegnato un URL** come `<nome-worker>.<account>.workers.dev`. L'utente pu√≤ impostarlo su un **sottodominio**, ma puoi sempre accedervi con quell'**URL originale** se lo conosci.
{% endhint %}

## R2

TODO

## Stream

TODO

## Immagini

TODO

## Centro di sicurezza

* [ ] Se possibile, esegui una **scansione delle informazioni di sicurezza** di **Security Insights** e una **scansione dell'infrastruttura**, in quanto evidenzieranno informazioni interessanti dal punto di vista della **sicurezza**.
* [ ] Controlla queste informazioni per eventuali errori di configurazione della sicurezza e informazioni interessanti

## Turnstile

TODO

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Reindirizzamenti di massa

{% hint style="info" %}
A differenza dei [Reindirizzamenti dinamici](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/), i [**Reindirizzamenti di massa**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) sono essenzialmente statici: **non supportano operazioni di sostituzione di stringhe** o espressioni regolari. Tuttavia, √® possibile configurare parametri di reindirizzamento URL che influiscono sul comportamento di corrispondenza degli URL e sul loro comportamento in fase di esecuzione.
{% endhint %}

* [ ] Verifica che le **espressioni** e i **requisiti** per i reindirizzamenti abbiano **senso**.
* [ ] Controlla anche la presenza di **endpoint nascosti sensibili** che contengono informazioni interessanti.

## Notifiche

* [ ] Controlla le **notifiche**. Queste notifiche sono consigliate per la sicurezza:
* `Fatturazione basata sull'utilizzo`
* `Avviso di attacco HTTP DDoS`
* `Avviso di attacco DDoS di livello 3/4`
* `Avviso di attacco HTTP DDoS avanzato`
* `Avviso di attacco DDoS di livello 3/4 avanzato`
* `Monitoraggio basato sul flusso: attacco volumetrico`
* `Avviso di rilevamento di perdita di rotta`
* `Avviso di scadenza del certificato mTLS di accesso`
* `Avviso di hostname personalizzati SSL per SaaS`
* `Avviso SSL universale`
* `Avviso di rilevamento di nuova modifica del codice di monitoraggio dello script`
* `Avviso di rilevamento di nuovo dominio di monitoraggio dello script`
* `Avviso di rilevamento di nuovo dominio dannoso di monitoraggio dello script`
* `Avviso di rilevamento di nuovo script dannoso di monitoraggio dello script`
* `Avviso di rilevamento di nuovo URL dannoso di monitoraggio dello script`
* `Avviso di rilevamento di nuovi script di monitoraggio dello script`
* `Avviso di rilevamento di nuovo script che supera la lunghezza massima dell'URL di monitoraggio dello script`
* `Avviso di eventi di sicurezza avanzati`
* `Avviso di eventi di sicurezza`
* [ ] Controlla tutte le **destinazioni**, in quanto potrebbero contenere **informazioni sensibili** (autenticazione di base http) negli URL del webhook. Assicurati anche che gli URL del webhook utilizzino **HTTPS**
* [ ] Come controllo aggiuntivo, potresti provare a **fingere di essere una notifica di Cloudflare** verso un terzo, forse puoi in qualche modo **iniettare qualcosa di pericoloso**

## Gestisci account

* [ ] √à possibile vedere gli **ultimi 4 numeri della carta di credito**, la **data di scadenza** e l'**indirizzo di fatturazione** in **`Fatturazione` -> `Informazioni di pagamento`**.
* [ ] √à possibile vedere il **tipo di piano** utilizzato nell'account in **`Fatturazione` -> `Sottoscrizioni`**.
* [ ] In **`Membri`** √® possibile vedere tutti i membri dell'account e il loro **ruolo**. Nota che se il tipo di piano non √® Enterprise, esistono solo 2 ruoli: Amministratore e Super Amministratore. Ma se viene utilizzato un **piano Enterprise**, √® possibile utilizzare [**altri ruoli**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) per seg
## Investigazione DDoS

[Controlla questa parte](cloudflare-domains.md#cloudflare-ddos-protection).

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF**, controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>
