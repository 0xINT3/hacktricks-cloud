# S√©curit√© Cloudflare

<details>

<summary><strong>Soutenez HackTricks et obtenez des avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **d√©p√¥ts Github.**

</details>

Dans un compte Cloudflare, il y a des **param√®tres et services g√©n√©raux** qui peuvent √™tre configur√©s. Dans cette page, nous allons **analyser les param√®tres li√©s √† la s√©curit√© de chaque section :**

<figure><img src="../../.gitbook/assets/image (85) (1).png" alt=""><figcaption></figcaption></figure>

## Sites Web

Examinez chacun avec :

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Enregistrement de domaine

* [ ] Dans **`Transf√©rer des domaines`**, v√©rifiez qu'il n'est pas possible de transf√©rer un domaine.

Examinez chacun avec :

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analytique

_Je n'ai rien trouv√© √† v√©rifier pour une analyse de s√©curit√© de la configuration._

## Pages

Sur chaque page de Cloudflare :

* [ ] V√©rifiez la pr√©sence d'**informations sensibles** dans le **`journal de construction`**.
* [ ] V√©rifiez la pr√©sence d'**informations sensibles** dans le **d√©p√¥t Github** assign√© aux pages.
* [ ] V√©rifiez la compromission potentielle du d√©p√¥t Github via l'**injection de commandes de workflow** ou la compromission de \*\*`pull_request_target` \*\*. Plus d'informations sur la [**page de s√©curit√© Github**](../github-security/).
* [ ] V√©rifiez la pr√©sence de **fonctions vuln√©rables** dans le r√©pertoire `/fuctions` (s'il y en a), v√©rifiez les **redirections** dans le fichier `_redirects` (s'il y en a) et les **en-t√™tes mal configur√©s** dans le fichier `_headers` (s'il y en a).
* [ ] V√©rifiez la pr√©sence de **vuln√©rabilit√©s** sur la **page web** via une analyse **bo√Æte noire** ou **bo√Æte blanche** si vous pouvez **acc√©der au code**
* [ ] Dans les d√©tails de chaque page \*\*\*\* `/<page_id>/pages/view/blocklist/settings/functions`. V√©rifiez la pr√©sence d'**informations sensibles** dans les **`Variables d'environnement`**.
* [ ] Dans la page de d√©tails, v√©rifiez √©galement la **commande de construction** et le **r√©pertoire racine** pour les **injections potentielles** afin de compromettre la page.

## **Workers**

Sur chaque worker de Cloudflare, v√©rifiez :

* [ ] Les d√©clencheurs : qu'est-ce qui d√©clenche le worker ? Un **utilisateur peut-il envoyer des donn√©es** qui seront **utilis√©es** par le worker ?
* [ ] Dans les **`Param√®tres`**, v√©rifiez la pr√©sence de **`Variables`** contenant des **informations sensibles**
* [ ] V√©rifiez le **code du worker** et recherchez des **vuln√©rabilit√©s** (en particulier dans les endroits o√π l'utilisateur peut g√©rer l'entr√©e)
  * V√©rifiez les SSRF renvoyant la page indiqu√©e que vous pouvez contr√¥ler
  * V√©rifiez les XSS ex√©cutant du JS √† l'int√©rieur d'une image svg

{% hint style="warning" %}
Notez qu'en g√©n√©ral, un **Worker est donn√© une URL** telle que `<worker-name>.<account>.workers.dev`. L'utilisateur peut le d√©finir sur un **sous-domaine** mais vous pouvez toujours y acc√©der avec cette **URL d'origine** si vous la connaissez.
{% endhint %}

## R2

TODO

## Stream

TODO

## Images

TODO

## Centre de s√©curit√©

* [ ] Si possible, ex√©cutez une **analyse de s√©curit√©** des **`Insights de s√©curit√©`** et une **analyse de l'infrastructure** des **`Infrastructure`**, car elles mettront en √©vidence des informations int√©ressantes en termes de **s√©curit√©**.
  * [ ] V√©rifiez simplement ces informations pour les erreurs de configuration de s√©curit√© et les informations int√©ressantes.

## Turnstile

TODO

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Redirections en masse

{% hint style="info" %}
Contrairement aux [Redirections dynamiques](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/), les [**Redirections en masse**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) sont essentiellement statiques - elles ne prennent en charge **aucune op√©ration de remplacement de cha√Æne** ou expressions r√©guli√®res. Cependant, vous pouvez configurer des param√®tres de redirection d'URL qui affectent leur comportement de correspondance d'URL et leur comportement d'ex√©cution.
{% endhint %}

* [ ] V√©rifiez que les **expressions** et les **exigences** pour les redirections **ont du sens**.
* [ ] V√©rifiez √©galement la pr√©sence d'**endpoints cach√©s sensibles** qui contiennent des informations int√©ressantes.

## Notifications

* [ ] V√©rifiez les **notifications**. Ces notifications sont recommand√©es pour la s√©curit√© :
  * `Facturation bas√©e sur l'utilisation`
  * `Alerte d'attaque HTTP DDoS`
  * `Alerte d'attaque de couche 3/4 DDoS`
  * `Alerte d'attaque HTTP DDoS avanc√©e`
  * `Alerte d'attaque de couche 3/4 DDoS avanc√©e`
  * `Surveillance bas√©e sur le flux : Attaque volum√©trique`
  * `Alerte de d√©tection de fuite de route`
  * `Alerte d'expiration de certificat mTLS d'acc√®s`
  * `Alerte d'h√¥tes personnalis√©s SSL pour SaaS`
  * `Alerte SSL universel`
  * `Alerte de d√©tection de changement de code de nouveau moniteur de script`
  * `Alerte de nouveau domaine de moniteur de script`
  * `Alerte de nouveau domaine malveillant de moniteur de script`
  * `Alerte de nouveau script malveillant de moniteur de script`
  * `Alerte de nouvelle URL malveillante de moniteur de script`
  * `Alerte de nouveaux scripts de moniteur de script`
  * `Alerte de d√©passement de la longueur d'URL maximale de nouveau script de moniteur de script`
  * `Alerte d'√©v√©nements de s√©curit√© avanc√©s`
  * `Alerte d'√©v√©nements de s√©curit√©`
* [ ] V√©rifiez toutes les **destinations**, car il peut