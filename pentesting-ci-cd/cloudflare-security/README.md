# Cloudflare 보안

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* HackTricks에서 **회사 광고를 보거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **Hacking 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>

Cloudflare 계정에는 구성할 수 있는 일부 **일반 설정 및 서비스**가 있습니다. 이 페이지에서는 각 섹션의 **보안 관련 설정을 분석**하겠습니다:

<figure><img src="../../.gitbook/assets/image (85) (1).png" alt=""><figcaption></figcaption></figure>

## 웹사이트

각각을 검토하세요:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### 도메인 등록

* [ ] **`도메인 이전`**에서 어떤 도메인도 이전할 수 없는지 확인하세요.

각각을 검토하세요:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## 분석

_구성 보안 검토를 위해 확인할 내용을 찾지 못했습니다._

## 페이지

각 Cloudflare 페이지에서:

* [ ] **`빌드 로그`**에 **민감한 정보**가 있는지 확인하세요.
* [ ] 페이지에 할당된 **Github 저장소**에서 **민감한 정보**가 있는지 확인하세요.
* [ ] **워크플로우 명령 삽입** 또는 `pull_request_target` 침해를 통한 **포텐셜한 Github 저장소 침해**를 확인하세요. 자세한 내용은 [**Github Security 페이지**](../github-security/)를 참조하세요.
* [ ] `/fuctions` 디렉토리(있는 경우)의 **취약한 함수**, `_redirects` 파일(있는 경우)의 **리디렉션**, `_headers` 파일(있는 경우)의 **잘못 구성된 헤더**를 확인하세요.
* [ ] **웹 페이지**에서 **블랙박스** 또는 **화이트박스**를 통해 **취약점**을 확인하세요. 코드에 **액세스할 수 있다면**.
* [ ] 각 페이지의 세부 정보 `/<page_id>/pages/view/blocklist/settings/functions`에서 **`환경 변수`**에 **민감한 정보**가 있는지 확인하세요.
* [ ] 세부 정보 페이지에서 **빌드 명령**과 **루트 디렉토리**도 확인하여 페이지를 침해하기 위한 **포텐셜한 인젝션**을 확인하세요.

## **워커**

각 Cloudflare 워커에서 확인하세요:

* [ ] 트리거: 워커를 트리거하는 요소는 무엇인가요? **사용자가 워커에서 사용할 데이터를 보낼 수 있는지** 확인하세요.
* [ ] **`설정`**에서 **민감한 정보**를 포함하는 **`변수`**를 확인하세요.
* [ ] 워커의 **코드**를 확인하고 **취약점**을 검색하세요(특히 사용자가 입력을 관리할 수 있는 위치에서).
* 제어할 수 있는 지시된 페이지를 반환하는 **SSRF** 확인
* **SVG 이미지 내에서 JS를 실행**하여 **XSS** 확인

{% hint style="warning" %}
기본적으로 **워커는** `<worker-name>.<account>.workers.dev`와 같은 **URL이 제공**됩니다. 사용자는 **서브도메인**으로 설정할 수 있지만, 알고 있다면 항상 해당 **원래 URL**로 액세스할 수 있습니다.
{% endhint %}

## R2

TODO

## 스트림

TODO

## 이미지

TODO

## 보안 센터

* [ ] 가능하다면 **`보안 인사이트`** **스캔**과 **`인프라`** **스캔**을 실행하여 **보안 관련** 흥미로운 정보를 **강조**합니다.
* [ ] 보안 구성 오류 및 흥미로운 정보를 확인하기 위해 이 정보를 **검토**하세요.

## Turnstile

TODO

## **제로 트러스트**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## 대량 리디렉션

{% hint style="info" %}
[동적 리디렉션](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/)과 달리 [**대량 리디렉션**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/)은 기본적으로 정적입니다. **문자열 대체** 작업이나 정규 표현식을 지원하지 **않습니다**. 그러나 URL 일치 동작 및 런타임 동작에 영향을 주는 URL 리디렉션 매개변수를 구성할 수 있습니다.
{% endhint %}

* [ ] 리디렉션의 **표현식**과 **요구 사항**이 **유효한지** 확인하세요.
* [ ] 또한 **민감한 숨겨진 엔드포인트**와 관련된 **URL**을 확인하세요.

## 알림

* [ ] **알림**을 확인하세요. 이러한 알림은 보안을 위해 권장됩니다:
* `Usage Based Billing`
* `HTTP DDoS Attack Alert`
* `Layer 3/4 DDoS Attack Alert`
* `Advanced HTTP DDoS Attack Alert`
* `Advanced Layer 3/4 DDoS Attack Alert`
* `Flow-based Monitoring: Volumetric Attack`
* `Route Leak Detection Alert`
* `Access mTLS Certificate Expiration Alert`
* `SSL for SaaS Custom Hostnames Alert`
* `Universal SSL Alert`
* `Script Monitor New Code Change Detection Alert`
* `Script Monitor New Domain Alert`
* `Script Monitor New Malicious Domain Alert`
* `Script Monitor New Malicious Script Alert`
* `Script Monitor New Malicious URL Alert`
* `Script Monitor New Scripts Alert`
* `Script Monitor New Script Exceeds Max URL Length Alert`
* `Advanced Security Events Alert`
* `Security Events Alert`
* [ ] **목적지**를 모두 확인하세요. 웹훅 URL에 **민감한 정보**(기본 http 인증)가 있을 수 있습니다. 또한 웹훅 URL이 **HTTPS**를 사용하는지 확인하세요.
* [ ] 추가로 확인하기 위해 **클라우드플레어 알림을** 제3자에게 **위장**해 볼 수 있습니다. 어떻게든 **위험한 내용을 삽입**할 수 있을지도 모릅니다.

## 계정 관리

* [ ] **`결제` -> `결제 정보`**에서 **신용카드의 마지막 4자리**, **만료일** 및 **청구 주소**를 볼 수 있습니다.
* [ ] **`결제` -> `구독`**에서 계정에서 사용하는 **플랜 유형**을 볼 수 있습니다.
* [ ] **`멤버`**에서 계
## DDoS 조사

[이 부분을 확인하세요](cloudflare-domains.md#cloudflare-ddos-protection).

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 제로부터 AWS 해킹을 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks**와 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하여 여러분의 해킹 기법을 공유하세요.

</details>
