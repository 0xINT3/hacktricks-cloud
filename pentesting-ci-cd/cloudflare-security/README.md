# Cloudflare Security

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJSTVO**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

U Cloudflare nalogu postoje neka **opšta podešavanja i usluge** koje se mogu konfigurisati. Na ovoj stranici ćemo **analizirati sigurnosna podešavanja u vezi sa svakom sekcijom:**

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## Veb sajtovi

Pregledajte svaki sa:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Registracija domena

* [ ] U **`Transfer Domains`** proverite da nije moguće preneti bilo koju domenu.

Pregledajte svaki sa:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analitika

_Nisam mogao pronaći ništa za proveru sigurnosne konfiguracije._

## Stranice

Na svakoj Cloudflare stranici:

* [ ] Proverite da li postoji **osetljive informacije** u **`Build log`**.
* [ ] Proverite da li postoji **osetljive informacije** u **Github repozitorijumu** dodeljenom stranicama.
* [ ] Proverite mogućnost kompromitovanja github repozitorijuma putem **workflow command injection** ili kompromitovanja putem `pull_request_target`. Više informacija na [**Github Security stranici**](../github-security/).
* [ ] Proverite da li postoje **ranjive funkcije** u `/fuctions` direktorijumu (ako postoje), proverite **preusmere** u `_redirects` fajlu (ako postoje) i **neispravljene zaglavlja** u `_headers` fajlu (ako postoje).
* [ ] Proverite **ranjivosti** na **veb stranici** putem **blackbox** ili **whitebox** ako možete **pristupiti kodu**
* [ ] U detaljima svake stranice `/<page_id>/pages/view/blocklist/settings/functions`. Proverite da li postoje **osetljive informacije** u **`Environment variables`**.
* [ ] Na stranici sa detaljima proverite i **build command** i **root directory** za **potencijalne injekcije** radi kompromitovanja stranice.

## **Workers**

Na svakom Cloudflare-ovom worker-u proverite:

* [ ] Okidači: Šta pokreće worker? Da li **korisnik može poslati podatke** koji će biti **korišćeni** od strane workera?
* [ ] U **`Podešavanjima`**, proverite **`Variables`** koji sadrže **osetljive informacije**
* [ ] Proverite **kod workera** i potražite **ranjivosti** (posebno na mestima gde korisnik može upravljati unosom)
* Proverite SSRF-ove koji vraćaju naznačenu stranicu koju možete kontrolisati
* Proverite XSS-ove koji izvršavaju JS unutar svg slike

{% hint style="warning" %}
Imajte na umu da je podrazumevano **Worker-u dodeljen URL** poput `<worker-name>.<account>.workers.dev`. Korisnik može postaviti poddomen, ali uvek možete pristupiti sa tim **originalnim URL-om** ako ga znate.
{% endhint %}

## R2

TODO

## Stream

TODO

## Slike

TODO

## Centar za sigurnost

* [ ] Ako je moguće, pokrenite **`Security Insights`** **skeniranje** i **`Infrastructure`** **skeniranje**, jer će istaknuti zanimljive informacije u vezi sa sigurnošću.
* [ ] Samo **proverite ove informacije** za sigurnosne neispravnosti i zanimljive informacije

## Turnstile

TODO

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Masovne preusmere

{% hint style="info" %}
Za razliku od [Dinamičnih preusmeravanja](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/), [**Masovne preusmere**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) su suštinski statične — ne podržavaju nikakve operacije zamene nizova ili regularne izraze. Međutim, možete konfigurisati parametre preusmeravanja URL-a koji utiču na njihovo ponašanje pri podudaranju URL-a i njihovo ponašanje u radu.
{% endhint %}

* [ ] Proverite da **izrazi** i **zahtevi** za preusmeravanja **imaju smisla**.
* [ ] Proverite takođe da li postoje **osetljive skrivene tačke završetka** koje sadrže zanimljive informacije.

## Obaveštenja

* [ ] Proverite **obaveštenja**. Ova obaveštenja se preporučuju za sigurnost:
* `Usage Based Billing`
* `HTTP DDoS Attack Alert`
* `Layer 3/4 DDoS Attack Alert`
* `Advanced HTTP DDoS Attack Alert`
* `Advanced Layer 3/4 DDoS Attack Alert`
* `Flow-based Monitoring: Volumetric Attack`
* `Route Leak Detection Alert`
* `Access mTLS Certificate Expiration Alert`
* `SSL for SaaS Custom Hostnames Alert`
* `Universal SSL Alert`
* `Script Monitor New Code Change Detection Alert`
* `Script Monitor New Domain Alert`
* `Script Monitor New Malicious Domain Alert`
* `Script Monitor New Malicious Script Alert`
* `Script Monitor New Malicious URL Alert`
* `Script Monitor New Scripts Alert`
* `Script Monitor New Script Exceeds Max URL Length Alert`
* `Advanced Security Events Alert`
* `Security Events Alert`
* [ ] Proverite sve **destinacije**, jer mogu postojati **osetljive informacije** (osnovna http autentifikacija) u webhook URL-ovima. Takođe se uverite da webhook URL-ovi koriste **HTTPS**
* [ ] Kao dodatnu proveru, možete pokušati da **se predstavite kao obaveštenje od Cloudflare-a** trećoj strani, možda na neki način možete **ubaciti nešto opasno**

## Upravljanje nalogom

* [ ] Moguće je videti **poslednje 4 cifre kreditne kartice**, **datum isteka** i **adresu za naplatu** u **`Billing` -> `Payment info`**.
* [ ] Moguće je videti **tip plana** koji se koristi na nalogu u **`Billing` -> `Subscriptions`**.
* [ ] U **`Members`** je moguće videti sve članove naloga i njihovu **ulogu**. Imajte na umu da ako tip plana nije Enterprise, postoje samo 2 uloge: Administrator i Super Administrator. Ali ako se koristi **Enterprise plan**, [**više uloga**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) može se koristiti kako bi se pratilo načelo najmanjih privilegija.
* Stoga, kad god je moguće, **preporučuje se** korišćenje **Enterprise plana**.
* [ ] U članovima je moguće proveriti koji **članovi** imaju omogućeno **2FA**. **Svaki** korisnik bi trebalo da ga ima omogućenog.

{% hint style="info" %}
Imajte na umu da srećom uloga **`Administrator`** ne daje dozvole za upravljanje članstvima (**ne može eskalirati privilegije ili pozvati** nove članove)
{% endhint %}
## Istraga DDoS napada

[Pogledajte ovaj deo](cloudflare-domains.md#cloudflare-ddos-protection).

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJSTVO**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
