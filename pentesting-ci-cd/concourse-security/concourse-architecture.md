# Concourse 架构

<details>

<summary><strong>支持 HackTricks 并获得福利！</strong></summary>

* 如果您想在 HackTricks 中看到您的公司广告，或者如果您想访问 PEASS 的最新版本或下载 PDF 版的 HackTricks，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方 PEASS 和 HackTricks 商品**](https://peass.creator-spring.com)
* 发现[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub 仓库提交 PR 来**分享您的黑客技巧**。

</details>

## 架构

![](<../../.gitbook/assets/image (39) (1).png>)

### ATC: web UI 和构建调度器

ATC 是 Concourse 的核心。它运行 **web UI 和 API**，负责所有流水线的 **调度**。它连接到 PostgreSQL，用于存储流水线数据（包括构建日志）。

[checker](https://concourse-ci.org/checker.html) 负责持续检查资源的新版本。[scheduler](https://concourse-ci.org/scheduler.html) 负责为作业调度构建。[build tracker](https://concourse-ci.org/build-tracker.html) 负责运行任何已调度的构建。[garbage collector](https://concourse-ci.org/garbage-collector.html) 是清理机制，用于删除未使用或过时的对象，如容器和卷。

### TSA: 工作节点注册和转发

TSA 是一个专门用于安全地将 [**工作节点**](https://concourse-ci.org/internals.html#architecture-worker) 注册到 [ATC](https://concourse-ci.org/internals.html#component-atc) 的自定义 SSH 服务器。

TSA 默认监听端口 `2222`，通常与 [ATC](https://concourse-ci.org/internals.html#component-atc) 部署在一起，并位于负载均衡器后面。

**TSA 在 SSH 连接上实现 CLI**，支持[**这些命令**](https://concourse-ci.org/internals.html#component-tsa)。

### 工作节点

为了执行任务，Concourse 必须拥有一些工作节点。这些工作节点通过 [TSA](https://concourse-ci.org/internals.html#component-tsa) 自行注册，并运行 [**Garden**](https://github.com/cloudfoundry-incubator/garden) 和 [**Baggageclaim**](https://github.com/concourse/baggageclaim) 服务。

* **Garden**：这是容器管理 API，通常通过 **HTTP** 在端口 **7777** 上运行。
* **Baggageclaim**：这是卷管理 API，通常通过 **HTTP** 在端口 **7788** 上运行。

<details>

<summary><strong>支持 HackTricks 并获得福利！</strong></summary>

* 如果您想在 HackTricks 中看到您的公司广告，或者如果您想访问 PEASS 的最新版本或下载 PDF 版的 HackTricks，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方 PEASS 和 HackTricks 商品**](https://peass.creator-spring.com)
* 发现[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub 仓库提交 PR 来**分享您的黑客技巧**。

</details>
