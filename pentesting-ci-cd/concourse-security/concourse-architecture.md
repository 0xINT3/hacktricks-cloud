# Concourse 架构

<details>

<summary><strong>从零到英雄学习 AWS 黑客技术，参加</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想在 **HackTricks 中看到您的公司广告** 或 **下载 HackTricks 的 PDF 版本**，请查看 [**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取 [**官方的 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 探索 [**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家的 [**NFTs 集合**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上 **关注** 我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>

## 架构

![](<../../.gitbook/assets/image (39) (1).png>)

### ATC：web UI 和构建调度器

ATC 是 Concourse 的核心。它运行 **web UI 和 API** 并负责所有管道的 **调度**。它 **连接到 PostgreSQL**，用于存储管道数据（包括构建日志）。

[checker](https://concourse-ci.org/checker.html) 的职责是持续检查资源的新版本。[scheduler](https://concourse-ci.org/scheduler.html) 负责为作业调度构建，而 [build tracker](https://concourse-ci.org/build-tracker.html) 负责运行任何已调度的构建。[garbage collector](https://concourse-ci.org/garbage-collector.html) 是清理机制，用于移除任何未使用或过时的对象，例如容器和卷。

### TSA：工作节点注册和转发

TSA 是一个 **定制的 SSH 服务器**，专门用于安全地 **注册** [**工作节点**](https://concourse-ci.org/internals.html#architecture-worker) 至 [ATC](https://concourse-ci.org/internals.html#component-atc)。

TSA **默认监听端口 `2222`**，通常与 [ATC](https://concourse-ci.org/internals.html#component-atc) 位于同一位置，并位于负载均衡器后面。

**TSA 通过 SSH 连接实现 CLI，** 支持 [**这些命令**](https://concourse-ci.org/internals.html#component-tsa)。

### 工作节点

为了执行任务，Concourse 必须有一些工作节点。这些工作节点通过 [TSA](https://concourse-ci.org/internals.html#component-tsa) **注册自己** 并运行服务 [**Garden**](https://github.com/cloudfoundry-incubator/garden) 和 [**Baggageclaim**](https://github.com/concourse/baggageclaim)。

* **Garden**: 这是 **容器管理 API**，通常在 **端口 7777** 通过 **HTTP** 运行。
* **Baggageclaim**: 这是 **卷管理 API**，通常在 **端口 7788** 通过 **HTTP** 运行。

# 参考资料
* [https://concourse-ci.org/internals.html](https://concourse-ci.org/internals.html)


<details>

<summary><strong>从零到英雄学习 AWS 黑客技术，参加</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想在 **HackTricks 中看到您的公司广告** 或 **下载 HackTricks 的 PDF 版本**，请查看 [**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取 [**官方的 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 探索 [**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家的 [**NFTs 集合**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上 **关注** 我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>
