# Ansible Tower / AWX / Outomatisering kontroleerder Sekuriteit

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## Basiese Inligting

**Ansible Tower** of sy oopbron-weergawe [**AWX**](https://github.com/ansible/awx) staan ook bekend as **Ansible se gebruikerskoppelvlak, paneel en REST API**. Met **rolgebaseerde toegangsbeheer**, taakbeplanning en grafiese inventarisbestuur kan jy jou Ansible-infrastruktuur bestuur vanuit 'n moderne gebruikerskoppelvlak. Tower se REST API en opdraglynkoppelvlak maak dit eenvoudig om dit in te skakel by huidige gereedskap en werkstrome.

**Automation Controller is 'n nuwer** weergawe van Ansible Tower met meer funksies.

### Verskille

Volgens [**hierdie**](https://blog.devops.dev/ansible-tower-vs-awx-under-the-hood-65cfec78db00), is die belangrikste verskille tussen Ansible Tower en AWS die ontvangste ondersteuning en die feit dat Ansible Tower addisionele funksies het soos rolgebaseerde toegangsbeheer, ondersteuning vir aangepaste API's en gebruikersgedefinieerde werkstrome.

### Tegniese Stapel

* **Webkoppelvlak**: Dit is die grafiese koppelvlak waar gebruikers inventarisse, geloofsbriewe, sjablone en take kan bestuur. Dit is ontwerp om intu√Øtief te wees en bied visualisering om te help met die verstaan van die toestand en resultate van jou outomatiseringstake.
* **REST API**: Alles wat jy in die webkoppelvlak kan doen, kan jy ook doen via die REST API. Dit beteken dat jy AWX/Tower kan integreer met ander stelsels of aksies kan skript wat jy tipies in die koppelvlak sou uitvoer.
* **Databasis**: AWX/Tower maak gebruik van 'n databasis (tipies PostgreSQL) om sy konfigurasie, taakresultate en ander noodsaaklike operasionele data te stoor.
* **RabbitMQ**: Dit is die boodskapstelsel wat deur AWX/Tower gebruik word om te kommunikeer tussen die verskillende komponente, veral tussen die webdiens en die taakuitvoerders.
* **Redis**: Redis dien as 'n cache en agterkant vir die taakry.

### Logiese Komponente

* **Inventarisse**: 'n Inventaris is 'n **versameling gasheer (of knotte)** waarteen **take** (Ansible-skatte) uitgevoer kan word. AWX/Tower stel jou in staat om jou inventarisse te definieer en te groepeer en ondersteun ook dinamiese inventarisse wat gasheerlyste van ander stelsels soos AWS, Azure, ens. kan **haal**.
* **Projekte**: 'n Projek is in wese 'n **versameling Ansible-skatte** wat afkomstig is van 'n **weergawebeheerstelsel** (soos Git) om die nuutste skatte te trek wanneer dit nodig is.
* **Sjablone**: Taaksjablone definieer **hoe 'n spesifieke skat uitgevoer sal word**, deur die **inventaris**, **geloofsbriewe** en ander **parameters** vir die taak te spesifiseer.
* **Geloofsbriewe**: AWX/Tower bied 'n veilige manier om geheime te **bestuur en stoor**, soos SSH-sleutels, wagwoorde en API-tokens. Hierdie geloofsbriewe kan gekoppel word aan taaksjablone sodat skatte die nodige toegang het wanneer hulle uitgevoer word.
* **Taak-enjin**: Hier gebeur die toorkuns. Die taak-enjin is gebou op Ansible en is verantwoordelik vir die **uitvoering van die skatte**. Take word na die taak-enjin gestuur, wat dan die Ansible-skatte teen die aangewese inventaris uitvoer met behulp van die gespesifiseerde geloofsbriewe.
* **Skeduleerders en Terugroepfunksies**: Dit is gevorderde funksies in AWX/Tower wat dit moontlik maak om take te **skeduleer** om op spesifieke tye uit te voer of deur eksterne gebeure geaktiveer te word.
* **Kennisgewings**: AWX/Tower kan kennisgewings stuur gebaseer op die sukses of mislukking van take. Dit ondersteun verskillende vorme van kennisgewings soos e-posse, Slack-boodskappe, webhooks, ens.
* **Ansible-skatte**: Ansible-skatte is konfigurasie-, implementering- en orkestrasietegnieke. Hulle beskryf die gewenste toestand van stelsels op 'n geoutomatiseerde, herhaalbare manier. Geskryf in YAML, gebruik skatte Ansible se deklaratiewe outomatiseringstaal om konfigurasies, take en stappe te beskryf wat uitgevoer moet word.

### Taakuitvoeringsvloei

1. **Gebruikersinteraksie**: 'n Gebruiker kan met AWX/Tower interaksie h√™ deur die **Webkoppelvlak** of die **REST API**. Hierdie bied front-end toegang tot al die funksionaliteit wat deur AWX/Tower aangebied word.
2. **Taakinisiasie**:
* Die gebruiker, via die Webkoppelvlak of API, begin 'n taak gebaseer op 'n **Taaksjabloon**.
* Die Taaksjabloon sluit verwysings na die **Inventaris**, **Projek** (wat die skat bevat), en **Geloofsbriewe** in.
* Met die begin van die taak word 'n versoek gestuur na die AWX/Tower agterkant om die taak vir uitvoering in die ry te plaas.
3. **Taakryplaas**:
* **RabbitMQ** hanteer die boodskappe tussen die webkomponent en die taakuitvoerders. Sodra 'n taak begin word, word 'n boodskap met behulp van RabbitMQ na die taak-enjin gestuur.
* **Redis** dien as die agterkant vir die taakry en bestuur die take wat wag om uitgevoer te word.
4. **Taakuitvoering**:
* Die **Taak-enjin** haal die taak uit die ry. Dit haal die nodige inligting uit die **Databasis** oor die taak se gekoppelde skat, inventaris en geloofsbriewe.
* Met behulp van die opgehaalde Ansible-skat uit die gekoppelde **Projek**, voer die Taak-enjin die skat uit teen die gespesifiseerde **Inventaris**-knotte met behulp van die verskafte **Geloofsbriewe**.
* Terwyl die skat uitgevoer word, word die uitvoer daarvan (logboeke, feite, ens.) vasgevang en in die **Databasis** gestoor.
5. **Taakresultate**:
* Sodra die skat klaar uitgevoer is, word die resultate (sukses, mislukking, logboeke) in die **Databasis** gestoor.
* Gebruikers kan dan die resultate deur die Webkoppelvlak sien of dit deur die REST API ondervra.
* Gebaseer op die uitkomste van die taak, kan **Kennisgewings** gestuur word om gebruikers of eksterne stelsels in te lig oor die status van die taak. Kennisgewings kan e-posse, Slack-boodskappe, webhooks, ens. wees.
6. **Integrasie met Eksterne Stelsels**:
* **Inventarisse** kan dinamies verk
```bash
git clone -b x.y.z https://github.com/ansible/awx.git # Get in x.y.z the latest release version

cd awx

# Build
make docker-compose-build

# Run
make docker-compose

# Or to create a more complex env
MAIN_NODE_TYPE=control EXECUTION_NODE_COUNT=2 COMPOSE_TAG=devel make docker-compose

# Clean and build the UI
docker exec tools_awx_1 make clean-ui ui-devel

# Once migrations are completed and the UI is built, you can begin using AWX. The UI can be reached in your browser at https://localhost:8043/#/home, and the API can be found at https://localhost:8043/api/v2.

# Create an admin user
docker exec -ti tools_awx_1 awx-manage createsuperuser

# Load demo data
docker exec tools_awx_1 awx-manage create_preload_data
```
{% endcode %}

## RBAC

### Ondersteunde rolle

Die mees bevoorregte rol word genoem **Stelseladministrateur**. Enige iemand met hierdie rol kan **enige iets wysig**.

Vanuit 'n **witboks-sekuriteitsoorsig** sal jy die **Stelselouditeur-rol** benodig, wat toelaat om **alle stelseldata te sien**, maar geen veranderinge kan aanbring nie. 'n Ander opsie sou wees om die **Organisasieouditeur-rol** te kry, maar dit sou beter wees om die ander een te kry.

<details>

<summary>Klik hier om 'n gedetailleerde beskrywing van beskikbare rolle te kry</summary>

1. **Stelseladministrateur**:
* Dit is die supergebruiker-rol met toestemmings om enige hulpbron in die stelsel te ontsluit en te wysig.
* Hulle kan alle organisasies, spanne, projekte, inventarisse, taakpatrone, ens. bestuur.
2. **Stelselouditeur**:
* Gebruikers met hierdie rol kan alle stelseldata sien, maar geen veranderinge aanbring nie.
* Hierdie rol is ontwerp vir nakoming en toesig.
3. **Organisasierolle**:
* **Admin**: Volle beheer oor die organisasie se hulpbronne.
* **Ouditeur**: Slegs leestoegang tot die organisasie se hulpbronne.
* **Lid**: Basiese lidmaatskap in 'n organisasie sonder enige spesifieke toestemmings.
* **Uitvoer**: Kan taakpatrone binne die organisasie uitvoer.
* **Lees**: Kan die organisasie se hulpbronne sien.
4. **Projekrolle**:
* **Admin**: Kan die projek bestuur en wysig.
* **Gebruik**: Kan die projek in 'n taakpatroon gebruik.
* **Opdateer**: Kan die projek opdateer deur SCM (bronbeheer) te gebruik.
5. **Inventarisrolle**:
* **Admin**: Kan die inventaris bestuur en wysig.
* **Ad Hoc**: Kan ad hoc-opdragte op die inventaris uitvoer.
* **Opdateer**: Kan die inventarisbron opdateer.
* **Gebruik**: Kan die inventaris in 'n taakpatroon gebruik.
* **Lees**: Slegs leestoegang.
6. **Taakpatroonrolle**:
* **Admin**: Kan die taakpatroon bestuur en wysig.
* **Uitvoer**: Kan die taak uitvoer.
* **Lees**: Slegs leestoegang.
7. **Legitimasieringsrolle**:
* **Admin**: Kan die legitimasies bestuur en wysig.
* **Gebruik**: Kan die legitimasies in taakpatrone of ander relevante hulpbronne gebruik.
* **Lees**: Slegs leestoegang.
8. **Spanrolle**:
* **Lid**: Deel van die span, maar sonder enige spesifieke toestemmings.
* **Admin**: Kan die span se lede en geassosieerde hulpbronne bestuur.
9. **Werksvloerrolle**:
* **Admin**: Kan die werksvloer bestuur en wysig.
* **Uitvoer**: Kan die werksvloer uitvoer.
* **Lees**: Slegs leestoegang.

</details>

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy in HackTricks wil adverteer** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks-uitrusting**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
