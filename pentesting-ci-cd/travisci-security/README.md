# Seguran√ßa do TravisCI

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou se quiser acessar a **vers√£o mais recente do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo Telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no GitHub.

</details>

## O que √© o TravisCI

**Travis CI** √© um servi√ßo de **integra√ß√£o cont√≠nua** hospedado ou local usado para construir e testar projetos de software hospedados em v√°rias **plataformas git diferentes**.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## Ataques

### Gatilhos

Para lan√ßar um ataque, voc√™ primeiro precisa saber como acionar uma compila√ß√£o. Por padr√£o, o TravisCI ir√° **acionar uma compila√ß√£o em pushs e pull requests**:

![](<../../.gitbook/assets/image (19) (1).png>)

#### Cron Jobs

Se voc√™ tiver acesso √† aplica√ß√£o web, pode **definir cron jobs para executar a compila√ß√£o**, isso pode ser √∫til para persist√™ncia ou para acionar uma compila√ß√£o:

![](<../../.gitbook/assets/image (42).png>)

{% hint style="info" %}
Parece que n√£o √© poss√≠vel definir cron jobs dentro do arquivo `.travis.yml` de acordo com [isso](https://github.com/travis-ci/travis-ci/issues/9162).
{% endhint %}

### PR de Terceiros

O TravisCI, por padr√£o, desativa o compartilhamento de vari√°veis de ambiente com PRs provenientes de terceiros, mas algu√©m pode ativ√°-lo e, em seguida, voc√™ pode criar PRs para o reposit√≥rio e extrair os segredos:

![](<../../.gitbook/assets/image (1) (1) (1) (1).png>)

### Vazamento de Segredos

Conforme explicado na p√°gina de [**informa√ß√µes b√°sicas**](basic-travisci-information.md), existem 2 tipos de segredos. **Segredos de Vari√°veis de Ambiente** (que est√£o listados na p√°gina da web) e **segredos criptografados personalizados**, que s√£o armazenados dentro do arquivo `.travis.yml` como base64 (observe que ambos, quando armazenados criptografados, ser√£o convertidos em vari√°veis de ambiente nas m√°quinas finais).

* Para **enumerar segredos** configurados como **Vari√°veis de Ambiente**, v√° para as **configura√ß√µes** do **projeto** e verifique a lista. No entanto, observe que todas as vari√°veis de ambiente do projeto definidas aqui aparecer√£o ao acionar uma compila√ß√£o.
* Para enumerar os **segredos criptografados personalizados**, a melhor coisa que voc√™ pode fazer √© **verificar o arquivo `.travis.yml`**.
* Para **enumerar arquivos criptografados**, voc√™ pode verificar a exist√™ncia de **arquivos `.enc`** no reposit√≥rio, de linhas semelhantes a `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d` no arquivo de configura√ß√£o, ou de **iv e chaves criptografadas** nas **Vari√°veis de Ambiente**, como:

![](<../../.gitbook/assets/image (71).png>)

### TODO:

* Exemplo de compila√ß√£o com shell reverso em execu√ß√£o no Windows/Mac/Linux
* Exemplo de compila√ß√£o vazando o env codificado em base64 nos logs

### TravisCI Enterprise

Se um invasor acabar em um ambiente que usa o **TravisCI Enterprise** (mais informa√ß√µes sobre o que √© isso em [**informa√ß√µes b√°sicas**](basic-travisci-information.md#travisci-enterprise)), ele poder√° **acionar compila√ß√µes no Worker**. Isso significa que um invasor poder√° se mover lateralmente para esse servidor, a partir do qual ele poder√° ser capaz de:

* escapar para o host?
* comprometer o Kubernetes?
* comprometer outras m√°quinas em execu√ß√£o na mesma rede?
* comprometer novas credenciais de nuvem?

## Refer√™ncias

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou se quiser acessar a **vers√£o mais recente do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo Telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no GitHub.

</details>
