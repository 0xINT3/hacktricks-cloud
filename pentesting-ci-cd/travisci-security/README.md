# TravisCI 보안

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)로부터 AWS 해킹을 제로부터 전문가까지 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나** **PDF 형식의 HackTricks를 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f)에 가입하거나 [**텔레그램 그룹**](https://t.me/peass)에 가입하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* **해킹 요령을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소로 PR을 제출하세요.

</details>

## TravisCI란

**Travis CI**는 **여러 다른 git 플랫폼에 호스팅된** 빌드 및 테스트를 위해 사용되는 **호스팅** 또는 **온프레미스** **지속적 통합** 서비스입니다.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## 공격

### 트리거

공격을 시작하려면 어떻게 빌드를 트리거하는지 알아야 합니다. 기본적으로 TravisCI는 **푸시 및 풀 리퀘스트에서 빌드를 트리거**합니다:

![](<../../.gitbook/assets/image (19) (1).png>)

#### 크론 작업

웹 애플리케이션에 액세스할 수 있다면 **크론을 설정하여 빌드를 실행**할 수 있습니다. 이는 지속성 또는 빌드를 트리거하는 데 유용할 수 있습니다:

![](<../../.gitbook/assets/image (42).png>)

{% hint style="info" %}
[여기](https://github.com/travis-ci/travis-ci/issues/9162)에 따르면 `.travis.yml` 내에서 크론을 설정할 수 없는 것으로 보입니다.
{% endhint %}

### 제3자 PR

TravisCI는 기본적으로 제3자로부터의 PR과 함께 환경 변수 공유를 비활성화하지만 누군가가 이를 활성화할 수 있고 그런 경우 레포지토리에 PR을 생성하고 비밀을 유출할 수 있습니다:

![](<../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png>)

### 비밀 유출

[**기본 정보**](basic-travisci-information.md) 페이지에서 설명한대로, 두 가지 유형의 비밀이 있습니다. **환경 변수 비밀** (웹 페이지에 나열된) 및 **사용자 지정 암호화된 비밀**, 이는 `.travis.yml` 파일에 base64로 저장됩니다 (두 가지 모두 암호화되어 저장되며 최종 머신에서 환경 변수로 끝납니다).

* **환경 변수로 구성된 비밀**을 **열거**하려면 **프로젝트**의 **설정**으로 이동하여 목록을 확인하세요. 그러나 여기에서 설정된 모든 프로젝트 환경 변수는 빌드를 트리거할 때 나타납니다.
* **사용자 지정 암호화된 비밀**을 열거하려면 **`.travis.yml` 파일**을 확인하는 것이 가장 좋습니다.
* **암호화된 파일을 열거**하려면 레포지토리에서 **`.enc` 파일**을 확인하거나 구성 파일에서 `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d`와 유사한 줄을 찾거나 **환경 변수**에 **암호화된 iv 및 키**를 확인할 수 있습니다.

![](<../../.gitbook/assets/image (71).png>)

### TODO:

* Windows/Mac/Linux에서 실행되는 역쉘이 있는 예제 빌드
* 로그에 base64로 인코딩된 env를 유출하는 예제 빌드

### TravisCI Enterprise

공격자가 **TravisCI 엔터프라이즈**를 사용하는 환경에 도달하면 ([**기본 정보**](basic-travisci-information.md#travisci-enterprise)에서 이에 대한 자세한 정보를 확인하세요), **Worker에서 빌드를 트리거**할 수 있습니다. 이는 공격자가 해당 서버로 측면 이동할 수 있게 해줍니다. 이후 공격자는 다음을 할 수 있습니다:

* 호스트로 탈출?
* 쿠버네티스 침해?
* 동일 네트워크에서 실행되는 다른 기계 침해?
* 새로운 클라우드 자격 증명 침해?

## 참고 자료

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)로부터 AWS 해킹을 제로부터 전문가까지 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나** **PDF 형식의 HackTricks를 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f)에 가입하거나 [**텔레그램 그룹**](https://t.me/peass)에 가입하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* **해킹 요령을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소로 PR을 제출하세요.

</details>
