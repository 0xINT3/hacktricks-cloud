# Seguran√ßa TravisCI

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## O que √© TravisCI

**Travis CI** √© um servi√ßo de **integra√ß√£o cont√≠nua** **hospedado** ou em **premissas** usado para construir e testar projetos de software hospedados em v√°rias **diferentes plataformas git**.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## Ataques

### Gatilhos

Para iniciar um ataque, voc√™ primeiro precisa saber como disparar uma constru√ß√£o. Por padr√£o, o TravisCI ir√° **disparar uma constru√ß√£o em pushes e pull requests**:

![](<../../.gitbook/assets/image (19) (1).png>)

#### Tarefas Cron

Se voc√™ tem acesso ao aplicativo web, pode **configurar crons para executar a constru√ß√£o**, isso pode ser √∫til para persist√™ncia ou para disparar uma constru√ß√£o:

![](<../../.gitbook/assets/image (42).png>)

{% hint style="info" %}
Parece que n√£o √© poss√≠vel configurar crons dentro do `.travis.yml` de acordo com [isto](https://github.com/travis-ci/travis-ci/issues/9162).
{% endhint %}

### PR de Terceiros

Por padr√£o, o TravisCI desabilita o compartilhamento de vari√°veis de ambiente com PRs vindos de terceiros, mas algu√©m pode habilit√°-lo e ent√£o voc√™ poderia criar PRs para o reposit√≥rio e exfiltrar os segredos:

![](<../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1).png>)

### Despejando Segredos

Como explicado na p√°gina de [**informa√ß√µes b√°sicas**](basic-travisci-information.md), existem 2 tipos de segredos. **Segredos de Vari√°veis de Ambiente** (que s√£o listados na p√°gina web) e **segredos criptografados personalizados**, que s√£o armazenados dentro do arquivo `.travis.yml` como base64 (note que ambos armazenados criptografados acabar√£o como vari√°veis de ambiente nas m√°quinas finais).

* Para **enumerar segredos** configurados como **Vari√°veis de Ambiente**, v√° at√© as **configura√ß√µes** do **projeto** e verifique a lista. No entanto, note que todas as vari√°veis de ambiente do projeto configuradas aqui aparecer√£o ao disparar uma constru√ß√£o.
* Para enumerar os **segredos criptografados personalizados**, o melhor que voc√™ pode fazer √© **verificar o arquivo `.travis.yml`**.
* Para **enumerar arquivos criptografados**, voc√™ pode procurar por arquivos **`.enc`** no reposit√≥rio, por linhas semelhantes a `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d` no arquivo de configura√ß√£o, ou por **iv e chaves criptografadas** nas **Vari√°veis de Ambiente**, como:

![](<../../.gitbook/assets/image (71).png>)

### A FAZER:

* Exemplo de constru√ß√£o com shell reverso rodando em Windows/Mac/Linux
* Exemplo de constru√ß√£o vazando a base64 do ambiente nos logs

### TravisCI Enterprise

Se um atacante termina em um ambiente que usa **TravisCI Enterprise** (mais informa√ß√µes sobre o que √© isso na p√°gina de [**informa√ß√µes b√°sicas**](basic-travisci-information.md#travisci-enterprise)), ele ser√° capaz de **disparar constru√ß√µes no Worker.** Isso significa que um atacante ser√° capaz de se mover lateralmente para aquele servidor a partir do qual ele poderia ser capaz de:

* escapar para o host?
* comprometer kubernetes?
* comprometer outras m√°quinas rodando na mesma rede?
* comprometer novas credenciais na nuvem?

## Refer√™ncias

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
