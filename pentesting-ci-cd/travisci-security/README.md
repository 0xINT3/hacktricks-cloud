# Seguran√ßa do TravisCI

<details>

<summary><strong>Aprenda hacking da AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** reposit√≥rios [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## O que √© o TravisCI

**Travis CI** √© um servi√ßo de **integra√ß√£o cont√≠nua** hospedado ou local usado para construir e testar projetos de software hospedados em v√°rias **plataformas git diferentes**.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## Ataques

### Gatilhos

Para lan√ßar um ataque, primeiro voc√™ precisa saber como acionar uma compila√ß√£o. Por padr√£o, o TravisCI ir√° **acionar uma compila√ß√£o em pushs e pull requests**:

![](<../../.gitbook/assets/image (19) (1).png>)

#### Cron Jobs

Se voc√™ tiver acesso √† aplica√ß√£o web, voc√™ pode **configurar crons para executar a compila√ß√£o**, isso poderia ser √∫til para persist√™ncia ou para acionar uma compila√ß√£o:

![](<../../.gitbook/assets/image (42).png>)

{% hint style="info" %}
Parece que n√£o √© poss√≠vel configurar crons dentro do arquivo `.travis.yml` de acordo com [este](https://github.com/travis-ci/travis-ci/issues/9162).
{% endhint %}

### PR de Terceiros

O TravisCI, por padr√£o, desabilita o compartilhamento de vari√°veis de ambiente com PRs vindos de terceiros, mas algu√©m pode habilitar e ent√£o voc√™ poderia criar PRs para o reposit√≥rio e extrair os segredos:

![](<../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png>)

### Vazamento de Segredos

Como explicado na p√°gina de [**informa√ß√µes b√°sicas**](basic-travisci-information.md), existem 2 tipos de segredos. **Segredos de Vari√°veis de Ambiente** (que est√£o listados na p√°gina web) e **segredos personalizados criptografados**, que s√£o armazenados dentro do arquivo `.travis.yml` como base64 (observe que ambos, quando armazenados criptografados, se tornar√£o vari√°veis de ambiente nas m√°quinas finais).

* Para **enumerar segredos** configurados como **Vari√°veis de Ambiente**, v√° para as **configura√ß√µes** do **projeto** e verifique a lista. No entanto, observe que todas as vari√°veis de ambiente do projeto definidas aqui aparecer√£o ao acionar uma compila√ß√£o.
* Para enumerar os **segredos criptografados personalizados**, o melhor que voc√™ pode fazer √© **verificar o arquivo `.travis.yml`**.
* Para **enumerar arquivos criptografados**, voc√™ pode verificar os **arquivos `.enc`** no reposit√≥rio, por linhas semelhantes a `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d` no arquivo de configura√ß√£o, ou por **iv e chaves criptografadas** nas **Vari√°veis de Ambiente** como:

![](<../../.gitbook/assets/image (71).png>)

### A FAZER:

* Exemplo de compila√ß√£o com shell reverso sendo executado no Windows/Mac/Linux
* Exemplo de compila√ß√£o vazando o env codificado em base64 nos logs

### TravisCI Enterprise

Se um atacante terminar em um ambiente que usa **TravisCI enterprise** (mais informa√ß√µes sobre o que √© isso nas [**informa√ß√µes b√°sicas**](basic-travisci-information.md#travisci-enterprise)), ele ser√° capaz de **acionar compila√ß√µes no Worker**. Isso significa que um atacante ser√° capaz de se mover lateralmente para esse servidor a partir do qual ele poderia ser capaz de:

* escapar para o host?
* comprometer o kubernetes?
* comprometer outras m√°quinas em execu√ß√£o na mesma rede?
* comprometer novas credenciais de nuvem?

## Refer√™ncias

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

<details>

<summary><strong>Aprenda hacking da AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** reposit√≥rios [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
