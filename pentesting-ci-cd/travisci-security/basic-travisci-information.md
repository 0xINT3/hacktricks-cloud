# 基本的TravisCI信息

<details>

<summary><strong>支持HackTricks并获得好处！</strong></summary>

* 如果您想在HackTricks中看到您的公司广告，或者如果您想访问PEASS的最新版本或下载PDF格式的HackTricks，请查看[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或者 [**telegram群组**](https://t.me/peass) 或者 **关注**我在**Twitter**上的账号 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) **和** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github仓库提交PR来分享您的黑客技巧。**

</details>

## 访问

TravisCI直接与不同的git平台集成，如Github、Bitbucket、Assembla和Gitlab。它会要求用户授予TravisCI访问他想要与TravisCI集成的仓库的权限。

例如，在Github上，它会要求以下权限：

* `user:email`（只读）
* `read:org`（只读）
* `repo`：为公共和私有仓库和组织授予代码、提交状态、协作者和部署状态的读写访问权限。

## 加密的秘密

### 环境变量

在TravisCI中，与其他CI平台一样，可以在仓库级别保存加密的秘密，并将其解密并推送到执行构建的机器的环境变量中。

![](<../../.gitbook/assets/image (44).png>)

可以指定**可以使用这些秘密的分支**（默认为全部），还可以指定TravisCI是否应该在日志中出现时**隐藏其值**（默认情况下会隐藏）。

### 自定义加密的秘密

对于**每个仓库**，TravisCI会生成一对**RSA密钥**，**保留**私钥，并将仓库的**公钥提供给**那些**有权访问**该仓库的人。

您可以使用以下命令访问一个仓库的公钥：
```
travis pubkey -r <owner>/<repo_name>
travis pubkey -r carlospolop/t-ci-test
```
然后，您可以使用此设置来**加密密钥并将其添加到您的`.travis.yaml`**文件中。这些密钥将在构建运行时**解密，并可在环境变量中访问**。

![](<../../.gitbook/assets/image (2) (2) (1) (1).png>)

请注意，以这种方式加密的密钥不会在设置的环境变量中列出。

### 自定义加密文件

与之前一样，TravisCI还允许在构建过程中**加密文件，然后解密它们**：
```
travis encrypt-file super_secret.txt -r carlospolop/t-ci-test

encrypting super_secret.txt for carlospolop/t-ci-test
storing result as super_secret.txt.enc
storing secure env variables for decryption

Please add the following to your build script (before_install stage in your .travis.yml, for instance):

openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d

Pro Tip: You can add it automatically by running with --add.

Make sure to add super_secret.txt.enc to the git repository.
Make sure not to add super_secret.txt to the git repository.
Commit all changes to your .travis.yml.
```
请注意，加密文件时，将在存储库中配置2个环境变量，如下所示：

![](<../../.gitbook/assets/image (23).png>)

## TravisCI企业版

Travis CI Enterprise是Travis CI的**本地版本**，您可以在**自己的基础设施**中部署。可以将其视为Travis CI的“服务器”版本。使用Travis CI可以在您想要的环境中配置和保护的易于使用的持续集成/持续部署（CI/CD）系统。

**Travis CI Enterprise由两个主要部分组成：**

1. TCI服务（或TCI核心服务），负责与版本控制系统集成、授权构建、调度构建作业等。
2. TCI Worker和构建环境镜像（也称为操作系统镜像）。

**TCI核心服务需要以下内容：**

1. 一个**PostgreSQL11**（或更高版本）数据库。
2. 一个用于部署Kubernetes集群的基础设施；如果需要，可以在服务器集群或单台机器上部署。
3. 根据您的设置，您可能希望自己部署和配置一些组件，例如RabbitMQ - 有关更多详细信息，请参阅[设置Travis CI Enterprise](https://docs.travis-ci.com/user/enterprise/tcie-3.x-setting-up-travis-ci-enterprise/)。

**TCI Worker需要以下内容：**

1. 一个基础设施，可以部署包含**Worker和链接的构建镜像的Docker镜像**。
2. 连接到某些Travis CI核心服务组件 - 有关更多详细信息，请参阅[设置Worker](https://docs.travis-ci.com/user/enterprise/setting-up-worker/)。

部署的TCI Worker和构建环境操作系统镜像的数量将确定Travis CI Enterprise在您的基础设施中的总并发容量。

![](<../../.gitbook/assets/image (8) (1) (1).png>)

<details>

<summary><strong>支持HackTricks并获得福利！</strong></summary>

* 如果您希望在HackTricks中看到您的**公司广告**，或者如果您想要访问**PEASS的最新版本或下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram群组**](https://t.me/peass) 或 **关注**我的**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向**[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github存储库提交PR来分享您的黑客技巧。**

</details>
