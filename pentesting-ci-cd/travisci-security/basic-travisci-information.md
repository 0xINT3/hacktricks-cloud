# Informa√ß√µes B√°sicas sobre TravisCI

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

## Acesso

O TravisCI integra diretamente com diferentes plataformas git como Github, Bitbucket, Assembla e Gitlab. Ele solicitar√° ao usu√°rio permiss√µes para acessar os reposit√≥rios que ele deseja integrar com o TravisCI.

Por exemplo, no Github, ele solicitar√° as seguintes permiss√µes:

* `user:email` (somente leitura)
* `read:org` (somente leitura)
* `repo`: Concede acesso de leitura e escrita ao c√≥digo, status de commit, colaboradores e status de implanta√ß√£o para reposit√≥rios p√∫blicos e privados e organiza√ß√µes.

## Segredos Criptografados

### Vari√°veis de Ambiente

No TravisCI, assim como em outras plataformas CI, √© poss√≠vel **salvar segredos no n√≠vel do reposit√≥rio** que ser√£o salvos criptografados e **descriptografados e inseridos na vari√°vel de ambiente** da m√°quina que executa a compila√ß√£o.

![](<../../.gitbook/assets/image (203).png>)

√â poss√≠vel indicar os **branches nos quais os segredos estar√£o dispon√≠veis** (por padr√£o, todos) e tamb√©m se o TravisCI **deve ocultar seu valor** se ele aparecer **nos logs** (por padr√£o, ele ir√°).

### Segredos Criptografados Personalizados

Para **cada reposit√≥rio**, o TravisCI gera um **par de chaves RSA**, **mant√©m** a **privada** e disponibiliza a **chave p√∫blica do reposit√≥rio** para aqueles que t√™m **acesso** ao reposit√≥rio.

Voc√™ pode acessar a chave p√∫blica de um reposit√≥rio com:
```
travis pubkey -r <owner>/<repo_name>
travis pubkey -r carlospolop/t-ci-test
```
Ent√£o, voc√™ pode usar essa configura√ß√£o para **criptografar segredos e adicion√°-los ao seu `.travis.yaml`**. Os segredos ser√£o **descriptografados quando a compila√ß√£o for executada** e acess√≠veis nas **vari√°veis de ambiente**.

![](<../../.gitbook/assets/image (139).png>)

Note que os segredos criptografados dessa maneira n√£o aparecer√£o listados nas vari√°veis ambientais das configura√ß√µes.

### Arquivos Criptografados Personalizados

Da mesma forma que antes, o TravisCI tamb√©m permite **criptografar arquivos e depois descriptograf√°-los durante a compila√ß√£o**:
```
travis encrypt-file super_secret.txt -r carlospolop/t-ci-test

encrypting super_secret.txt for carlospolop/t-ci-test
storing result as super_secret.txt.enc
storing secure env variables for decryption

Please add the following to your build script (before_install stage in your .travis.yml, for instance):

openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d

Pro Tip: You can add it automatically by running with --add.

Make sure to add super_secret.txt.enc to the git repository.
Make sure not to add super_secret.txt to the git repository.
Commit all changes to your .travis.yml.
```
Note que ao criptografar um arquivo, 2 Vari√°veis de Ambiente ser√£o configuradas dentro do reposit√≥rio, como:

![](<../../.gitbook/assets/image (170).png>)

## TravisCI Enterprise

O Travis CI Enterprise √© uma **vers√£o local do Travis CI**, que voc√™ pode implantar **em sua infraestrutura**. Pense na vers√£o 'servidor' do Travis CI. Usar o Travis CI permite que voc√™ habilite um sistema de Integra√ß√£o Cont√≠nua/Implanta√ß√£o Cont√≠nua (CI/CD) f√°cil de usar em um ambiente que voc√™ pode configurar e proteger conforme desejar.

**O Travis CI Enterprise √© composto por duas partes principais:**

1. Servi√ßos do TCI (ou Servi√ßos Principais do TCI), respons√°veis pela integra√ß√£o com sistemas de controle de vers√£o, autoriza√ß√£o de compila√ß√µes, agendamento de trabalhos de compila√ß√£o, etc.
2. Trabalhador do TCI e imagens de ambiente de compila√ß√£o (tamb√©m chamadas de imagens de SO).

**Os servi√ßos principais do TCI requerem o seguinte:**

1. Um banco de dados **PostgreSQL11** (ou posterior).
2. Uma infraestrutura para implantar um cluster Kubernetes; pode ser implantado em um cluster de servidores ou em uma √∫nica m√°quina, se necess√°rio.
3. Dependendo da sua configura√ß√£o, voc√™ pode querer implantar e configurar alguns dos componentes por conta pr√≥pria, por exemplo, RabbitMQ - consulte a [Configura√ß√£o do Travis CI Enterprise](https://docs.travis-ci.com/user/enterprise/tcie-3.x-setting-up-travis-ci-enterprise/) para mais detalhes.

**O Trabalhador do TCI requer o seguinte:**

1. Uma infraestrutura onde uma imagem docker contendo o **Trabalhador e uma imagem de compila√ß√£o vinculada possa ser implantada**.
2. Conectividade com certos componentes dos Servi√ßos Principais do Travis CI - consulte a [Configura√ß√£o do Trabalhador](https://docs.travis-ci.com/user/enterprise/setting-up-worker/) para mais detalhes.

A quantidade de Trabalhadores do TCI implantados e imagens de SO de ambiente de compila√ß√£o determinar√° a capacidade total de concorr√™ncia da implanta√ß√£o do Travis CI Enterprise em sua infraestrutura.

![](<../../.gitbook/assets/image (199).png>)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
