# Airflow Konfiguration

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie mir auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## Konfigurationsdatei

**Apache Airflow** generiert eine **Konfigurationsdatei** auf allen Airflow-Maschinen namens **`airflow.cfg`** im Home-Verzeichnis des Airflow-Benutzers. Diese Konfigurationsdatei enth√§lt Konfigurationsinformationen und **kann interessante und sensible Informationen enthalten**.

**Es gibt zwei M√∂glichkeiten, auf diese Datei zuzugreifen: Durch Kompromittierung einer Airflow-Maschine oder Zugriff auf die Webkonsole.**

Beachten Sie, dass die **Werte innerhalb der Konfigurationsdatei** **m√∂glicherweise nicht die verwendeten Werte sind**, da Sie sie √ºberschreiben k√∂nnen, indem Sie Umgebungsvariablen wie `AIRFLOW__WEBSERVER__EXPOSE_CONFIG: 'true'` setzen.

Wenn Sie Zugriff auf die **Konfigurationsdatei im Webserver** haben, k√∂nnen Sie die **tats√§chliche laufende Konfiguration** auf derselben Seite √ºberpr√ºfen, auf der die Konfiguration angezeigt wird.\
Wenn Sie Zugriff auf eine **Maschine innerhalb der Airflow-Umgebung** haben, √ºberpr√ºfen Sie die **Umgebung**.

Einige interessante Werte, die beim Lesen der Konfigurationsdatei √ºberpr√ºft werden sollten:

### \[api]

* **`access_control_allow_headers`**: Dies gibt die **erlaubten Header** f√ºr **CORS** an
* **`access_control_allow_methods`**: Dies gibt die **erlaubten Methoden** f√ºr **CORS** an
* **`access_control_allow_origins`**: Dies gibt die **erlaubten Urspr√ºnge** f√ºr **CORS** an
* **`auth_backend`**: [**Gem√§√ü der Dokumentation**](https://airflow.apache.org/docs/apache-airflow/stable/security/api.html) k√∂nnen einige Optionen konfiguriert werden, wer auf die API zugreifen kann:
* `airflow.api.auth.backend.deny_all`: **Standardm√§√üig kann niemand** auf die API zugreifen
* `airflow.api.auth.backend.default`: **Jeder kann** darauf ohne Authentifizierung zugreifen
* `airflow.api.auth.backend.kerberos_auth`: Zur Konfiguration der **Kerberos-Authentifizierung**
* `airflow.api.auth.backend.basic_auth`: F√ºr die **grundlegende Authentifizierung**
* `airflow.composer.api.backend.composer_auth`: Verwendet die Komponistenauthentifizierung (GCP) (von [**hier**](https://cloud.google.com/composer/docs/access-airflow-api)).
* `composer_auth_user_registration_role`: Dies gibt die **Rolle** an, die der **Komponistenbenutzer** in **Airflow** erh√§lt (**Op** standardm√§√üig).
* Sie k√∂nnen auch Ihre eigene Authentifizierungsmethode mit Python erstellen.
* **`google_key_path`:** Pfad zum **GCP-Dienstkonto-Schl√ºssel**

### **\[atlas]**

* **`password`**: Atlas-Passwort
* **`username`**: Atlas-Benutzername

### \[celery]

* **`flower_basic_auth`** : Anmeldeinformationen (_Benutzer1:Passwort1,Benutzer2:Passwort2_)
* **`result_backend`**: Postgres-URL, die **Anmeldeinformationen** enthalten kann.
* **`ssl_cacert`**: Pfad zum CACert
* **`ssl_cert`**: Pfad zum Zertifikat
* **`ssl_key`**: Pfad zum Schl√ºssel

### \[core]

* **`dag_discovery_safe_mode`**: Standardm√§√üig aktiviert. Beim Entdecken von DAGs werden Dateien ignoriert, die die Zeichenfolgen `DAG` und `airflow` nicht enthalten.
* **`fernet_key`**: Schl√ºssel zum Speichern verschl√ºsselter Variablen (symmetrisch)
* **`hide_sensitive_var_conn_fields`**: Standardm√§√üig aktiviert, versteckt sensible Informationen von Verbindungen.
* **`security`**: Welches Sicherheitsmodul verwendet werden soll (z. B. Kerberos)

### \[dask]

* **`tls_ca`**: Pfad zum CA
* **`tls_cert`**: Teil zum Zertifikat
* **`tls_key`**: Teil zum TLS-Schl√ºssel

### \[kerberos]

* **`ccache`**: Pfad zur CCache-Datei
* **`forwardable`**: Standardm√§√üig aktiviert

### \[logging]

* **`google_key_path`**: Pfad zu GCP JSON-Credentials.

### \[secrets]

* **`backend`**: Vollst√§ndiger Klassenname des Secrets-Backends, um es zu aktivieren
* **`backend_kwargs`**: Der backend\_kwargs-Parameter wird in ein Dictionary geladen und an **init** der Secrets-Backend-Klasse √ºbergeben.

### \[smtp]

* **`smtp_password`**: SMTP-Passwort
* **`smtp_user`**: SMTP-Benutzer

### \[webserver]

* **`cookie_samesite`**: Standardm√§√üig ist es **Lax**, daher ist es bereits der schw√§chstm√∂gliche Wert
* **`cookie_secure`**: Setzt das **Sicherheitsflag** auf das Sitzungscookie
* **`expose_config`**: Standardm√§√üig ist es False, wenn true, kann die **Konfiguration** aus der Webkonsole **gelesen** werden
* **`expose_stacktrace`**: Standardm√§√üig ist es True, es zeigt **Python-Tracebacks** an (potenziell n√ºtzlich f√ºr einen Angreifer)
* **`secret_key`**: Dies ist der **Schl√ºssel, den Flask zum Signieren der Cookies** verwendet (wenn Sie diesen haben, k√∂nnen Sie **jeden Benutzer in Airflow** darstellen)
* **`web_server_ssl_cert`**: **Pfad** zum **SSL-Zertifikat**
* **`web_server_ssl_key`**: **Pfad** zum **SSL-Schl√ºssel**
* **`x_frame_enabled`**: Standardm√§√üig **True**, daher ist Clickjacking standardm√§√üig nicht m√∂glich

### Web-Authentifizierung

Standardm√§√üig wird die **Web-Authentifizierung** in der Datei **`webserver_config.py`** angegeben und konfiguriert als
```bash
AUTH_TYPE = AUTH_DB
```
Was bedeutet, dass die **Authentifizierung gegen die Datenbank √ºberpr√ºft wird**. Es sind jedoch auch andere Konfigurationen m√∂glich, wie z.B.
```bash
AUTH_TYPE = AUTH_OAUTH
```
Um die **Authentifizierung an Drittanbieterdienste** zu √ºberlassen.

Es gibt jedoch auch die M√∂glichkeit, **anonymen Benutzern Zugriff zu gew√§hren**, indem der folgende Parameter auf die **gew√ºnschte Rolle** gesetzt wird:
```bash
AUTH_ROLE_PUBLIC = 'Admin'
```
<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie mir auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositorys einreichen.

</details>
