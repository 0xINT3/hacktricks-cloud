# Seguridad de Okta

<details>

<summary><strong>춰Apoya a HackTricks y obt칠n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **칰ltima versi칩n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop).
* Obt칠n [**productos oficiales de PEASS y HackTricks**](https://peass.creator-spring.com).
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family).
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>

## Informaci칩n b치sica

Okta, Inc. es una empresa de **gesti칩n de identidad y acceso** que proporciona software en la nube para ayudar a las empresas a **administrar y asegurar la autenticaci칩n de usuarios en aplicaciones modernas**, y para que los desarrolladores puedan construir controles de identidad en aplicaciones, servicios web y dispositivos.

Su servicio principal, llamado Okta Identity Cloud, ofrece productos que incluyen inicio de sesi칩n 칰nico (SSO), autenticaci칩n multifactor (MFA), gesti칩n del ciclo de vida, directorio universal, gesti칩n de acceso a API y m치s. Esto ayuda a las empresas a proteger sus datos sensibles y tambi칠n a agilizar el acceso de los usuarios, haciendo que las aplicaciones y servicios sean m치s accesibles y f치ciles de usar para los empleados o clientes.

Los servicios de Okta se utilizan ampliamente en contextos empresariales, as칤 como por empresas m치s peque침as y desarrolladores. Juega un papel crucial en permitir a las empresas adoptar y gestionar de forma segura las tecnolog칤as en la nube. Hasta mi fecha l칤mite de conocimiento en septiembre de 2021, Okta sigue siendo un jugador importante en la industria de la gesti칩n de identidad y acceso (IAM).

{% hint style="danger" %}
El objetivo principal de Okta es configurar el acceso de diferentes usuarios y grupos a aplicaciones externas. Si logras **comprometer privilegios de administrador en un entorno de Okta**, es muy probable que puedas **comprometer todas las dem치s plataformas que la empresa est칠 utilizando**.
{% endhint %}

{% hint style="success" %}
Para realizar una revisi칩n de seguridad de un entorno de Okta, debes solicitar acceso de solo lectura para administradores.
{% endhint %}

## Directorio

### Personas

Desde la perspectiva de un atacante, esto es muy interesante, ya que podr치s ver **todos los usuarios registrados**, sus direcciones de **correo electr칩nico**, los **grupos** a los que pertenecen, los **perfiles** e incluso los **dispositivos** (m칩viles junto con sus sistemas operativos).

Para una revisi칩n en caja blanca, verifica que no haya varios "Pending user action" y "Password reset".

### Grupos

Aqu칤 es donde se encuentran todos los grupos creados en Okta. Es interesante comprender los diferentes grupos (conjunto de **permisos**) que se pueden otorgar a los **usuarios**.\
Es posible ver las **personas incluidas en los grupos** y las **aplicaciones asignadas** a cada grupo.

Por supuesto, cualquier grupo con el nombre de **admin** es interesante, especialmente el grupo **Global Administrators**, verifica los miembros para saber qui칠nes son los miembros m치s privilegiados.

Desde una revisi칩n en caja blanca, **no deber칤a haber m치s de 5 administradores globales** (mejor si hay solo 2 o 3).

### Dispositivos

Aqu칤 encontrar치s una **lista de todos los dispositivos** de todos los usuarios. Tambi칠n puedes ver si se est치 **gestionando activamente** o no.

### Editor de perfiles

Aqu칤 es posible observar c칩mo se comparten informaci칩n clave como nombres, apellidos, correos electr칩nicos, nombres de usuario, etc. entre Okta y otras aplicaciones. Esto es interesante porque si un usuario puede **modificar en Okta un campo** (como su nombre o correo electr칩nico) que luego es utilizado por una **aplicaci칩n externa** para **identificar** al usuario, un empleado podr칤a intentar **apoderarse de otras cuentas**.

Adem치s, en el perfil **`User (default)`** de Okta, puedes ver **qu칠 campos** tiene cada **usuario** y cu치les son **modificables** por los usuarios. Si no puedes ver el panel de administraci칩n, simplemente ve a **actualizar la informaci칩n de tu perfil** y ver치s qu칠 campos puedes actualizar (ten en cuenta que para actualizar una direcci칩n de correo electr칩nico deber치s verificarla).

### Integraciones de directorio

Los directorios te permiten importar personas de fuentes existentes. Supongo que aqu칤 ver치s los usuarios importados de otros directorios.

No lo he visto, pero supongo que esto es interesante para descubrir **otros directorios que Okta est치 utilizando para importar usuarios**, por lo que si **comprometes ese directorio**, podr칤as establecer algunos valores de atributos en los usuarios creados en Okta y **comprometer el entorno de Okta**.

### Fuentes de perfil

Una fuente de perfil es una **aplicaci칩n que act칰a como fuente de verdad** para los atributos del perfil de usuario. Un usuario solo puede tener una 칰nica aplicaci칩n o directorio como fuente a la vez.

No lo he visto, por lo que se agradece cualquier informaci칩n sobre seguridad y hacking relacionada con esta opci칩n.

## Personalizaciones

### Marcas

Verifica en la pesta침a **Dominios** de esta secci칩n las direcciones de correo electr칩nico utilizadas para enviar correos electr칩nicos y el dominio personalizado dentro de Okta de la empresa (que probablemente ya conozcas).

Adem치s, en la pesta침a **Configuraci칩n**, si eres administrador, puedes "**Usar una p치gina de cierre de sesi칩n personalizada**" y establecer una URL personalizada.

### SMS

Nada interesante aqu칤.

### Panel de usuario final

Aqu칤 puedes encontrar las aplicaciones configuradas, pero veremos los detalles de estas en una secci칩n diferente.

### Otros

Configuraci칩n interesante, pero nada super interesante desde el punto de vista de la seguridad.

## Aplicaciones

### Aplicaciones

Aqu칤 puedes encontrar todas las **aplicaciones configuradas** y sus detalles: qui칠n tiene acceso a ellas, c칩mo est치 configurado (SAML, OpenID), URL para iniciar sesi칩n, las asignaciones entre Okta y la aplicaci칩n...

## Gobierno de identidad

### Certificaciones de acceso

Utiliza las Certificaciones de acceso para crear campa침as de auditor칤a para revisar peri칩dicamente el acceso de tus usuarios a los recursos y aprobar o revocar el acceso autom치ticamente cuando sea necesario.

No lo he visto utilizado, pero supongo que desde un punto de vista defensivo es una caracter칤stica interesante.

## Seguridad

### General

* **Correos electr칩nicos de notificaci칩n de seguridad**: Todos deber칤an estar habilitados.
* **Integraci칩n de CAPTCHA**: Se recomienda configurar al menos el reCaptcha invisible.
* **Seguridad de la organizaci칩n**: Todo se puede habilitar y los correos electr칩nicos de activaci칩n no deben durar mucho tiempo (7 d칤as est치 bien).
* **Prevenci칩n de enumeraci칩n de usuarios**: Ambos deben estar habilitados.
* Ten en cuenta que la prevenci칩n de enumeraci칩n de usuarios no tiene efecto si se permiten alguna de las siguientes condiciones (consulta [Gesti칩n de usuarios](https://help.okta.com/oie/en-us/Content/Topics/users-groups-profiles/usgp-main.htm) para obtener m치s informaci칩n):
* Registro de autoservicio
* Flujos JIT con autenticaci칩n por correo electr칩nico
* **Configuraci칩n de Okta ThreatInsight**: Registrar y aplicar seguridad en funci칩n del nivel de amenaza.
### HealthInsight

Aqu칤 es posible encontrar configuraciones correctamente y **peligrosas**.

### Autenticadores

Aqu칤 puedes encontrar todos los m칠todos de autenticaci칩n, y en la pesta침a **Inscripci칩n** puedes ver c칩mo se requieren para acceder a Okta seg칰n cada grupo:

<figure><img src="../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

<details>

<summary><strong>춰Apoya a HackTricks y obt칠n beneficios!</strong></summary>

* Si quieres ver tu **empresa anunciada en HackTricks** o si quieres acceder a la **칰ltima versi칩n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop).
* Obt칠n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>
