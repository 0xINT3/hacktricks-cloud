# 基础 Gitea 信息

<details>

<summary><strong>从零开始学习 AWS 黑客技术，成为英雄</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想在 **HackTricks 中看到您的公司广告** 或 **下载 HackTricks 的 PDF**，请查看 [**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取 [**官方的 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 发现 [**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家的 [**NFTs 集合**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上 **关注** 我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>

## 基本结构

基本的 Gitea 环境结构是按 **组织** 对仓库进行分组，每个组织可能包含 **多个仓库** 和 **多个团队**。但是，请注意，就像在 github 中一样，用户可以在组织之外拥有仓库。

此外，一个 **用户** 可以是 **不同组织的成员**。在组织内，用户可能对每个仓库有 **不同的权限**。

用户也可能是 **不同团队的一部分**，对不同仓库有不同的权限。

最后，**仓库可能有特殊的保护机制**。

## 权限

### 组织

当一个 **组织被创建** 时，会创建一个名为 **Owners** 的团队，并将用户放入其中。这个团队将授予对 **组织的管理员访问权限**，这些 **权限** 和团队的 **名称** **不能被修改**。

**组织管理员**（所有者）可以选择组织的 **可见性**：

* 公开
* 限制（仅限登录用户）
* 私有（仅限成员）

**组织管理员** 还可以指示 **仓库管理员** 是否可以 **添加和/或移除** 团队的访问权限。他们还可以指示仓库的最大数量。

创建新团队时，会选择几个重要的设置：

* 指出团队成员将能够访问的 **组织仓库**：特定仓库（团队被添加的仓库）或所有。
* 还指出 **成员是否可以创建新仓库**（创建者将获得对其的管理员访问权限）
* 团队成员将 **拥有的权限**：
* **管理员** 访问权限
* **特定** 访问权限：

![](<../../.gitbook/assets/image (3) (1) (1) (1) (1).png>)

### 团队和用户

在仓库中，**组织管理员** 和 **仓库管理员**（如果组织允许）可以 **管理** 分配给协作者（其他用户）和团队的角色。有 **3** 种可能的 **角色**：

* 管理员
* 写入
* 阅读

## Gitea 身份验证

### 网页访问

使用 **用户名 + 密码**，并可能（推荐）使用 2FA。

### **SSH 密钥**

您可以使用一个或多个公钥配置您的帐户，允许相关的 **私钥代表您执行操作。** [http://localhost:3000/user/settings/keys](http://localhost:3000/user/settings/keys)

#### **GPG 密钥**

您 **不能用这些密钥冒充用户**，但如果您不使用它，可能会因为发送没有签名的提交而 **被发现**。

### **个人访问令牌**

您可以生成个人访问令牌以 **授予应用程序访问您的帐户**。个人访问令牌提供对您帐户的完全访问权限：[http://localhost:3000/user/settings/applications](http://localhost:3000/user/settings/applications)

### Oauth 应用程序

就像个人访问令牌一样，**Oauth 应用程序** 将对您的帐户和您的帐户有权访问的地方拥有 **完全访问权限**，因为正如 [文档](https://docs.gitea.io/en-us/oauth2-provider/#scopes) 中指出的，作用域尚未得到支持：

![](<../../.gitbook/assets/image (60).png>)

### 部署密钥

部署密钥可能对仓库具有只读或写入访问权限，因此它们可能对危害特定仓库很有趣。

## 分支保护

分支保护旨在 **不给用户完全控制仓库**。目标是在能够在某些分支内写入代码之前 **设置几种保护方法**。

可以在 _https://localhost:3000/\<orgname>/\<reponame>/settings/branches_ 中找到 **仓库的分支保护**。

{% hint style="info" %}
**不可能在组织级别设置分支保护**。因此，所有这些都必须在每个仓库中声明。
{% endhint %}

可以对分支应用不同的保护（如 master 分支）：

* **禁用推送**：没有人可以推送到这个分支
* **启用推送**：任何有权限的人都可以推送，但不能强制推送。
* **白名单限制推送**：只有选定的用户/团队可以推送到这个分支（但不能强制推送）
* **启用合并白名单**：只有白名单上的用户/团队可以合并 PR。
* **启用状态检查**：要求状态检查通过后才能合并。
* **要求审批**：指出在 PR 可以合并之前需要的审批数量。
* **限制审批到白名单**：指出可以批准 PR 的用户/团队。
* **拒绝审批的合并**：如果请求了更改，则不能合并（即使其他检查通过）
* **拒绝官方审查请求的合并**：如果有官方审查请求，则不能合并
* **驳回过时的审批**：当有新提交时，旧的审批将被驳回。
* **要求签名的提交**：提交必须是签名的。
* **如果拉取请求过时则阻止合并**
* **受保护/未受保护的文件模式**：指出要保护/不保护免受更改影响的文件模式

{% hint style="info" %}
正如您所看到的，即使您设法获得了某个用户的一些凭据，**仓库可能受到保护，避免您将代码推送到 master**，例如危害 CI/CD 管道。
{% endhint %}

<details>

<summary><strong>从零开始学习 AWS 黑客技术，成为英雄</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想在 **HackTricks 中看到您的公司广告** 或 **下载 HackTricks 的 PDF**，请查看 [**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取 [**官方的 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 发现 [**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家的 [**NFTs 集合**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上 **关注** 我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**

</details>
```markdown
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github 仓库提交 PRs 来分享你的黑客技巧。**

</details>
```
