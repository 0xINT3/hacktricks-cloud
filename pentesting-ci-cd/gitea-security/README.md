# S√©curit√© de Gitea

<details>

<summary><strong>Soutenez HackTricks et obtenez des avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **d√©p√¥ts Github.**

</details>

## Qu'est-ce que Gitea

**Gitea** est une **solution d'h√©bergement de code l√©g√®re, g√©r√©e par la communaut√© et auto-h√©berg√©e** √©crite en Go.

![](<../../.gitbook/assets/image (5) (1) (1) (1).png>)

### Informations de base

{% content-ref url="basic-gitea-information.md" %}
[basic-gitea-information.md](basic-gitea-information.md)
{% endcontent-ref %}

## Laboratoire

Pour ex√©cuter une instance de Gitea localement, vous pouvez simplement ex√©cuter un conteneur Docker :

```bash
docker run -p 3000:3000 gitea/gitea
```

Connectez-vous au port 3000 pour acc√©der √† la page web.

Vous pouvez √©galement l'ex√©cuter avec Kubernetes :

```
helm repo add gitea-charts https://dl.gitea.io/charts/
helm install gitea gitea-charts/gitea
```

## √ânum√©ration non authentifi√©e

* Repos publics : [http://localhost:3000/explore/repos](http://localhost:3000/explore/repos)
* Utilisateurs enregistr√©s : [http://localhost:3000/explore/users](http://localhost:3000/explore/users)
* Organisations enregistr√©es : [http://localhost:3000/explore/organizations](http://localhost:3000/explore/organizations)

Notez que par **d√©faut, Gitea permet aux nouveaux utilisateurs de s'inscrire**. Cela ne donnera pas d'acc√®s particuli√®rement int√©ressant aux nouveaux utilisateurs sur les autres d√©p√¥ts d'organisations/utilisateurs, mais un **utilisateur connect√©** pourrait √™tre en mesure de **visualiser plus de d√©p√¥ts ou d'organisations**.

## Exploitation interne

Pour ce sc√©nario, nous allons supposer que vous avez obtenu un certain acc√®s √† un compte Github.

### Avec les identifiants de l'utilisateur/le cookie Web

Si vous avez d√©j√† des identifiants pour un utilisateur au sein d'une organisation (ou si vous avez vol√© un cookie de session), vous pouvez simplement vous **connecter** et v√©rifier les **permissions que vous avez** sur les **d√©p√¥ts**, dans **quelles √©quipes** vous √™tes, **listez les autres utilisateurs**, et **comment les d√©p√¥ts sont prot√©g√©s**.

Notez que **2FA peut √™tre utilis√©**, vous ne pourrez donc acc√©der √† ces informations que si vous pouvez √©galement **passer cette v√©rification**.

{% hint style="info" %}
Notez que si vous **parvenez √† voler le cookie `i_like_gitea`** (actuellement configur√© avec SameSite: Lax), vous pouvez **compl√®tement usurper l'utilisateur** sans avoir besoin d'identifiants ou de 2FA.
{% endhint %}

### Avec la cl√© SSH de l'utilisateur

Gitea permet aux **utilisateurs** de d√©finir des **cl√©s SSH** qui seront utilis√©es comme **m√©thode d'authentification pour d√©ployer du code** en leur nom (aucun 2FA n'est appliqu√©).

Avec cette cl√©, vous pouvez effectuer des **changements dans les d√©p√¥ts o√π l'utilisateur a certains privil√®ges**, mais vous ne pouvez pas l'utiliser pour acc√©der √† l'API Gitea pour √©num√©rer l'environnement. Cependant, vous pouvez **√©num√©rer les param√®tres locaux** pour obtenir des informations sur les d√©p√¥ts et l'utilisateur auxquels vous avez acc√®s :

```bash
# Aller dans le dossier du d√©p√¥t
# Obtenir la configuration du d√©p√¥t et le nom et l'e-mail de l'utilisateur actuel
git config --list
```

Si l'utilisateur a configur√© son nom d'utilisateur comme son nom d'utilisateur Gitea, vous pouvez acc√©der aux **cl√©s publiques qu'il a d√©finies** dans son compte en _https://github.com/\<gitea\_username>.keys_, vous pouvez v√©rifier cela pour confirmer que la cl√© priv√©e que vous avez trouv√©e peut √™tre utilis√©e.

Les **cl√©s SSH** peuvent √©galement √™tre d√©finies dans les d√©p√¥ts en tant que **cl√©s de d√©ploiement**. Toute personne ayant acc√®s √† cette cl√© sera en mesure de **lancer des projets √† partir d'un d√©p√¥t**. Habituellement, dans un serveur avec diff√©rentes cl√©s de d√©ploiement, le fichier local **`~/.ssh/config`** vous donnera des informations sur la cl√© associ√©e.

#### Cl√©s GPG

Comme expliqu√© [**ici**](broken-reference/), il est parfois n√©cessaire de signer les commits ou vous pourriez √™tre d√©couvert.

V√©rifiez localement si l'utilisateur actuel poss√®de une cl√© avec :

```shell
gpg --list-secret-keys --keyid-format=long
```

### Avec le jeton utilisateur

Pour une introduction aux [**jetons d'acc√®s personnels** consultez les informations de base](basic-gitea-information.md#personal-access-tokens).

Un jeton utilisateur peut √™tre utilis√© **au lieu d'un mot de passe** pour **s'authentifier** aupr√®s du serveur Gitea [**via l'API**](https://try.gitea.io/api/swagger#/). il aura **un acc√®s complet** sur l'utilisateur.

### Avec l'application Oauth

Pour une introduction aux [**applications Oauth de Gitea, consultez les informations de base**](./#with-oauth-application).

Un attaquant peut cr√©er une **application Oauth malveillante** pour acc√©der aux donn√©es/actions privil√©gi√©es des utilisateurs qui les acceptent probablement dans le cadre d'une campagne de phishing.

Comme expliqu√© dans les informations de base, l'application aura **un acc√®s complet au compte utilisateur**