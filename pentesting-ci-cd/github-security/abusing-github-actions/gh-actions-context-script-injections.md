# Gh Actions - Iniezioni di Script

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Informazioni di base

Si noti che ci sono determinati [**contesti di github**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context) i cui valori sono **controllati** dall'**utente** che crea la PR. Se l'azione di github utilizza quei **dati per eseguire qualcosa**, potrebbe portare a una **esecuzione di codice arbitraria**. Questi contesti terminano tipicamente con `body`, `default_branch`, `email`, `head_ref`, `label`, `message`, `name`, `page_name`,`ref` e `title`. Ad esempio (elenco da questo [**articolo**](https://medium.com/tinder/exploiting-github-actions-on-open-source-projects-5d93936d189f)):

* github.event.comment.body
* github.event.issue.body
* github.event.issue.title
* github.head\_ref
* github.pull\_request.\*
* github.\*.\*.authors.name
* github.\*.\*.authors.email

Si noti che ci sono **fonti meno ovvie** di input potenzialmente non attendibili, come i nomi dei branch e gli indirizzi email, che possono essere **piuttosto flessibili in termini di contenuto consentito**. Ad esempio, `zzz";echo${IFS}"hello";#` sarebbe un nome di branch valido e potrebbe essere un possibile vettore di attacco per un repository target.

### Esempio di un attacco di iniezione di script <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

Un attacco di iniezione di script pu√≤ verificarsi direttamente all'interno dello script inline di un flusso di lavoro. Nell'esempio seguente, un'azione utilizza un'**espressione per testare la validit√† del titolo di una pull request**, ma aggiunge anche il rischio di iniezione di script:
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Prima dell'esecuzione dello script shell, le espressioni all'interno di `${{ }}` vengono **valutate** e quindi sostituite con i valori risultanti, il che pu√≤ renderlo **vulnerabile all'iniezione di comandi shell**.

Per iniettare comandi in questo workflow, l'attaccante potrebbe creare una pull request con un titolo di **`a"; ls $GITHUB_WORKSPACE"`**

In questo esempio, il carattere **`"`** viene utilizzato per interrompere l'istruzione `title=`**`"${{ github.event.pull_request.title }}"`**, consentendo l'esecuzione del comando `ls` sul runner.

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF**, controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository github di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
