# GH Actions - Önbellek Zehirlenmesi

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamını görmek** veya HackTricks'i **PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live) takip edin.
* Hacking hilelerinizi [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR göndererek paylaşın.

</details>


Daha fazla ayrıntı için orijinal yazıya bakın [https://scribesecurity.com/blog/github-cache-poisoning/](https://scribesecurity.com/blog/github-cache-poisoning/)


## Önbellek Zehirlenmesi

Git eylemi [**action/cache**](https://github.com/actions/cache), Sürekli Entegrasyon (CI) sürecinde bir önbellekleme mekanizması sunar ve iki önemli aşamayı kapsar:

1. **Eylemi Çalıştır**: Bu aşama, CI çalışması sırasında önbelleğe alınmış verilerin aranması ve alınmasıyla ilgilidir. Arama, benzersiz bir önbellek anahtarı kullanır ve iki sonuç üretir:
- **Önbellek bulma**: İstenen veri önbellekte bulunur ve dolayısıyla hemen kullanım için alınır.
- **Önbellek bulunamama**: Önbellekte eşleşen veri bulunamaz, bu da gereken dosya ve dizinlerin taze bir indirmeyle istenmesine benzer şekilde ilk kez istek yapılmasını tetikler.

2. **Son İş Akışı Eylemi**: Bu aşama, CI iş akışından sonra veri önbelleğine alınmıştır. Özellikle, çalışma eylemi sırasında önbellek bulunamama durumu oluşursa, belirtilen dizinlerin mevcut durumu sağlanan anahtar kullanılarak önbelleğe alınır. Bu işlem otomatiktir ve açıkça çağrı gerektirmez.

#### Güvenlik Önlemleri: Önbellek İzolasyonu ve Erişim Kısıtlamaları

Güvenliği sağlamak ve önbellek izolasyonunu sağlamak için erişim kısıtlamaları uygulanır ve farklı dallar arasında mantıksal bir ayrım oluşturulur. Örneğin, ana dalda temel alan **Özellik-A** adlı bir dal için oluşturulan bir önbelleğe, ana dalda temel alan **Özellik-B** adlı bir dalın pull isteği erişemez.

Önbellek eylemi belirli bir arama sırasına uyar:
- İlk olarak, iş akışı çalışmasıyla aynı dalda önbellek bulma arar.
- Başarısız olursa, aramayı üst dal ve diğer yukarı akış dallarına genişletir.

Önemli bir şekilde, önbellek erişimi dal kapsamlıdır ve belirli bir dalın tüm iş akışları ve çalışmaları boyunca geçerlidir. Ayrıca, GitHub, önbellek girişlerinin oluşturulduktan sonra salt okunur bir politika uygular ve herhangi bir değişikliği yasaklar.

#### Gerçek Dünya Etkisi: Düşük İzinli İş Akışından Yüksek İzinli İş Akışına Saldırı

Bir örnek CI senaryosu, bir saldırganın önbellek zehirlenmesini kullanarak düşük izinli bir iş akışından yüksek izinli bir iş akışına ayrıcalıkları yükseltmesini nasıl gerçekleştirebileceğini gösterir:

- Birim test iş akışı, birim testlerini ve kod kapsama araçlarını çalıştırmaktan sorumlu olup, tehlikeli veya savunmasız bir araç kullanmaktadır. Bu iş akışı, önbelleğe herhangi bir iş akışından erişilebilir hale getiren **action/cache** Git eylemini kullanır.
- Uygulama paketini oluşturup yayınlayan **Yayın** iş akışı, Golang bağımlılıklarını önbelleğe alarak işlemlerini optimize eder.

Bu senaryoda, birim test iş akışı, meşru bir Golang günlükleme kütüphanesini (`go`
