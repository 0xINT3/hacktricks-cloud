# Github Sekuriteit

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslagplekke.

</details>

## Wat is Github

(Van [hier](https://kinsta.com/knowledgebase/what-is-github/)) Op 'n ho√´ vlak is **GitHub 'n webwerf en wolkgebaseerde diens wat ontwikkelaars help om hul kode te stoor en te bestuur, sowel as om veranderinge aan hul kode te volg en te beheer**.

### Basiese Inligting

{% content-ref url="basic-github-information.md" %}
[basic-github-information.md](basic-github-information.md)
{% endcontent-ref %}

## Eksterne Verkenning

Github-opslagplekke kan as openbaar, privaat en intern gekonfigureer word.

* **Privaat** beteken dat **slegs** persone van die **organisasie** dit kan toegang kry
* **Intern** beteken dat **slegs** persone van die **onderneming** ('n onderneming kan verskeie organisasies h√™) dit kan toegang kry
* **Openbaar** beteken dat **die hele internet** dit kan toegang kry.

In die geval dat jy die **gebruiker, opslagplek of organisasie wat jy wil teiken** ken, kan jy **github dorks** gebruik om sensitiewe inligting te vind of te soek na **lekke van sensitiewe inligting** **op elke opslagplek**.

### Github Dorks

Github maak dit moontlik om **te soek na iets deur 'n gebruiker, opslagplek of organisasie as omvang te spesifiseer**. Daarom kan jy met 'n lys strings wat naby sensitiewe inligting gaan verskyn, maklik **soek na potensi√´le sensitiewe inligting in jou teiken**.

Hulpmiddels (elke hulpmiddel bevat sy lys van dorks):

* [https://github.com/obheda12/GitDorker](https://github.com/obheda12/GitDorker) ([Lys van dorks](https://github.com/obheda12/GitDorker/tree/master/Dorks))
* [https://github.com/techgaun/github-dorks](https://github.com/techgaun/github-dorks) ([Lys van dorks](https://github.com/techgaun/github-dorks/blob/master/github-dorks.txt))
* [https://github.com/hisxo/gitGraber](https://github.com/hisxo/gitGraber) ([Lys van dorks](https://github.com/hisxo/gitGraber/tree/master/wordlists))

### Github Lekke

Let asseblief daarop dat die github dorks ook bedoel is om te soek na lekke deur gebruik te maak van github-soekopsies. Hierdie afdeling is gewy aan daardie hulpmiddels wat **elke opslagplek sal aflaai en daarin sal soek na sensitiewe inligting** (selfs deur 'n sekere diepte van commits te ondersoek).

Hulpmiddels (elke hulpmiddel bevat sy lys van regexes):

* [https://github.com/zricethezav/gitleaks](https://github.com/zricethezav/gitleaks)
* [https://github.com/trufflesecurity/truffleHog](https://github.com/trufflesecurity/truffleHog)
* [https://github.com/eth0izzle/shhgit](https://github.com/eth0izzle/shhgit)
* [https://github.com/michenriksen/gitrob](https://github.com/michenriksen/gitrob)
* [https://github.com/anshumanbh/git-all-secrets](https://github.com/anshumanbh/git-all-secrets)
* [https://github.com/kootenpv/gittyleaks](https://github.com/kootenpv/gittyleaks)
* [https://github.com/awslabs/git-secrets](https://github.com/awslabs/git-secrets)

{% hint style="warning" %}
Wanneer jy soek na lekke in 'n opslagplek en iets soos `git log -p` hardloop, moenie vergeet dat daar dalk **ander takke met ander commits** wat geheime bevat nie!
{% endhint %}

### Eksterne Forks

Dit is moontlik om opslagplekke te **kompromitteer deur gebruik te maak van pull-aanvrae**. Om te weet of 'n opslagplek kwesbaar is, moet jy meestal die Github Actions yaml-konfigurasies lees. [**Meer inligting hieroor hieronder**](./#execution-from-a-external-fork).

## Organisasie Verharding

### Lid Voorregte

Daar is 'n paar **standaard voorregte** wat aan **lede** van die organisasie toegewys kan word. Hierdie kan beheer word vanaf die bladsy `https://github.com/organizations/<org_name>/settings/member_privileges` of vanaf die [**Organisasies API**](https://docs.github.com/en/rest/orgs/orgs).

* **Basiese toestemmings**: Lede sal die toestemming None/Lees/Skryf/Admin h√™ oor die organisasie-opslagplekke. Dit word aanbeveel om **None** of **Lees** te gebruik.
* **Opslagplek vurk**: As dit nie nodig is nie, is dit beter om lede **nie toe te laat** om organisasie-opslagplekke te vurk nie.
* **Skepping van bladsye**: As dit nie nodig is nie, is dit beter om lede **nie toe te laat** om bladsye van die organisasie-opslagplekke te publiseer nie. As dit nodig is, kan jy toelaat om openbare of private bladsye te skep.
* **Versoeke vir integrasie-toegang**: Met hierdie opsie sal buite-medewerkers in staat wees om toegang tot hierdie organisasie en sy hulpbronne te versoek vir GitHub- of OAuth-toepassings. Dit is gewoonlik nodig, maar as dit nie nodig is nie, is dit beter om dit uit te skakel.
* _Ek kon nie hierdie inligting in die API-respons vind nie, deel as jy dit doen_
* **Verandering van opslagplek sigbaarheid**: As dit geaktiveer is, sal **lede** met **admin**-toestemmings vir die **opslagplek** in staat wees om **die sigbaarheid daarvan te verander**. As dit gedeaktiveer is, kan slegs organisasie-eienaars opslagplek-sigbaarhede verander. As jy nie wil h√™ dat mense dinge **openbaar** maak nie, maak seker dat dit **gedeaktiveer** is.
* _Ek kon nie hierdie inligting in die API-respons vind nie, deel as jy dit doen_
* **Opslagplek verwydering en oord
### Integrasies

Laat weet as jy die API-eindpunt ken om hierdie inligting te bekom!

* **Beleid vir toegang tot derde-party-toepassings**: Dit word aanbeveel om die toegang tot elke toepassing te beperk en slegs die nodige toepassings toe te laat (nadat hulle hersien is).
* **Ge√Ønstalleerde GitHub-toepassings**: Dit word aanbeveel om slegs die nodige toepassings toe te laat (nadat hulle hersien is).

## Verkenning en aanvalle wat geloofsbriewe misbruik

Vir hierdie scenario gaan ons aanneem dat jy toegang tot 'n GitHub-rekening verkry het.

### Met gebruikersgeloofsbriewe

As jy op een of ander manier al geloofsbriewe vir 'n gebruiker binne 'n organisasie het, kan jy eenvoudig **aanteken** en kyk watter **onderneming- en organisasierolle jy het**, as jy 'n gewone lid is, kyk watter **regte gewone lede het**, in watter **groepe** jy is, watter **regte jy het** oor watter **bewaarplekke**, en **hoe die bewaarplekke beskerm is**.

Let daarop dat **2FA gebruik kan word**, sodat jy hierdie inligting slegs kan benader as jy ook **daardie toets kan slaag**.

{% hint style="info" %}
Let daarop dat as jy daarin slaag om die `user_session`-koekie te **steel** (tans gekonfigureer met SameSite: Lax), jy die gebruiker **volledig kan naboots** sonder om geloofsbriewe of 2FA nodig te h√™.
{% endhint %}

Kyk na die afdeling hieronder oor [**takbeskermingsomseilings**](./#takbeskerming-omseiling) as dit nuttig is.

### Met gebruikers SSH-sleutel

Github laat **gebruikers** toe om **SSH-sleutels** in te stel wat as **verifikasiemetode gebruik sal word om kode te implementeer** namens hulle (geen 2FA word toegepas nie).

Met hierdie sleutel kan jy **veranderings in bewaarplekke waar die gebruiker sekere voorregte het**, uitvoer, maar jy kan dit nie gebruik om toegang tot die GitHub API te verkry om die omgewing op te som nie. Jy kan egter **plaaslike instellings opnoem** om inligting oor die bewaarplekke en gebruiker waarop jy toegang het, te verkry:
```bash
# Go to the the repository folder
# Get repo config and current user name and email
git config --list
```
As die gebruiker sy gebruikersnaam as sy github-gebruikersnaam gekonfigureer het, kan jy die **openbare sleutels wat hy ingestel het** in sy rekening by _https://github.com/\<github\_gebruikersnaam>.keys_ toegang, jy kan dit nagaan om te bevestig dat die privaatsleutel wat jy gevind het, gebruik kan word.

**SSH-sleutels** kan ook in repositories as **implementeringssleutels** ingestel word. Enigeen met toegang tot hierdie sleutel sal in staat wees om projekte vanuit 'n repository te **begin**. Gewoonlik sal die plaaslike l√™er **`~/.ssh/config`** jou inligting gee oor watter sleutel verband hou.

#### GPG-sleutels

Soos [**hier**](broken-reference/) verduidelik, is dit soms nodig om die commits te onderteken, anders kan jy ontdek word.

Kyk plaaslik of die huidige gebruiker enige sleutels het met:
```shell
gpg --list-secret-keys --keyid-format=long
```
### Met Gebruikerstoken

Vir 'n inleiding oor [**Gebruikerstokens, sien die basiese inligting**](basic-github-information.md#personal-access-tokens).

'n Gebruikerstoken kan gebruik word **in plaas van 'n wagwoord** vir Git oor HTTPS, of kan gebruik word om [**teken te gee tot die API oor Basiese Verifikasie**](https://docs.github.com/v3/auth/#basic-authentication). Afhangende van die voorregte wat daaraan verbind is, kan jy verskillende aksies uitvoer.

'n Gebruikerstoken lyk soos hierdie: `ghp_EfHnQFcFHX6fGIu5mpduvRiYR584kK0dX123`

### Met Oauth-aansoek

Vir 'n inleiding oor [**Github Oauth-aansoeke, sien die basiese inligting**](basic-github-information.md#oauth-applications).

'n Aanvaller kan 'n **boosaardige Oauth-aansoek** skep om toegang te verkry tot bevoorregte data/aksies van gebruikers wat hulle waarskynlik aanvaar as deel van 'n phising-veldtog.

Dit is die [omvang wat 'n Oauth-aansoek kan aanvra](https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps). 'n Persoon moet altyd die aangevraagde omvang nakyk voordat hulle dit aanvaar.

Verder, soos verduidelik in die basiese inligting, **kan organisasies toegang tot derdeparty-aansoeke gee/weier** tot inligting/repos/aksies wat verband hou met die organisasie.

### Met Github-aansoek

Vir 'n inleiding oor [**Github-aansoeke, sien die basiese inligting**](basic-github-information.md#github-applications).

'n Aanvaller kan 'n **boosaardige Github-aansoek** skep om toegang te verkry tot bevoorregte data/aksies van gebruikers wat hulle waarskynlik aanvaar as deel van 'n phising-veldtog.

Verder, soos verduidelik in die basiese inligting, **kan organisasies toegang tot derdeparty-aansoeke gee/weier** tot inligting/repos/aksies wat verband hou met die organisasie.

## Kompromittering en Misbruik van Github-aksie

Daar is verskeie tegnieke om 'n Github-aksie te kompromitteer en te misbruik, kyk hulle hier:

{% content-ref url="abusing-github-actions/" %}
[abusing-github-actions](abusing-github-actions/)
{% endcontent-ref %}

## Oorskryf van Takkiebeskerming

* **Vereis 'n aantal goedkeurings**: As jy verskeie rekeninge gekompromitteer het, kan jy jou PR's van ander rekeninge aanvaar. As jy net die rekening het waarvandaan jy die PR geskep het, kan jy nie jou eie PR aanvaar nie. Tog, as jy toegang het tot 'n **Github-aksie-omgewing binne die repo**, deur die gebruik van die **GITHUB\_TOKEN**, kan jy dalk jou PR **goedkeur** en op hierdie manier 1 goedkeuring kry.
* _Let op dat 'n gebruiker gewoonlik nie sy eie PR's kan goedkeur nie, maar as jy dit kan, kan jy dit misbruik om jou PR's te aanvaar._
* **Verwerp goedkeurings wanneer nuwe veranderinge gedruk word**: As dit nie ingestel is nie, kan jy legitieme kode indien, wag tot iemand dit goedkeur, en dan boosaardige kode indien en dit in die beskermde tak saamvoeg.
* **Vereis resensies deur kode-eienaars**: As dit geaktiveer is en jy 'n kode-eienaar is, kan jy 'n **Github-aksie maak wat jou PR skep en dit dan self goedkeur**.
* Wanneer 'n **CODEOWNER-l√™er verkeerd geconfigureer** is, kla Github nie daaroor nie, maar gebruik dit nie. Daarom, as dit verkeerd geconfigureer is, word **Code Owners-beskerming nie toegepas nie**.
* **Laat gespesifiseerde akteurs toe om aanvraag vir trekvereistes te omseil**: As jy een van hierdie akteurs is, kan jy trekvereistes omseil.
* **Sluit administrateurs in**: As dit nie ingestel is nie en jy is 'n administrateur van die repo, kan jy hierdie takbeskerming omseil.
* **PR-ontvoering**: Jy kan dalk die PR van iemand anders **verander deur boosaardige kode by te voeg**, die resulterende PR self goed te keur en alles saam te voeg.
* **Verwydering van takbeskerming**: As jy 'n **administrateur van die repo is, kan jy die beskerming uitskakel**, jou PR saamvoeg en die beskerming weer instel.
* **Omseiling van drukbeskerming**: As 'n repo slegs sekere gebruikers toelaat om druk (kode saamvoeg) in takke te stuur (die takbeskerming kan al die takke beskerm deur die wildcard `*` te spesifiseer).
* As jy **skryftoegang tot die repo het, maar nie toegelaat word om kode te stuur nie** as gevolg van die takbeskerming, kan jy steeds 'n nuwe tak **skep** en binne dit 'n **github-aksie skep wat geaktiveer word wanneer kode gestuur word**. Aangesien die **takbeskerming die tak nie sal beskerm totdat dit geskep is nie**, sal hierdie eerste kode-indiening na die tak die **github-aksie uitvoer**. 

## Omseiling van Omgewingsbeskerming

Vir 'n inleiding oor [**Github-omgewings, sien die basiese inligting**](basic-github-information.md#git-environments).

In die geval waar 'n omgewing vanaf **alle takke toeganklik** is, is dit **nie beskerm nie** en kan jy maklik toegang verkry tot die geheime binne die omgewing. Let daarop dat jy dalk repos sal vind waar **alle takke beskerm is** (deur hul name te spesifiseer of deur `*` te gebruik) in daardie scenario, **vind 'n tak waar jy kode kan indien** en jy kan die geheime uitlek deur 'n nuwe github-aksie te skep (of een te wysig).

Let daarop dat jy die uitsonderlike geval kan vind waar **alle takke beskerm is** (via die wildcard `*`) en daar is gespesifiseer **wie kode na die takke kan stuur** (_jy kan dit spesifiseer in die takbeskerming_) en **jou gebruiker nie toegelaat word nie**. Jy kan steeds 'n aangepaste github-aksie uitvoer omdat jy 'n tak kan skep en die druktrigger daaroor kan gebruik. Die **takbeskerming laat die indiening na 'n nuwe tak toe, sodat die github-aksie uitgevoer sal word**.
```yaml
push: # Run it when a push is made to a branch
branches:
- current_branch_name #Use '**' to run when a push is made to any branch
```
Let wel dat **nadat die tak geskep is**, die **takbeskerming van toepassing sal wees op die nuwe tak** en jy sal dit nie kan wysig nie, maar teen daardie tyd sal jy reeds die geheime uitgelek het.

## Volharding

* Genereer **gebruikerstoken**
* Steel **Github-tokens** uit **geheime**
* **Verwydering** van werkstroom **resultate** en **takke**
* Gee **meer toestemmings aan die hele organisasie**
* Skep **webhooks** om inligting uit te voer
* Nooi **buiteste medewerkers** uit
* **Verwyder** **webhooks** wat deur die **SIEM** gebruik word
* Skep/wysig **Github-aksie met 'n agterdeur**
* Vind **kwesbare Github-aksie vir opdraginjeksie** deur middel van **geheime** waarde wysiging

### Imposter Commits - Agterdeur via repo commits

In Github is dit moontlik om **'n PR na 'n repo van 'n vurk te skep**. Selfs as die PR **nie aanvaar word nie**, sal 'n **commit**-id binne die oorspronklike repo geskep word vir die vurk-weergawe van die kode. Daarom kan 'n aanvaller **spesifiek verwys na 'n commit van 'n skynbaar legitieme repo wat nie deur die eienaar van die repo geskep is nie**.

Soos [**hierdie**](https://github.com/actions/checkout/commit/c7d749a2d57b4b375d1ebcd17cfbfb60c676f18e):
```yaml
name: example
on: [push]
jobs:
commit:
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@c7d749a2d57b4b375d1ebcd17cfbfb60c676f18e
- shell: bash
run: |
echo 'hello world!'
```
Vir meer inligting, kyk na [https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd](https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd)

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
