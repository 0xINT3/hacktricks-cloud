# Okta Absicherung

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

## Verzeichnis

### Personen

Aus der Sicht eines Angreifers ist dies besonders interessant, da Sie **alle registrierten Benutzer**, ihre **E-Mail-Adressen**, die **Gruppen**, denen sie angeh√∂ren, **Profile** und sogar **Ger√§te** (Mobilger√§te mit ihren Betriebssystemen) sehen k√∂nnen.

F√ºr eine Whitebox-√úberpr√ºfung √ºberpr√ºfen Sie, ob es mehrere "**Ausstehende Benutzeraktionen**" und "**Passwort zur√ºcksetzen**" gibt.

### Gruppen

Hier finden Sie alle erstellten Gruppen in Okta. Es ist interessant, die verschiedenen Gruppen (Berechtigungss√§tze) zu verstehen, die **Benutzern** gew√§hrt werden k√∂nnten.\
Es ist m√∂glich, die **Personen innerhalb von Gruppen** und die **Apps, die jeder Gruppe zugewiesen sind**, zu sehen.

Nat√ºrlich ist jede Gruppe mit dem Namen **admin** interessant, insbesondere die Gruppe **Globale Administratoren**, √ºberpr√ºfen Sie die Mitglieder, um herauszufinden, wer die privilegiertesten Mitglieder sind.

Aus einer Whitebox-√úberpr√ºfung heraus sollten **nicht mehr als 5 globale Admins** vorhanden sein (besser, wenn es nur 2 oder 3 gibt).

### Ger√§te

Hier finden Sie eine **Liste aller Ger√§te** aller Benutzer. Sie k√∂nnen auch sehen, ob sie **aktiv verwaltet** werden oder nicht.

### Profil-Editor

Hier ist es m√∂glich zu beobachten, wie Schl√ºsselinformationen wie Vor- und Nachnamen, E-Mails, Benutzernamen usw. zwischen Okta und anderen Anwendungen geteilt werden. Dies ist interessant, weil ein Benutzer ein Feld in Okta **√§ndern kann** (wie seinen Namen oder seine E-Mail), das dann von einer **externen Anwendung** verwendet wird, um den Benutzer zu **identifizieren**, und ein Insider versuchen k√∂nnte, **andere Konten zu √ºbernehmen**.

Dar√ºber hinaus k√∂nnen Sie im Profil **`Benutzer (Standard)`** von Okta sehen, **welche Felder** jeder **Benutzer** hat und welche von Benutzern **beschreibbar** sind. Wenn Sie das Admin-Panel nicht sehen k√∂nnen, gehen Sie einfach zu **Aktualisieren Ihrer Profil**-Informationen und Sie sehen, welche Felder Sie aktualisieren k√∂nnen (beachten Sie, dass Sie zur Aktualisierung einer E-Mail-Adresse diese verifizieren m√ºssen).

### Verzeichnisintegrationen

Verzeichnisse erm√∂glichen es Ihnen, Personen aus vorhandenen Quellen zu importieren. Ich nehme an, hier sehen Sie die aus anderen Verzeichnissen importierten Benutzer.

Ich habe es nicht gesehen, aber ich nehme an, dass es interessant ist, **andere Verzeichnisse zu finden, die Okta zum Importieren von Benutzern verwendet**, sodass Sie, wenn Sie dieses Verzeichnis **kompromittieren**, einige Attributwerte bei den in Okta erstellten Benutzern festlegen k√∂nnten und **m√∂glicherweise die Okta-Umgebung kompromittieren** k√∂nnten.

### Profilquellen

Eine Profilquelle ist eine **Anwendung, die als Wahrheitsquelle** f√ºr Benutzerprofilattribute fungiert. Ein Benutzer kann immer nur von einer einzelnen Anwendung oder einem Verzeichnis bezogen werden.

Ich habe es nicht gesehen, daher sind alle Informationen zur Sicherheit und zum Hacking in Bezug auf diese Option willkommen.

## Anpassungen

### Marken

√úberpr√ºfen Sie im Abschnitt **Domains** dieser Sektion die E-Mail-Adressen, die zum Senden von E-Mails verwendet werden, und die benutzerdefinierte Domain innerhalb von Okta des Unternehmens (die Sie wahrscheinlich bereits kennen).

Dar√ºber hinaus k√∂nnen Sie im **Einstellungen**-Tab, wenn Sie Administrator sind, "**Eine benutzerdefinierte Abmelde-Seite verwenden**" und eine benutzerdefinierte URL festlegen.

### SMS

Hier gibt es nichts Interessantes.

### Dashboard f√ºr Endbenutzer

Hier finden Sie konfigurierte Anwendungen, aber wir werden die Details sp√§ter in einem anderen Abschnitt sehen.

### Andere

Interessante Einstellung, aber nichts besonders Interessantes aus Sicherheitssicht.

## Anwendungen

### Anwendungen

Hier finden Sie alle **konfigurierten Anwendungen** und deren Details: Wer hat Zugriff darauf, wie ist sie konfiguriert (SAML, OPenID), URL zum Einloggen, die Zuordnungen zwischen Okta und der Anwendung...

Im Tab **`Anmeldung`** gibt es auch ein Feld namens **`Passwort anzeigen`**, das es einem Benutzer erm√∂glichen w√ºrde, **sein Passwort anzuzeigen**, wenn er die Anwendungseinstellungen √ºberpr√ºft. Um die Einstellungen einer Anwendung im Benutzerpanel zu √ºberpr√ºfen, klicken Sie auf die 3 Punkte:

<figure><img src="../../.gitbook/assets/image (4) (7).png" alt=""><figcaption></figcaption></figure>

Und Sie k√∂nnten einige weitere Details zur App sehen (wie die Passwortanzeige-Funktion, wenn sie aktiviert ist):

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

## Identit√§tsverwaltung

### Zugriffszertifizierungen

Verwenden Sie Zugriffszertifizierungen, um Auditkampagnen zu erstellen, um regelm√§√üig den Zugriff Ihrer Benutzer auf Ressourcen zu √ºberpr√ºfen und den Zugriff automatisch zu genehmigen oder zu widerrufen, wenn erforderlich.

Ich habe es nicht verwendet, aber ich nehme an, dass es aus defensiver Sicht eine n√ºtzliche Funktion ist.

## Sicherheit

### Allgemein

* **Sicherheitsbenachrichtigungs-E-Mails**: Alle sollten aktiviert sein.
* **CAPTCHA-Integration**: Es wird empfohlen, mindestens das unsichtbare reCaptcha einzurichten.
* **Organisationssicherheit**: Alles kann aktiviert werden und Aktivierungs-E-Mails sollten nicht lange dauern (7 Tage sind in Ordnung)
* **Benutzerenumerierungspr√§vention**: Beide sollten aktiviert sein
* Beachten Sie, dass die Benutzerenumerierungspr√§vention nicht wirksam wird, wenn eine der folgenden Bedingungen erlaubt ist (Weitere Informationen finden Sie unter [Benutzerverwaltung](https://help.okta.com/oie/en-us/Content/Topics/users-groups-profiles/usgp-main.htm)):
* Selbstregistrierung
* JIT-Flows mit E-Mail-Authentifizierung
* **Okta ThreatInsight-Einstellungen**: Protokollieren und Sicherheit basierend auf Bedrohungsstufe durchsetzen

### HealthInsight

Hier k√∂nnen korrekt und **gef√§hrlich** konfigurierte **Einstellungen** gefunden werden.

### Authentifizierer

Hier finden Sie alle Authentifizierungsmethoden, die ein Benutzer verwenden k√∂nnte: Passwort, Telefon, E-Mail, Code, WebAuthn... Wenn Sie auf den Passwort-Authentifizierer klicken, k√∂nnen Sie die **Passwortrichtlinie** sehen. √úberpr√ºfen Sie, dass sie stark ist.

Im Tab **Registrierung** k√∂nnen Sie sehen, welche davon erforderlich oder optional sind:

<figure><img src="../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

Es wird empfohlen, Telefon zu deaktivieren. Die st√§rksten sind wahrscheinlich eine Kombination aus Passwort, E-Mail und WebAuthn.

### Authentifizierungsrichtlinien

Jede App hat eine Authentifizierungsrichtlinie. Die Authentifizierungsrichtlinie √ºberpr√ºft, ob Benutzer, die versuchen, sich bei der App anzumelden, bestimmte Bedingungen erf√ºllen, und erzwingt Faktoranforderungen basierend auf diesen Bedingungen.

Hier finden Sie die **Anforderungen zum Zugriff auf jede Anwendung**. Es wird empfohlen, f√ºr jede Anwendung mindestens ein Passwort und eine weitere Methode anzufordern. Aber wenn Sie als Angreifer etwas Schw√§cheres finden, k√∂nnten Sie es angreifen.
### Globale Sitzungsrichtlinie

Hier finden Sie die Sitzungsrichtlinien, die verschiedenen Gruppen zugewiesen sind. Zum Beispiel:

<figure><img src="../../.gitbook/assets/image (2) (1) (2).png" alt=""><figcaption></figcaption></figure>

Es wird empfohlen, MFA anzufordern, die Sitzungsdauer auf einige Stunden zu begrenzen, Sitzungscookies nicht √ºber Browsererweiterungen zu speichern und den Standort und den Identit√§tsanbieter (falls m√∂glich) zu beschr√§nken. Wenn beispielsweise jeder Benutzer sich aus einem Land einloggen sollte, k√∂nnten Sie nur diesen Standort zulassen.

### Identit√§tsanbieter

Identit√§tsanbieter (IdPs) sind Dienste, die **Benutzerkonten verwalten**. Durch das Hinzuf√ºgen von IdPs in Okta k√∂nnen Ihre Endbenutzer sich mit Ihren benutzerdefinierten Anwendungen **selbst registrieren**, indem sie sich zuerst mit einem sozialen Konto oder einer Smartcard authentifizieren.

Auf der Seite der Identit√§tsanbieter k√∂nnen Sie soziale Logins (IdPs) hinzuf√ºgen und Okta als Dienstanbieter (SP) konfigurieren, indem Sie eingehendes SAML hinzuf√ºgen. Nachdem Sie IdPs hinzugef√ºgt haben, k√∂nnen Sie Routing-Regeln einrichten, um Benutzer basierend auf dem Kontext, wie dem Standort des Benutzers, Ger√§t oder E-Mail-Dom√§ne, zu einem IdP zu leiten.

**Wenn ein Identit√§tsanbieter konfiguriert ist**, √ºberpr√ºfen Sie diese Konfiguration aus der Sicht eines Angreifers und Verteidigers und stellen Sie sicher, dass die Quelle wirklich vertrauensw√ºrdig ist, da ein Angreifer, der sie kompromittiert, auch Zugriff auf die Okta-Umgebung erhalten k√∂nnte.

### Delegierte Authentifizierung

Die delegierte Authentifizierung erm√∂glicht es Benutzern, sich bei Okta anzumelden, indem sie Anmeldeinformationen f√ºr den **Active Directory (AD) oder LDAP**-Server ihrer Organisation eingeben.

√úberpr√ºfen Sie dies erneut, da ein Angreifer, der das AD einer Organisation kompromittiert, dank dieser Einstellung m√∂glicherweise auf Okta umschwenken kann.

### Netzwerk

Eine Netzwerkzone ist eine konfigurierbare Grenze, die Sie verwenden k√∂nnen, um den Zugriff auf Computer und Ger√§te in Ihrer Organisation basierend auf der **IP-Adresse**, die den Zugriff anfordert, zu **gew√§hren oder einzuschr√§nken**. Sie k√∂nnen eine Netzwerkzone definieren, indem Sie eine oder mehrere einzelne IP-Adressen, IP-Adressbereiche oder geografische Standorte angeben.

Nachdem Sie eine oder mehrere Netzwerkzonen definiert haben, k√∂nnen Sie sie in **globalen Sitzungsrichtlinien**, **Authentifizierungsrichtlinien**, VPN-Benachrichtigungen und **Routing-Regeln** verwenden.

Aus der Sicht eines Angreifers ist es interessant zu wissen, welche IPs zugelassen sind (und √ºberpr√ºfen, ob einige IPs privilegierter sind als andere). Aus der Sicht eines Angreifers, wenn die Benutzer von einer bestimmten IP-Adresse oder Region aus zugreifen sollten, √ºberpr√ºfen Sie, ob diese Funktion ordnungsgem√§√ü verwendet wird.

### Ger√§teintegrationen

* **Endpunktverwaltung**: Die Endpunktverwaltung ist eine Bedingung, die in einer Authentifizierungsrichtlinie angewendet werden kann, um sicherzustellen, dass verwaltete Ger√§te Zugriff auf eine Anwendung haben.
* Ich habe dies noch nicht verwendet. TODO
* **Benachrichtigungsdienste**: Ich habe dies noch nicht verwendet. TODO

### API

Sie k√∂nnen auf dieser Seite Okta-API-Token erstellen und diejenigen sehen, die **erstellt** wurden, ihre **Berechtigungen**, **Ablaufzeit** und **Ursprungs-URLs**. Beachten Sie, dass API-Token mit den Berechtigungen des Benutzers generiert werden, der das Token erstellt hat, und nur g√ºltig sind, wenn der **Benutzer**, der sie erstellt hat, **aktiv** ist.

Die **Vertrauensw√ºrdigen Urspr√ºnge** gew√§hren Websites, die Sie kontrollieren und denen Sie vertrauen, den Zugriff auf Ihre Okta-Organisation √ºber die Okta-API.

Es sollten nicht viele API-Token vorhanden sein, da ein Angreifer versuchen k√∂nnte, auf sie zuzugreifen und sie zu verwenden.

## Workflow

### Automatisierungen

Automatisierungen erm√∂glichen es Ihnen, automatisierte Aktionen zu erstellen, die basierend auf einer Reihe von Triggerbedingungen ausgef√ºhrt werden, die w√§hrend des Lebenszyklus von Endbenutzern auftreten.

Beispielsweise k√∂nnte eine Bedingung "Benutzer-Inaktivit√§t in Okta" oder "Ablauf des Benutzerpassworts in Okta" sein und die Aktion k√∂nnte "E-Mail an den Benutzer senden" oder "Benutzerlebenszyklusstatus in Okta √§ndern" sein.

## Berichte

### Berichte

Logs herunterladen. Sie werden an die **E-Mail-Adresse** des aktuellen Kontos **gesendet**.

### Systemprotokoll

Hier finden Sie die **Protokolle der Aktionen, die von Benutzern** durchgef√ºhrt wurden, mit vielen Details wie dem Einloggen in Okta oder in Anwendungen √ºber Okta.

### Import√ºberwachung

Hier k√∂nnen Sie **Logs von anderen Plattformen importieren**, auf die mit Okta zugegriffen wurde.

### Rate Limits

√úberpr√ºfen Sie die erreichten API-Rate-Limits.

## Einstellungen

### Konto

Hier finden Sie **allgemeine Informationen** √ºber die Okta-Umgebung, wie den Firmennamen, die Adresse, **E-Mail-Rechnungskontakt**, **E-Mail-technischer Kontakt** und auch wer Okta-Updates erhalten sollte und welche Art von Okta-Updates.

### Downloads

Hier k√∂nnen Sie Okta-Agenten herunterladen, um Okta mit anderen Technologien zu synchronisieren.
