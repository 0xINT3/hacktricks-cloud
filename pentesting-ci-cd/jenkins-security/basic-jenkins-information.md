# Taarifa Msingi za Jenkins

<details>

<summary><strong>Jifunze kuhusu kuvamia AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuvamia kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Kupata

### Jina la Mtumiaji + Nywila

Njia ya kawaida zaidi ya kuingia kwenye Jenkins ni kwa kutumia jina la mtumiaji au nywila.

### Kuki

Ikiwa **kuki iliyoruhusiwa inaporwa**, inaweza kutumika kufikia kikao cha mtumiaji. Kuki kawaida huitwa `JSESSIONID.*`. (Mtumiaji anaweza kusitisha vikao vyake vyote, lakini atahitaji kwanza kugundua kwamba kuki imerowa).

### SSO/Vifaa vya Programu

Jenkins inaweza kusanidiwa kutumia vifaa vya programu ili iwe **inapatikana kupitia SSO ya mtu wa tatu**.

### Vitufe

**Watumiaji wanaweza kuzalisha vitufe** kutoa ufikiaji kwa programu kuwakilisha kupitia CLI au REST API.

### Vipuli vya SSH

Kipengele hiki hutoa seva ya SSH iliyojengwa kwa Jenkins. Ni kiolesura mbadala kwa [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), na amri zinaweza kuitwa kwa njia hii kwa kutumia mteja yeyote wa SSH. (Kutoka kwa [nyaraka](https://plugins.jenkins.io/sshd/))

## Idhini

Katika `/configureSecurity` ni **inawezekana kusanidi njia ya idhini ya Jenkins**. Kuna chaguo kadhaa:

* **Kila mtu anaweza kufanya chochote**: Hata ufikiaji wa bila jina unaweza kusimamia seva
* **Hali ya zamani**: Sawa na Jenkins <1.164. Ikiwa una **jukumu la "admin"**, utapewa **udhibiti kamili** juu ya mfumo, na **vinginevyo** (ikiwa ni pamoja na **watumiaji wasiojulikana**) utapata ufikiaji wa **kusoma** tu.
* **Watumiaji walioingia wanaweza kufanya chochote**: Katika hali hii, kila **mtumiaji aliyeingia anapata udhibiti kamili** wa Jenkins. Mtumiaji pekee ambaye hatakuwa na udhibiti kamili ni **mtumiaji asiyejulikana**, ambaye anapata ufikiaji wa **kusoma** tu.
* **Usalama wa Msingi wa Matriki**: Unaweza kusanidi **nani anaweza kufanya nini** kwenye jedwali. Kila **safu** inawakilisha **ruhusa**. Kila **safu** inawakilisha **mtumiaji au kikundi/jukumu.** Hii ni pamoja na mtumiaji maalum '**asiyejulikana**', ambaye anawakilisha **watumiaji wasiothibitishwa**, pamoja na '**thibitishwa**', ambayo inawakilisha **watumiaji wote waliothibitishwa**.

![](<../../.gitbook/assets/image (40).png>)

* **Mbinu ya Idhini ya Matriki kulingana na Mradi:** Hali hii ni **nyongeza** kwa "**Usalama wa Matriki**" ambayo inaruhusu Matriki ya ACL ya ziada **kutajwa kwa kila mradi kando.**
* **Mbinu ya Msingi ya Jukumu:** Inawezesha kutaja idhini kwa kutumia **mkakati uliojengwa kwa jukumu**. Dhibiti majukumu katika `/role-strategy`.

## **Ulimwengu wa Usalama**

Katika `/configureSecurity` ni **inawezekana kusanidi ulimwengu wa usalama.** Kwa chaguo-msingi Jenkins inajumuisha msaada kwa Ulimwengu tofauti wa Usalama:

* **Kumweka kwa kontena ya servlet**: Kwa **kupeleka uthibitishaji kwa kontena ya servlet inayoendesha kudhibiti Jenkins**, kama vile [Jetty](https://www.eclipse.org/jetty/).
* **Hifadhidata ya mtumiaji wa Jenkins yenyewe:** Tumia **hifadhidata ya mtumiaji iliyojengwa ndani ya Jenkins** kwa uthibitishaji badala ya kupeleka kwa mfumo wa nje. Hii imeamilishwa kwa chaguo-msingi.
* **LDAP**: Kupeleka uthibitishaji wote kwa seva ya LDAP iliyosanidiwa, ikiwa ni pamoja na watumiaji na vikundi.
* **Hifadhidata ya mtumiaji/kikundi cha Unix**: **Kupeleka uthibitishaji kwa hifadhidata ya mtumiaji wa kiwango cha Unix** kwenye kudhibiti Jenkins. Hali hii pia itaruhusu kutumia tena vikundi vya Unix kwa idhini.

Vifaa vya programu vinaweza kutoa ulimwengu wa usalama wa ziada ambao unaweza kuwa na manufaa kwa kuingiza Jenkins katika mifumo ya utambulisho iliyopo, kama vile:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [Uthibitishaji wa GitHub](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Nodes, Mawakala & Watendaji wa Jenkins

Maelezo kutoka kwa [nyaraka](https://www.jenkins.io/doc/book/managing/nodes/):

**Nodes** ni **mashine** ambazo mawakala wa kujenga **hufanya kazi**. Jenkins inachunguza kila node iliyowekwa kwa nafasi ya diski, nafasi ya temp ya bure, swap ya bure, wakati wa saa/sawazisha na wakati wa majibu. Node inachukuliwa nje ya mtandao ikiwa thamani yoyote ya thamani hizi inatoka nje ya kizingiti kilichowekwa.

**Mawakala** **hudhibiti** utekelezaji wa kazi kwa niaba ya kudhibiti Jenkins kwa **kutumia watendaji**. Mawakala wanaweza kutumia mfumo wa uendeshaji wowote unaounga mkono Java. Zana zinazohitajika kwa ujenzi na vipimo vinafungwa kwenye node ambapo mawakala wanafanya kazi; wanaweza **kufungwa moja kwa moja au kwenye kontena** (Docker au Kubernetes). Kila **mawakala ni mchakato na PID yake mwenyewe** kwenye mashine mwenyeji.

Watendaji ni **nafasi ya utekelezaji wa kazi**; kimsingi, ni **mnyororo katika mawakala**. Idadi ya watendaji kwenye node inaamua idadi ya **kazi za wakati mmoja** zinazoweza kutekelezwa kwenye node hiyo wakati mmoja. Kwa maneno mengine, hii inaamua idadi ya **hatua za Pipeline za wakati mmoja** zinazoweza kutekelezwa kwenye node hiyo wakati mmoja.

## Siri za Jenkins

### Ufichaji wa Siri na Vyeti

Ufafanuzi kutoka kwa [nyaraka](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials):
Jenkins hutumia **AES kufichia na kulinda siri**, vyeti, na funguo zao za kufichia. Funguo hizi za kufichia zimehifadhiwa katika `$JENKINS_HOME/secrets/` pamoja na funguo kuu zinazotumiwa kulinda funguo hizo. Dhibiti huu unapaswa kusanidiwa ili tu mtumiaji wa mfumo wa uendeshaji ambaye kudhibiti Jenkins awe na ufikiaji wa kusoma na kuandika kwenye saraka hii (yaani, thamani ya `chmod` ya `0700` au kutumia sifa sahihi za faili). **Funguo kuu** (mara nyingine inaitwa "funguo la kufichia funguo" katika cryptojargon) **imehifadhiwa **_**bila kufichwa**_ kwenye mfumo wa faili wa kudhibiti Jenkins katika **`$JENKINS_HOME/secrets/master.key`** ambayo haikulindwa dhidi ya wachomaji wenye ufikiaji moja kwa moja kwa faili hiyo. Watumiaji wengi na watengenezaji watatumia funguo hizi za kufichia kwa njia isiyo ya moja kwa moja kupitia [API ya Siri](https://javadoc.jenkins.io/byShortName/Secret) kwa kuficha data ya siri ya kawaida au kupitia API ya vyeti. Kwa wale wanaopenda crypto, Jenkins hutumia AES katika mnyororo wa kufungia mnyororo (CBC) na PKCS#5 kufunika na IVs za nasibu kuficha mifano ya [CryptoConfidentialKey](https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey) ambayo imehifadhiwa katika `$JENKINS_HOME/secrets/` na jina la faili linalolingana na kitambulisho chake cha `CryptoConfidentialKey`. Vitambulisho vya funguo vya kawaida ni pamoja na:

* `hudson.util.Secret`: hutumiwa kwa siri za kawaida;
* `com.cloudbees.plugins.credentials.SecretBytes.KEY`: hutumiwa kwa aina fulani za vyeti;
* `jenkins.model.Jenkins.crumbSalt`: hutumiwa na [muhimu wa ulinzi wa CSRF](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery); na
### Upatikanaji wa Vyeti

Vyeti vinaweza kuwa **vimeelekezwa kwa watoa huduma wa ulimwengu** (`/credentials/`) ambao wanaweza kufikiwa na mradi wowote ulioconfigurewa, au vinaweza kuwa **vimeelekezwa kwa miradi maalum** (`/job/<jina-la-mradi>/configure`) na hivyo basi vinapatikana tu kutoka kwenye mradi maalum.

Kulingana na [**nyaraka**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/): Vyeti ambavyo viko kwenye eneo la tazama vinapatikana kwa mabomba bila kizuizi. Ili **kuzuia kufichuliwa kwa bahati mbaya kwenye kumbukumbu ya ujenzi**, vyeti vinatolewa **kwa kuficha** kutoka kwa matokeo ya kawaida, hivyo wito wa `env` (Linux) au `set` (Windows), au programu zinazochapisha mazingira yao au vigezo havitafunua vyeti hivyo kwenye kumbukumbu ya ujenzi kwa watumiaji ambao vinginevyo wasingekuwa na ufikivu wa vyeti hivyo.

**Ndiyo maana ili kuchukua vyeti kwa siri, mshambuliaji anahitaji, kwa mfano, kuyabadilisha kuwa base64.**

## Marejeo

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
