# Informa√ß√µes b√°sicas do Jenkins

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou se deseja acessar a **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no Github.

</details>

## Acesso

### Nome de usu√°rio + senha

A forma mais comum de fazer login no Jenkins √© com um nome de usu√°rio ou uma senha.

### Cookie

Se um **cookie autorizado for roubado**, ele pode ser usado para acessar a sess√£o do usu√°rio. O cookie geralmente √© chamado de `JSESSIONID.*`. (Um usu√°rio pode encerrar todas as suas sess√µes, mas precisaria descobrir primeiro que um cookie foi roubado).

### SSO/Plugins

O Jenkins pode ser configurado usando plugins para ser **acess√≠vel via SSO de terceiros**.

### Tokens

**Os usu√°rios podem gerar tokens** para dar acesso a aplicativos para se passarem por eles via CLI ou REST API.

### Chaves SSH

Este componente fornece um servidor SSH integrado para o Jenkins. √â uma interface alternativa para o [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), e os comandos podem ser invocados desta forma usando qualquer cliente SSH. (Dos [documentos](https://plugins.jenkins.io/sshd/))

## Autoriza√ß√£o

Em `/configureSecurity` √© poss√≠vel **configurar o m√©todo de autoriza√ß√£o do Jenkins**. Existem v√°rias op√ß√µes:

* **Qualquer pessoa pode fazer qualquer coisa**: at√© o acesso an√¥nimo pode administrar o servidor
* **Modo legado**: mesmo que o Jenkins <1.164. Se voc√™ tiver a **fun√ß√£o "admin"**, ter√° **controle total** sobre o sistema, e **caso contr√°rio** (incluindo usu√°rios **an√¥nimos**) ter√° **acesso de leitura**.
* **Usu√°rios logados podem fazer qualquer coisa**: neste modo, **todos os usu√°rios logados t√™m controle total** do Jenkins. O √∫nico usu√°rio que n√£o ter√° controle total √© o **usu√°rio an√¥nimo**, que s√≥ ter√° **acesso de leitura**.
* **Seguran√ßa baseada em matriz**: voc√™ pode configurar **quem pode fazer o qu√™** em uma tabela. Cada **coluna** representa uma **permiss√£o**. Cada **linha** **representa** um **usu√°rio ou um grupo/papel**. Isso inclui um usu√°rio especial '**an√¥nimo**', que representa **usu√°rios n√£o autenticados**, bem como '**autenticado**', que representa **todos os usu√°rios autenticados**.

![](<../../.gitbook/assets/image (40).png>)

* **Estrat√©gia de autoriza√ß√£o de matriz baseada em projeto:** Este modo √© uma **extens√£o** da "**seguran√ßa baseada em matriz**" que permite definir matrizes ACL adicionais para cada projeto separadamente.
* **Estrat√©gia baseada em fun√ß√£o:** Permite definir autoriza√ß√µes usando uma **estrat√©gia baseada em fun√ß√£o**. Gerencie as fun√ß√µes em `/role-strategy`.

## **Realm de seguran√ßa**

Em `/configureSecurity` √© poss√≠vel **configurar o realm de seguran√ßa**. Por padr√£o, o Jenkins inclui suporte a alguns Realms de seguran√ßa diferentes:

* **Delegar para o cont√™iner servlet**: para **delegar a autentica√ß√£o a um cont√™iner servlet executando o controlador Jenkins**, como o [Jetty](https://www.eclipse.org/jetty/).
* **Banco de dados de usu√°rio pr√≥prio do Jenkins:** Use o **pr√≥prio armazenamento de dados de usu√°rio integrado do Jenkins** para autentica√ß√£o em vez de delegar para um sistema externo. Isso √© habilitado por padr√£o.
* **LDAP**: Delega toda a autentica√ß√£o para um servidor LDAP configurado, incluindo usu√°rios e grupos.
* **Banco de dados de usu√°rio/grupo Unix**: **Delega a autentica√ß√£o para o Unix subjacente** banco de dados de usu√°rio em n√≠vel de sistema operacional no controlador Jenkins. Este modo tamb√©m permitir√° a reutiliza√ß√£o de grupos Unix para autoriza√ß√£o.

Os plugins podem fornecer realms de seguran√ßa adicionais que podem ser √∫teis para incorporar o Jenkins em sistemas de identidade existentes, como:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub Authentication](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## N√≥s, agentes e executores do Jenkins

**N√≥s** s√£o as **m√°quinas** em que os **agentes de compila√ß√£o s√£o executados**. O Jenkins monitora cada n√≥ anexado para espa√ßo em disco, espa√ßo tempor√°rio livre, swap livre, tempo/sincroniza√ß√£o do rel√≥gio e tempo de resposta. Um n√≥ √© retirado do ar se algum desses valores sair do limite configurado.

**Agentes** **gerenciam** a **execu√ß√£o de tarefas** em nome do controlador Jenkins usando executores. Um agente pode usar qualquer sistema operacional que suporte Java. As ferramentas necess√°rias para compila√ß√µes e testes s√£o instaladas no n√≥ em que o agente √© executado; elas podem **ser instaladas diretamente ou em um cont√™iner** (Docker ou Kubernetes). Cada **agente √© efetivamente um processo com seu pr√≥prio PID** na m√°quina host.

Um **executor** √© um **slot para a execu√ß√£o de tarefas**; efetivamente, √© **uma thread no agente**. O **n√∫mero de executores** em um n√≥ define o n√∫mero de **tarefas simult√¢neas** que podem ser executadas nesse n√≥ ao mesmo tempo. Em outras palavras, isso determina o **n√∫mero de `stages` do Pipeline que podem ser executados simultaneamente** nesse n√≥.

## Segredos do Jenkins

### Criptografia de segredos e credenciais

O Jenkins usa **AES para criptografar e proteger segredos**, credenciais e suas respectivas chaves de criptografia. Essas chaves de criptografia s√£o armazenadas em `$JENKINS_HOME/secrets/` juntamente com a chave mestra usada para proteger essas chaves. Este diret√≥rio deve ser configurado para que apenas o usu√°rio do sistema operacional em que o controlador Jenkins est√° sendo executado tenha acesso de leitura e grava√ß√£o a este diret√≥rio (ou seja, um