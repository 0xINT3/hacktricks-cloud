# Informazioni di base su Jenkins

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di github.

</details>

## Accesso

### Nome utente + Password

Il modo pi√π comune per accedere a Jenkins √® utilizzare un nome utente o una password.

### Cookie

Se un **cookie autorizzato viene rubato**, pu√≤ essere utilizzato per accedere alla sessione dell'utente. Il cookie di solito si chiama `JSESSIONID.*`. (Un utente pu√≤ terminare tutte le sue sessioni, ma prima deve scoprire che un cookie √® stato rubato).

### SSO/Plugin

Jenkins pu√≤ essere configurato utilizzando plugin per essere **accessibile tramite SSO di terze parti**.

### Token

**Gli utenti possono generare token** per concedere l'accesso alle applicazioni per impersonarli tramite CLI o REST API.

### Chiavi SSH

Questo componente fornisce un server SSH integrato per Jenkins. √à un'interfaccia alternativa per la [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), e i comandi possono essere invocati in questo modo utilizzando qualsiasi client SSH. (Dalla [documentazione](https://plugins.jenkins.io/sshd/))

## Autorizzazione

In `/configureSecurity` √® possibile **configurare il metodo di autorizzazione di Jenkins**. Ci sono diverse opzioni:

* **Chiunque pu√≤ fare qualsiasi cosa**: Anche l'accesso anonimo pu√≤ amministrare il server.
* **Modalit√† legacy**: Come Jenkins <1.164. Se hai il ruolo di **"admin"**, avrai **controllo completo** sul sistema, altrimenti (inclusi gli utenti **anonimi**) avrai solo accesso in **lettura**.
* **Gli utenti con accesso possono fare qualsiasi cosa**: In questa modalit√†, ogni utente con accesso ha il **controllo completo** di Jenkins. L'unico utente che non ha il controllo completo √® l'utente **anonimo**, che ha solo accesso in **lettura**.
* **Sicurezza basata su matrice**: √à possibile configurare **chi pu√≤ fare cosa** in una tabella. Ogni **colonna** rappresenta un **permesso**. Ogni **riga** rappresenta un **utente o un gruppo/ruolo**. Questo include un utente speciale '**anonymous**', che rappresenta gli utenti **non autenticati**, cos√¨ come '**authenticated**', che rappresenta **tutti gli utenti autenticati**.

![](<../../.gitbook/assets/image (40).png>)

* **Strategia di autorizzazione basata su progetto**: Questa modalit√† √® un'estensione della "**Sicurezza basata su matrice**" che consente di **definire una matrice ACL aggiuntiva per ogni progetto separatamente**.
* **Strategia basata su ruoli**: Consente di definire autorizzazioni utilizzando una **strategia basata su ruoli**. Gestisci i ruoli in `/role-strategy`.

## **Realm di sicurezza**

In `/configureSecurity` √® possibile **configurare il realm di sicurezza**. Per impostazione predefinita, Jenkins include il supporto per alcuni realm di sicurezza diversi:

* **Delega al container servlet**: Per **delegare l'autenticazione a un container servlet in esecuzione sul controller Jenkins**, come [Jetty](https://www.eclipse.org/jetty/).
* **Database utenti di Jenkins**: Utilizza il **proprio datastore utenti integrato di Jenkins** per l'autenticazione anzich√© delegare a un sistema esterno. Questo √® abilitato per impostazione predefinita.
* **LDAP**: Delega l'autenticazione a un server LDAP configurato, inclusi utenti e gruppi.
* **Database utenti/gruppi Unix**: Delega l'autenticazione al database utenti di livello Unix sottostante sul controller Jenkins. Questa modalit√† consente anche il riutilizzo dei gruppi Unix per l'autorizzazione.

I plugin possono fornire realm di sicurezza aggiuntivi che possono essere utili per incorporare Jenkins in sistemi di identit√† esistenti, come:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [Autenticazione GitHub](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Nodi, Agenti ed Esecutori di Jenkins

Definizioni dalla [documentazione](https://www.jenkins.io/doc/book/managing/nodes/):

**Nodi** sono le **macchine** su cui vengono eseguiti gli **agenti di build**. Jenkins monitora ogni nodo collegato per lo spazio su disco, lo spazio temporaneo libero, lo swap libero, l'ora del clock/sincronizzazione e il tempo di risposta. Un nodo viene messo offline se uno di questi valori supera la soglia configurata.

Gli **agenti** **gestiscono** l'**esecuzione dei task** per conto del controller Jenkins utilizzando gli esecutori. Un agente pu√≤ utilizzare qualsiasi sistema operativo che supporta Java. Gli strumenti necessari per le build e i test vengono installati sul nodo in cui viene eseguito l'agente; possono **essere installati direttamente o in un container** (Docker o Kubernetes). Ogni **agente √® effettivamente un processo con il proprio PID** sulla macchina host.

Un **esecutore** √® uno **slot per l'esecuzione dei task**; in pratica, √® **un thread nell'agente**. Il **numero di esecutori** su un nodo definisce il numero di **task simultanei** che possono essere eseguiti su quel nodo contemporaneamente. In altre parole, questo determina il **numero di `stages` di Pipeline simultanei** che possono essere eseguiti su quel nodo contemporaneamente.

## Segreti di Jenkins

### Crittografia di Segreti e Credenziali

Definizione dalla [documentazione](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials):
Jenkins utilizza **AES per crittografare e proteggere segreti, credenziali e le rispettive chiavi di crittografia**. Queste chiavi di crittografia sono memorizzate in `$JENKINS_HOME/secrets/` insieme alla chiave principale utilizzata per proteggere tali chiavi. Questa directory dovrebbe essere configurata in modo che solo l'utente del sistema operativo su cui viene eseguito il controller Jenkins abbia accesso in lettura e scrittura a questa directory (ad esempio, un valore `chmod` di `0700` o utilizzando attributi di file appropriati). La **chiave principale** (talvolta indicata come "chiave di crittografia delle chiavi" nel gergo crittografico) √® **memorizzata**_**non crittografata**_ sul filesystem del controller Jenkins in **`$JENKINS_HOME/secrets/master.key`** che non protegge da attacchi con accesso diretto a tale file. La maggior parte degli utenti e degli sviluppatori utilizzer√† queste chiavi di crittografia indirettamente tramite l'API [Secret](https://javadoc.jenkins.io/byShortName/Secret) per crittografare dati segreti generici o tramite l'API delle credenziali. Per i curiosi della crittografia, Jenkins utilizza AES in modalit√† di cifratura a catena di blocchi (CBC) con padding PKCS#5 e IV casuali per crittografare istanze di [CryptoConfidentialKey](https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey) che sono memorizzate in `$JENKINS_HOME/secrets/` con un nome file corrispondente al loro id di `CryptoConfidentialKey`. Gli id chiave comuni includono:

* `hudson.util.Secret`: utilizzato per segreti generici;
* `com.cloudbees.plugins.credentials.SecretBytes.KEY`: utilizzato per alcuni tipi di credenziali
### Accesso alle credenziali

Le credenziali possono essere **limitate ai provider globali** (`/credentials/`) che possono essere accessibili da qualsiasi progetto configurato, oppure possono essere limitate a **progetti specifici** (`/job/<nome-progetto>/configure`) e quindi accessibili solo dal progetto specifico.

Secondo [**la documentazione**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/): Le credenziali che sono in scope sono rese disponibili al pipeline senza limitazioni. Per **evitare l'esposizione accidentale nel log di build**, le credenziali sono **mascherate** dall'output regolare, quindi un'invocazione di `env` (Linux) o `set` (Windows), o programmi che stampino il loro ambiente o parametri **non le rivelerebbero nel log di build** agli utenti che non avrebbero altrimenti accesso alle credenziali.

**Ecco perch√© per estrarre le credenziali un attaccante deve, ad esempio, codificarle in base64.**

## Riferimenti

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
