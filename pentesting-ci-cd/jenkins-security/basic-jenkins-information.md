# Grundlegende Jenkins-Informationen

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## Zugriff

### Benutzername + Passwort

Der h√§ufigste Weg, sich bei Jenkins anzumelden, ist mit einem Benutzernamen oder einem Passwort.

### Cookie

Wenn ein **autorisierter Cookie gestohlen wird**, kann er verwendet werden, um auf die Sitzung des Benutzers zuzugreifen. Der Cookie wird normalerweise `JSESSIONID.*` genannt. (Ein Benutzer kann alle seine Sitzungen beenden, m√ºsste jedoch zuerst herausfinden, dass ein Cookie gestohlen wurde).

### SSO/Plugins

Jenkins kann mithilfe von Plugins konfiguriert werden, um √ºber ein Drittanbieter-SSO zug√§nglich zu sein.

### Tokens

**Benutzer k√∂nnen Tokens generieren**, um Anwendungen den Zugriff zu erm√∂glichen, sie √ºber die CLI oder die REST-API zu vertreten.

### SSH-Schl√ºssel

Dieser Bestandteil bietet einen integrierten SSH-Server f√ºr Jenkins. Es ist eine alternative Schnittstelle f√ºr die [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), und Befehle k√∂nnen auf diese Weise unter Verwendung eines beliebigen SSH-Clients aufgerufen werden. (Aus den [Dokumenten](https://plugins.jenkins.io/sshd/))

## Autorisierung

In `/configureSecurity` ist es m√∂glich, die Autorisierungsmethode von Jenkins zu konfigurieren. Es gibt mehrere Optionen:

* **Jeder kann alles tun**: Selbst anonymer Zugriff kann den Server verwalten.
* **Legacy-Modus**: Gleich wie Jenkins <1.164. Wenn Sie die Rolle **"admin"** haben, erhalten Sie **volle Kontrolle** √ºber das System, andernfalls (einschlie√ülich **anonymer** Benutzer) haben Sie nur **Lesezugriff**.
* **Angemeldete Benutzer k√∂nnen alles tun**: In diesem Modus erh√§lt jeder **angemeldete Benutzer die volle Kontrolle** √ºber Jenkins. Der einzige Benutzer, der keine volle Kontrolle hat, ist der **anonyme Benutzer**, der nur **Lesezugriff** erh√§lt.
* **Matrixbasierte Sicherheit**: Sie k√∂nnen in einer Tabelle konfigurieren, **wer was tun kann**. Jede **Spalte** repr√§sentiert eine **Berechtigung**. Jede **Zeile** repr√§sentiert einen **Benutzer oder eine Gruppe/Rolle**. Dies beinhaltet einen speziellen Benutzer '**anonym**', der **nicht authentifizierte Benutzer** repr√§sentiert, sowie '**authentifiziert**', der **alle authentifizierten Benutzer** repr√§sentiert.

![](<../../.gitbook/assets/image (149).png>)

* **Projektbasierte Matrix-Autorisierungsstrategie:** Dieser Modus ist eine **Erweiterung** der "**Matrixbasierten Sicherheit**", die es erm√∂glicht, f√ºr jedes Projekt separat zus√§tzliche ACL-Matrizen zu **definieren**.
* **Rollenbasierte Strategie:** Erm√∂glicht die Definition von Autorisierungen mithilfe einer **rollenbasierten Strategie**. Verwalten Sie die Rollen in `/role-strategy`.

## **Sicherheitsbereich**

In `/configureSecurity` ist es m√∂glich, den Sicherheitsbereich zu konfigurieren. Standardm√§√üig unterst√ºtzt Jenkins verschiedene Sicherheitsbereiche:

* **An Servlet-Container delegieren**: Zur **Delegierung der Authentifizierung an einen Servlet-Container, der den Jenkins-Controller ausf√ºhrt**, wie [Jetty](https://www.eclipse.org/jetty/).
* **Jenkins eigene Benutzerdatenbank**: Verwenden Sie **Jenkins eigene integrierte Benutzerdatenbank** zur Authentifizierung anstelle der Delegierung an ein externes System. Dies ist standardm√§√üig aktiviert.
* **LDAP**: Delegiert die gesamte Authentifizierung an einen konfigurierten LDAP-Server, einschlie√ülich Benutzern und Gruppen.
* **Unix-Benutzer-/Gruppendatenbank**: **Delegiert die Authentifizierung an die zugrunde liegende Unix**-Betriebssystemebene Benutzerdatenbank auf dem Jenkins-Controller. Dieser Modus erm√∂glicht auch die Wiederverwendung von Unix-Gruppen f√ºr die Autorisierung.

Plugins k√∂nnen zus√§tzliche Sicherheitsbereiche bereitstellen, die n√ºtzlich sein k√∂nnen, um Jenkins in bestehende Identit√§tssysteme zu integrieren, wie z.B.:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub-Authentifizierung](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Jenkins-Nodes, Agenten & Ausf√ºhrer

Definitionen aus den [Dokumenten](https://www.jenkins.io/doc/book/managing/nodes/):

**Nodes** sind die **Maschinen**, auf denen Build-**Agenten ausgef√ºhrt** werden. Jenkins √ºberwacht jeden angeschlossenen Node auf Festplattenspeicher, freien tempor√§ren Speicher, freien Swap, Uhrzeit/-synchronisation und Antwortzeit. Ein Node wird offline genommen, wenn einer dieser Werte au√üerhalb des konfigurierten Schwellenwerts liegt.

**Agenten** **verwalten** die **Aufgabenausf√ºhrung** im Auftrag des Jenkins-Controllers durch **Verwendung von Ausf√ºhrern**. Ein Agent kann jedes Betriebssystem verwenden, das Java unterst√ºtzt. Tools, die f√ºr Builds und Tests erforderlich sind, werden auf dem Node installiert, auf dem der Agent l√§uft; sie k√∂nnen **direkt oder in einem Container** (Docker oder Kubernetes) installiert werden. Jeder **Agent ist effektiv ein Prozess mit seiner eigenen PID** auf dem Hostrechner.

Ein **Ausf√ºhrer** ist ein **Slot zur Ausf√ºhrung von Aufgaben**; effektiv ist es **ein Thread im Agenten**. Die **Anzahl der Ausf√ºhrer** auf einem Node definiert die Anzahl der **gleichzeitigen Aufgaben**, die auf diesem Node gleichzeitig ausgef√ºhrt werden k√∂nnen. Mit anderen Worten bestimmt dies die **Anzahl der gleichzeitigen Pipeline-`Stages`**, die auf diesem Node gleichzeitig ausgef√ºhrt werden k√∂nnen.

## Jenkins-Geheimnisse

### Verschl√ºsselung von Geheimnissen und Anmeldeinformationen

Definition aus den [Dokumenten](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials): Jenkins verwendet **AES zur Verschl√ºsselung und zum Schutz von Geheimnissen**, Anmeldeinformationen und den entsprechenden Verschl√ºsselungsschl√ºsseln. Diese Verschl√ºsselungsschl√ºssel werden in `$JENKINS_HOME/secrets/` zusammen mit dem Master-Key, der zum Schutz dieser Schl√ºssel verwendet wird, gespeichert. Dieses Verzeichnis sollte so konfiguriert sein, dass nur der Betriebssystembenutzer, unter dem der Jenkins-Controller ausgef√ºhrt wird, Lese- und Schreibzugriff auf dieses Verzeichnis hat (d.h. ein `chmod`-Wert von `0700` oder die Verwendung geeigneter Dateiattribute). Der **Master-Key** (manchmal auch als "Schl√ºsselverschl√ºsselungsschl√ºssel" in der Kryptojargon bezeichnet) wird **unverschl√ºsselt** auf dem Dateisystem des Jenkins-Controllers in **`$JENKINS_HOME/secrets/master.key`** gespeichert, was nicht vor Angreifern sch√ºtzt, die direkten Zugriff auf diese Datei haben. Die meisten Benutzer und Entwickler werden diese Verschl√ºsselungsschl√ºssel indirekt √ºber die [Secret](https://javadoc.jenkins.io/byShortName/Secret)-API zur Verschl√ºsselung generischer Geheimdaten oder √ºber die Anmeldeinformations-API verwenden. F√ºr die Kryptobegeisterten verwendet Jenkins AES im Cipher Block Chaining (CBC)-Modus mit PKCS#5-Padding und zuf√§lligen IVs zur Verschl√ºsselung von Instanzen von [CryptoConfidentialKey](https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey), die in `$JENKINS_HOME/secrets/` mit einem Dateinamen entsprechend ihrer `CryptoConfidentialKey`-ID gespeichert sind. H√§ufige Schl√ºssel-IDs sind:

* `hudson.util.Secret`: verwendet f√ºr generische Geheimnisse;
* `com.cloudbees.plugins.credentials.SecretBytes.KEY`: verwendet f√ºr einige Arten von Anmeldeinformationen;
* `jenkins.model.Jenkins.crumbSalt`: verwendet vom [CSRF-Schutzmechanismus](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery); und
### Zugriff auf Anmeldedaten

Anmeldeinformationen k√∂nnen auf **globale Anbieter** (`/credentials/`) beschr√§nkt sein, die von jedem konfigurierten Projekt zugegriffen werden k√∂nnen, oder auf **spezifische Projekte** (`/job/<project-name>/configure`) beschr√§nkt sein und daher nur aus dem spezifischen Projekt zug√§nglich sein.

Laut [**der Dokumentation**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/): Anmeldeinformationen, die im Scope sind, werden ohne Einschr√§nkung im Pipeline verf√ºgbar gemacht. Um **versehentliche Offenlegung im Build-Protokoll zu verhindern**, werden Anmeldeinformationen aus der regul√§ren Ausgabe **maskiert**, sodass ein Aufruf von `env` (Linux) oder `set` (Windows) oder Programme, die ihre Umgebung oder Parameter ausgeben, sie nicht im Build-Protokoll offenbaren w√ºrden, f√ºr Benutzer, die anderweitig keinen Zugriff auf die Anmeldeinformationen haben.

**Deshalb muss ein Angreifer beispielsweise die Anmeldeinformationen base64-codieren, um sie abzusch√∂pfen.**

## Referenzen

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks in PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
