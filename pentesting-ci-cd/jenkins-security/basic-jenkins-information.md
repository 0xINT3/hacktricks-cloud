# 基本的なJenkins情報

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もし **HackTricksであなたの会社を宣伝したい** または **PEASSの最新バージョンにアクセスしたい** または **HackTricksをPDFでダウンロードしたい** 場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式PEASS＆HackTricksのグッズ**](https://peass.creator-spring.com) を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を見つけましょう。これは私たちの独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションです
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)** または **[telegramグループ](https://t.me/peass)** に参加するか、 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) を **フォロー** してください。
* **HackTricks** と **HackTricks Cloud** の github レポジトリに **PRを提出** して、あなたのハッキングテクニックを共有しましょう。

</details>

## アクセス

### ユーザー名 + パスワード

Jenkinsにログインする最も一般的な方法は、ユーザー名またはパスワードを使用することです。

### Cookie

**認証済みのCookieが盗まれた**場合、それを使用してユーザーのセッションにアクセスすることができます。Cookieは通常、`JSESSIONID.*`と呼ばれます。（ユーザーはすべてのセッションを終了することができますが、最初にCookieが盗まれたことを見つける必要があります）。

### SSO/プラグイン

Jenkinsは、サードパーティSSOを介してアクセス可能にするためにプラグインを使用して構成することができます。

### トークン

**ユーザーはトークンを生成**して、CLIやREST APIを介して自分を模倣するためのアプリケーションにアクセスを許可することができます。

### SSHキー

このコンポーネントはJenkinsのための組み込みSSHサーバーを提供します。これは[Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/)の代替インターフェースであり、SSHクライアントを使用してこの方法でコマンドを呼び出すことができます。（[ドキュメント](https://plugins.jenkins.io/sshd/)から）

## 認可

`/configureSecurity`でJenkinsの認可方法を設定することができます。いくつかのオプションがあります：

* **誰でも何でもできる**：匿名アクセスでもサーバーを管理できます。
* **レガシーモード**：Jenkins <1.164と同じです。**"admin"の役割**がある場合、システム全体を**完全に制御**できます。それ以外の場合（**匿名**ユーザーを含む）、**読み取り**アクセスしかありません。
* **ログインユーザーは何でもできる**：このモードでは、**ログインユーザーはJenkinsを完全に制御**できます。唯一の例外は**匿名ユーザー**で、**読み取り**アクセスのみがあります。
* **マトリックスベースのセキュリティ**：テーブルで**誰が何を行えるか**を設定できます。各**列**は**権限**を表します。各**行**は**ユーザーまたはグループ/役割**を表します。これには、**未認証のユーザー**を表す特別なユーザー '**anonymous**' と、**すべての認証済みユーザー**を表す '**authenticated**' が含まれます。

![](<../../.gitbook/assets/image (40).png>)

* **プロジェクトベースのマトリックス認可戦略**：このモードは、各プロジェクトごとに追加のACLマトリックスを**定義**するための "**マトリックスベースのセキュリティ**" の**拡張**です。
* **ロールベースの戦略**：**ロールベースの戦略**を使用して認可を定義できます。`/role-strategy`で役割を管理します。

## **セキュリティレルム**

`/configureSecurity`でセキュリティレルムを設定することができます。デフォルトでは、Jenkinsにはいくつかの異なるセキュリティレルムのサポートが含まれています：

* **サーブレットコンテナへの委任**：Jenkinsコントローラーを実行しているサーブレットコンテナ（[Jetty](https://www.eclipse.org/jetty/)など）に認証を委任するためのものです。
* **Jenkins独自のユーザーデータベース**：外部システムへの委任ではなく、認証のためにJenkins独自の組み込みユーザーデータストアを使用します。これはデフォルトで有効になっています。
* **LDAP**：ユーザーとグループの両方を含む、設定されたLDAPサーバーに認証を委任します。
* **Unixユーザー/グループデータベース**：Jenkinsコントローラー上の基礎となるUnix OSレベルのユーザーデータベースに認証を委任します。このモードでは、認可のためにUnixグループを再利用することも可能です。

プラグインは、Jenkinsを既存のアイデンティティシステムに組み込むために役立つ追加のセキュリティレルムを提供する場合があります。例えば：

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub Authentication](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Jenkinsノード、エージェント、および実行者

**ノード**は、ビルド**エージェントが実行されるマシン**です。 Jenkinsは、各接続されたノードのディスクスペース、空きの一時スペース、空きスワップ、クロックの時間/同期、および応答時間を監視します。これらの値のいずれかが設定された閾値を超えると、ノードはオフラインになります。

**エージェント**は、Jenkinsコントローラーの代わりにタスクの実行を**管理**します。エージェントはJavaをサポートする任意のオペレーティングシステムを使用できます。ビルドとテストに必要なツールは、エージェントが実行されるノードにインストールされます。これらのツールは、直接またはコンテナ（DockerまたはKubernetes）に**インストール**できます。各**エージェントは、ホストマシン上の独自のPIDを持つプロセス**です。

**実行者**は、タスクの実行のための**スロット**です。実際には、これはエージェント内の**スレッド**です。ノード上の実行者の数は、そのノードで同時に実行できる**並行タスク**の数を定義します。言い換えると、これはそのノードで同時に実行できる**並行パ
### 認証情報のアクセス

認証情報は、グローバルプロバイダ（`/credentials/`）にスコープを設定することができ、設定された任意のプロジェクトからアクセスすることができます。また、特定のプロジェクト（`/job/<project-name>/configure`）にスコープを設定することもでき、その場合は特定のプロジェクトからのみアクセスできます。

[**ドキュメント**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)によると、スコープ内の認証情報は制限なくパイプラインで利用できます。ビルドログでの誤った公開を防ぐため、認証情報は通常の出力から**マスク**されます。したがって、`env`（Linux）や`set`（Windows）の呼び出し、または環境やパラメータを表示するプログラムは、認証情報にアクセス権限を持たないユーザーにはビルドログでそれらを表示しません。

**そのため、攻撃者が認証情報を漏洩させるためには、例えばそれらをBase64でエンコードする必要があります。**

## 参考文献

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もしもあなたの**会社をHackTricksで宣伝したい**場合や、**最新版のPEASSやHackTricksのPDFをダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式のPEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを楽しみましょう。
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローしてください🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **HackTricks**と**HackTricks Cloud**のGitHubリポジトリにPRを提出して、あなたのハッキングテクニックを共有しましょう。

</details>
