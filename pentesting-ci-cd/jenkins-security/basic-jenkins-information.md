# Podstawowe informacje o Jenkinsie

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Dostęp

### Nazwa użytkownika + Hasło

Najczęstszy sposób logowania do Jenkinsa to za pomocą nazwy użytkownika i hasła.

### Cookie

Jeśli **ukradziono uprawnione cookie**, można je wykorzystać do uzyskania dostępu do sesji użytkownika. Cookie zwykle nazywane jest `JSESSIONID.*`. (Użytkownik może zakończyć wszystkie swoje sesje, ale musiałby najpierw dowiedzieć się, że cookie zostało skradzione).

### SSO/Wtyczki

Jenkins można skonfigurować za pomocą wtyczek, aby był **dostępny za pośrednictwem zewnętrznego SSO**.

### Tokeny

**Użytkownicy mogą generować tokeny**, aby umożliwić aplikacjom udawanie ich za pomocą interfejsu CLI lub REST API.

### Klucze SSH

Ten komponent dostarcza wbudowany serwer SSH dla Jenkinsa. Jest to alternatywny interfejs dla [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), a polecenia można wywoływać w ten sposób za pomocą dowolnego klienta SSH. (Z dokumentacji (https://plugins.jenkins.io/sshd/))

## Autoryzacja

W `/configureSecurity` można **skonfigurować metodę autoryzacji Jenkinsa**. Istnieje kilka opcji:

* **Każdy może wszystko**: Nawet anonimowy dostęp może zarządzać serwerem.
* **Tryb dziedzictwa**: To samo co w Jenkinsie <1.164. Jeśli masz rolę **"admin"**, otrzymasz **pełną kontrolę** nad systemem, a w przeciwnym razie (w tym użytkownicy **anonimowi**) otrzymasz dostęp tylko do odczytu.
* **Zalogowani użytkownicy mogą wszystko**: W tym trybie każdy **zalogowany użytkownik ma pełną kontrolę** nad Jenkins. Jedynym użytkownikiem, który nie ma pełnej kontroli, jest użytkownik **anonimowy**, który ma tylko dostęp do odczytu.
* **Matrix-based security**: Można skonfigurować, **kto może co robić** w tabeli. Każda **kolumna** reprezentuje **uprawnienie**. Każdy **wiersz** reprezentuje **użytkownika lub grupę/rolę**. Obejmuje to specjalnego użytkownika '**anonymous**', który reprezentuje **nieuwierzytelnionych użytkowników**, oraz '**authenticated**', który reprezentuje **wszystkich uwierzytelnionych użytkowników**.

![](<../../.gitbook/assets/image (40).png>)

* **Project-based Matrix Authorization Strategy:** Ten tryb jest **rozszerzeniem** dla "**Matrix-based security**", które pozwala na zdefiniowanie dodatkowej macierzy ACL dla każdego projektu osobno.
* **Role-Based Strategy:** Umożliwia definiowanie autoryzacji za pomocą **strategii opartej na rolach**. Zarządzaj rolami w `/role-strategy`.

## **Realm zabezpieczeń**

W `/configureSecurity` można **skonfigurować realm zabezpieczeń**. Domyślnie Jenkins zawiera obsługę kilku różnych realmów zabezpieczeń:

* **Delegowanie do kontenera serwletów**: Do **delegowania uwierzytelniania do kontenera serwletów uruchamiającego kontroler Jenkinsa**, takiego jak [Jetty](https://www.eclipse.org/jetty/).
* **Własna baza danych użytkowników Jenkinsa:** Użyj **wbudowanej w Jenkinsa bazy danych użytkowników** do uwierzytelniania zamiast delegowania do zewnętrznego systemu. Jest to domyślnie włączone.
* **LDAP**: Deleguj całe uwierzytelnianie do skonfigurowanego serwera LDAP, obejmującego zarówno użytkowników, jak i grupy.
* **Baza danych użytkowników/grup Unix**: Deleguje uwierzytelnianie do baz danych użytkowników na poziomie systemu operacyjnego Unix na kontrolerze Jenkinsa. Ten tryb umożliwia również ponowne wykorzystanie grup Unix do autoryzacji.

Wtyczki mogą dostarczać dodatkowe realm zabezpieczeń, które mogą być przydatne do włączenia Jenkinsa do istniejących systemów tożsamości, takich jak:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub Authentication](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Węzły, Agenci i Wykonawcy Jenkinsa

Definicje z [dokumentacji](https://www.jenkins.io/doc/book/managing/nodes/):

**Węzły** to **maszyny**, na których uruchamiane są **agenty budowy**. Jenkins monitoruje każdy podłączony węzeł pod kątem miejsca na dysku, wolnego miejsca tymczasowego, wolnej przestrzeni wymiany, czasu/zgodności zegara i czasu odpowiedzi. Węzeł jest wyłączany, jeśli któreś z tych wartości wykracza poza skonfigurowany próg.

**Agenci** **zarządzają** wykonaniem zadań w imieniu kontrolera Jenkinsa, **korzystając z wykonawców**. Agent może korzystać z dowolnego systemu operacyjnego obsługującego Javę. Narzędzia wymagane do budowy i testów są instalowane na węźle, na którym działa agent; mogą być **instalowane bezpośrednio lub w kontenerze** (Docker lub Kubernetes). Każdy **agent jest efektywnie procesem z własnym PID** na maszynie hosta.

Wykonawca to **slot do wykonywania zadań**; efektywnie jest to **wątek w agencie**. Liczba wykonawców na węźle określa liczbę **równoczesnych zadań**, które można wykonać na tym węźle w jednym czasie. Innymi słowy, to określa **liczbę równoczesnych etapów Pipeline**, które można wykonać na tym węźle w jednym czasie.

## Tajemnice Jenkinsa

### Szyfrowanie tajemnic i poświadczeń

Definicja z [dokumentacji](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials):
Jenkins używa **AES do szyfrowania i ochrony tajemnic**, poświadczeń i ich odpowiednich kluczy szyfrowania. Te klucze szyfrowania są przechowywane w `$JENKINS_HOME/secrets/` wraz z kluczem głównym używanym do ochrony tych kluczy. Ten katalog powinien być skonfigurowany tak, aby tylko użytkownik systemu operacyjnego, na którym działa kontroler Jenkinsa, miał dostęp do odczytu i zapisu do tego katalogu (tj. wartość `chmod` równa `0700` lub odpowiednie atrybuty pliku). **Klucz główny** (czasami nazywany "kluczem szyfrowania kluc
### Dostęp do poświadczeń

Poświadczenia mogą być **ograniczone do globalnych dostawców** (`/credentials/`), które mogą być dostępne dla dowolnie skonfigurowanego projektu, lub mogą być ograniczone do **konkretnych projektów** (`/job/<nazwa-projektu>/configure`) i w związku z tym dostępne tylko z tego konkretnego projektu.

Zgodnie z [**dokumentacją**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/): Poświadczenia, które są w zakresie, są udostępniane w potoku bez ograniczeń. Aby **zapobiec przypadkowemu ujawnieniu w dzienniku budowy**, poświadczenia są **zamazywane** w zwykłym wyjściu, więc wywołanie `env` (Linux) lub `set` (Windows), lub programy drukujące swoje środowisko lub parametry **nie ujawnią ich w dzienniku budowy** dla użytkowników, którzy nie mają w przeciwnym razie dostępu do poświadczeń.

**Dlatego też, aby wydobyć poświadczenia, atakujący musi np. zakodować je w base64.**

## Odwołania

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi trikami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
