# Kubernetes命名空间升级

<details>

<summary><strong>支持HackTricks并获得福利！</strong></summary>

* 如果您想在HackTricks中看到您的公司广告，或者如果您想访问PEASS的最新版本或下载PDF格式的HackTricks，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) **和** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github仓库提交PR来分享您的黑客技巧。**

</details>

在Kubernetes中，通常情况下，您可以通过窃取某些用户凭据或者入侵一个Pod的方式，**成功进入一个命名空间**。然而，通常您会希望**升级到另一个命名空间，因为那里可能有更有趣的内容**。

以下是一些尝试逃离到其他命名空间的技术：

### 滥用K8s权限

显然，如果您窃取的帐户在您要升级的命名空间中具有敏感权限，您可以滥用一些操作，例如在该命名空间中使用服务帐户**创建Pods**，在已存在的Pod中**执行**一个shell，或者读取**秘密**服务帐户令牌。

有关可以滥用的权限的更多信息，请阅读：

{% content-ref url="abusing-roles-clusterroles-in-kubernetes/" %}
[abusing-roles-clusterroles-in-kubernetes](abusing-roles-clusterroles-in-kubernetes/)
{% endcontent-ref %}

### 逃离到节点

如果您可以逃离到节点，无论是因为您已经入侵了一个Pod并且可以逃离，还是因为您可以创建一个特权Pod并逃离，您可以执行以下几个操作来窃取其他服务帐户令牌：

* 检查节点上运行的其他Docker容器中是否**挂载了SAs令牌**
* 检查节点上是否有新的**kubeconfig文件，并赋予节点额外权限**
* 如果已启用（或自行启用），尝试**创建其他命名空间的镜像Pods**，因为您可能会获得对这些命名空间默认令牌帐户的访问权限（我尚未测试过此方法）

所有这些技术都在以下文档中有详细说明：

{% content-ref url="attacking-kubernetes-from-inside-a-pod.md" %}
[attacking-kubernetes-from-inside-a-pod.md](attacking-kubernetes-from-inside-a-pod.md)
{% endcontent-ref %}

<details>

<summary><strong>支持HackTricks并获得福利！</strong></summary>

* 如果您想在HackTricks中看到您的公司广告，或者如果您想访问PEASS的最新版本或下载PDF格式的HackTricks，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) **和** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github仓库提交PR来分享您的黑客技巧。**

</details>
