# AWS - CloudFrontのポストエクスプロイテーション

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* **会社をHackTricksで宣伝したい**場合や、**最新バージョンのPEASSを入手したい**場合、またはHackTricksをPDFでダウンロードしたい場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をご確認ください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを発見する
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローする 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)
* **ハッキングのトリックを共有するには、**[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>

## CloudFront

詳細については、次を参照してください：

{% content-ref url="../aws-services/aws-cloudfront-enum.md" %}
[aws-cloudfront-enum.md](../aws-services/aws-cloudfront-enum.md)
{% endcontent-ref %}

### Man-in-the-Middle

この[**ブログポスト**](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c)では、**Lambda**を使用して（または既に使用されている場合は変更して）**CloudFrontを介した通信**に追加することで、ユーザー情報（セッション**クッキー**など）を**盗み出し**、**レスポンス**に**悪意のあるJSスクリプトを注入**する目的で、いくつかの異なるシナリオが提案されています。

#### シナリオ1：CloudFrontがバケットのHTMLにアクセスするように構成されているMitM

* 悪意のある**関数**を**作成**します。
* CloudFrontディストリビューションにそれを**関連付け**ます。
* **イベントタイプを「Viewer Response」**に設定します。

レスポンスにアクセスすることで、ユーザーのクッキーを盗み出し、悪意のあるJSを注入することができます。

#### シナリオ2：CloudFrontが既にラムダ関数を使用しているMitM

* ラムダ関数の**コードを変更**して、機密情報を盗み出します。

このシナリオを再現するための[**tfコードはこちら**](https://github.com/adanalvarez/AWS-Attack-Scenarios/tree/main)を確認できます。

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* **会社をHackTricksで宣伝したい**場合や、**最新バージョンのPEASSを入手したい**場合、またはHackTricksをPDFでダウンロードしたい場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をご確認ください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを発見する
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローする 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)

* **ハッキングのトリックを共有するには、**[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>
