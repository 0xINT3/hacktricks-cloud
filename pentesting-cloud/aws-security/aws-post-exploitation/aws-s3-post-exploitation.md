# AWS - Exploitation Post-S3

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## S3

Pour plus d'informations, consultez :

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### Informations Sensibles

Parfois, vous pourrez trouver des informations sensibles lisibles dans les buckets. Par exemple, des secrets d'√©tat terraform.

### Pivotage

Diff√©rentes plateformes pourraient utiliser S3 pour stocker des actifs sensibles.\
Par exemple, **airflow** pourrait stocker du **code DAGs** l√†-bas, ou des **pages web** pourraient √™tre directement servies depuis S3. Un attaquant avec des autorisations d'√©criture pourrait **modifier le code** du bucket pour **pivoter** vers d'autres plateformes, ou **prendre le contr√¥le de comptes** en modifiant des fichiers JS.

### Ran√ßongiciel S3

Dans ce sc√©nario, l'**attaquant cr√©e une cl√© KMS (Key Management Service) dans son propre compte AWS** ou un autre compte compromis. Il rend ensuite cette **cl√© accessible √† tout le monde dans le monde**, permettant √† tout utilisateur, r√¥le ou compte AWS de chiffrer des objets en utilisant cette cl√©. Cependant, les objets ne peuvent pas √™tre d√©chiffr√©s.

L'attaquant identifie un **bucket S3 cible et obtient un acc√®s de niveau √©criture** en utilisant diverses m√©thodes. Cela pourrait √™tre d√ª √† une mauvaise configuration du bucket qui l'expose publiquement ou √† l'attaquant qui obtient l'acc√®s √† l'environnement AWS lui-m√™me. L'attaquant cible g√©n√©ralement des buckets contenant des informations sensibles telles que des informations personnellement identifiables (PII), des informations de sant√© prot√©g√©es (PHI), des journaux, des sauvegardes, et plus encore.

Pour d√©terminer si le bucket peut √™tre cibl√© par un ran√ßongiciel, l'attaquant v√©rifie sa configuration. Cela inclut la v√©rification si la **Version d'Objet S3** est activ√©e et si la **suppression multi-facteurs (MFA delete) est activ√©e**. Si la Version d'Objet n'est pas activ√©e, l'attaquant peut proc√©der. Si la Version d'Objet est activ√©e mais que MFA delete est d√©sactiv√©, l'attaquant peut **d√©sactiver la Version d'Objet**. Si la Version d'Objet et MFA delete sont activ√©s, il devient plus difficile pour l'attaquant de ran√ßonner ce bucket sp√©cifique.

En utilisant l'API AWS, l'attaquant **remplace chaque objet dans le bucket par une copie chiffr√©e en utilisant sa cl√© KMS**. Cela chiffre efficacement les donn√©es dans le bucket, les rendant inaccessibles sans la cl√©.

Pour ajouter une pression suppl√©mentaire, l'attaquant planifie la suppression de la cl√© KMS utilis√©e dans l'attaque. Cela donne √† la cible une fen√™tre de 7 jours pour r√©cup√©rer ses donn√©es avant que la cl√© ne soit supprim√©e et que les donn√©es soient d√©finitivement perdues.

Enfin, l'attaquant pourrait t√©l√©charger un fichier final, g√©n√©ralement nomm√© "ransom-note.txt", qui contient des instructions pour la cible sur la fa√ßon de r√©cup√©rer ses fichiers. Ce fichier est t√©l√©charg√© sans cryptage, probablement pour attirer l'attention de la cible et la rendre consciente de l'attaque de ran√ßongiciel.

**Pour plus d'informations** [**consultez la recherche originale**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
