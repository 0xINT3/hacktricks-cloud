# AWS - S3 Post Esploitation

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** repository [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>

## S3

Per ulteriori informazioni controlla:

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### Informazioni Sensibili

A volte sar√† possibile trovare informazioni sensibili leggibili nei bucket. Ad esempio, segreti di stato di terraform.

### Pivoting

Diverse piattaforme potrebbero utilizzare S3 per archiviare risorse sensibili.\
Ad esempio, **airflow** potrebbe archiviare il **codice DAGs** l√¨, o **pagine web** potrebbero essere servite direttamente da S3. Un attaccante con permessi di scrittura potrebbe **modificare il codice** dal bucket per **pivoting** verso altre piattaforme, o **prendere il controllo di account** modificando file JS.

### Ransomware S3

In questo scenario, l'**attaccante crea una chiave KMS (Key Management Service) nel proprio account AWS** o in un altro account compromesso. Quindi rende questa **chiave accessibile a chiunque nel mondo**, consentendo a qualsiasi utente, ruolo o account AWS di crittografare oggetti utilizzando questa chiave. Tuttavia, gli oggetti non possono essere decrittografati.

L'attaccante identifica un **bucket S3 di destinazione e ottiene l'accesso a livello di scrittura** ad esso utilizzando vari metodi. Ci√≤ potrebbe essere dovuto a una cattiva configurazione del bucket che lo espone pubblicamente o all'attaccante che ottiene l'accesso all'ambiente AWS stesso. L'attaccante di solito mira a bucket che contengono informazioni sensibili come informazioni personalmente identificabili (PII), informazioni sanitarie protette (PHI), registri, backup e altro.

Per determinare se il bucket pu√≤ essere preso di mira per il ransomware, l'attaccante controlla la sua configurazione. Ci√≤ include la verifica se **S3 Object Versioning** √® abilitato e se **l'eliminazione con autenticazione multifattore (MFA delete) √® abilitata**. Se Object Versioning non √® abilitato, l'attaccante pu√≤ procedere. Se Object Versioning √® abilitato ma MFA delete √® disabilitato, l'attaccante pu√≤ **disabilitare Object Versioning**. Se sia Object Versioning che MFA delete sono abilitati, diventa pi√π difficile per l'attaccante prendere di mira quel bucket specifico con ransomware.

Utilizzando l'API di AWS, l'attaccante **sostituisce ogni oggetto nel bucket con una copia crittografata utilizzando la propria chiave KMS**. Ci√≤ crittografa efficacemente i dati nel bucket, rendendoli inaccessibili senza la chiave.

Per aggiungere ulteriore pressione, l'attaccante pianifica l'eliminazione della chiave KMS utilizzata nell'attacco. Ci√≤ d√† al bersaglio una finestra di 7 giorni per recuperare i propri dati prima che la chiave venga eliminata e i dati vengano persi in modo permanente.

Infine, l'attaccante potrebbe caricare un file finale, di solito chiamato "ransom-note.txt", che contiene istruzioni per il bersaglio su come recuperare i propri file. Questo file viene caricato senza crittografia, probabilmente per attirare l'attenzione del bersaglio e renderlo consapevole dell'attacco ransomware.

**Per ulteriori informazioni** [**controlla la ricerca originale**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** repository [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>
