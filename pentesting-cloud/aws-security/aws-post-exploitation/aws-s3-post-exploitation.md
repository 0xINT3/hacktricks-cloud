# AWS - S3 포스트 익스플로이트

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

## S3

자세한 정보는 다음을 확인하세요:

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### 민감한 정보

가끔 버킷에서 읽을 수 있는 민감한 정보를 찾을 수 있습니다. 예를 들어, terraform 상태 비밀 정보입니다.

### 피벗팅

다른 플랫폼에서는 S3를 사용하여 민감한 자산을 저장할 수 있습니다.\
예를 들어, **airflow**는 **DAGs** **코드**를 저장할 수 있으며, **웹 페이지**는 S3에서 직접 제공될 수 있습니다. 쓰기 권한을 가진 공격자는 버킷의 코드를 수정하여 다른 플랫폼으로 **피벗**하거나 JS 파일을 수정하여 계정을 **인수**할 수 있습니다.

### S3 랜섬웨어

이 시나리오에서 **공격자는 자신의 AWS 계정** 또는 다른 침해된 계정에서 **KMS (Key Management Service) 키를 생성**합니다. 그런 다음 이 키를 **전 세계의 누구나 액세스할 수 있도록** 설정하여 모든 AWS 사용자, 역할 또는 계정이 이 키를 사용하여 객체를 암호화할 수 있게 합니다. 그러나 객체는 복호화할 수 없습니다.

공격자는 다양한 방법을 사용하여 대상 **S3 버킷에 대한 쓰기 수준 액세스**를 식별합니다. 이는 버킷이 공개적으로 노출되는 잘못된 버킷 구성 또는 공격자가 AWS 환경 자체에 액세스하는 것에 기인할 수 있습니다. 공격자는 일반적으로 개인 식별 정보 (PII), 보호된 건강 정보 (PHI), 로그, 백업 등과 같은 민감한 정보를 포함하는 버킷을 대상으로합니다.

버킷이 랜섬웨어의 대상이 될 수 있는지 여부를 확인하기 위해 공격자는 버킷의 구성을 확인합니다. 이는 **S3 객체 버전 관리가 활성화되어 있는지** 및 **다중 요소 인증 삭제 (MFA 삭제)가 활성화되어 있는지** 확인하는 것을 포함합니다. 객체 버전 관리가 활성화되지 않은 경우 공격자는 진행할 수 있습니다. 객체 버전 관리가 활성화되었지만 MFA 삭제가 비활성화 된 경우 공격자는 객체 버전 관리를 **비활성화**할 수 있습니다. 객체 버전 관리와 MFA 삭제가 모두 활성화되어있는 경우 공격자는 특정 버킷을 랜섬웨어로 암호화하는 것이 더 어려워집니다.

AWS API를 사용하여 공격자는 자신의 KMS 키를 사용하여 버킷의 각 객체를 암호화 된 복사본으로 대체합니다. 이렇게하면 키 없이는 버킷의 데이터에 액세스 할 수 없게되어 데이터가 암호화됩니다.

더 큰 압력을 가하기 위해 공격자는 공격에 사용된 KMS 키의 삭제를 예약합니다. 이렇게하면 대상이 데이터를 복구하기 전에 7 일 동안의 기간이 주어지며, 키가 삭제되고 데이터가 영구적으로 손실 됩니다.

마지막으로, 공격자는 일반적으로 "ransom-note.txt"라는 최종 파일을 업로드 할 수 있으며, 이 파일에는 대상이 파일을 검색하는 방법에 대한 지침이 포함되어 있습니다. 이 파일은 암호화되지 않은 상태로 업로드되며, 대상의 주의를 끌고 랜섬웨어 공격을 인식시키기 위해 업로드됩니다.

**더 많은 정보는** [**원본 연구를 확인하세요**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>
