# AWS - S3 Post Exploitation

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di Github.

</details>

## S3

Per ulteriori informazioni controlla:

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### Informazioni Sensibili

A volte potresti trovare informazioni sensibili leggibili nei bucket. Ad esempio, segreti di stato di terraform.

### Pivoting

Diverse piattaforme potrebbero utilizzare S3 per memorizzare risorse sensibili.\
Ad esempio, **airflow** potrebbe memorizzare il **codice DAGs** l√¨, o le **pagine web** potrebbero essere servite direttamente da S3. Un attaccante con permessi di scrittura potrebbe **modificare il codice** dal bucket per **pivoting** verso altre piattaforme, o **prendere il controllo degli account** modificando i file JS.

### Ransomware di S3

In questo scenario, l'**attaccante crea una chiave KMS (Key Management Service) nel proprio account AWS** o in un altro account compromesso. Quindi rende questa **chiave accessibile a chiunque nel mondo**, consentendo a qualsiasi utente, ruolo o account AWS di crittografare oggetti utilizzando questa chiave. Tuttavia, gli oggetti non possono essere decrittografati.

L'attaccante identifica un **bucket S3 di destinazione e ottiene l'accesso a livello di scrittura** ad esso utilizzando vari metodi. Ci√≤ potrebbe essere dovuto a una cattiva configurazione del bucket che lo espone pubblicamente o all'attaccante che ottiene l'accesso all'ambiente AWS stesso. L'attaccante di solito mira ai bucket che contengono informazioni sensibili come informazioni personali identificabili (PII), informazioni sanitarie protette (PHI), log, backup e altro ancora.

Per determinare se il bucket pu√≤ essere preso di mira per il ransomware, l'attaccante controlla la sua configurazione. Ci√≤ include la verifica se √® abilitato il **Versioning degli oggetti S3** e se √® abilitata la **cancellazione con autenticazione a due fattori (MFA delete)**. Se il Versioning degli oggetti non √® abilitato, l'attaccante pu√≤ procedere. Se il Versioning degli oggetti √® abilitato ma MFA delete √® disabilitato, l'attaccante pu√≤ **disabilitare il Versioning degli oggetti**. Se sia il Versioning degli oggetti che MFA delete sono abilitati, diventa pi√π difficile per l'attaccante eseguire il ransomware su quel bucket specifico.

Utilizzando l'API AWS, l'attaccante **sostituisce ciascun oggetto nel bucket con una copia crittografata utilizzando la propria chiave KMS**. Questo cripta efficacemente i dati nel bucket, rendendoli inaccessibili senza la chiave.

Per aggiungere ulteriore pressione, l'attaccante pianifica la cancellazione della chiave KMS utilizzata nell'attacco. Questo d√† al bersaglio una finestra temporale di 7 giorni per recuperare i propri dati prima che la chiave venga cancellata e i dati vengano persi definitivamente.

Infine, l'attaccante potrebbe caricare un file finale, di solito chiamato "ransom-note.txt," che contiene istruzioni per il bersaglio su come recuperare i propri file. Questo file viene caricato senza crittografia, probabilmente per attirare l'attenzione del bersaglio e renderlo consapevole dell'attacco ransomware.

**Per ulteriori informazioni** [**controlla la ricerca originale**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di Github.

</details>
