# AWS - S3 Post Exploitation

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PRs aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## S3

Pour plus d'informations, consultez :

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### Informations Sensibles

Parfois, vous pourrez trouver des informations sensibles lisibles dans les seaux. Par exemple, les secrets d'√©tat de terraform.

### Pivotement

Diff√©rentes plateformes pourraient utiliser S3 pour stocker des actifs sensibles.\
Par exemple, **airflow** pourrait stocker le **code des DAGs** l√†-bas, ou des **pages web** pourraient √™tre directement servies depuis S3. Un attaquant avec des permissions d'√©criture pourrait **modifier le code** du seau pour **pivoter** vers d'autres plateformes, ou **prendre le contr√¥le de comptes** en modifiant des fichiers JS.

### Ransomware S3

Dans ce sc√©nario, l'**attaquant cr√©e une cl√© KMS (Key Management Service) dans son propre compte AWS** ou un autre compte compromis. Il rend ensuite cette **cl√© accessible √† tout le monde**, permettant √† tout utilisateur, r√¥le ou compte AWS de chiffrer des objets en utilisant cette cl√©. Cependant, les objets ne peuvent pas √™tre d√©chiffr√©s.

L'attaquant identifie un **seau S3 cible et obtient un acc√®s de niveau √©criture** √† celui-ci en utilisant diverses m√©thodes. Cela pourrait √™tre d√ª √† une mauvaise configuration du seau qui l'expose publiquement ou √† l'acc√®s de l'attaquant √† l'environnement AWS lui-m√™me. L'attaquant cible g√©n√©ralement des seaux contenant des informations sensibles telles que des informations personnellement identifiables (PII), des informations de sant√© prot√©g√©es (PHI), des journaux, des sauvegardes, et plus encore.

Pour d√©terminer si le seau peut √™tre cibl√© pour un ransomware, l'attaquant v√©rifie sa configuration. Cela inclut la v√©rification si le **Versioning d'Objet S3** est activ√© et si l'**authentification multi-facteurs pour la suppression (MFA delete) est activ√©e**. Si le Versioning d'Objet n'est pas activ√©, l'attaquant peut proc√©der. Si le Versioning d'Objet est activ√© mais que la suppression MFA est d√©sactiv√©e, l'attaquant peut **d√©sactiver le Versioning d'Objet**. Si le Versioning d'Objet et la suppression MFA sont tous deux activ√©s, il devient plus difficile pour l'attaquant de ran√ßonner ce seau sp√©cifique.

En utilisant l'API AWS, l'attaquant **remplace chaque objet dans le seau par une copie chiffr√©e en utilisant sa cl√© KMS**. Cela chiffre efficacement les donn√©es dans le seau, les rendant inaccessibles sans la cl√©.

Pour ajouter une pression suppl√©mentaire, l'attaquant programme la suppression de la cl√© KMS utilis√©e dans l'attaque. Cela donne √† la cible une fen√™tre de 7 jours pour r√©cup√©rer leurs donn√©es avant que la cl√© ne soit supprim√©e et que les donn√©es ne deviennent d√©finitivement perdues.

Enfin, l'attaquant pourrait t√©l√©charger un dernier fichier, g√©n√©ralement nomm√© "ransom-note.txt", qui contient des instructions pour la cible sur la mani√®re de r√©cup√©rer leurs fichiers. Ce fichier est t√©l√©charg√© sans chiffrement, probablement pour attirer l'attention de la cible et la rendre consciente de l'attaque par ransomware.

**Pour plus d'infos** [**consultez la recherche originale**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PRs aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
