# AWS - STS持続性

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もし **HackTricksで会社を宣伝したい**場合や、**PEASSの最新バージョンを入手したい**場合、または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。これは、私たちの独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)をフォローしてください。
* **ハッキングのトリックを共有するには、** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>

## STS

詳細については、以下を参照してください：

{% content-ref url="../aws-services/aws-sts-enum.md" %}
[aws-sts-enum.md](../aws-services/aws-sts-enum.md)
{% endcontent-ref %}

### ロールの仮想トークン

一時トークンはリスト化できないため、アクティブな一時トークンを維持することは持続性を維持する方法です。

<pre class="language-bash"><code class="lang-bash">aws sts get-session-token --duration-seconds 129600

# MFAを使用する場合
aws sts get-session-token \
--serial-number &#x3C;mfa-device-name> \
--token-code &#x3C;code-from-token>

# ハードウェアデバイス名は通常、デバイスの背面にある番号です（例：GAHT12345678）
<strong># SMSデバイス名はAWSのARNです（例：arn:aws:iam::123456789012:sms-mfa/username）
</strong># 仮想デバイス名はAWSのARNです（例：arn:aws:iam::123456789012:mfa/username）
</code></pre>

### ロールチェーンジャグリング

[**ロールチェーン**](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_roles\_terms-and-concepts.html#Role%20chaining)は、ステルスの持続性を維持するために役立つAWSの認識された機能です。\
**ロールを仮定して別のロールを仮定し、最初のロールを仮定し続ける（無期限）**ことができます。

ロールが仮定されると、資格情報の**有効期限フィールドが更新**されます。したがって、**2つのロールが互いを仮定できる**場合、新しい資格情報を継続的に取得することができます。

この[**ツール**](https://github.com/hotnops/AWSRoleJuggler/)を使用してジャグリングを続けることができます：
```bash
./aws_role_juggler.py -h
usage: aws_role_juggler.py [-h] [-r ROLE_LIST [ROLE_LIST ...]]

optional arguments:
-h, --help            show this help message and exit
-r ROLE_LIST [ROLE_LIST ...], --role-list ROLE_LIST [ROLE_LIST ...]
```
<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もしもあなたの**会社をHackTricksで広告表示したい**場合や、**最新版のPEASSを入手したい**場合や、HackTricksをPDFでダウンロードしたい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式のPEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを発見しましょう
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローしましょう 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)
* 自分のハッキングテクニックを共有するために、[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>
