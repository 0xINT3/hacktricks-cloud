# AWS - Persistance STS

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## STS

Pour plus d'informations, acc√©dez √† :

{% content-ref url="../aws-services/aws-sts-enum.md" %}
[aws-sts-enum.md](../aws-services/aws-sts-enum.md)
{% endcontent-ref %}

### Jeton de r√¥le suppos√©

Les jetons temporaires ne peuvent pas √™tre r√©pertori√©s, donc maintenir un jeton temporaire actif est un moyen de maintenir la persistance.

<pre class="language-bash"><code class="lang-bash">aws sts get-session-token --duration-seconds 129600

# Avec MFA
aws sts get-session-token \
    --serial-number &#x3C;mfa-device-name> \
    --token-code &#x3C;code-from-token>

# Le nom du p√©riph√©rique mat√©riel est g√©n√©ralement le num√©ro √† l'arri√®re du p√©riph√©rique, tel que GAHT12345678
<strong># Le nom du p√©riph√©rique SMS est l'ARN dans AWS, tel que arn:aws:iam::123456789012:sms-mfa/username
</strong># Le nom du p√©riph√©rique virtuel est l'ARN dans AWS, tel que arn:aws:iam::123456789012:mfa/username
</code></pre>

### Cha√Æne de r√¥le jonglante

Le [**chainage de r√¥le**](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_roles\_terms-and-concepts.html#Role%20chaining) est une fonctionnalit√© reconnue d'AWS utile pour maintenir une persistance furtive. \
Comme vous pouvez **supposer un r√¥le pour en supposer un autre pour supposer le premier (ind√©finiment)**.&#x20;

Lorsqu'un r√¥le est suppos√©, le **champ d'expiration des informations d'identification est actualis√©**. Par cons√©quent, si **2 r√¥les peuvent se supposer mutuellement**, il est possible d'obtenir continuellement de nouvelles informations d'identification.

Vous pouvez utiliser cet [**outil**](https://github.com/hotnops/AWSRoleJuggler/) pour continuer √† jongler :

```bash
./aws_role_juggler.py -h
usage: aws_role_juggler.py [-h] [-r ROLE_LIST [ROLE_LIST ...]]

optional arguments:
  -h, --help            show this help message and exit
  -r ROLE_LIST [ROLE_LIST ...], --role-list ROLE_LIST [ROLE_LIST ...]
```





<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>