# AWS - Persistencia de IAM

<details>

<summary><strong>¬°Apoya a HackTricks y obt√©n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF** ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## IAM

Para obtener m√°s informaci√≥n, acceda a:

{% content-ref url="../aws-services/aws-iam-enum.md" %}
[aws-iam-enum.md](../aws-services/aws-iam-enum.md)
{% endcontent-ref %}

### Persistencia com√∫n de IAM

* Crear un usuario
* Agregar un usuario controlado a un grupo privilegiado
* Crear claves de acceso (del nuevo usuario o de todos los usuarios)
* Conceder permisos adicionales a usuarios/grupos controlados (pol√≠ticas adjuntas o pol√≠ticas en l√≠nea)
* Desactivar MFA / Agregar su propio dispositivo MFA
* Crear una situaci√≥n de Role Chain Juggling (m√°s sobre esto a continuaci√≥n en la persistencia de STS)

### Pol√≠ticas de confianza de roles de puerta trasera

Podr√≠a crear una pol√≠tica de confianza de puerta trasera para poder asumirla para un recurso externo controlado por usted (o para todos):

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Principal": {
                "AWS": [
                    "*",
                    "arn:aws:iam::123213123123:root"
                ]
            },
            "Action": "sts:AssumeRole"
        }
    ]
}
```

### Versi√≥n de pol√≠tica de puerta trasera

Dar permisos de administrador a una pol√≠tica que no sea su √∫ltima versi√≥n (la √∫ltima versi√≥n deber√≠a parecer leg√≠tima), luego asignar esa versi√≥n de la pol√≠tica a un usuario/grupo controlado.

### Puerta trasera / Crear proveedor de identidad

Si la cuenta ya conf√≠a en un proveedor de identidad com√∫n (como Github), las condiciones de la confianza podr√≠an aumentarse para que el atacante pueda abusar de ellas.