# AWS - Acceso no autenticado a CodeBuild

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>

## CodeBuild

Para m√°s informaci√≥n, consulta esta p√°gina:

{% content-ref url="../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### buildspec.yml

Si comprometes el acceso de escritura sobre un repositorio que contiene un archivo llamado **`buildspec.yml`**, podr√≠as **puerta trasera** este archivo, el cual especifica los **comandos que se van a ejecutar** dentro de un proyecto de CodeBuild y extraer los secretos, comprometer lo que se hace y tambi√©n comprometer las **credenciales del rol IAM de CodeBuild**.

Ten en cuenta que incluso si no hay ning√∫n archivo **`buildspec.yml`** pero sabes que se est√° utilizando CodeBuild (u otro CI/CD) **modificar alg√∫n c√≥digo leg√≠timo** que se va a ejecutar tambi√©n puede darte una shell inversa, por ejemplo.

Para obtener informaci√≥n relacionada, puedes consultar la p√°gina sobre c√≥mo atacar las Acciones de Github (similar a esto):

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

## Ejecutores de GitHub Actions autohospedados en AWS CodeBuild <a href="#action-runner" id="action-runner"></a>

Como [**se indica en la documentaci√≥n**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html), es posible configurar **CodeBuild** para ejecutar **acciones de Github autohospedadas** cuando se desencadena un flujo de trabajo dentro de un repositorio de Github configurado. Esto se puede detectar revisando la configuraci√≥n del proyecto de CodeBuild porque el **`Tipo de evento`** debe contener: **`WORKFLOW_JOB_QUEUED`** y en un Flujo de trabajo de Github porque seleccionar√° un ejecutor **autohospedado** de esta manera:
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
```markdown
Esta nueva relaci√≥n entre Github Actions y AWS crea otra forma de comprometer AWS desde Github, ya que el c√≥digo en Github se ejecutar√° en un proyecto CodeBuild con un rol IAM adjunto.

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Equipos Rojos de HackTricks AWS)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
```
