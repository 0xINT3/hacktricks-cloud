# AWS - CodeBuild Unauthenticated Access

<details>

<summary><strong>htARTE (HackTricks AWS Red Team 전문가)</strong>에서 <strong>AWS 해킹을 처음부터 전문가까지 배우세요</strong>!</summary>

다른 HackTricks 지원 방법:

- **회사가 HackTricks에 광고되길 원하거나 PDF로 HackTricks를 다운로드하고 싶다면** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
- [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
- **💬 [Discord 그룹](https://discord.gg/hRep4RUj7f)** 또는 [텔레그램 그룹](https://t.me/peass)에 **가입**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)를 **팔로우**하세요.
- **HackTricks** 및 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 요령을 공유**하세요.

</details>

## CodeBuild

자세한 정보는 이 페이지를 확인하세요:

{% content-ref url="../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### buildspec.yml

만약 **`buildspec.yml`**이라는 파일을 포함하는 저장소에 쓰기 액세스를 침해한다면, **CodeBuild 프로젝트 내에서 실행될 명령어를 지정하는** 이 파일을 **백도어**할 수 있으며, 비밀을 유출하거나 수행 중인 작업을 침해하거나 **CodeBuild IAM 역할 자격 증명을 침해**할 수 있습니다.

`buildspec.yml` 파일이 없더라도 Codebuild가 사용 중이라는 것을 알고 있다면 (또는 다른 CI/CD인 경우) **실행될 합법적인 코드를 수정**하여 예를 들어 역쉘을 얻을 수도 있습니다.

관련 정보를 얻으려면 이와 유사한 Github Actions 공격에 대한 페이지를 확인할 수 있습니다:

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

## AWS CodeBuild에서 Self-hosted GitHub Actions 러너 <a href="#action-runner" id="action-runner"></a>

[**문서에서 언급된 대로**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html), **CodeBuild**를 구성하여 **Github 레포지토리 내에서 워크플로가 트리거될 때** **self-hosted Github actions**를 실행할 수 있습니다. 이는 CodeBuild 프로젝트 구성을 확인하여 감지할 수 있습니다. 왜냐하면 **`Event type`**이 **`WORKFLOW_JOB_QUEUED`**를 포함해야 하며 Github 워크플로는 다음과 같이 **self-hosted** 러너를 선택할 것입니다:
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
이제 Github Actions와 AWS 간의 새로운 관계는 Github의 코드가 IAM 역할이 부여된 CodeBuild 프로젝트에서 실행되므로 Github에서 AWS를 compromise할 수 있는 또 다른 방법을 만듭니다.

<details>

<summary><strong>제로부터 히어로가 되는 AWS 해킹을 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나** **PDF 형식의 HackTricks를 다운로드하길 원한다면** [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 굿즈**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f)이나 [**텔레그램 그룹**](https://t.me/peass)에 **가입**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* **해킹 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소로 PR을 제출하세요.

</details>
