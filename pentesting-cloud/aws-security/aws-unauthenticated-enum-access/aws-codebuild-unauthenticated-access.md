# AWS - CodeBuild Unauthenticated Access

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい場合**は[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**または[telegramグループ](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)を**フォロー**する。
* **ハッキングテクニックを共有するには、PRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) **および** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **のGitHubリポジトリに提出してください。**

</details>

## CodeBuild

詳細については、このページをチェックしてください：

{% content-ref url="../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### buildspec.yml

リポジトリに**`buildspec.yml`**というファイルが含まれている場合、そのファイルを**バックドア**にすることができます。これは、CodeBuildプロジェクト内で実行される**コマンドを指定**するファイルであり、秘密情報を外部に送信したり、実行される内容を妨害したり、**CodeBuild IAMロールの資格情報を妨害**することができます。

**`buildspec.yml`**ファイルがなくても、CodeBuildが使用されていることがわかっている場合（または異なるCI/CDの場合）、実行される**合法的なコードを変更**することで、例えばリバースシェルを取得することができます。

関連情報については、GitHub Actionsを攻撃する方法に関するページをチェックできます（これに類似しています）：

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

## AWS CodeBuildでの自己ホスト型GitHub Actionsランナー <a href="#action-runner" id="action-runner"></a>

[**ドキュメントで示されているように**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html)、**CodeBuild**を構成して、Githubリポジトリ内でワークフローがトリガーされたときに**自己ホスト型GitHub Actions**を実行することが可能です。これは、CodeBuildプロジェクトの構成をチェックすることで検出できます。なぜなら、**`Event type`**には**`WORKFLOW_JOB_QUEUED`**が含まれている必要があり、Githubワークフローでは、次のように**自己ホスト型**ランナーが選択されるからです：
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
```html
このGithub ActionsとAWSの新しい関係は、GithubのコードがIAMロールがアタッチされたCodeBuildプロジェクトで実行されるため、GithubからAWSを侵害する別の方法を作成します。
```
