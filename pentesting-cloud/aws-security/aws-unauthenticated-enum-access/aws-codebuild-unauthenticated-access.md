# AWS - CodeBuild未经身份验证访问

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS红队专家）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想看到您的**公司在HackTricks中做广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或在**Twitter**上关注我们 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>

## CodeBuild

有关更多信息，请查看此页面：

{% content-ref url="../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### buildspec.yml

如果您入侵了包含名为**`buildspec.yml`**的文件的存储库的写访问权限，您可以**后门**此文件，该文件指定了将在CodeBuild项目内执行的**命令**，并窃取秘密，入侵所做的事情，以及入侵**CodeBuild IAM角色凭据**。

请注意，即使没有**`buildspec.yml`**文件，但您知道正在使用Codebuild（或其他CI/CD），**修改一些将要执行的合法代码**也可以让您例如获取反向shell。

有关一些相关信息，您可以查看有关如何攻击Github Actions的页面（类似于此）：

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

## 在AWS CodeBuild中托管的GitHub Actions运行程序 <a href="#action-runner" id="action-runner"></a>

正如[**文档中指出的**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html)，可以配置**CodeBuild**在触发Github存储库内的工作流时运行**自托管的Github actions**。这可以通过检查CodeBuild项目配置来检测，因为**`事件类型`**需要包含：**`WORKFLOW_JOB_QUEUED`**，在Github工作流中，它将选择一个**自托管**的运行程序，如下所示：
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
这种Github Actions和AWS之间的新关系为从Github入侵AWS提供了另一种方式，因为Github中的代码将在附有IAM角色的CodeBuild项目中运行。

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想看到您的**公司在HackTricks中做广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或 **关注**我们的**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
