# AWS - Codepipeline Privilege Escalation

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>

## codepipeline

Codepipeline hakkında daha fazla bilgi için:

{% content-ref url="../aws-services/aws-datapipeline-codepipeline-codebuild-and-codecommit.md" %}
[aws-datapipeline-codepipeline-codebuild-and-codecommit.md](../aws-services/aws-datapipeline-codepipeline-codebuild-and-codecommit.md)
{% endcontent-ref %}

### `iam:PassRole`, `codepipeline:CreatePipeline`, `codebuild:CreateProject, codepipeline:StartPipelineExecution`

Bir code pipeline oluştururken **çalıştırılacak bir codepipeline IAM Rolü** belirtebilirsiniz, bu nedenle onları tehlikeye atabilirsiniz.

Önceki izinlere ek olarak, **kodun depolandığı yere erişiminiz olması** gerekecektir (S3, ECR, github, bitbucket...).

Bunu web sayfasında yaparak test ettim, önceki belirtilen izinler bir codepipeline oluşturmak için gereken List/Get izinleri değildir, ancak web üzerinde oluşturmak için ayrıca şunlara ihtiyacınız olacaktır: `codebuild:ListCuratedEnvironmentImages, codebuild:ListProjects, codebuild:ListRepositories, codecommit:ListRepositories, events:PutTargets, codepipeline:ListPipelines, events:PutRule, codepipeline:ListActionTypes, cloudtrail:<several>`

**Build projesi oluşturulurken** çalıştırılacak bir **komut belirtebilirsiniz** (ters kabuk?) ve build aşamasını **yetkili kullanıcı olarak** çalıştırmak için yapılandırma saldırganın tehlikeye atması gereken konfigürasyondur:

![](<../../../.gitbook/assets/image (53).png>)

![](<../../../.gitbook/assets/image (64).png>)

### ?`codebuild:UpdateProject, codepipeline:UpdatePipeline, codepipeline:StartPipelineExecution`

Önceki izinlerle bir codepipeline'da kullanılan rolü ve yürütülen komutu değiştirmek mümkün olabilir.

### `codepipeline:pollforjobs`

[AWS belirtir](https://docs.aws.amazon.com/codepipeline/latest/APIReference/API_PollForJobs.html):

> Bu API çağrıldığında, CodePipeline, eylemin giriş veya çıkış sanatçıları için o S3 kovasına erişim gerektiriyorsa, bu API, bu S3 kovası için geçici kimlik bilgilerini **döndürür**. Bu API ayrıca, eylem için tanımlanan herhangi bir gizli değeri de **döndürür**.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>
