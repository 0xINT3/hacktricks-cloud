# AWS - Codepipeline Privesc

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## codepipeline

Vir meer inligting oor codepipeline kyk:

{% content-ref url="../aws-services/aws-datapipeline-codepipeline-codebuild-and-codecommit.md" %}
[aws-datapipeline-codepipeline-codebuild-and-codecommit.md](../aws-services/aws-datapipeline-codepipeline-codebuild-and-codecommit.md)
{% endcontent-ref %}

### `iam:PassRole`, `codepipeline:CreatePipeline`, `codebuild:CreateProject, codepipeline:StartPipelineExecution`

Wanneer jy 'n kodepyplyn skep, kan jy 'n **codepipeline IAM Rol om uit te voer** aandui, dus kan jy hulle kompromitteer.

Afgesien van die vorige toestemmings, sal jy toegang tot die plek waar die kode gestoor word nodig h√™ (S3, ECR, github, bitbucket...)

Ek het dit getoets deur die proses op die webwerf te doen, die toestemmings wat voorheen aangedui is, is nie die Lys/Kry eenhede wat nodig is om 'n kodepyplyn te skep nie, maar om dit op die web te skep, sal jy ook nodig h√™: `codebuild:ListCuratedEnvironmentImages, codebuild:ListProjects, codebuild:ListRepositories, codecommit:ListRepositories, events:PutTargets, codepipeline:ListPipelines, events:PutRule, codepipeline:ListActionTypes, cloudtrail:<several>`

Tydens die **skepping van die bouprojek** kan jy 'n **bevel om uit te voer** (rev shell?) aandui en die boufase as **bevoorregte gebruiker** uitvoer, dit is die konfigurasie wat die aanvaller nodig het om te kompromitteer:

![](<../../../.gitbook/assets/image (276).png>)

![](<../../../.gitbook/assets/image (181).png>)

### ?`codebuild:UpdateProject, codepipeline:UpdatePipeline, codepipeline:StartPipelineExecution`

Dit mag moontlik wees om die rol wat gebruik word en die bevel wat op 'n kodepyplyn uitgevoer word, te wysig met die vorige toestemmings.

### `codepipeline:pollforjobs`

[AWS noem](https://docs.aws.amazon.com/codepipeline/latest/APIReference/API\_PollForJobs.html):

> Wanneer hierdie API geroep word, gee CodePipeline **tydelike geloofsbriewe vir die S3-emmer** wat gebruik word om artefakte vir die pyplyn te stoor, as die aksie toegang tot daardie S3-emmer vir inset- of uitvoerartefakte benodig. Hierdie API gee ook **enige geheime waardes wat vir die aksie gedefinieer is** terug.

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
