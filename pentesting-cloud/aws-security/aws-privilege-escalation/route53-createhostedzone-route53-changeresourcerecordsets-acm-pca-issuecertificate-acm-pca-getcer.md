# AWS - Route53 Yetki Yükseltme

<details>

<summary><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı takip edin.
* Hacking hilelerinizi [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR göndererek paylaşın.

</details>

Route53 hakkında daha fazla bilgi için:

{% content-ref url="../aws-services/aws-route53-enum.md" %}
[aws-route53-enum.md](../aws-services/aws-route53-enum.md)
{% endcontent-ref %}

### `route53:CreateHostedZone`, `route53:ChangeResourceRecordSets`, `acm-pca:IssueCertificate`, `acm-pca:GetCertificate`

{% hint style="info" %}
Bu saldırıyı gerçekleştirmek için hedef hesabın zaten hesapta [**AWS Sertifika Yöneticisi Özel Sertifika Yetkilisi**](https://aws.amazon.com/certificate-manager/private-certificate-authority/) **(AWS-PCA)** kurulu olmalı ve VPC(ler) içindeki EC2 örneklerinin sertifikaları güvenmesi için önceden içe aktarılmış olmalıdır. Bu altyapı mevcut olduğunda, aşağıdaki saldırı AWS API trafiğini ele geçirmek için gerçekleştirilebilir.
{% endhint %}

Diğer izinler **enumarasyon için önerilir ancak zorunlu değildir**: `route53:GetHostedZone`, `route53:ListHostedZones`, `acm-pca:ListCertificateAuthorities`, `ec2:DescribeVpcs`

Bir AWS VPC'sinin birden çok bulut doğal uygulamasının birbirleriyle ve AWS API'yle iletişim kurduğu varsayılır. Mikro servisler arasındaki iletişim genellikle TLS şifrelemeli olduğundan, bu hizmetler için geçerli sertifikaları vermek için özel bir CA olmalıdır. **ACM-PCA** bunun için kullanılıyorsa ve saldırgan, yukarıda açıklanan minimum izin setiyle hem route53'ü hem de acm-pca özel CA'yı kontrol etme erişimine sahip olursa, uygulama çağrılarını AWS API'ye ele geçirebilir ve IAM izinlerini ele geçirebilir.

Bu mümkün çünkü:

* AWS SDK'ları [Sertifika Pinleme](https://www.digicert.com/blog/certificate-pinning-what-is-certificate-pinning) özelliğine sahip değildir.
* Route53, AWS API etki alan adları için Özel Barındırılan Bölge ve DNS kayıtları oluşturmaya izin verir.
* ACM-PCA'daki Özel CA, yalnızca belirli Ortak Adlar için sertifika imzalamakla sınırlanamaz.

**Potansiyel Etki:** Trafikteki hassas bilgileri ele geçirerek dolaylı olarak yetki yükseltme.

#### Sömürü <a href="#discovery" id="discovery"></a>

Sömürü adımlarını orijinal araştırmada bulabilirsiniz: [**https://niebardzo.github.io/2022-03-11-aws-hijacking-route53/**](https://niebardzo.github.io/2022-03-11-aws-hijacking-route53/)

<details>

<summary><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı takip edin.
* Hacking hilelerinizi [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR göndererek paylaşın.

</details>
