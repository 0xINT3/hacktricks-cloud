# AWS - MQ 枚举

<details>

<summary><strong>从零开始学习AWS黑客攻击直到成为专家，通过</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在 **HackTricks中看到您的公司广告** 或 **下载HackTricks的PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>

## AWS - MQ

**消息代理**允许使用不同编程语言在各种平台上的软件系统进行通信和信息交换。**Amazon MQ** 是一个托管的消息代理服务，适用于 **Apache ActiveMQ** 和 **RabbitMQ**，它简化了在AWS上设置、操作和管理消息代理的过程。通过几个步骤，Amazon MQ可以为您的消息代理提供支持软件版本升级的服务。

### AWS - RabbitMQ

RabbitMQ 是一种**消息队列软件**，也被称为_消息代理_或_队列管理器_。简单来说，它是**定义队列的软件**，**应用程序连接**到这些队列以**传输消息**或多个消息。

消息可以包含任何类型的信息。例如，它可以包含有关应该在另一个应用程序（甚至可能在另一个服务器上）上启动的进程或任务的信息，或者它可以仅仅是一个简单的文本消息。队列管理软件存储消息，直到接收应用程序连接并从队列中取走消息。然后接收应用程序处理该消息。

AWS提供了一种简单的方式来**托管和管理RabbitMQ服务器**。

### AWS - ActiveMQ

Apache ActiveMQ® 是最受欢迎的开源、多协议、基于Java的**消息代理**。它支持行业标准协议，因此用户可以在广泛的语言和平台中选择客户端。从用JavaScript、C、C++、Python、.Net等编写的客户端连接。使用普遍的**AMQP**协议整合您的多平台应用程序。使用**STOMP**通过websockets在您的Web应用程序之间交换消息。使用**MQTT**管理您的物联网设备。支持您现有的**JMS**基础设施及更多。ActiveMQ提供了支持任何消息用例的能力和灵活性。

## 枚举
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
{% hint style="warning" %}
待办：指明如何在内部枚举 RabbitMQ 和 ActiveMQ，以及如何监听所有队列并发送数据（如果您知道如何做，请发送 PR）
{% endhint %}

## 权限提升

{% content-ref url="../aws-privilege-escalation/aws-mq-privesc.md" %}
[aws-mq-privesc.md](../aws-privilege-escalation/aws-mq-privesc.md)
{% endcontent-ref %}

## 未经认证的访问

{% content-ref url="../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md" %}
[aws-mq-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md)
{% endcontent-ref %}

## 持久性

如果您知道访问 RabbitMQ 网络控制台的凭证，您可以创建一个具有管理员权限的新用户。

## 参考资料

* [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
* [https://activemq.apache.org/](https://activemq.apache.org/)

<details>

<summary><strong>通过</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>从零开始学习 AWS 黑客攻击！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想在 **HackTricks** 中看到您的**公司广告**或**下载 HackTricks 的 PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取 [**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 发现 [**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家的 [**NFTs**](https://opensea.io/collection/the-peass-family) 收藏
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>
