# AWS - Enumera√ß√£o do MQ

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

## Amazon MQ

### Introdu√ß√£o aos Corretores de Mensagens
Os **corretores de mensagens** atuam como intermedi√°rios, facilitando a comunica√ß√£o entre diferentes sistemas de software, que podem ser constru√≠dos em plataformas variadas e programados em diferentes idiomas. A **Amazon MQ** simplifica a implanta√ß√£o, opera√ß√£o e manuten√ß√£o de corretores de mensagens na AWS. Ele fornece servi√ßos gerenciados para **Apache ActiveMQ** e **RabbitMQ**, garantindo o provisionamento cont√≠nuo e atualiza√ß√µes autom√°ticas de vers√£o do software.

### AWS - RabbitMQ
RabbitMQ √© um software de **fila de mensagens** proeminente, tamb√©m conhecido como um _corretor de mensagens_ ou _gerenciador de filas_. √â fundamentalmente um sistema onde filas s√£o configuradas. As aplica√ß√µes interagem com essas filas para **enviar e receber mensagens**. Mensagens neste contexto podem transportar uma variedade de informa√ß√µes, que v√£o desde comandos para iniciar processos em outras aplica√ß√µes (potencialmente em servidores diferentes) at√© mensagens de texto simples. As mensagens s√£o retidas pelo software do gerenciador de filas at√© serem recuperadas e processadas por uma aplica√ß√£o receptora. A AWS fornece uma solu√ß√£o f√°cil de usar para hospedar e gerenciar servidores RabbitMQ.

### AWS - ActiveMQ
O Apache ActiveMQ¬Æ √© um principal **corretor de mensagens** de c√≥digo aberto baseado em Java conhecido por sua versatilidade. Ele suporta m√∫ltiplos protocolos padr√£o do setor, oferecendo ampla compatibilidade com clientes em uma ampla variedade de idiomas e plataformas. Os usu√°rios podem:

- Conectar-se com clientes escritos em JavaScript, C, C++, Python, .Net e mais.
- Alavancar o protocolo **AMQP** para integrar aplica√ß√µes de diferentes plataformas.
- Usar **STOMP** sobre websockets para trocas de mensagens de aplicativos da web.
- Gerenciar dispositivos IoT com **MQTT**.
- Manter a infraestrutura existente de **JMS** e estender suas capacidades.

A robustez e flexibilidade do ActiveMQ o tornam adequado para uma infinidade de requisitos de mensagens.

## Enumera√ß√£o
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
{% hint style="warning" %}
A FAZER: Indicar como enumerar RabbitMQ e ActiveMQ internamente e como escutar em todas as filas e enviar dados (envie PR se souber como fazer isso)
{% endhint %}

## Privesc

{% content-ref url="../aws-privilege-escalation/aws-mq-privesc.md" %}
[aws-mq-privesc.md](../aws-privilege-escalation/aws-mq-privesc.md)
{% endcontent-ref %}

## Acesso n√£o autenticado

{% content-ref url="../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md" %}
[aws-mq-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md)
{% endcontent-ref %}

## Persist√™ncia

Se voc√™ conhece as credenciais para acessar o console web do RabbitMQ, voc√™ pode criar um novo usu√°rio com privil√©gios de administrador.

## Refer√™ncias

* [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
* [https://activemq.apache.org/](https://activemq.apache.org/)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
