# AWS - Enumera√ß√£o do MQ

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou se deseja acessar a **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegrama**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>

## AWS - MQ

**Message brokers** permitem que sistemas de software, que muitas vezes usam diferentes linguagens de programa√ß√£o em v√°rias plataformas, se comuniquem e troquem informa√ß√µes. **Amazon MQ** √© um servi√ßo de corretor de mensagens gerenciado para **Apache ActiveMQ** e **RabbitMQ** que simplifica a configura√ß√£o, opera√ß√£o e gerenciamento de corretores de mensagens na AWS. Com alguns passos, o Amazon MQ pode provisionar seu corretor de mensagens com suporte para atualiza√ß√µes de vers√£o de software.

### AWS - RabbitMQ

RabbitMQ √© um **software de fila de mensagens** tamb√©m conhecido como um _message broker_ ou _queue manager_. Simplificando, √© **um software onde as filas s√£o definidas**, para as quais **aplicativos se conectam** para **transferir uma mensagem** ou mensagens.

Uma mensagem pode incluir qualquer tipo de informa√ß√£o. Pode, por exemplo, ter informa√ß√µes sobre um processo ou tarefa que deve ser iniciado em outro aplicativo (que pode at√© estar em outro servidor), ou pode ser apenas uma mensagem de texto simples. O software do gerenciador de filas armazena as mensagens at√© que um aplicativo receptor se conecte e retire uma mensagem da fila. O aplicativo receptor, ent√£o, processa a mensagem.

A AWS oferece **hospedagem e gerenciamento f√°cil de servidores RabbitMQ**.

### AWS - ActiveMQ

O Apache ActiveMQ¬Æ √© o corretor de mensagens de c√≥digo aberto, multi-protocolo e baseado em Java mais popular. Ele suporta protocolos padr√£o do setor para que os usu√°rios obtenham os benef√≠cios de escolhas de clientes em uma ampla variedade de idiomas e plataformas. Conecte-se a partir de clientes escritos em JavaScript, C, C ++, Python, .Net e muito mais. Integre suas aplica√ß√µes multiplataforma usando o protocolo **AMQP** ub√≠quo. Troque mensagens entre suas aplica√ß√µes web usando **STOMP** sobre websockets. Gerencie seus dispositivos IoT usando **MQTT**. Suporte sua infraestrutura **JMS** existente e al√©m. O ActiveMQ oferece o poder e a flexibilidade para suportar qualquer caso de uso de mensagens.

## Enumera√ß√£o

```bash
# Listar corretores
aws mq list-brokers

# Obter informa√ß√µes do corretor
aws mq describe-broker --broker-id <broker-id>
## Encontre endpoints em .BrokerInstances
## Encontre se √© acess√≠vel publicamente em .PubliclyAccessible

# Listar nomes de usu√°rio (somente para ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Obter informa√ß√µes do usu√°rio (SENHA N√ÉO INCLU√çDA)
aws mq describe-user --broker-id <broker-id> --username <username>

# Listar configura√ß√µes (somente para ActiveMQ)
aws mq list-configurations
## Aqui voc√™ pode encontrar se a autentica√ß√£o simples ou LDAP √© usada

# Criar usu√°rio Active MQ
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```

{% hint style="warning" %}
TODO: Indicar como enumerar internamente o RabbitMQ e o ActiveMQ e como ouvir todas as filas e enviar dados (enviar PR se souber como fazer isso)
{% endhint %}

## Privesc

{% content-ref url="../aws-privilege-escalation/aws-mq-privesc.md" %}
[aws-mq-privesc.md](../aws-privilege-escalation/aws-mq-privesc.md)
{% endcontent-ref %}

## Acesso n√£o autenticado

{% content-ref url="../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md" %}
[aws-mq-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md)
{% endcontent-ref %}

## Persist√™ncia

Se voc√™ conhece as credenciais para acessar o console da web do RabbitMQ, pode criar um novo usu√°rio com privil√©gios de administrador.

## Refer√™ncias

* [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
* [https://activemq.apache.org/](https://activemq.apache.org/)

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou se deseja acessar a **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegrama**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>