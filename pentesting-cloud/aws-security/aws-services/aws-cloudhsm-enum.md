# AWS - Enumerazione di CloudHSM

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di github.

</details>

## HSM - Modulo di sicurezza hardware

Cloud HSM √® un dispositivo hardware convalidato FIPS 140 di livello due per la memorizzazione sicura delle chiavi crittografiche (nota che CloudHSM √® un dispositivo hardware, non un servizio virtualizzato). √à un dispositivo SafeNetLuna 7000 con preinstallato il firmware 5.3.13. Ci sono due versioni del firmware e quella da scegliere dipende dalle tue esigenze specifiche. Una √® conforme a FIPS 140-2 e c'√® una versione pi√π recente che pu√≤ essere utilizzata.

La caratteristica insolita di CloudHSM √® che √® un dispositivo fisico e quindi **non √® condiviso con altri clienti**, o come viene comunemente definito, multi-tenant. √à un dispositivo dedicato a un singolo tenant disponibile esclusivamente per i tuoi carichi di lavoro.

Di solito, un dispositivo √® disponibile entro 15 minuti, a condizione che ci sia capacit√†, ma in alcune zone potrebbe non esserci.

Poich√© si tratta di un dispositivo fisico dedicato a te, **le chiavi sono memorizzate sul dispositivo**. Le chiavi devono essere replicate su un altro dispositivo, copiate su un supporto di archiviazione offline o esportate su un dispositivo di riserva. **Questo dispositivo non √® supportato** da S3 o da altri servizi di AWS come KMS.

In **CloudHSM**, devi **scalare il servizio da solo**. Devi fornire abbastanza dispositivi CloudHSM per gestire le tue esigenze di crittografia in base agli algoritmi di crittografia che hai scelto di implementare per la tua soluzione.\
La scalabilit√† del servizio di gestione delle chiavi viene eseguita da AWS e si ridimensiona automaticamente su richiesta, quindi man mano che aumenta l'utilizzo, potrebbe essere necessario un numero maggiore di dispositivi CloudHSM. Tieni presente questo mentre scali la tua soluzione e se la tua soluzione ha il ridimensionamento automatico, assicurati che il tuo massimo ridimensionamento sia considerato con un numero sufficiente di dispositivi CloudHSM per gestire la soluzione.

Come per la scalabilit√†, **le prestazioni dipendono da te con CloudHSM**. Le prestazioni variano in base all'algoritmo di crittografia utilizzato e a quanto spesso √® necessario accedere o recuperare le chiavi per crittografare i dati. Le prestazioni del servizio di gestione delle chiavi sono gestite da Amazon e si ridimensionano automaticamente in base alle esigenze. Le prestazioni di CloudHSM vengono ottenute aggiungendo pi√π dispositivi e se hai bisogno di maggiori prestazioni, puoi aggiungere dispositivi o modificare il metodo di crittografia con un algoritmo pi√π veloce.

Se la tua soluzione √® **multiregione**, dovresti aggiungere diversi **dispositivi CloudHSM nella seconda regione e configurare la connettivit√† cross-region con una connessione VPN privata** o un altro metodo per garantire che il traffico sia sempre protetto tra il dispositivo in ogni livello della connessione. Se hai una soluzione multiregione, devi pensare a come **replicare le chiavi e configurare dispositivi CloudHSM aggiuntivi nelle regioni in cui operi**. Puoi trovarsi rapidamente in una situazione in cui hai sei o otto dispositivi distribuiti su pi√π regioni, consentendo una ridondanza completa delle tue chiavi di crittografia.

**CloudHSM** √® un servizio di classe enterprise per la memorizzazione sicura delle chiavi e pu√≤ essere utilizzato come **radice di fiducia per un'azienda**. Pu√≤ memorizzare chiavi private in PKI e chiavi di autorit√† di certificazione in implementazioni X509. Oltre alle chiavi simmetriche utilizzate negli algoritmi simmetrici come AES, **KMS memorizza e protegge fisicamente solo le chiavi simmetriche (non pu√≤ agire come autorit√† di certificazione)**, quindi se hai bisogno di memorizzare chiavi PKI e CA, uno o due o tre dispositivi CloudHSM potrebbero essere la tua soluzione.

**CloudHSM √® considerevolmente pi√π costoso rispetto al servizio di gestione delle chiavi**. CloudHSM √® un dispositivo hardware, quindi hai costi fissi per fornire il dispositivo CloudHSM, quindi un costo orario per eseguire il dispositivo. Il costo viene moltiplicato per il numero di dispositivi CloudHSM necessari per soddisfare le tue specifiche esigenze.\
Inoltre, √® necessario considerare l'acquisto di software di terze parti come i pacchetti software SafeNet ProtectV e il tempo e lo sforzo di integrazione. Il servizio di gestione delle chiavi √® basato sull'utilizzo e dipende dal numero di chiavi che possiedi e dalle operazioni di input e output. Poich√© la gestione delle chiavi offre un'integrazione senza soluzione di continuit√† con molti servizi AWS, i costi di integrazione dovrebbero essere significativamente inferiori. I costi dovrebbero essere considerati un fattore secondario nelle soluzioni di crittografia. La crittografia viene tipicamente utilizzata per la sicurezza e la conformit√†.

**Con CloudHSM solo tu hai accesso alle chiavi** e senza entrare troppo nei dettagli, con CloudHSM gestisci le tue chiavi. **Con KMS, tu e Amazon gestite congiuntamente le chiavi**. AWS ha molte politiche di salvaguardia contro gli abusi e **non pu√≤ ancora accedere alle tue chiavi in nessuna delle due soluzioni**. La principale distinzione riguarda la conformit√† per quanto riguarda la propriet√† e la gestione delle chiavi e, con CloudHSM, si tratta di un dispositivo hardware che gestisci e mantieni con accesso esclusivo solo per te.

### Suggerimenti per CloudHSM

1. Distribuisci sempre CloudHSM in un'**architettura ad alta disponibilit√† (HA)** con almeno due dispositivi in **zone di disponibilit√† separate**, e se possibile, distribuisci un terzo dispositivo in locale o in un'altra regione di AWS.
2. Presta attenzione quando **inizializzi** un **CloudHSM**. Questa azione **distrugger√† le chiavi**, quindi assicurati di avere un'altra copia delle chiavi o di essere assolutamente sicuro che non avrai mai bisogno di queste chiavi per decrittografare dati.
3. CloudHSM supporta solo **alcune versioni del firmware** e del software. Prima di eseguire qualsiasi aggiornamento, assicurati che il firmware e/o il software siano supportati da AWS. Puoi sempre contattare il supporto AWS per verificare se la guida all'aggiornamento non √® chiara.
4. La **configurazione di rete non dovrebbe mai essere modificata**. Ricorda, si trova in un data center AWS e AWS monitora l'hardware di base per te. Ci√≤ significa che se l'hardware presenta un guasto, lo sostituiranno per te, ma solo se sanno che √® guasto.
5. Il **forward di SysLog non dovrebbe essere rimosso o modificato**. Puoi sempre **aggiungere** un inoltratore di SysLog per indirizzare i log al tuo strumento di raccolta.
6. La configurazione **SNMP** ha le stesse restrizioni di base della rete e della cartella SysLog. Questa **non dovrebbe essere modificata o rimossa**.
### Cos'√® un modulo di sicurezza hardware

Un modulo di sicurezza hardware (HSM) √® un dispositivo crittografico dedicato utilizzato per generare, archiviare e gestire chiavi crittografiche e proteggere dati sensibili. √à progettato per fornire un alto livello di sicurezza isolando fisicamente ed elettronicamente le funzioni crittografiche dal resto del sistema.

Il funzionamento di un HSM pu√≤ variare a seconda del modello e del produttore specifico, ma generalmente si verificano i seguenti passaggi:

1. **Generazione delle chiavi**: L'HSM genera una chiave crittografica casuale utilizzando un generatore di numeri casuali sicuro.
2. **Archiviazione delle chiavi**: La chiave viene **archiviata in modo sicuro all'interno dell'HSM, dove pu√≤ essere accessibile solo da utenti o processi autorizzati**.
3. **Gestione delle chiavi**: L'HSM fornisce una serie di funzioni di gestione delle chiavi, tra cui rotazione delle chiavi, backup e revoca.
4. **Operazioni crittografiche**: L'HSM esegue una serie di operazioni crittografiche, tra cui crittografia, decrittografia, firma digitale e scambio di chiavi. Queste operazioni vengono **eseguite all'interno dell'ambiente sicuro dell'HSM**, che protegge contro l'accesso non autorizzato e la manipolazione.
5. **Registrazione delle attivit√†**: L'HSM registra tutte le operazioni crittografiche e i tentativi di accesso, che possono essere utilizzati per scopi di conformit√† e audit di sicurezza.

Gli HSM possono essere utilizzati per una vasta gamma di applicazioni, tra cui transazioni online sicure, certificati digitali, comunicazioni sicure e crittografia dei dati. Sono spesso utilizzati in settori che richiedono un alto livello di sicurezza, come finanza, sanit√† e governo.

In generale, l'alto livello di sicurezza fornito dagli HSM rende **molto difficile e considerato una violazione della sicurezza** estrarre chiavi grezze da essi. Tuttavia, potrebbero esserci **alcuni scenari** in cui una **chiave grezza potrebbe essere estratta** da personale autorizzato per scopi specifici, come nel caso di una procedura di recupero chiave.

### Enumerazione
```
```
<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) su GitHub.

</details>
