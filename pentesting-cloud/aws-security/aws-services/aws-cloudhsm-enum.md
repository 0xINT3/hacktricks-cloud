# AWS - CloudHSM Enum

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów GitHub.

</details>

## HSM - Moduł Bezpieczeństwa Sprzętowego

Cloud HSM to sprzętowe urządzenie **walidowane na poziomie FIPS 140-2**, służące do bezpiecznego przechowywania kluczy kryptograficznych (należy zauważyć, że CloudHSM to urządzenie sprzętowe, a nie wirtualna usługa). Jest to urządzenie SafeNetLuna 7000 z wersją 5.3.13 preinstalowaną. Istnieją dwie wersje oprogramowania układowego, a wybór zależy od konkretnych potrzeb. Jedna z nich jest zgodna z normą FIPS 140-2, a istnieje nowsza wersja, która może być używana.

Nietypową cechą CloudHSM jest to, że jest to fizyczne urządzenie i **nie jest współdzielone z innymi klientami**, czyli nie jest wieloosobowe. Jest to dedykowane urządzenie dla jednego najemcy, dostępne wyłącznie dla Twoich obciążeń.

Zazwyczaj urządzenie jest dostępne w ciągu 15 minut, o ile jest dostępna pojemność, ale w niektórych strefach może jej nie być.

Ponieważ jest to fizyczne urządzenie dedykowane dla Ciebie, **klucze są przechowywane na urządzeniu**. Klucze muszą być replikowane na inne urządzenie, zapisywane na offline storage lub eksportowane do zapasowego urządzenia. **To urządzenie nie jest obsługiwane** przez S3 ani żadną inną usługę AWS, taką jak KMS.

W **CloudHSM** musisz **samodzielnie skalować usługę**. Musisz dostarczyć wystarczającą liczbę urządzeń CloudHSM, aby obsłużyć swoje potrzeby związane z szyfrowaniem, w zależności od algorytmów szyfrowania, które wybrałeś do implementacji w swoim rozwiązaniu.\
Skalowanie usługi Key Management Service jest wykonywane przez AWS i automatycznie dostosowuje się do zapotrzebowania, więc w miarę wzrostu użytkowania może być wymagana większa liczba urządzeń CloudHSM. Pamiętaj o tym, skalując swoje rozwiązanie, i jeśli Twoje rozwiązanie ma automatyczne skalowanie, upewnij się, że maksymalna skala jest uwzględniona w wystarczającej liczbie urządzeń CloudHSM do obsługi rozwiązania.

Podobnie jak skalowanie, **wydajność zależy od Ciebie z CloudHSM**. Wydajność zależy od używanego algorytmu szyfrowania i częstotliwości dostępu lub pobierania kluczy do szyfrowania danych. Wydajność usługi zarządzania kluczami jest obsługiwana przez Amazona i automatycznie dostosowuje się do wymagań zapotrzebowania. Wydajność CloudHSM jest osiągana poprzez dodawanie kolejnych urządzeń, a jeśli potrzebujesz większej wydajności, musisz dodać urządzenia lub zmienić metodę szyfrowania na szybszy algorytm.

Jeśli Twoje rozwiązanie jest **wieloregionalne**, powinieneś dodać kilka **urządzeń CloudHSM w drugim regionie i skonfigurować łączność międzyregionową za pomocą prywatnego połączenia VPN** lub inną metodę, aby zapewnić ochronę ruchu między urządzeniem na każdym poziomie połączenia. Jeśli masz rozwiązanie wieloregionalne, musisz zastanowić się, jak replikować klucze i skonfigurować dodatkowe urządzenia CloudHSM w regionach, w których działasz. Możesz bardzo szybko znaleźć się w sytuacji, w której masz sześć lub osiem urządzeń rozproszonych w różnych regionach, zapewniających pełną redundancję kluczy szyfrowania.

**CloudHSM** to usługa klasy enterprise do bezpiecznego przechowywania kluczy i może być używana jako **podstawa zaufania dla przedsiębiorstwa**. Może przechowywać klucze prywatne w PKI i klucze certyfikatów w implementacjach X509. Oprócz kluczy symetrycznych używanych w algorytmach symetrycznych, takich jak AES, **KMS przechowuje i fizycznie chroni tylko klucze symetryczne (nie może działać jako urządzenie certyfikujące)**, więc jeśli potrzebujesz przechowywać klucze PKI i CA, CloudHSM lub dwa lub trzy urządzenia mogą być Twoim rozwiązaniem.

**CloudHSM jest znacznie droższy niż Key Management Service**. CloudHSM to urządzenie sprzętowe, więc musisz ponieść koszty związane z dostarczeniem urządzenia CloudHSM, a następnie koszt godzinowy związany z jego działaniem, który obecnie wynosi 1,88 USD za godzinę pracy, czyli około 1 373 USD miesięcznie.

Najczęstszym powodem użycia CloudHSM są standardy zgodności, które musisz spełnić z przyczyn regulacyjnych. **KMS nie oferuje obsługi danych dla kluczy asymetrycznych. CloudHSM pozwala na bezpieczne przechowywanie kluczy asymetrycznych**.

**Klucz publiczny jest instalowany na urządzeniu HSM podczas inicjalizacji**, dzięki czemu można uzyskać dostęp do instancji CloudHSM za pomocą SSH.
### Co to jest moduł zabezpieczeń sprzętowych (HSM)

Moduł zabezpieczeń sprzętowych (HSM) to dedykowane urządzenie kryptograficzne, które służy do generowania, przechowywania i zarządzania kluczami kryptograficznymi oraz ochrony danych poufnych. Został zaprojektowany w celu zapewnienia wysokiego poziomu bezpieczeństwa poprzez fizyczną i elektroniczną izolację funkcji kryptograficznych od reszty systemu.

Sposób działania HSM może się różnić w zależności od konkretnego modelu i producenta, ale ogólnie występują następujące kroki:

1. **Generowanie kluczy**: HSM generuje losowy klucz kryptograficzny za pomocą bezpiecznego generatora liczb losowych.
2. **Przechowywanie kluczy**: Klucz jest **przechowywany bezpiecznie wewnątrz HSM, gdzie może być dostępny tylko dla upoważnionych użytkowników lub procesów**.
3. **Zarządzanie kluczami**: HSM zapewnia szereg funkcji zarządzania kluczami, w tym rotację kluczy, tworzenie kopii zapasowych i unieważnianie.
4. **Operacje kryptograficzne**: HSM wykonuje różne operacje kryptograficzne, takie jak szyfrowanie, deszyfrowanie, cyfrowe podpisywanie i wymiana kluczy. Te operacje są **wykonywane w bezpiecznym środowisku HSM**, które chroni przed nieautoryzowanym dostępem i manipulacją.
5. **Rejestracja audytowa**: HSM rejestruje wszystkie operacje kryptograficzne i próby dostępu, co może być wykorzystane do celów audytu zgodności i bezpieczeństwa.

HSM-y mogą być stosowane w różnych aplikacjach, w tym w bezpiecznych transakcjach online, certyfikatach cyfrowych, bezpiecznej komunikacji i szyfrowaniu danych. Są często używane w branżach, które wymagają wysokiego poziomu bezpieczeństwa, takich jak finanse, opieka zdrowotna i sektor publiczny.

Ogólnie rzecz biorąc, wysoki poziom bezpieczeństwa zapewniany przez HSM-y sprawia, że **jest bardzo trudno wydobyć z nich surowe klucze, a próba tego jest często uważana za naruszenie bezpieczeństwa**. Jednakże, mogą występować **pewne scenariusze**, w których **upoważniony personel może wydobyć surowy klucz** w celach specyficznych, na przykład w przypadku procedury odzyskiwania klucza.

### Wyliczanie
```
```
<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów github.

</details>
