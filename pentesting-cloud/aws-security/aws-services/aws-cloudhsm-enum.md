# AWS - CloudHSM Enum

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju oglašenu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## HSM - Modul za hardversku sigurnost

Cloud HSM je FIPS 140 nivo dva validisani **hardverski uređaj** za sigurno skladištenje kriptografskih ključeva (napomena: CloudHSM je hardverski uređaj, nije virtualizovana usluga). To je SafeNetLuna 7000 uređaj sa prethodno učitanom verzijom 5.3.13. Postoje dve verzije firmware-a i koju ćete izabrati zavisi od vaših tačnih potreba. Jedna je za FIPS 140-2 usaglašenost, a postoji i novija verzija koja se može koristiti.

Neobična karakteristika CloudHSM-a je da je fizički uređaj i stoga se **ne deli sa drugim korisnicima**, ili kako se to obično naziva, multi-tenant. To je dedikovani uređaj samo za vas koji je dostupan isključivo vašim radnim opterećenjima.

Uobičajeno, uređaj je dostupan u roku od 15 minuta, pod uslovom da ima kapaciteta, ali u nekim zonama to možda nije slučaj.

Pošto je ovo fizički uređaj posvećen vama, **ključevi se čuvaju na uređaju**. Ključevi moraju biti ili **replikovani na drugi uređaj**, rezervisani na offline skladištu ili izvezeni na rezervni uređaj. **Ovaj uređaj nije podržan** od strane S3 ili bilo koje druge usluge na AWS-u kao što je KMS.

U **CloudHSM-u**, morate **samostalno skalirati uslugu**. Morate obezbediti dovoljno CloudHSM uređaja da biste se nosili sa svojim potrebama za enkripcijom, na osnovu algoritama enkripcije koje ste izabrali za svoje rešenje.\
Skaliranje usluge upravljanja ključevima vrši AWS i automatski se prilagođava potražnji, tako da se broj CloudHSM uređaja koji su potrebni može povećavati kako raste vaše korišćenje. Imajte to u vidu prilikom skaliranja rešenja i ako vaše rešenje ima automatsko skaliranje, pobrinite se da je vaš maksimalni obim uzet u obzir sa dovoljno CloudHSM uređaja za uslugu rešenja.

Kao i skaliranje, **performanse su u vašim rukama sa CloudHSM-om**. Performanse variraju u zavisnosti od toga koji algoritam enkripcije se koristi i koliko često trebate pristupiti ili povući ključeve za enkripciju podataka. Performanse usluge upravljanja ključevima se obrađuju od strane Amazona i automatski se prilagođavaju prema potrebama potražnje. Performanse CloudHSM-a se postižu dodavanjem više uređaja, a ako vam je potrebna veća performansa, dodajte uređaje ili promenite metodu enkripcije na algoritam koji je brži.

Ako je vaše rešenje **višeregionalno**, trebali biste dodati nekoliko **CloudHSM uređaja u drugoj regiji i uspostaviti povezanost između regija putem privatne VPN veze** ili nekog drugog načina kako biste osigurali da je saobraćaj uvek zaštićen između uređaja na svakom nivou veze. Ako imate višeregionalno rešenje, morate razmisliti o tome kako **replikovati ključeve i postaviti dodatne CloudHSM uređaje u regijama u kojima radite**. Vrlo brzo možete doći u situaciju da imate šest ili osam uređaja raspoređenih u više regija, omogućavajući potpunu redundanciju vaših ključeva za enkripciju.

**CloudHSM** je usluga za skladištenje ključeva visokog nivoa za preduzeća i može se koristiti kao **osnova poverenja za preduzeće**. Može skladištiti privatne ključeve u PKI i ključeve sertifikacionih tela u X509 implementacijama. Pored simetričnih ključeva koji se koriste u simetričnim algoritmima kao što je AES, **KMS skladišti i fizički štiti samo simetrične ključeve (ne može delovati kao sertifikaciono telo)**, pa ako trebate skladištiti PKI i CA ključeve, CloudHSM ili dva ili tri uređaja mogu biti vaše rešenje.

**CloudHSM je značajno skuplji od usluge upravljanja ključevima**. CloudHSM je hardverski uređaj, pa imate fiksne troškove za obezbeđivanje CloudHSM uređaja, a zatim i trošak po satu za rad uređaja. Trošak se množi sa brojem CloudHSM uređaja koji su potrebni da bi se postigli vaši specifični zahtevi.\
Dodatno, treba uzeti u obzir kupovinu softvera treće strane kao što su SafeNet ProtectV softverski paketi i vreme i napor potreban za integraciju. Usluga upravljanja ključevima se naplaćuje na osnovu korišćenja i zavisi od broja ključeva koje imate i operacija unosa i izlaza. S obzirom na to da upravljanje ključevima omogućava besprekorno integrisanje sa mnogim AWS uslugama, troškovi integracije bi trebali biti značajno niži. Troškovi bi trebali biti sekundarni faktor u rešenjima za enkripciju. Enkripcija se obično koristi u svrhu bezbednosti i usaglašenosti.

**Samo vi imate pristup ključevima sa CloudHSM-om** i bez ulaska u previše detalja, sa CloudHSM-om upravljate sopstvenim ključevima. **Sa KMS-om, vi i Amazon zajedno upravljate ključevima**. AWS ima mnoge politike zaštite od zloupotrebe i **još uvek ne može pristupiti vašim ključevima ni u jednom od ova dva rešenja**. Glavna razlika je usaglašenost u vezi sa vlasništvom i upravljanjem ključev
### Šta je Hardverski modul za bezbednost

Hardverski modul za bezbednost (HSM) je posvećeni kriptografski uređaj koji se koristi za generisanje, skladištenje i upravljanje kriptografskim ključevima i zaštitu osetljivih podataka. Dizajniran je da pruži visok nivo bezbednosti fizičkim i elektronskim izolovanjem kriptografskih funkcija od ostatka sistema.

Način rada HSM-a može varirati u zavisnosti od specifičnog modela i proizvođača, ali generalno se javljaju sledeći koraci:

1. **Generisanje ključeva**: HSM generiše slučajni kriptografski ključ koristeći siguran generator slučajnih brojeva.
2. **Skladištenje ključeva**: Ključ je **sigurno skladišten unutar HSM-a, gde mu mogu pristupiti samo ovlašćeni korisnici ili procesi**.
3. **Upravljanje ključevima**: HSM pruža razne funkcije upravljanja ključevima, uključujući rotaciju ključeva, rezervne kopije i opoziv.
4. **Kriptografske operacije**: HSM vrši razne kriptografske operacije, uključujući šifrovanje, dešifrovanje, digitalno potpisivanje i razmenu ključeva. Ove operacije se **izvode unutar sigurnog okruženja HSM-a**, koje štiti od neovlašćenog pristupa i manipulacije.
5. **Evidencija nadzora**: HSM beleži sve kriptografske operacije i pokušaje pristupa, što se može koristiti u svrhe usklađenosti i nadzora bezbednosti.

HSM-ovi se mogu koristiti za širok spektar aplikacija, uključujući sigurne online transakcije, digitalne sertifikate, sigurne komunikacije i šifrovanje podataka. Često se koriste u industrijama koje zahtevaju visok nivo bezbednosti, kao što su finansije, zdravstvo i vlada.

Ukupno, visok nivo bezbednosti koji pružaju HSM-ovi čini **veoma teškim izvlačenje sirovih ključeva iz njih, a pokušaj takvog izvlačenja često se smatra kršenjem bezbednosti**. Međutim, mogu postojati **određeni scenariji** u kojima **ovlašćeno osoblje može izvući sirovi ključ** u specifične svrhe, kao što je slučaj postupka oporavka ključeva.

### Enumeracija
```
```
<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
