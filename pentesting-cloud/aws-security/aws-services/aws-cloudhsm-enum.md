# AWS - CloudHSM Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**를** 팔로우하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

## HSM - 하드웨어 보안 모듈

Cloud HSM은 안전한 암호화 키 저장을 위한 FIPS 140 레벨 2로 인증된 **하드웨어 장치**입니다 (CloudHSM은 하드웨어 장치로, 가상화된 서비스가 아닙니다). 이는 5.3.13이 미리 로드된 SafeNetLuna 7000 장치입니다. 두 가지 펌웨어 버전이 있으며, 선택하는 것은 정확한 요구 사항에 따라 달라집니다. 하나는 FIPS 140-2 규정을 준수하며, 사용할 수 있는 더 최신 버전도 있습니다.

CloudHSM의 특이한 기능은 이것이 물리적인 장치이기 때문에 다른 고객과 공유되지 않는다는 것입니다. 일반적으로, 장치는 15분 이내에 사용 가능하며, 용량이 있는 경우에만 가능합니다. 

이 장치는 **키가 장치에 저장**되어 있습니다. 키는 다른 장치로 복제하거나 오프라인 저장소에 백업하거나 대기 중인 장치로 내보내야 합니다. 이 장치는 S3나 KMS와 같은 AWS의 다른 서비스로 백업되지 않습니다.

**CloudHSM**에서는 서비스를 **스스로 확장**해야 합니다. 솔루션에 구현한 암호화 알고리즘에 따라 암호화에 필요한 CloudHSM 장치를 충분히 프로비저닝해야 합니다.\
Key Management Service의 확장은 AWS에서 수행되며, 수요에 따라 자동으로 확장되므로 사용량이 증가함에 따라 필요한 CloudHSM 장치의 수도 증가할 수 있습니다. 이를 고려하여 솔루션을 확장하고, 솔루션이 자동 확장되는 경우에는 충분한 CloudHSM 장치로 최대 확장이 고려되도록 해야 합니다.

확장과 마찬가지로, **성능은 CloudHSM에 달려 있습니다**. 성능은 사용하는 암호화 알고리즘과 데이터를 암호화하기 위해 키를 액세스하거나 검색하는 빈도에 따라 다릅니다. 키 관리 서비스의 성능은 Amazon에서 처리하며, 수요에 따라 자동으로 확장됩니다. CloudHSM의 성능은 장치를 추가함으로써 달성되며, 더 많은 성능이 필요한 경우 장치를 추가하거나 더 빠른 알고리즘으로 암호화 방법을 변경해야 합니다.

솔루션이 **멀티 리전**인 경우, 두 번째 리전에 여러 **CloudHSM 장치를 추가**하고, 개인 VPN 연결 또는 트래픽이 항상 보호되도록 어떤 방법으로든 교차 리전 연결을 설정해야 합니다. 멀티 리전 솔루션의 경우, 운영하는 리전에 따라 키를 복제하고 추가적인 CloudHSM 장치를 설정해야 합니다. 이렇게 하면 암호화 키의 완전한 장애 조치를 위해 여러 리전에 퍼져 있는 여섯 개 또는 여덟 개의 장치가 필요한 상황에 빠르게 진입할 수 있습니다.

**CloudHSM**은 기업용 보안 키 저장소로 사용되며, 기업의 **신뢰의 근간**으로 사용될 수 있습니다. CloudHSM은 PKI에서 개인 키와 인증서 기관 키를 저장할 수 있습니다. AES와 같은 대칭 알고리즘에서 사용되는 대칭 키만 KMS가 저장하고 물리적으로 보호합니다(인증서 기관으로 사용할 수 없음). 따라서 PKI 및 CA 키를 저장해야 하는 경우 CloudHSM을 사용할 수 있습니다.

**CloudHSM은 Key Management Service보다 상당히 비싸다**. CloudHSM은 하드웨어 장치이므로 CloudHSM 장치를 프로비저닝하는 데 고정 비용이 발생하며, 장치를 실행하는 데 시간당 비용이 발생합니다. 비용은 특정 요구 사항을 충족하기 위해 필요한 CloudHSM 장치의 수에 따라 곱해집니다.\
또한, SafeNet ProtectV 소프트웨어 스위트와 통합 시간 및 노력을 포함한 제3자 소프트웨어 구매에 대한 고려도 필요합니다. Key Management Service는 사용량에 따라 청구되며, 키의 수와 입력 및 출력 작업에 따라 달라집니다. 키 관리는 많은 AWS 서비스와 원활하게 통합되므로 통합 비용은 상당히 낮아야 합니다. 비용은 암호화 솔루션에서는 부차적인 요소로 고려되어야 합니다. 암호화는 일반적으로 보안 및 규정 준수를 위해 사용됩니다.

**CloudHSM에서는 키에 대한 액세스 권한이 오직 당신에게만 있습니다**. CloudHSM을 사용하면 자체 키 관리를 수행하므로 자세한 내용은 언급하지 않겠습니다. **KMS에서는 키를 공동으로 관리**합니다. AWS는 남용에 대한 많은 정책 보호 기능을 갖추고 있으며, 어느 솔루션에서도 키에 액세스할 수 없습니다. 주요한 차이점은 키 소유 및 관리와 관련된 규정 준수입니다. CloudHSM에서는 당신이 관리하고 유지하는 하드웨어 장치이며, 오직 당신만이 독점적으로 액세스할 수 있습니다.

### CloudHSM 제안

1. CloudHSM을 **HA 설정**으로 배포하세요. 적어도 두 개의 장치를 **별도의 가용 영역**에 배치하고 가능하면 세 번째 장치를 온프레미스나 다른 AWS 리전에 배치하세요.
2. CloudHSM을 **초기화**할 때 주의
### 하드웨어 보안 모듈(Hardware Security Module, HSM)이란?

하드웨어 보안 모듈(HSM)은 암호화 키를 생성, 저장 및 관리하고 민감한 데이터를 보호하기 위해 사용되는 전용 암호화 장치입니다. HSM은 암호화 기능을 시스템의 나머지 부분으로부터 물리적으로와 전자적으로 격리하여 높은 수준의 보안을 제공하기 위해 설계되었습니다.

HSM의 작동 방식은 특정 모델과 제조업체에 따라 다를 수 있지만, 일반적으로 다음 단계가 발생합니다:

1. **키 생성**: HSM은 안전한 난수 생성기를 사용하여 무작위 암호화 키를 생성합니다.
2. **키 저장**: 키는 **HSM 내에서 안전하게 저장되며, 권한이 있는 사용자 또는 프로세스만이 액세스할 수 있습니다**.
3. **키 관리**: HSM은 키 회전, 백업 및 폐기와 같은 다양한 키 관리 기능을 제공합니다.
4. **암호화 작업**: HSM은 암호화, 복호화, 디지털 서명 및 키 교환과 같은 다양한 암호화 작업을 수행합니다. 이러한 작업은 **HSM의 안전한 환경 내에서 수행**되며, 무단 액세스 및 조작으로부터 보호됩니다.
5. **감사 로깅**: HSM은 모든 암호화 작업 및 액세스 시도를 로그로 기록하며, 규정 준수 및 보안 감사 목적으로 사용될 수 있습니다.

HSM은 안전한 온라인 거래, 디지털 인증서, 보안 통신 및 데이터 암호화 등 다양한 응용 프로그램에 사용될 수 있습니다. 금융, 의료 및 정부와 같이 높은 수준의 보안이 필요한 산업에서 자주 사용됩니다.

전반적으로 HSM이 제공하는 높은 수준의 보안은 **HSM에서 원시 키를 추출하는 것이 매우 어렵고, 이를 시도하는 것은 보안 위반으로 간주**됩니다. 그러나 키 복구 절차와 같은 특정 목적을 위해 권한이 있는 인원에 의해 **원시 키가 추출될 수 있는 특정 시나리오**가 있을 수 있습니다.

### 열거(Enumeration)
```
```
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **Hacking 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>
