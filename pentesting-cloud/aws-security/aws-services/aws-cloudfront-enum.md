# AWS - CloudFront Enum

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もし **HackTricks で会社の広告を見たい** または **PEASS の最新バージョンにアクセスしたい** または **HackTricks を PDF でダウンロードしたい** 場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式の PEASS & HackTricks スワッグ**](https://peass.creator-spring.com) を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を見つけましょう。これは、私たちの独占的な [**NFT**](https://opensea.io/collection/the-peass-family) のコレクションです
* 💬 [**Discord グループ**](https://discord.gg/hRep4RUj7f) または [**telegram グループ**](https://t.me/peass) に参加するか、私を **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) で **フォロー** してください。
* 自分のハッキングテクニックを共有するために、[**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) の GitHub リポジトリに PR を提出してください。

</details>

## CloudFront

CloudFront は、AWS の **コンテンツ配信ネットワーク**であり、グローバルなエッジロケーションのネットワークを通じて、静的および動的なコンテンツの配信を高速化します。Amazon CloudFront を介してホストされているコンテンツへのリクエストを使用する場合、リクエストは最も低いレイテンシで最高のパフォーマンスを提供する最も近いエッジロケーションにルーティングされます。CloudFront アクセスログが有効になっている場合、ウェブサイトや配信へのアクセスをリクエストする各ユーザーからのリクエストを記録することができます。S3 アクセスログと同様に、これらのログも **Amazon S3 に耐久性と永続性のあるストレージとして保存**されます。ログの有効化自体には料金はかかりませんが、ログは S3 によって使用されるストレージに保存されるため、S3 のストレージ使用量によって料金が発生します。

ログファイルは一定期間のデータをキャプチャし、その配信には Amazon CloudFront に対して受信されるリクエストの量によって生成されるログファイルの量が依存します。これらのログファイルは S3 上で作成または書き込まれるわけではないことを知っておくことが重要です。ログファイルがいっぱいになったら、単に S3 に配信されます。**Amazon CloudFront は、これらのログを S3 に配信する準備ができるまで保持**します。再度、これらのログファイルのサイズによって、この配信には **1 時間から 24 時間**かかる場合があります。

**デフォルトでは、クッキーロギングは無効**になっていますが、有効にすることができます。

### 関数

CloudFront では関数を作成することができます。これらの関数は、**cloudfront でエンドポイント**が定義され、宣言された **NodeJS コード**が実行されます。このコードは、AWS の管理されたマシンで実行されるマシン内の **サンドボックス**で実行されます（アンダーレイイング OS に脱出するためにはサンドボックスのバイパスが必要です）。

関数はユーザーの AWS アカウントで実行されないため、IAM ロールはアタッチされていないため、この機能を悪用して直接的な特権昇格はできません。

### 列挙化
```bash
aws cloudfront list-distributions
aws cloudfront get-distribution --id <id> # Just get 1
aws cloudfront get-distribution-config --id <id>

aws cloudfront list-functions
aws cloudfront get-function --name TestFunction function_code.js

aws cloudfront list-distributions | jq ".DistributionList.Items[] | .Id, .Origins.Items[].Id, .Origins.Items[].DomainName, .AliasICPRecordals[].CNAME"
```
## 認証されていないアクセス

{% content-ref url="../aws-unauthenticated-enum-access/aws-cloudfront-unauthenticated-enum.md" %}
[aws-cloudfront-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-cloudfront-unauthenticated-enum.md)
{% endcontent-ref %}

## ポストエクスプロイテーション

{% content-ref url="../aws-post-exploitation/aws-cloudfront-post-exploitation.md" %}
[aws-cloudfront-post-exploitation.md](../aws-post-exploitation/aws-cloudfront-post-exploitation.md)
{% endcontent-ref %}

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もし **HackTricks で会社を宣伝したい** または **PEASS の最新バージョンにアクセスしたい** または **HackTricks を PDF でダウンロードしたい** 場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式の PEASS & HackTricks スワッグ**](https://peass.creator-spring.com) を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を見つけて、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを発見しましょう
* 💬 [**Discord グループ**](https://discord.gg/hRep4RUj7f) または [**telegram グループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) をフォローしましょう。
* **ハッキングのトリックを共有するために、** [**HackTricks**](https://github.com/carlospolop/hacktricks) **と** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **の GitHub リポジトリに PR を提出してください。**

</details>
