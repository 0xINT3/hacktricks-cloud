# AWS - Lambda Enum

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)\*\* рдкрд░ рдлреЙрд▓реЛ\*\* рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## рд▓реИрдореНрдмрдбрд╛

рдЕрдореЗрдЬрд╝рди рд╡реЗрдм рд╕реЗрд╡рд╛рдПрдВ (AWS) рд▓реИрдореНрдмрдбрд╛ рдХреЛ рдПрдХ **рдХрдореНрдкреНрдпреВрдЯ рд╕реЗрд╡рд╛** рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рд╕рд░реНрд╡рд░ рдкреНрд░рд╛рд╡рд┐рдзрд╛рди рдпрд╛ рдкреНрд░рдмрдВрдзрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛ рдХреЛрдб рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИред рдЗрд╕реЗ рдЙрд╕рдХреА рдХреНрд╖рдорддрд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрд╕рд╛рдзрди рдЖрд╡рдВрдЯрди** рдХрд░рдиреЗ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕реЗ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХреЛрдб рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рдВрд╕рд╛рдзрди рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЙрдЪреНрдЪ рдЙрдкрд▓рдмреНрдзрддрд╛, рдкреИрдореНрдмрд▓рд┐рддрд╛ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЬреИрд╕реА рд╕реБрд╡рд┐рдзрд╛рдПрдВ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рд▓реИрдореНрдмрдбрд╛ рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд╣рд▓реВ рдЗрд╕рдХреА рдореВрд▓реНрдп рдирд┐рд░реНрдзрд╛рд░рдг рдореЙрдбрд▓ рд╣реИ, рдЬрд╣рд╛рдВ **рд╢реБрд▓реНрдХ рдХреЗрд╡рд▓ рдХрдореНрдкреНрдпреВрдЯ рд╕рдордп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ**, рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдирд┐рд╡реЗрд╢ рдпрд╛ рджреАрд░реНрдШрдХрд╛рд▓рд┐рдХ рджрд╛рдпрд┐рддреНрд╡ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред

рд▓реИрдореНрдмрдбрд╛ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реЗ **рдЬрд┐рддрдиреА рдмрд╛рд░ рдЪрд╛рд╣реЗрдВ рдХреЙрд▓** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдХреНрд▓рд╛рдЙрдбрд╡реЙрдЪ рдХреЗ рд╕рд╛рде), **рдПрдХ URL** рдПрдВрдбрдкреЙрдЗрдВрдЯ рдЙрдЬрд╛рдЧрд░ рдХрд░реЗрдВ рдФрд░ рдХреЙрд▓ рдХрд░реЗрдВ, **API рдЧреЗрдЯрд╡реЗ** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрд▓ рдХрд░реЗрдВ рдпрд╛ рдпрд╛ **рдШрдЯрдирд╛рдУрдВ** рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреЙрд▓ рдХрд░реЗрдВ рдЬреИрд╕реЗ рдХрд┐ **S3** рдмрдХреЗрдЯ рдореЗрдВ рдбреЗрдЯрд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдпрд╛ **DynamoDB** рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЕрдкрдбреЗрдЯред

рд▓реИрдореНрдмрдбрд╛ рдХрд╛ **рдХреЛрдб** **`/var/task`** рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддрд╛ рд╣реИред

### рд▓реИрдореНрдмрдбрд╛ рдЙрдкрдирд╛рдо рд╡реЗрдЯ

рд▓реИрдореНрдмрдбрд╛ рдХреЗ рдкрд╛рд╕ **рдХрдИ рд╕рдВрд╕реНрдХрд░рдг** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рдПрдХ **рдЙрдкрдирд╛рдо** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ** рд╕рдВрд╕реНрдХрд░рдг рдЙрдЬрд╛рдЧрд░ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдЙрдкрдирд╛рдо рдХреЗ рдЕрдВрджрд░ рдЙрдЬрд╛рдЧрд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ **рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрд╕реНрдХрд░рдг** рдХреА **рд╡рдЬрди** рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдЧрд╛ **рдХрд┐ рдХреМрди рд╕рд╛ рдЙрдкрдирд╛рдо рдЖрдордВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛** (рдпрд╣ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП 90%-10% рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред рдпрджрд┐ **рдХрд┐рд╕реА** рдЙрдкрдирд╛рдо рдХрд╛ рдХреЛрдб **рд╡рдВрд╢рд╡рд╛рджреА** рд╣реИ рддреЛ рдЖрдк **рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рддрдХ рд╡рдВрд╢рд╡рд╛рджреА рд╕рдВрд╕реНрдХрд░рдг рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рддрд╛**ред

![](<../../../.gitbook/assets/image (16) (1).png>)

### рд╕рдВрд╕рд╛рдзрди рдиреАрддрд┐рдпрд╛рдБ

рд▓реИрдореНрдмрдбрд╛ рд╕рдВрд╕рд╛рдзрди рдиреАрдд

```bash
aws lambda get-account-settings

# List functions and get extra config info
aws lambda list-functions
aws lambda get-function --function-name <function_name>
aws lambda get-function-configuration --function-name <function_name>
aws lambda list-function-event-invoke-configs --function-name <function_name>
## Check for creds in env vars
aws lambda list-functions | jq '.Functions[].Environment'
## Download & check the source code
aws lambda get-function --function-name "<func_name>" --query 'Code.Location'
wget -O lambda-function.zip <url-from-previous-query>

# Get Lambda URL (if any)
aws lambda list-function-url-configs --function-name <function_name>
aws lambda get-function-url-config --function-name <function_name>

# Get who has permissions to invoke the Lambda
aws lambda get-policy --function-name <function_name>

# Versions and Aliases
aws lambda list-versions-by-function --function-name <func_name>
aws lambda list-aliases --function-name <func_name>

# List layers
aws lambda list-layers
aws lambda list-layer-versions --layer-name <name>
aws lambda get-layer-version --layer-name <name> --version-number <ver>
aws lambda get-layer-version-by-arn --arn <name> #Get external ARNs

# List other metadata
aws lambda list-event-source-mappings
aws lambda list-code-signing-configs
aws lambda list-functions-by-code-signing-config --code-signing-config-arn <arn>
```

### рд▓реИрдореНрдмрдбрд╛ рдХреЛ рдЖрд╣реНрд╡рд╛рди рдХрд░реЗрдВ

#### рдореИрдиреНрдпреБрдЕрд▓

```bash
# Invoke function
aws lambda invoke --function-name FUNCTION_NAME /tmp/out
## Some functions will expect parameters, they will access them with something like:
## target_policys = event['policy_names']
## user_name = event['user_name']
aws lambda invoke --function-name <name> --cli-binary-format raw-in-base64-out --payload '{"policy_names": ["AdministratorAccess], "user_name": "sdf"}' out.txt
```

#### рдЙрдЬрд╛рдЧрд░ рдХрд┐рдП рдЧрдП URL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

```bash
aws lambda list-function-url-configs --function-name <function_name> #Get lambda URL
aws lambda get-function-url-config   --function-name <function_name> #Get lambda URL
```

#### URL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Lambda function рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ

рдЕрдм рд╕рдордп рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд▓реИрдореНрдмрдбрд╛ рдлрдВрдХреНрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рдП:

```
aws --region us-west-2 --profile level6 lambda list-functions
```

![](<../../../.gitbook/assets/image (21) (1).png>)

рдПрдХ рд▓реИрдореНрдмрдбрд╛ рдлрдВрдХреНрд╢рди рдЬрд┐рд╕рдХрд╛ рдирд╛рдо "Level6" рд╣реИ, рдЙрдкрд▓рдмреНрдз рд╣реИред рдЪрд▓рд┐рдП рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕реЗ рдХреИрд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдП:

```bash
aws --region us-west-2 --profile level6 lambda get-policy --function-name Level6
```

![](<../../../.gitbook/assets/image (69).png>)

рдЕрдм, рдЬрдм рдЖрдк рдирд╛рдо рдФрд░ рдЖрдИрдбреА рдЬрд╛рди рдЪреБрдХреЗ рд╣реИрдВ рддреЛ рдЖрдк рдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
aws --profile level6 --region us-west-2 apigateway get-stages --rest-api-id "s33ppypa75"
```

![](<../../../.gitbook/assets/image (20).png>)

рдФрд░ рдЕрдВрдд рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдИрдбреА, рдирд╛рдо рдФрд░ рдлрд╝рдВрдХреНрд╢рди-рдирд╛рдо URL рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ): [https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6](https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6)

`URL:`**`https://<rest-api-id>.execute-api.<region>.amazonaws.com/<stageName>/<funcName>`**

#### рдЕрдиреНрдп рдЯреНрд░рд┐рдЧрд░

рдХрдИ рдЕрдиреНрдп рд╕реНрд░реЛрдд рд╣реИрдВ рдЬреЛ рд▓реИрдореНрдмрдбрд╛ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

<figure><img src="../../../.gitbook/assets/image (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

### Privesc

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрд░ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рд▓реИрдореНрдмрдбрд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░реЗрдВ**:

{% content-ref url="../aws-privilege-escalation/aws-lambda-privesc.md" %}
[aws-lambda-privesc.md](../aws-privilege-escalation/aws-lambda-privesc.md)
{% endcontent-ref %}

### рдЕрдЕрдереЗрдВрдЯрд┐рдХреЗрдЯреЗрдб рдПрдХреНрд╕реЗрд╕

{% content-ref url="../aws-unauthenticated-enum-access/aws-lambda-unauthenticated-access.md" %}
[aws-lambda-unauthenticated-access.md](../aws-unauthenticated-enum-access/aws-lambda-unauthenticated-access.md)
{% endcontent-ref %}

### рдкреЛрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

{% content-ref url="../aws-post-exploitation/aws-lambda-post-exploitation/" %}
[aws-lambda-post-exploitation](../aws-post-exploitation/aws-lambda-post-exploitation/)
{% endcontent-ref %}

### рд╕реНрдерд┐рд░рддрд╛

{% content-ref url="../aws-persistence/aws-lambda-persistence/" %}
[aws-lambda-persistence](../aws-persistence/aws-lambda-persistence/)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-layer](https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-layer)
* [https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/](https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/)

<details>

<summary><strong>рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ рдПрдбрдмреНрд▓реНрдпреВрдПрд╕ рд╕реЗ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **PDF рдореЗрдВ HackTricks рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live) рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
