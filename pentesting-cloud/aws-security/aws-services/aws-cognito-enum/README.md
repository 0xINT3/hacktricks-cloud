# AWS - Enumera√ß√£o do Cognito

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou se deseja acessar a **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegrama**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>

## Cognito

O Cognito fornece **autentica√ß√£o, autoriza√ß√£o e gerenciamento de usu√°rios** para seus aplicativos da web e m√≥veis. Seus usu√°rios podem fazer login diretamente com um **nome de usu√°rio e senha**, ou por meio de um **terceiro** como Facebook, Amazon, Google ou Apple.

Os dois principais componentes do Amazon Cognito s√£o os **pools de usu√°rios** e os **pools de identidades**. Os **pools de usu√°rios** s√£o diret√≥rios de usu√°rios que fornecem **op√ß√µes de registro e login para os usu√°rios do seu aplicativo**. Os **pools de identidades** permitem que voc√™ **conceda aos seus usu√°rios acesso a outros servi√ßos da AWS**.

### **Pools de usu√°rios**

Para saber o que √© um **Pool de Usu√°rios do Cognito, verifique**:

{% content-ref url="cognito-user-pools.md" %}
[cognito-user-pools.md](cognito-user-pools.md)
{% endcontent-ref %}

### **Pools de identidades**

Para saber o que √© um **Pool de Identidades do Cognito, verifique**:

{% content-ref url="cognito-identity-pools.md" %}
[cognito-identity-pools.md](cognito-identity-pools.md)
{% endcontent-ref %}

## Enumera√ß√£o

{% code overflow="wrap" %}
```bash
# Listar Pools de Identidades
aws cognito-identity list-identity-pools --max-results 60
aws cognito-identity describe-identity-pool --identity-pool-id "eu-west-2:38b294756-2578-8246-9074-5367fc9f5367"
aws cognito-identity list-identities --identity-pool-id <ident-pool-id> --max-results 60
aws cognito-identity get-identity-pool-roles --identity-pool-id <ident-pool-id>

# Conjuntos de dados de identidades
## Obter conjunto de dados do id de identidade (dentro do pool de identidades)
aws cognito-sync list-datasets --identity-pool-id <ident-pool-id> --identity-id <ident-id>
## Obter informa√ß√µes do conjunto de dados
aws cognito-sync describe-dataset --identity-pool-id <value> --identity-id <value> --dataset-name <value>
## Obter registros do conjunto de dados
aws cognito-sync list-records --identity-pool-id <value> --identity-id <value> --dataset-name <value>

# Pools de usu√°rios
## Obter pools
aws cognito-idp list-user-pools --max-results 60

## Obter usu√°rios
aws cognito-idp list-users --user-pool-id <user-pool-id>

## Obter grupos
aws cognito-idp list-groups --user-pool-id <user-pool-id>

## Obter usu√°rios em um grupo
aws cognito-idp list-users-in-group --user-pool-id <user-pool-id> --group-name <group-name>

## Listar IDs de aplicativos de um pool de usu√°rios
aws cognito-idp list-user-pool-clients --user-pool-id <user-pool-id>

## Listar provedores de identidade configurados para um pool de usu√°rios
aws cognito-idp list-identity-providers --user-pool-id <user-poo

## Listar trabalhos de importa√ß√£o de usu√°rios
aws cognito-idp list-user-import-jobs --user-pool-id <user-pool-id> --max-results 60

## Obter configura√ß√£o MFA de um pool de usu√°rios
aws cognito-idp get-user-pool-mfa-config --user-pool-id <user-pool-id>

## Obter configura√ß√£o de risco
aws cognito-idp describe-risk-configuration --user-pool-id <user-pool-id>
```
{% endcode %}

### Enumera√ß√£o n√£o autenticada de Pools de Identidades

Apenas **conhecendo o ID do Pool de Identidades**, voc√™ pode ser capaz de **obter credenciais da fun√ß√£o associada a usu√°rios n√£o autenticados** (se houver). [**Verifique como aqui**](cognito-identity-pools.md#accessing-iam-roles).

### Enumera√ß√£o n√£o autenticada de Pools de Usu√°rios

Mesmo que voc√™ **n√£o saiba um nome de usu√°rio v√°lido** dentro do Cognito, voc√™ pode ser capaz de **enumerar** nomes de usu√°rio v√°lidos, **BF** as **senhas** ou at√© mesmo **registrar um novo usu√°rio** apenas **conhecendo o ID do cliente do aplicativo** (que geralmente √© encontrado no c√≥digo-fonte). [**Verifique como aqui**](cognito-user-pools.md#registration)**.**

## Privesc

{% content-ref url="../../aws-privilege-escalation/aws-cognito-privesc.md" %}
[aws-cognito-privesc.md](../../aws-privilege-escalation/aws-cognito-privesc.md)
{% endcontent-ref %}

## Acesso n√£o autenticado

{% content-ref url="../../aws-unauthenticated-enum-access/aws-cognito-unauthenticated-enum.md" %}
[aws-cognito-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-cognito-unauthenticated-enum.md)
{% endcontent-ref %}

## Persist√™ncia

{% content-ref url="../../../aws-pentesting/aws-persistence/aws-cognito-persistence.md" %}
[aws-cognito-persistence.md](../../../aws-pentesting/aws-persistence/aws-cognito-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Apoie o HackTricks e obtenha benef√≠cios!</strong></summary>

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou se deseja acessar a **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegrama**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>