# AWS - Uchambuzi wa DynamoDB

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## DynamoDB

### Taarifa Msingi

Amazon DynamoDB inapendekezwa na AWS kama **database ya NoSQL ya aina ya kuhifadhi, bila seva, yenye thamani ya msingi**, iliyoundwa kwa ajili ya kuendesha programu zenye utendaji wa juu bila kujali ukubwa wao. Huduma hii inahakikisha vipengele imara ikiwa ni pamoja na hatua za usalama asili, nakala rudufu isiyosimama, nakala rudufu iliyowekwa kiotomatiki katika mikoa mingi, uwekaji wa cache ya kumbukumbu, na zana za kuuza data kwa urahisi.

Katika muktadha wa DynamoDB, badala ya kuanzisha database ya jadi, **meza huanzishwa**. Kila meza inahitaji maelezo ya **funguo la sehemu** kama sehemu muhimu ya **funguo kuu la meza**. Funguo hili la sehemu, kimsingi **thamani ya hash**, inacheza jukumu muhimu katika kupata vitu na usambazaji wa data kote kwenye wenyewe. Usambazaji huu ni muhimu kwa ajili ya kudumisha uwezo na upatikanaji wa database. Aidha, kuna chaguo la kuingiza **funguo la aina** ili kuboresha zaidi utaratibu wa data.

### Ufichaji

Kwa chaguo-msingi, DynamoDB hutumia ufunguo wa KMS ambao \*\*unamilikiwa na Amazon DynamoDB,\*\*hata sio ufunguo uliosimamiwa na AWS ambao angalau unamilikiwa na akaunti yako.

<figure><img src="https://lh4.googleusercontent.com/JjtNS7aA-_GRMgZb4v93jWEQJi6DQdUPq0FEpzZPdeyCeNoG05p0NJiV9Zs-ULs_-Tfjmx0W1ZgsE2Ui2ljo7D-1a87Xny-gpLVQO0XmXdFoph9ci1RepbVNwaCe9oPruEZSEDxGTxF5dIv6pW1WpT6kWA=s2048" alt=""><figcaption></figcaption></figure>

### Nakala Rudufu & Kuuza kwa S3

Inawezekana **kupanga** kizazi cha **nakala rudufu za meza** au kuziumba **kwa ombi**. Zaidi ya hayo, pia inawezekana kuwezesha **Kurejesha Wakati wa Muda (PITR) kwa meza.** Kurejesha wakati wa muda hutoa **nakala rudufu** endelevu ya data yako ya DynamoDB kwa **siku 35** ili kukusaidia kulinda dhidi ya operesheni za kuandika au kufuta kwa bahati mbaya.

Pia inawezekana kuuza **data ya meza kwenda S3**, lakini meza inahitaji kuwa na **PITR imewezeshwa**.

### GUI

Kuna GUI kwa huduma za Dynamo za ndani kama [DynamoDB Local](https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/), [dynalite](https://github.com/mhart/dynalite), [localstack](https://github.com/localstack/localstack), n.k, ambazo zinaweza kuwa na manufaa: [https://github.com/aaronshaf/dynamodb-admin](https://github.com/aaronshaf/dynamodb-admin)

### Uchambuzi
```bash
# Tables
aws dynamodb list-tables
aws dynamodb describe-table --table-name <t_name> #Get metadata info
## The primary key and sort key will appear inside the KeySchema field

#Check if point in time recovery is enabled
aws dynamodb describe-continuous-backups \
--table-name tablename

# Backups
aws dynamodb list-backups
aws dynamodb describe-backup --backup-arn <arn>
aws dynamodb describe-continuous-backups --table-name <t_name>

# Global tables
aws dynamodb list-global-tables
aws dynamodb describe-global-table --global-table-name <name>

# Exports
aws dynamodb list-exports
aws dynamodb describe-export --export-arn <arn>

# Misc
aws dynamodb describe-endpoints #Dynamodb endpoints
```
### Upatikanaji usiothibitishwa

{% content-ref url="../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md" %}
[aws-dynamodb-unauthenticated-access.md](../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-dynamodb-privesc.md" %}
[aws-dynamodb-privesc.md](../aws-privilege-escalation/aws-dynamodb-privesc.md)
{% endcontent-ref %}

### Baada ya Uvamizi

{% content-ref url="../aws-post-exploitation/aws-dynamodb-post-exploitation.md" %}
[aws-dynamodb-post-exploitation.md](../aws-post-exploitation/aws-dynamodb-post-exploitation.md)
{% endcontent-ref %}

### Uthabiti

{% content-ref url="../aws-persistence/aws-dynamodb-persistence.md" %}
[aws-dynamodb-persistence.md](../aws-persistence/aws-dynamodb-persistence.md)
{% endcontent-ref %}

## Uvamizi wa DynamoDB

### Uvujaji wa SQL

Kuna njia za kupata data ya DynamoDB na **muundo wa SQL**, hivyo, **uvujaji wa SQL wa kawaida pia ni wa kawaida**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

### Uvujaji wa NoSQL

Katika DynamoDB **masharti** tofauti yanaweza kutumika kufikia data, kama katika Uvujaji wa kawaida wa NoSQL ikiwa ni **inawezekana kuunganisha masharti zaidi** kufikia data unaweza kupata data iliyofichwa (au kudump meza nzima).\
Unaweza kupata hapa masharti yanayoungwa mkono na DynamoDB: [https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html)

Tambua kwamba **masharti tofauti** yanauungwa mkono ikiwa data inafikiwa kupitia **`query`** au kupitia **`scan`**.

{% hint style="info" %}
Kwa kweli, hatua za **Utafutaji** inahitaji kutaja **masharti "EQ" (sawa)** katika **msingi** wa funguo ili kufanya kazi, ikifanya iwe **chini ya uwezekano wa Uvujaji wa NoSQL** (na pia kufanya operesheni iwe ya kikomo sana).
{% endhint %}

Ikiwa unaweza **kubadilisha kulinganisha** lililofanywa au kuongeza mpya, unaweza kupata data zaidi.
```bash
# Comparators to dump the database
"NE": "a123" #Get everything that doesn't equal "a123"
"NOT_CONTAINS": "a123" #What you think
"GT": " " #All strings are greater than a space
```
### Kuingiza Json moja kwa moja

**DynamoDB** inakubali vitu vya **Json** kutafuta data ndani ya DB. Ikiwa utagundua unaweza kuandika kwenye kipengee cha json kilichotumwa kutafuta, unaweza kufanya DB itoe, yaliyomo yote.

Kwa mfano, kuingiza katika ombi kama:
```bash
'{"Id": {"ComparisonOperator": "EQ","AttributeValueList": [{"N": "' + user_input + '"}]}}'
```
{% endcode %}

Mshambuliaji anaweza kuingiza kitu kama hiki:

`1000"}],"ComparisonOperator": "GT","AttributeValueList": [{"N": "0`

sahihisha hali ya "EQ" kutafuta kitambulisho 1000 na kisha kutafuta data zote na kitambulisho cha nambari kubwa kuliko 0, ambayo ni zote.

### :property Injection

Baadhi ya SDK huruhusu kutumia string inayoonyesha uchujaji utakaofanywa kama:
```java
new ScanSpec().withProjectionExpression("UserName").withFilterExpression(user_input+" = :username and Password = :password").withValueMap(valueMap)
```
{% endcode %}

Unahitaji kujua kwamba kutafuta katika DynamoDB kwa **kubadilisha** thamani ya sifa katika **maelezo ya kuchuja** wakati wa kutafuta vitu, vidole vinapaswa **kuanza** na herufi **`:`**. Vidole kama hivyo vitabadilishwa na **thamani halisi ya sifa wakati wa uendeshaji**.

Kwa hivyo, kuingia kama ile ya awali inaweza kuepukwa na kitu kama hiki:
```bash
:username = :username or :username
# This will generate the query:
# :username = :username or :username = :username and Password = :password
# which is always true
```
<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
