# AWS - DynamoDB Enum

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## DynamoDB

### Basiese Inligting

Amazon DynamoDB word deur AWS aangebied as 'n **volledig bestuurde, serverlose, sleutel-waarde NoSQL-databasis**, wat geskik is vir die aandryf van ho√´-prestasie-toepassings ongeag hul grootte. Die diens verseker robuuste funksies, insluitend inherente sekuriteitsmaatre√´ls, ononderbroke rugsteun, outomatiese replikasie oor verskeie streke, ge√Øntegreerde in-memory caching, en gerieflike data-uitvoerhulpmiddels.

In die konteks van DynamoDB, in plaas van die skep van 'n tradisionele databasis, word **tabelle geskep**. Elke tabel vereis die spesifikasie van 'n **partisie sleutel** as 'n integrale komponent van die **tabel se prim√™re sleutel**. Hierdie partisie sleutel, essensieel 'n **hash-waarde**, speel 'n kritieke rol in beide die herwinning van items en die verspreiding van data oor verskillende gasheerstelsels. Hierdie verspreiding is noodsaaklik vir die handhawing van skaalbaarheid en beskikbaarheid van die databasis. Daar is ook 'n opsie om 'n **sorteersleutel** in te sluit om data-organisasie verder te verfyn.

### Versleuteling

Standaard gebruik DynamoDB 'n KMS-sleutel wat **aan Amazon DynamoDB behoort**, nie eens die AWS-bestuurde sleutel wat ten minste aan jou rekening behoort nie.

<figure><img src="https://lh4.googleusercontent.com/JjtNS7aA-_GRMgZb4v93jWEQJi6DQdUPq0FEpzZPdeyCeNoG05p0NJiV9Zs-ULs_-Tfjmx0W1ZgsE2Ui2ljo7D-1a87Xny-gpLVQO0XmXdFoph9ci1RepbVNwaCe9oPruEZSEDxGTxF5dIv6pW1WpT6kWA=s2048" alt=""><figcaption></figcaption></figure>

### Rugsteun & Uitvoer na S3

Dit is moontlik om die generering van **tabelrugsteun** te **skeduleer** of dit op **aanvraag** te skep. Dit is ook moontlik om **Punt-in-tyd-herstel (PITR) vir 'n tabel in te skakel.** Punt-in-tyd-herstel bied voortdurende **rugsteun** van jou DynamoDB-data vir **35 dae** om jou te help beskerm teen toevallige skryf- of verwyderingshandelinge.

Dit is ook moontlik om **die data van 'n tabel na S3 uit te voer**, maar die tabel moet **PITR ingeskakel** h√™.

### GUI

Daar is 'n GUI vir plaaslike Dynamo-diensverskaffers soos [DynamoDB Local](https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/), [dynalite](https://github.com/mhart/dynalite), [localstack](https://github.com/localstack/localstack), ens., wat nuttig kan wees: [https://github.com/aaronshaf/dynamodb-admin](https://github.com/aaronshaf/dynamodb-admin)

### Enumerasie

```bash
# Tables
aws dynamodb list-tables
aws dynamodb describe-table --table-name <t_name> #Get metadata info
## The primary key and sort key will appear inside the KeySchema field

#Check if point in time recovery is enabled
aws dynamodb describe-continuous-backups \
--table-name tablename

# Backups
aws dynamodb list-backups
aws dynamodb describe-backup --backup-arn <arn>
aws dynamodb describe-continuous-backups --table-name <t_name>

# Global tables
aws dynamodb list-global-tables
aws dynamodb describe-global-table --global-table-name <name>

# Exports
aws dynamodb list-exports
aws dynamodb describe-export --export-arn <arn>

# Misc
aws dynamodb describe-endpoints #Dynamodb endpoints
```

### Ongeverifieerde Toegang

{% content-ref url="../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md" %}
[aws-dynamodb-unauthenticated-access.md](../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md)
{% endcontent-ref %}

### Privilege Escalation

{% content-ref url="../aws-privilege-escalation/aws-dynamodb-privesc.md" %}
[aws-dynamodb-privesc.md](../aws-privilege-escalation/aws-dynamodb-privesc.md)
{% endcontent-ref %}

### Post Exploitatie

{% content-ref url="../aws-post-exploitation/aws-dynamodb-post-exploitation.md" %}
[aws-dynamodb-post-exploitation.md](../aws-post-exploitation/aws-dynamodb-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../aws-persistence/aws-dynamodb-persistence.md" %}
[aws-dynamodb-persistence.md](../aws-persistence/aws-dynamodb-persistence.md)
{% endcontent-ref %}

## DynamoDB Injeksie

### SQL Injeksie

Daar is maniere om toegang tot DynamoDB-data te verkry met **SQL-sintaksis**, daarom is tipiese **SQL-injeksies ook moontlik**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

### NoSQL Injeksie

In DynamoDB kan verskillende **voorwaardes** gebruik word om data op te haal, soos in 'n tipiese NoSQL Injeksie, as dit moontlik is om **meer voorwaardes te koppel om** data op te haal, kan jy verborge data verkry (of die hele tabel aflaai).\
Hier kan jy die voorwaardes vind wat ondersteun word deur DynamoDB: [https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html)

Let daarop dat **verskillende voorwaardes** ondersteun word as die data toegang kry via **`query`** of via **`scan`**.

{% hint style="info" %}
Tans moet **Query**-aksies die **voorwaarde "EQ" (gelyk aan)** spesifiseer in die **prim√™re** sleutel om te werk, wat dit baie **minder vatbaar vir NoSQL-injeksies** maak (en maak ook die operasie baie beperk).
{% endhint %}

As jy die **vergelyking** wat uitgevoer word kan **verander** of nuwes kan byvoeg, kan jy meer data ophaal.

```bash
# Comparators to dump the database
"NE": "a123" #Get everything that doesn't equal "a123"
"NOT_CONTAINS": "a123" #What you think
"GT": " " #All strings are greater than a space
```

{% embed url="https://book.hacktricks.xyz/pentesting-web/nosql-injection" %}

### Roh Json-injeksie

**DynamoDB** aanvaar **Json**-voorwerpe om data binne die DB te **soek**. As jy vind dat jy kan skryf in die json-voorwerp wat gestuur word om te soek, kan jy die DB-dump maak, al die inhoud.

Byvoorbeeld, deur in 'n versoek soos die volgende in te spuit:

{% code overflow="wrap" %}
```bash
'{"Id": {"ComparisonOperator": "EQ","AttributeValueList": [{"N": "' + user_input + '"}]}}'
```
{% endcode %}

'n aanvaller kan iets soos die volgende inspuit:

`1000"}],"ComparisonOperator": "GT","AttributeValueList": [{"N": "0`

herstel die "EQ" toestand wat soek na die ID 1000 en dan kyk na al die data met 'n Id-string groter as 0, wat alles is.

### :property Injeksie

Sommige SDK's maak dit moontlik om 'n string te gebruik wat die filter wat uitgevoer moet word, aandui, soos:

```java
new ScanSpec().withProjectionExpression("UserName").withFilterExpression(user_input+" = :username and Password = :password").withValueMap(valueMap)
```

Jy moet weet dat as jy in DynamoDB soek vir die **vervanging** van 'n attribuut **waarde** in **filter uitdrukkings** terwyl jy die items skandeer, die tokens moet **begin** met die **`:`** karakter. Sulke tokens sal by die uitvoering **vervang** word met die werklike **attribuutwaarde**.

Daarom kan 'n login soos die vorige een omseil word met iets soos:

```bash
:username = :username or :username
# This will generate the query:
# :username = :username or :username = :username and Password = :password
# which is always true
```

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
