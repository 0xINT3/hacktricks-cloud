# AWS - GuardDuty Enum

<details>

<summary><strong>рдмрдврд╝рд┐рдпрд╛ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## GuardDuty

[**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реА**](https://aws.amazon.com/guardduty/features/) рдХреЗ рдЕрдиреБрд╕рд╛рд░: GuardDuty, AWS рдФрд░ рдЙрджреНрдпреЛрдЧ-рдкреНрд░рдореБрдЦ рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реНрд░реЛрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, **рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ, рдЕрдиреЛрдорд▓реА рдбрд┐рдЯреЗрдХреНрд╢рди, рдиреЗрдЯрд╡рд░реНрдХ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдФрд░ рдЦрддрд░рдирд╛рдХ рдлрд╝рд╛рдЗрд▓ рдЦреЛрдЬ** рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рдЬреЛ AWS рдкрд░ рдХрд╛рд░реНрдпрднреВрдорд┐ рдФрд░ рдбреЗрдЯрд╛ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред GuardDuty, AWS CloudTrail рдШрдЯрдирд╛ рд▓реЙрдЧ, Amazon Virtual Private Cloud (VPC) рдлрд╝реНрд▓реЛ рд▓реЙрдЧ, Amazon Elastic Kubernetes Service (EKS) рдСрдбрд┐рдЯ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рд╕реНрддрд░ рдХреЗ рд▓реЙрдЧ, рдФрд░ DNS рдХреНрд╡реЗрд░реА рд▓реЙрдЧ рдЬреИрд╕реЗ рдХрдИ AWS рдбреЗрдЯрд╛ рд╕реНрд░реЛрддреЛрдВ рдкрд░ рджрд╕ рдЕрд░рдмреЛрдВ рдШрдЯрдирд╛рдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддрд╛ рд╣реИред

Amazon GuardDuty **рдЖрдкрдХреЗ рдЦрд╛рддреЛрдВ рдореЗрдВ рдЕрд╕рд╛рдорд╛рдиреНрдп рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддрд╛ рд╣реИ**, рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреА **рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзрд┐рддрддрд╛** рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ рдЖрд╡реЛрдХ рдХрд┐рдП рдЬрд╛рдиреЗ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рджреЗрддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рддрд╛ рд╡рд╛рд▓реЗ рдХреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдорд┐рд▓рддреА рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЙрдиреНрд╣реЗрдВ рдЖрдЧреЗ рдЬрд╛рдВрдЪ рдкрд░ рд╕рдордп рдмрд┐рддрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЕрд▓рд░реНрдЯреНрд╕ **GuardDuty рдХрдВрд╕реЛрд▓ (90 рджрд┐рди)** рдФрд░ CloudWatch рдЗрд╡реЗрдВрдЯреНрд╕ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВред

{% hint style="warning" %}
рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **GuardDuty рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдпрд╣ рдЖрдкрдХреЗ AWS рдкрд░реНрдпрд╛рд╡рд░рдг рдХреА рдирд┐рдЧрд░рд╛рдиреА рдмрдВрдж рдХрд░ рджреЗрдЧрд╛ рдФрд░ рдпрд╣ рдХреЛрдИ рдирдИ рдЦреЛрдЬ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдФрд░ **рдореМрдЬреВрджрд╛ рдЦреЛрдЬ рдЦреЛ рдЬрд╛рдПрдВрдЧреА**ред\
рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рдмрд╕ рд░реЛрдХ рджреЗрддреЗ рд╣реИрдВ, рддреЛ рдореМрдЬреВрджрд╛ рдЦреЛрдЬ рдмрдиреА рд░рд╣реЗрдЧреАред
{% endhint %}

### рдЦреЛрдЬ рдХрд╛ рдЙрджрд╛рд╣рд░рдг

* **рд░рд┐рдХреЙрдиреИрд╕реЗрдВрд╕**: рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рд░рд┐рдХреЙрдиреИрд╕реЗрдВрд╕ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрдиреЗ рд╡рд╛рд▓реА рдЧрддрд┐рд╡рд┐рдзрд┐, рдЬреИрд╕реЗ **рдЕрд╕рд╛рдорд╛рдиреНрдп API рдЧрддрд┐рд╡рд┐рдзрд┐**, рд╕рдВрджрд┐рдЧреНрдз рдбреЗрдЯрд╛рдмреЗрд╕ **рд▓реЙрдЧрд┐рди** рдкреНрд░рдпрд╛рд╕, рдЗрдВрдЯреНрд░рд╛-VPC **рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд┐рдВрдЧ**, рдЕрд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдлрд▓ рд▓реЙрдЧрд┐рди рдЕрдиреБрд░реЛрдз рдкреИрдЯрд░реНрди, рдпрд╛ рдПрдХ рдЬреНрдЮрд╛рдд рдмреБрд░реЗ IP рд╕реЗ рдЕрдирдмреНрд▓реЙрдХреНрдб рдкреЛрд░реНрдЯ рдкреНрд░реЛрдмрд┐рдВрдЧред
* **рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝**: рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐, рдЬреИрд╕реЗ **рдХреНрд░рд┐рдкреНрдЯреЛрдХрд░реЗрдВрд╕реА рдорд╛рдЗрдирд┐рдВрдЧ, рдмреИрдХрдбреЛрд░ рдХрдорд╛рдВрдб рдПрдВрдб рдХрдВрдЯреНрд░реЛрд▓ (C\&C)** рдЧрддрд┐рд╡рд┐рдзрд┐, рдбреЛрдореЗрди рдЬрдирд░реЗрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо (DGA) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореИрд▓рд╡реЗрдпрд░, рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдбрд┐рдирд╛рдпрд▓ рдСрдл рд╕рд░реНрд╡рд┐рд╕ рдЧрддрд┐рд╡рд┐рдзрд┐, рдЕрд╕рд╛рдорд╛рдиреНрдп **рдЙрдЪреНрдЪ рдиреЗрдЯрд╡рд░реНрдХ** рдЯреНрд░реИрдлрд╝рд┐рдХ рдЖрдпрд╛рдо, рдЕрд╕рд╛рдорд╛рдиреНрдп рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓, рдЬреНрдЮрд╛рдд рджреБрд╖реНрдЯ IP рдХреЗ рд╕рд╛рде рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕рдВрдЪрд╛рд░, рдмрд╛рд╣рд░реА IP рдкрддреЗ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдЕрд╕реНрдерд╛рдпреА Amazon EC2 рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕, рдФрд░ DNS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛ред
* **рдЦрд╛рддрд╛ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝**: рдЦрд╛рддрд╛ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рд╛рдорд╛рдиреНрдп рдкреИрдЯрд░реНрди рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: рдЕрд╕рд╛рдорд╛рдиреНрдп рднреВрдЧреЛрд▓ рд╕реЗ рдпрд╛ рдЫрд┐рдкрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗ API рдХреЙрд▓, AWS CloudTrail рд▓реЙрдЧрд┐рдВрдЧ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕, рдЦрд╛рддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐ рдХреЛ рдХрдордЬреЛрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдмрджрд▓рд╛рд╡, рдЕрд╕рд╛рдорд╛рдиреНрдп рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдпрд╛ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рд▓реЙрдиреНрдЪ, рдЕрд╕рд╛рдорд╛рдиреНрдп рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ, рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдЪреЛрд░реА, рд╕рдВрджрд┐рдЧреНрдз рдбреЗрдЯрд╛рдмреЗрд╕ рд▓реЙрдЧрд┐рди рдЧрддрд┐рд╡рд┐рдзрд┐, рдФрд░ рдЬреНрдЮрд╛рдд рджреБрд╖реНрдЯ IP рдкрддреЛрдВ рд╕реЗ API рдХреЙрд▓ред
* **рдмрдХреЗрдЯ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝**: рдмрдХреЗрдЯ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐, рдЬреИрд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рджреБрд░реБрдк
```bash
# Get Org config
aws guardduty list-organization-admin-accounts #Get Delegated Administrator
aws guardduty describe-organization-configuration --detector-id <id>

# Check external invitations
aws guardduty list-invitations
aws guardduty get-invitations-count

# Detector Information
aws guardduty list-detectors # 1 detector per account with GuardDuty
aws guardduty get-detector --detector-id <id> # Get detector info
aws guardduty get-master-account --detector-id <id>

# Get filters
aws guardduty list-filters --detector-id <id> # Check filters
aws guardduty get-filter --detector-id <id> --filter-name <name>

# Findings
aws guardduty list-findings --detector-id <id> # List findings
aws guardduty get-findings --detector-id <id> --finding-ids <id> # Get details about the finding
aws guardduty get-findings-statistics --detector-id <id> --finding-statistic-types <types>

# Get trusted IP addresses
aws guardduty list-ip-sets --detector-id <id>
aws guardduty get-ip-set --detector-id <id>

# Member accounts of the current AWS GuardDuty master account
aws guardduty list-members --detector-id <id>
aws guardduty get-members --detector-id <id> --account-ids <id>
aws guardduty get-member-detectors --detector-id <id> --account-ids <id>

# Continuously export its findings to an Amazon S3 bucket
aws guardduty list-publishing-destinations --detector-id <id>

# Intelligence sets that you have uploaded to GuardDuty
aws guardduty list-threat-intel-sets --detector-id <id>
aws guardduty get-threat-intel-set --detector-id <id> --threat-intel-set-id <id>
```
{% endcode %}

## GuardDuty рдмрд╛рдИрдкрд╛рд╕

### рд╕рд╛рдорд╛рдиреНрдп рдорд╛рд░реНрдЧрджрд░реНрд╢рди

рдЙрди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд┐рддрдиреА рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ рдЬрд╛рдиреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ:

* рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рддрдиреА рдмрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
* рд╕реНрдерд╛рди
* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ / рд╕реЗрд╡рд╛рдПрдВ (рдпрд╣ awscli, webconsole, lambda рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ...)
* рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЕрдиреБрдорддрд┐рдпрд╛рдВ

рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде, рдкрд╣реБрдВрдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐ рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ рдкреБрдирд░реНрд╕реГрдЬрд┐рдд рдХрд░реЗрдВ:

* рдпрджрд┐ рдпрд╣ рдПрдХ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рднреВрдорд┐рдХрд╛** рд╣реИ, рддреЛ рдЗрд╕реЗ рдЙрд╕реА рдШрдВрдЯреЛрдВ рдореЗрдВ, рдЙрд╕реА рднреМрдЧреЛрд▓рд┐рдХ рд╕реНрдерд╛рди рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ (рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рд╡рд╣реА ISP рдФрд░ IP рднреА)
* рдпрджрд┐ рдпрд╣ рдПрдХ **рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рднреВрдорд┐рдХрд╛** рд╣реИ, рддреЛ рдЙрд╕реА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЙрд╕реА рд╕рдордп рд╕реАрдорд╛рдУрдВ рдореЗрдВ рдЙрд╕реА рд╕реЗрд╡рд╛ рдХреЛ рдмрдирд╛рдПрдВ рдФрд░ рдЙрд╕рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
* рд╣рдореЗрд╢рд╛ рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдХрд┐ рдЗрд╕ рдкреНрд░рдореБрдЦ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА **рд╡рд╣реА рдЕрдиреБрдорддрд┐рдпрд╛рдВ** рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
* рдпрджрд┐ рдЖрдкрдХреЛ **рдЕрдиреНрдп рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдпрд╛ рдЕрдиреБрдорддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 1,000,000 рдХреНрд▓рд╛рдЙрдбрдЯреНрд░реЗрд▓ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ), рддреЛ рдЗрд╕реЗ **рдзреАрд░реЗ-рдзреАрд░реЗ** рдФрд░ **AWS рдХреЗ рд╕рд╛рде рдиреНрдпреВрдирддрдо рд╕рдВрд╡рд╛рджреЛрдВ** рдХреЗ рд╕рд╛рде рдХрд░реЗрдВ (awscli рдХрднреА-рдХрднреА рд▓рд┐рдЦрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХрдИ рдкрдарди API рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ)

### GuardDuty рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ

#### `guardduty:ListDetectors`, `guardduty:UpdateDetector`

рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЖрдк рдЪреЗрддрд╛рд╡рдиреА рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП GuardDuty рдХреЛ рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
# Disabling the detector
aws guardduty update-detector \
--detector-id <detector-id> \
--no-enable

# Removing s3 as a log source
aws guardduty update-detector \
--detector-id <detector-id> \
--data-sources S3Logs={Enable=false}

# Increase finding update time to 6 hours
aws guardduty update-detector \
--detector-id <detector-id> \
--finding-publishing-frequency SIX_HOURS
```
#### `guardduty:ListDetectors`, `guardduty:ListIPSet`, `iam:PutRolePolicy`, (`guardduty:CreateIPSet`|`guardduty:UpdateIPSet`)

рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрддреА рдЧрд╛рд░реНрдбрдбреНрдпреВрдЯреА рдХреА [рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдЖрдИрдкреА рд╕реВрдЪреА](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_upload-lists.html) рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ **рдЕрдкрдирд╛ рдЖрдИрдкреА рд╕реВрдЪреА рдореЗрдВ рд╢рд╛рдорд┐рд▓** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдЖрдИрдкреА рд╕реВрдЪреА рдореЗрдВ рдХреЛрдИ рднреА рдЖрдИрдкреА рдХреНрд▓рд╛рдЙрдбрдЯреНрд░реЗрд▓ рдпрд╛ рд╡реАрдкреАрд╕реА рдлреНрд▓реЛ рд▓реЙрдЧ рдЕрд▓рд░реНрдЯ рдЙрдард╛рдП рдирд╣реАрдВ рдЬрд╛рдПрдВрдЧреЗред

{% hint style="info" %}
рдбреАрдПрдирдПрд╕ рдлрд╛рдЗрдВрдбрд┐рдВрдЧреНрд╕ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдЖрдИрдкреА рд╕реВрдЪреА рд╕реЗ рдореБрдХреНрдд рд╣реИрдВред
{% endhint %}
```bash
aws guardduty update-ip-set \
--detector-id <detector-id> \
--ip-set-id 24adjigdk34290840348exampleiplist \
--location https://malicious-bucket.s3-us-east-1.amazonaws.com/customiplist.csv \
--activate
```
{% hint style="info" %}
рдЖрдзрд╛рд░рд┐рдд рдЫрд┐рдкрд╛рдиреЗ рдХреЗ рд╕реНрддрд░ рдкрд░, рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдЦрд╛рддреЗ рдореЗрдВ рдПрдХ s3 рдмрдХреЗрдЯ рдореЗрдВ рдЕрдкрд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдЦрд╛рддреЗ рдореЗрдВред
{% endhint %}

#### `guardduty:CreateFilter`

рдирд╡реАрдирддрдо рд░реВрдк рдореЗрдВ рдмрдирд╛рдП рдЧрдП GuardDuty рдлрд╝рд╛рдЗрдВрдбрд┐рдВрдЧреНрд╕ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ [рджрдмрд╛рд╡ рдирд┐рдпрдо](https://docs.aws.amazon.com/guardduty/latest/ug/findings\_suppression-rule.html) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рд╡рд┐рд░реЛрдзреА [рдлрд╝рд┐рд▓реНрдЯрд░](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_filter-findings.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реЗ рдлрд╝рд╛рдЗрдВрдбрд┐рдВрдЧреНрд╕ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд╡реЗ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИрдВред

рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕ рдХреЛ [CreateFilter API](https://docs.aws.amazon.com/guardduty/latest/APIReference/API\_CreateFilter.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
aws guardduty create-filter \
--action ARCHIVE \
--detector-id <detector-id> \
--name yourfiltername \
--finding-criteria file://criteria.json
```
#### `guardduty:DeletePublishingDestination`

рдПрдХ рд╡рд┐рд░реЛрдзреА рдЕрдкреНрд░рд┐рдпрддрд╛ рдЖрд╕рд╛рдиреА рд╕реЗ рдЪреЗрддрд╛рд╡рдиреА рдХреЛ рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╕рд┐рд░реНрдл рдЪреЗрддрд╛рд╡рдиреА рдХреЗ рдЧрдВрддрд╡реНрдп рдХреЛ рд╣рдЯрд╛ рдХрд░ред [рдЪреЗрддрд╛рд╡рдиреА рдХреЗ рдЧрдВрддрд╡реНрдп рдХреЛ рд╣рдЯрд╛рдиреЗ](https://docs.aws.amazon.com/cli/latest/reference/guardduty/delete-publishing-destination.html) рдХреЗ рджреНрд╡рд╛рд░рд╛ред
```bash
aws guardduty delete-publishing-destination \
--detector-id <detector-id> \
--destination-id def456
```
{% hint style="danger" %}
рдЗрд╕ рдкреНрд░рдХрд╛рд╢рди рд╕реНрдерд╛рди рдХреЛ рд╣рдЯрд╛рдиреЗ рд╕реЗ **GuardDuty рдХрдВрд╕реЛрд▓ рдореЗрдВ рдЦреЛрдЬреЛрдВ рдХреА рдкреАрдврд╝реА рдпрд╛ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрдЧреА**ред GuardDuty рдЖрдкрдХреЗ AWS рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдШрдЯрдирд╛рдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦреЗрдЧрд╛, рд╕рдВрджрд┐рдЧреНрдз рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдЧрд╛ рдФрд░ рдЦреЛрдЬреЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ред
{% endhint %}

### рд╡рд┐рд╢реЗрд╖ рдЦреЛрдЬреЛрдВ рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░реЗрдВ

#### рдкреЗрдВрдЯреЗрд╕реНрдЯ рдЦреЛрдЬ

OS рдХреЗ GuardDuty рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдЙрдкрдХрд░рдгреЛрдВ рд╕реЗ AWS API рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдФрд░ рдПрдХ [рдкреЗрдирдЯреЗрд╕реНрдЯ рдЦреЛрдЬ](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#pentest-iam-kalilinux) рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред\
рдпрд╣ API рдЕрдиреБрд░реЛрдз рдореЗрдВ рдкрд╛рд╕ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рдирд╛рдо** рджреНрд╡рд╛рд░рд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИред\
рдЗрд╕рд▓рд┐рдП, **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░рдХреЗ рд╣рдо рдЖрдХреНрд░рдордг рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╕реЗ GuardDuty рдХреЛ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВред

рдпреВрдмрдВрдЯреВ, рдореИрдХ рдпрд╛ рд╡рд┐рдВрдбреЛрдЬ рдЬреИрд╕реЗ рдУрдПрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдпрд╣ рдЪреЗрддрд╛рд╡рдиреА рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рд╣реЛрдЧреАред

рдЗрд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк `botocore` рдкреИрдХреЗрдЬ рдореЗрдВ `session.py` рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ `session.py` рд╕реЗ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред рдХрд╛рд▓реА рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рдпрд╣ `/usr/local/lib/python3.7/dist-packages/botocore/session.py` рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред

рд▓рд╛рдЗрди [456](https://github.com/boto/botocore/blob/7de36c07ecec503f588ac27658b1795e83b67b75/botocore/session.py#L456) рдХреЗ рдЖрд╕рдкрд╛рд╕ рдЖрдкрдХреЛ `platform.system()` рдФрд░ `platform.release()` рджрд┐рдЦрд╛рдИ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕ **рдХреЛрдб рдХреЛ** [**Pacu**](https://github.com/RhinoSecurityLabs/pacu/blob/master/pacu/user\_agents.txt) рдореЗрдВ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **рд╡рд┐рдзрд┐рдкреНрд░рдж рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдмрджрд▓реЗрдВ**ред

#### Tor рдХреНрд▓рд╛рдЗрдВрдЯ рдЦреЛрдЬ

{% hint style="success" %}
рдЗрд╕реЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рд╣реИ рдХреЗрд╡рд▓ **AWS рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Tor рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ** (рдпрджрд┐ рдЖрдк рд╕рдВрдХреБрдЪрд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рд╕реНрдерд┐рддрд┐ рдХреЛ рдЫрд┐рдкрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдк Tor рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВ?)
{% endhint %}

рдпрджрд┐ рдЖрдк **Tor** рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ **Guarduty** рдПрд▓рд░реНрдЯ [**UnauthorizedAccess:EC2/TorClient**](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-ec2.html#unauthorizedaccess-ec2-torclient) рд╕реЗрдЯ рдХрд░реЗрдЧрд╛ред

Guarduty рдЗрд╕реЗ [Tor рдиреЛрдбреЛрдВ рдХреА рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реВрдЪреА](https://metrics.torproject.org/exonerator.html) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдкрдХреЛ Tor рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдЖрдк [Bridges](https://community.torproject.org/relay/types-of-relays/#Bridge) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ рдпрд╣ рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ рдХрд┐ рдЖрдк рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╕ Tor рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реА рди рдХрд░реЗрдВред

рдПрдХ рдмреНрд░рд┐рдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк [Obfs4](https://gitlab.com/yawning/obfs4) (`apt install tor obfs4proxy`) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ [bridges.torproject.org](https://bridges.torproject.org/options) рд╕реЗ рдПрдХ рдмреНрд░рд┐рдЬ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣рд╛рдВ рд╕реЗ, рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХ `torrc` рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ:
```
UseBridges 1
Bridge obfs4 <IP ADDRESS>:<PORT> <FINGERPRINT> cert=<cert_string> iat-mode=0
ClientTransportPlugin obfs4 exec /bin/obfs4proxy
```
рдЪрд▓рд╛рдПрдБ `tor -f torrc` рдФрд░ рдЖрдк рдкреЛрд░реНрдЯ 9050 рдкрд░ рдирд┐рдпрдорд┐рдд socks5 рдкреНрд░реЙрдХреНрд╕реА рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

#### рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЙрджреНрдзрд░рдг рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

рдпрджрд┐ рдЖрдк **рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд╕реЗрд╡рд╛ рд╕реЗ EC2 рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдЪреЛрд░реА** рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ **AWS рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреЗ рдмрд╛рд╣рд░** рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЪреЗрддрд╛рд╡рдиреА [UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.OutsideAWS](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationoutsideaws) рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддреА рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдЖрдк **рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ **рдЪреЛрд░реА рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдХреЗ рд▓рд┐рдП, рддреЛ рдЪреЗрддрд╛рд╡рдиреА [UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.InsideAWS](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationinsideaws) рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддреА рд╣реИред

{% hint style="warning" %}
рдпрджрд┐ рдЖрдкрдиреЗ рджреВрд╕рд░реЗ **EC2** рдорд╢реАрди рдХреЛ **рдЙрд╕реА рдЦрд╛рддреЗ рд╕реЗ рд╣рдерд┐рдпрд╛ рд▓рд┐рдпрд╛** рд╣реИ, рддреЛ рдЖрдк рд╡рд╣рд╛рдВ рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдХреЛрдИ рдЪреЗрддрд╛рд╡рдиреА рдирд╣реАрдВ** рдЙрддреНрдкрдиреНрди рд╣реЛрдЧреАред
{% endhint %}

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдПрдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдмрд╛рдИрдкрд╛рд╕ рд╣реИ - [VPC рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕](https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints.html)ред **VPC рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ **GuardDuty рдЪреЗрддрд╛рд╡рдиреА рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рд╣реЛрдЧреА**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд░реВрдк рдореЗрдВ, `рдпрджрд┐ рдЖрдк EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реЗ IAM рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдЪреЛрд░реА рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╡рд╣реАрдВ рд╕реЗ рдЙрди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдкрдиреЗ EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдмрдХрд┐ рдЯреНрд░реИрдлрд┐рдХ VPC рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░реВрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ GuardDuty рдлрд╛рдЗрдВрдбрд┐рдВрдЧ рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рд╣реЛрдЧреАред`

рдЯреВрд▓ [**SneakyEndpoints**](https://github.com/Frichetten/SneakyEndpoints) рдХреЛ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрд╣ рдкрд░рд┐рдпреЛрдЬрдирд╛ **Terraform рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рддрд╛рд╡рд░рдг рдЙрдард╛рддреА рд╣реИ**ред рдпрд╣ рдЖрдкрдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рдЬреА рд╕рдмрдиреЗрдЯ рдореЗрдВ рдПрдХ EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдмрдирд╛рдПрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдЗрдВрдЯрд░рдиреЗрдЯ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдирд╣реАрдВ рд╣реЛрдЧреА рдФрд░ рдЖрдкрдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдХрдИ VPC рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдмрдирд╛рдПрдЧрд╛ред

**рдЗрд╕ рдЪреЗрддрд╛рд╡рдиреА рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛** рд╣реИ рдХрд┐ рдЪреЛрд░реА рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЙрдиреНрд╣реАрдВ рдорд╢реАрди рдореЗрдВ **рдЬрд╣рд╛рдВ рд╕реЗ рд╡реЗ рдЪреЛрд░реА рд╣реБрдП рдереЗ рдпрд╛ рдЙрд╕реА рдЦрд╛рддреЗ рдХреЗ рдПрдХ рдорд╢реАрди рдореЗрдВред**

## рд╕рдВрджрд░реНрдн

* [https://hackingthe.cloud/aws/avoiding-detection/guardduty-pentest/](https://hackingthe.cloud/aws/avoiding-detection/guardduty-pentest/)
* [https://hackingthe.cloud/aws/avoiding-detection/guardduty-tor-client/](https://hackingthe.cloud/aws/avoiding-detection/guardduty-tor-client/)
* [https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)
* [https://hackingthe.cloud/aws/avoiding-detection/steal-keys-undetected/](https://hackingthe.cloud/aws/avoiding-detection/steal-keys-undetected/)

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рдпрджрд┐ рдЖрдк PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
