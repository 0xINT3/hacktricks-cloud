# AWS - Enum√©ration de GuardDuty

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFT exclusifs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).

</details>

## GuardDuty

Amazon GuardDuty est un service de d√©tection de menaces intelligent bas√© sur la r√©gion, le premier du genre propos√© par AWS, qui permet aux utilisateurs de **surveiller** leur **compte AWS** pour **d√©tecter des comportements inhabituels et inattendus en analysant les journaux de flux VPC, les journaux d'√©v√©nements de gestion AWS CloudTrail, les journaux d'√©v√©nements de donn√©es CloudTrail S3 et les journaux DNS**. Il utilise des **flux de renseignements sur les menaces**, tels que des listes d'adresses IP et de domaines malveillants, et **l'apprentissage automatique** pour identifier **les activit√©s inattendues et potentiellement non autoris√©es et malveillantes** au sein de votre environnement AWS. Cela peut inclure des probl√®mes tels que des escalades de privil√®ges, l'utilisation de r√©f√©rences expos√©es ou la communication avec des adresses IP ou des domaines malveillants.

Les alertes **apparaissent dans la console GuardDuty (90 jours)** et les √©v√©nements CloudWatch.

Par exemple, GuardDuty peut d√©tecter des **instances EC2 compromises servant de logiciels malveillants ou de minage** de bitcoin. Il surveille √©galement le **comportement d'acc√®s au compte AWS pour d√©tecter des signes de compromission**, tels que des d√©ploiements d'infrastructure non autoris√©s, comme des instances d√©ploy√©es dans une **r√©gion qui n'a jamais √©t√© utilis√©e**, ou des appels API inhabituels, comme un changement de politique de mot de passe pour r√©duire la force du mot de passe.\
Vous pouvez **t√©l√©charger une liste d'adresses IP blanches et noires** afin que GuardDuty prenne en compte ces informations.

R√©sum√© des r√©sultats :

* Type de r√©sultat
* Gravit√© : 7-8,9 √âlev√©e, 4-6,9 Moyenne, 01-3,9 Faible
* R√©gion
* ID de compte
* ID de ressource
* Heure de d√©tection
* Quelle liste de menaces a √©t√© utilis√©e

Le corps contient ces informations :

* Ressource affect√©e
* Action
* Acteur : adresse IP, port et domaine
* Informations suppl√©mentaires

Vous pouvez **inviter d'autres comptes** √† un compte AWS GuardDuty diff√©rent afin que **chaque compte soit surveill√© √† partir du m√™me GuardDuty**. Le compte principal doit inviter les comptes membres, puis le repr√©sentant du compte membre doit accepter l'invitation.\
Il existe diff√©rentes autorisations de r√¥le IAM pour permettre √† GuardDuty d'obtenir les informations et permettre √† un utilisateur de **t√©l√©charger des adresses IP blanches et noires**.\
GuarDuty utilise un r√¥le li√© au service appel√© "AWSServiceRoleForAmazonGuardDuty" qui lui permet de r√©cup√©rer des m√©tadonn√©es √† partir de points d'extr√©mit√© affect√©s.

Vous payez pour le traitement de vos fichiers journaux, par 1 million d'√©v√©nements par mois √† partir de CloudTrail et par Go de journaux analys√©s √† partir de VPC Flow.

Lorsqu'un utilisateur **d√©sactive GuardDuty**, il cessera de surveiller votre environnement AWS et ne g√©n√©rera plus de nouveaux r√©sultats du tout, et les **r√©sultats existants seront perdus**.\
Si vous l'arr√™tez simplement, les r√©sultats existants resteront.

## Actions

### √ânum√©ration

```bash
aws guardduty list-organization-admin-accounts
aws guardduty list-invitations
aws guardduty get-invitations-count
aws guardduty list-detectors
aws guardduty describe-organization-configuration --detector-id <id>
aws guardduty get-detector --detector-id <id>
aws guardduty list-filters --detector-id
## R√©f√©rences

* [https://hackingthe.cloud/aws/avoiding-detection/guardduty-pentest/](https://hackingthe.cloud/aws/avoiding-detection/guardduty-pentest/)
* [https://hackingthe.cloud/aws/avoiding-detection/guardduty-tor-client/](https://hackingthe.cloud/aws/avoiding-detection/guardduty-tor-client/)
* [https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)
* [https://hackingthe.cloud/aws/avoiding-detection/steal-keys-undetected/](https://hackingthe.cloud/aws/avoiding-detection/steal-keys-undetected/)

<details>

<summary><strong>Soutenez HackTricks et obtenez des avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>