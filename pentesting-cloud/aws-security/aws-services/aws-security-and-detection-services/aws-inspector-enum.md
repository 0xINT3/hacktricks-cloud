# AWS - Inspector Enum

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositorys senden.

</details>

## Inspector

Der Amazon Inspector-Dienst ist **agentenbasiert**, was bedeutet, dass Software-Agenten auf allen EC2-Instanzen **installiert werden m√ºssen**, die Sie bewerten m√∂chten. Dies macht es einfach, den Dienst zu konfigurieren und zu jedem Zeitpunkt zu den bereits in Ihrer AWS-Infrastruktur ausgef√ºhrten Ressourcen hinzuzuf√ºgen. Dies hilft Amazon Inspector, sich nahtlos in Ihre bestehenden Sicherheitsprozesse und -verfahren als eine weitere Sicherheitsebene zu integrieren.

Dies sind die Tests, die AWS Inspector Ihnen erm√∂glicht durchzuf√ºhren:

* **CVEs**
* **CIS-Benchmarks**
* **Sicherheitsbew√§hrte Verfahren**
* **Netzwerkzug√§nglichkeit**

Sie k√∂nnen beliebige dieser Tests auf den von Ihnen ausgew√§hlten EC2-Maschinen durchf√ºhren.

### Element von AWS Inspector

**Rolle**: Erstellen oder w√§hlen Sie eine Rolle, um Amazon Inspector Lesezugriff auf die EC2-Instanzen zu gew√§hren (DescribeInstances)\
**Bewertungsziele**: Gruppe von EC2-Instanzen, gegen die Sie eine Bewertung durchf√ºhren m√∂chten\
**AWS-Agenten**: Software-Agenten, die auf EC2-Instanzen installiert werden m√ºssen, um zu √ºberwachen. Daten werden √ºber einen TLS-Kanal an Amazon Inspector gesendet. Ein regelm√§√üiger Herzschlag wird vom Agenten an den Inspector gesendet, um Anweisungen anzufordern. Er kann sich selbst aktualisieren\
**Bewertungsvorlagen**: Definieren Sie spezifische Konfigurationen, wie eine Bewertung auf Ihren EC2-Instanzen durchgef√ºhrt wird. Eine Bewertungsvorlage kann nach der Erstellung nicht ge√§ndert werden.

* Zu verwendende Regel-Pakete
* Dauer des Bewertungslaufs 15 Minuten/1 Stunde/8 Stunden
* SNS-Themen, w√§hlen Sie, wann benachrichtigt werden soll: Start, Abschluss, Zustands√§nderung, Bericht eines Ergebnisses
* Attribute, die den Ergebnissen zugewiesen werden sollen

**Regelpaket**: Enth√§lt eine Reihe einzelner Regeln, die gegen eine EC2 √ºberpr√ºft werden, wenn eine Bewertung durchgef√ºhrt wird. Jede hat auch eine Schwere (hoch, mittel, niedrig, informativ). Die M√∂glichkeiten sind:

* Allgemeine Schwachstellen und Expositionen (CVEs)
* Center for Internet Security (CIS) Benchmark
* Sicherheitsbew√§hrte Verfahren

Sobald Sie die Amazon Inspector-Rolle konfiguriert, die AWS-Agenten installiert, das Ziel konfiguriert und die Vorlage konfiguriert haben, k√∂nnen Sie sie ausf√ºhren. Ein Bewertungslauf kann gestoppt, fortgesetzt oder gel√∂scht werden.

Amazon Inspector verf√ºgt √ºber eine vordefinierte Reihe von Regeln, die in Pakete gruppiert sind. Jede Bewertungsvorlage legt fest, welche Regelpakete im Test enthalten sein sollen. Instanzen werden gegen die im Bewertungsvorlage enthaltenen Regelpakete bewertet.

{% hint style="info" %}
Beachten Sie, dass AWS heutzutage bereits erlaubt, alle erforderlichen Konfigurationen **automatisch zu erstellen** und sogar die Agenten automatisch **innerhalb der EC2-Instanzen zu installieren**.
{% endhint %}

### **Berichterstattung**

**Telemetrie**: Daten, die von einer Instanz gesammelt werden, die ihre Konfiguration, Verhalten und Prozesse w√§hrend eines Bewertungslaufs detaillieren. Sobald die Daten gesammelt wurden, werden sie in Echtzeit √ºber TLS an Amazon Inspector zur√ºckgesendet, wo sie dann √ºber einen fl√ºchtigen KMS-Schl√ºssel verschl√ºsselt im S3 gespeichert werden. Amazon Inspector greift dann auf den S3-Bucket zu, entschl√ºsselt die Daten im Speicher und analysiert sie gegen die f√ºr diese Bewertung verwendeten Regelpakete, um die Ergebnisse zu generieren.

**Bewertungsbericht**: Bietet Details dar√ºber, was bewertet wurde und die Ergebnisse der Bewertung.

* Der **Ergebnisbericht** enth√§lt die Zusammenfassung der Bewertung, Informationen √ºber die EC2 und Regeln sowie die aufgetretenen Ergebnisse.
* Der **vollst√§ndige Bericht** ist der Ergebnisbericht + eine Liste der bestandenen Regeln.

## Enumeration
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Post-Exploitation

{% hint style="success" %}
Aus der Sicht eines Angreifers kann dieser Dienst dem Angreifer helfen, Schwachstellen und Netzwerkexpositionen zu finden, die ihm helfen k√∂nnten, andere Instanzen/Container zu kompromittieren.

Ein Angreifer k√∂nnte jedoch auch daran interessiert sein, diesen Dienst zu st√∂ren, damit das Opfer Schwachstellen (alle oder bestimmte) nicht sehen kann.
{% endhint %}

TODO: Pull Requests sind willkommen

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
