# AWS - Inspector Enum

<details>

<summary><strong>¡Apoya a HackTricks y obtén beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **última versión de PEASS o descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en Github.

</details>

## Inspector

El servicio Amazon Inspector es **basado en agentes**, lo que significa que requiere que se **instalen agentes de software en cualquier instancia EC2** que desee evaluar. Esto hace que sea un servicio fácil de configurar y agregar en cualquier momento a los recursos existentes que ya se ejecutan dentro de su infraestructura de AWS. Esto ayuda a que Amazon Inspector se convierta en una integración perfecta con cualquiera de sus procesos y procedimientos de seguridad existentes como otro nivel de seguridad.

Estas son las pruebas que AWS Inspector le permite realizar:

* **CVEs**
* **CIS Benchmarks**
* **Mejores prácticas de seguridad**
* **Alcance de la red**

Puede hacer que cualquiera de ellas se ejecute en las máquinas EC2 que decida.

### Elemento de AWS Inspector

**Rol**: Cree o seleccione un rol para permitir que Amazon Inspector tenga acceso de solo lectura a las instancias EC2 (DescribeInstances)\
**Objetivos de evaluación**: Grupo de instancias EC2 contra las que desea ejecutar una evaluación\
**Agentes de AWS**: Agentes de software que deben instalarse en las instancias EC2 para monitorear. Los datos se envían a Amazon Inspector utilizando un canal TLS. Se envía un latido de corazón regular desde el agente al inspector solicitando instrucciones. Puede actualizarse automáticamente\
**Plantillas de evaluación**: Defina configuraciones específicas sobre cómo se ejecuta una evaluación en sus instancias EC2. Una plantilla de evaluación no se puede modificar después de la creación.

* Paquetes de reglas a utilizar
* Duración de la ejecución de la evaluación 15min/1hora/8horas
* Temas de SNS, seleccione cuándo notificar: Inicio, finalización, cambio de estado, informes de hallazgos
* Atributos para asignar a los hallazgos

**Paquete de reglas**: Contiene una serie de reglas individuales que se verifican en una EC2 cuando se ejecuta una evaluación. Cada uno también tiene una gravedad (alta, media, baja, informativa). Las posibilidades son:

* Vulnerabilidades y exposiciones comunes (CVEs)
* Centro de seguridad de Internet (CIS) Benchmark
* Mejores prácticas de seguridad

Una vez que haya configurado el Rol de Amazon Inspector, se hayan instalado los Agentes de AWS, se haya configurado el objetivo y se haya configurado la plantilla, podrá ejecutarlo. Una ejecución de evaluación se puede detener, reanudar o eliminar.

Amazon Inspector tiene un conjunto predefinido de reglas, agrupadas en paquetes. Cada plantilla de evaluación define qué paquetes de reglas se incluirán en la prueba. Las instancias se evalúan en función de los paquetes de reglas incluidos en la plantilla de evaluación.

{% hint style="info" %}
Tenga en cuenta que hoy en día AWS ya le permite **crear automáticamente** todas las **configuraciones** necesarias e incluso **instalar automáticamente los agentes dentro de las instancias EC2.**
{% endhint %}

### **Informes**

**Telemetría**: datos que se recopilan de una instancia, detallando su configuración, comportamiento y procesos durante una ejecución de evaluación. Una vez recopilados, los datos se envían de vuelta a Amazon Inspector en tiempo casi real sobre TLS, donde se almacenan y cifran en S3 a través de una clave KMS efímera. Luego, Amazon Inspector accede al bucket de S3, descifra los datos en memoria y los analiza en función de cualquier paquete de reglas utilizado para esa evaluación para generar los hallazgos.

**Informe de evaluación**: Proporciona detalles sobre lo que se evaluó y los resultados de la evaluación.

* El informe de **hallazgos** contiene el resumen de la evaluación, información sobre EC2 y reglas y los hallazgos que ocurrieron.
* El **informe completo** es el informe de hallazgos + una lista de reglas que se aprobaron.

<details>

<summary><strong>¡Apoya a HackTricks y obtén beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **última versión de PEASS o descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en Github.

</details>