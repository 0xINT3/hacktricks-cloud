# AWS - Inspector Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya HackTricks'i **PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>

## Inspector

Amazon Inspector hizmeti, **ajans tabanlı** olduğundan, değerlendirmek istediğiniz herhangi bir EC2 örneğine **kurulu yazılım ajanslarının gerektiğini** gerektirir. Bu, mevcut AWS altyapınızda zaten çalışan var olan kaynaklara herhangi bir noktada kolayca yapılandırılabilen ve eklenen bir hizmet olmasını sağlar. Bu, Amazon Inspector'ın mevcut güvenlik süreçleriniz ve prosedürlerinizle sorunsuz bir entegrasyon haline gelmesine yardımcı olur.

AWS Inspector ile yapabileceğiniz testler şunlardır:

* **CVE'ler**
* **CIS Benchmarks**
* **Güvenlik En İyi Uygulamaları**
* **Ağ Erişilebilirliği**

Bu testlerden herhangi birini EC2 makinelerinde çalıştırabilirsiniz.

### AWS Inspector'ın Elemanları

**Rol**: Amazon Inspector'ın EC2 örneklerine salt okunur erişime sahip olmasına izin vermek için bir rol oluşturun veya seçin (DescribeInstances)\
**Değerlendirme Hedefleri**: Bir değerlendirme yapmak istediğiniz EC2 örneklerinin bir grubu\
**AWS ajansları**: İzlemek için EC2 örneklerine kurulması gereken yazılım ajansları. Veriler, bir TLS kanalı kullanarak Amazon Inspector'a gönderilir. Ajans, talimatlar için Inspector'a düzenli bir kalp atışı gönderir. Kendini otomatik olarak güncelleyebilir\
**Değerlendirme Şablonları**: EC2 örneklerinizde bir değerlendirmenin nasıl çalıştırılacağına ilişkin belirli yapılandırmaları tanımlayın. Bir değerlendirme şablonu oluşturulduktan sonra değiştirilemez.

* Kullanılacak kurallar paketleri
* Değerlendirme süresi 15 dakika/1 saat/8 saat
* Bildirim göndermek için SNS konuları: Başladığında, bittiğinde, durum değiştiğinde, bir bulgu raporladığında
* Bulgulara atanacak öznitelikler

**Kural paketi**: Bir değerlendirme çalıştırıldığında bir EC2 üzerinde kontrol edilen bir dizi bireysel kural içerir. Her birinin ayrıca bir ciddiyeti vardır (yüksek, orta, düşük, bilgilendirici). Olasılıklar şunlardır:

* Ortak Zayıflıklar ve Maruziyetler (CVE'ler)
* İnternet Güvenlik Merkezi (CIS) Benchmark
* Güvenlik En İyi Uygulamaları

Amazon Inspector Rolünü yapılandırdıktan sonra, AWS Ajansları Kuruldu, hedef yapılandırıldı ve şablon yapılandırıldıktan sonra çalıştırabilirsiniz. Bir değerlendirme çalıştırması durdurulabilir, devam ettirilebilir veya silinebilir.

Amazon Inspector'ın önceden tanımlanmış bir dizi kuralı, paketlere gruplandırılmıştır. Her Değerlendirme Şablonu, testte kullanılacak kurallar paketlerini tanımlar. Örnekler, değerlendirme şablonuna dahil edilen kurallar paketlerine karşı değerlendirilir.

{% hint style="info" %}
Günümüzde AWS, **tüm gerekli yapılandırmaları otomatik olarak oluşturmanıza** ve hatta EC2 örneklerinin içine otomatik olarak **ajansları yüklemenize** izin verir.
{% endhint %}

### **Raporlama**

**Telemetri**: Bir örneğin yapılandırması, davranışı ve süreçleri hakkında ayrıntıları içeren bir değerlendirme çalışması sırasında toplanan veriler. Toplanan veriler, ardından TLS üzerinden Amazon Inspector'a geri gönderilir ve orada geçici bir KMS anahtarı aracılığıyla S3 üzerinde depolanır ve şifrelenir. Amazon Inspector daha sonra S3 Kova'sına erişir, bellekteki verileri şifre çözer ve bulguları oluşturmak için o değerlendirmeler için kullanılan kurallar paketlerine karşı analiz eder.

**Değerlendirme Raporu**: Değerlendirilen ve değerlendirmenin sonuçları hakkında ayrıntılar sağlar.

* **Bulgular raporu**, değerlendirmenin özeti, EC2 hakkında bilgiler ve kurallar ve meydana gelen bulguları içerir.
* **Tam rapor**, bulgu raporu + geçen kuralların bir listesidir.

## Numaralandırma
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Son Aşama Saldırı

{% hint style="success" %}
Bir saldırganın perspektifinden, bu hizmet saldırgana diğer örnekler/konteynerlerin güvenlik açıklarını ve ağ maruziyetlerini bulmasına yardımcı olabilir.

Ancak, bir saldırgan da bu hizmeti engellemekle ilgilenebilir, böylece kurban güvenlik açıklarını (tümünü veya belirli olanları) göremez.
{% endhint %}

TODO: PR'lar kabul edilir

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya HackTricks'i **PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya bizi **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'da takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR göndererek paylaşın.

</details>
