# AWS - Inspector Enum

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* **HackTricksで会社を宣伝したい**場合や、**PEASSの最新バージョンを見たい**場合、または**HackTricksをPDFでダウンロード**したい場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを発見しましょう
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローする🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **ハッキングのトリックを共有するには、**[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>

## Inspector

Amazon Inspectorサービスは**エージェントベース**であり、評価を行いたい**EC2インスタンスにソフトウェアエージェントをインストールする**必要があります。これにより、既存のAWSインフラストラクチャ内で既に実行されているリソースにいつでも簡単に構成および追加できるサービスとなります。これにより、Amazon Inspectorは既存のセキュリティプロセスと手順にシームレスに統合され、別のセキュリティレベルとして機能します。

AWS Inspectorで実行できるテストは次のとおりです：

* **CVE**
* **CISベンチマーク**
* **セキュリティベストプラクティス**
* **ネットワーク到達性**

これらのテストをEC2マシンで実行することができます。

### AWS Inspectorの要素

**ロール**：Amazon InspectorがEC2インスタンスに対して読み取り専用アクセスを持つためのロールを作成または選択します（DescribeInstances）\
**評価ターゲット**：評価を実行したいEC2インスタンスのグループ\
**AWSエージェント**：モニタリングするためにEC2インスタンスにインストールする必要のあるソフトウェアエージェント。データはTLSチャネルを介してAmazon Inspectorに送信されます。エージェントは定期的にインスペクターに命令を要求するためのハートビートを送信します。自動更新も可能です\
**評価テンプレート**：EC2インスタンスで評価を実行する方法に関する特定の設定を定義します。評価テンプレートは作成後に変更できません。

* 使用するルールパッケージ
* 評価の実行時間 15分/1時間/8時間
* SNSトピック、通知するタイミングを選択：開始、終了、状態の変更、発見の報告
* 発見に割り当てる属性

**ルールパッケージ**：評価が実行される際にEC2に対してチェックされる個々のルールの集合です。各ルールには重要度（高、中、低、情報）もあります。可能なルールパッケージは次のとおりです：

* 一般的な脆弱性と公開情報（CVE）
* インターネットセキュリティセンター（CIS）ベンチマーク
* セキュリティベストプラクティス

Amazon Inspectorのロールを構成し、AWSエージェントをインストールし、ターゲットを構成し、テンプレートを構成したら、実行することができます。評価実行は停止、再開、または削除することができます。

Amazon Inspectorには、パッケージにグループ化された事前定義のルールがあります。各評価テンプレートは、評価テンプレートに含まれるルールパッケージに対してインスタンスが評価されます。

{% hint style="info" %}
現在、AWSではすでに**必要なすべての構成を自動作成**し、EC2インスタンス内にエージェントを自動的に**インストールする**ことができることに注意してください。
{% endhint %}

### **レポート**

**テレメトリ**: インスタンスから収集されたデータで、評価実行中の構成、動作、プロセスの詳細を示します。データが収集されると、TLSを介してAmazon Inspectorにリアルタイムで送信され、そこで一時的なKMSキーを使用してS3に格納され、暗号化されます。その後、Amazon InspectorはS3バケットにアクセスし、メモリ内でデータを復号化し、その評価に使用されるルールパッケージに対して分析して結果を生成します。

**評価レポート**: 評価された内容と評価の結果の詳細を提供します。

* **発見レポート**には、評価の概要、EC2およびルールに関する情報、発見の詳細が含まれています。
* **完全なレポート**は、発見レポート+パスしたルールのリストです。

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* **HackTricksで会社を宣伝したい**場合や、**PEASSの最新バージョンを見たい**場合、または**HackTricksをPDFでダウンロード**したい場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを発見しましょう
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローする🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **ハッキングのトリックを共有するには、**[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>
