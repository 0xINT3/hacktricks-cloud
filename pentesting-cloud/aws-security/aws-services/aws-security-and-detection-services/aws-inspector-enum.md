# AWS - Inspector Enum

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** 💬 [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## Inspector

Die Amazon Inspector-diens is **agent-gebaseerd**, wat beteken dat dit sagteware-agente vereis om **geïnstalleer te word op enige EC2-instanties** wat jy wil assesseer. Dit maak dit 'n maklike diens om te konfigureer en by te voeg op enige punt aan bestaande hulpbronne wat reeds in jou AWS-infrastruktuur loop. Dit help Amazon Inspector om 'n naadlose integrasie te word met enige van jou bestaande sekuriteitsprosesse en -prosedures as 'n verdere vlak van sekuriteit.

Dit is die toetse wat AWS Inspector jou toelaat om uit te voer:

* **CVE's**
* **CIS Benchmarks**
* **Sekuriteitsbestuurspraktyke**
* **Netwerk bereikbaarheid**

Jy kan enige van hierdie toetse uitvoer op die EC2-masjiene wat jy kies.

### Element van AWS Inspector

**Rol**: Skep of kies 'n rol om Amazon Inspector leesnetwerktoegang tot die EC2-instanties te gee (DescribeInstances)\
**Assessment Targets**: Groep EC2-instanties wat jy wil assesseer\
**AWS-agente**: Sagteware-agente wat op EC2-instanties geïnstalleer moet word om te monitor. Data word na Amazon Inspector gestuur deur middel van 'n TLS-kanaal. 'n Gereelde hartklop word van die agent na die inspector gestuur om vir instruksies te vra. Dit kan outomaties opdateer word\
**Assessment Templates**: Definieer spesifieke konfigurasies vir hoe 'n assessering op jou EC2-instanties uitgevoer word. 'n Assesseringstemplate kan nie gewysig word nadat dit geskep is nie.

* Reëlspakkette wat gebruik moet word
* Duur van die assessering 15min/1uur/8ure
* SNS-onderwerpe, kies wanneer om kennisgewing te stuur: Begin, klaar, verander toestand, vind 'n bevinding
* Kenmerke wat aan bevindinge toegewys moet word

**Reëlspakket**: Bevat 'n aantal individuele reëls wat teen 'n EC2 nagegaan word wanneer 'n assessering uitgevoer word. Elkeen het ook 'n erns (hoog, medium, laag, inligting). Die moontlikhede is:

* Algemene kwesbaarhede en blootstelling (CVE's)
* Sentrum vir Internet-sekuriteit (CIS) Benchmark
* Sekuriteitsbestuurspraktyke

Sodra jy die Amazon Inspector-rol gekonfigureer het, die AWS-agente geïnstalleer het, die teiken gekonfigureer het en die sjabloon gekonfigureer het, sal jy dit kan uitvoer. 'n Assessering kan gestop, hervat of uitgevee word.

Amazon Inspector het 'n vooraf gedefinieerde stel reëls wat in pakkette gegroepeer is. Elke assesseringstemplate bepaal watter reëlspakkette in die toets ingesluit moet word. Instansies word geëvalueer teen reëlspakkette wat in die assesseringstemplate ingesluit is.

{% hint style="info" %}
Let daarop dat AWS tans al toelaat om **outomaties** al die **nodige konfigurasies te skep** en selfs die agente outomaties **binne die EC2-instanties te installeer**.
{% endhint %}

### **Verslagdoening**

**Telemetrie**: Data wat versamel word van 'n instantie, wat sy konfigurasie, gedrag en prosesse tydens 'n assessering aandui. Sodra die data versamel is, word dit dan in byna-ware tyd oor TLS teruggestuur na Amazon Inspector, waar dit dan gestoor en versleutel word op S3 deur middel van 'n tydelike KMS-sleutel. Amazon Inspector het dan toegang tot die S3-emmer, ontsluit die data in die geheue, en analiseer dit teen enige reëlspakkette wat vir daardie assessering gebruik word om die bevindinge te genereer.

**Assesseringverslag**: Verskaf besonderhede oor wat geassesseer is en die resultate van die assessering.

* Die **bevindingverslag** bevat 'n opsomming van die assessering, inligting oor die EC2 en reëls, en die bevindinge wat voorgekom het.
* Die **volledige verslag** is die bevindingverslag + 'n lys van reëls wat geslaag is.

## Enumerasie
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Post Exploitasie

{% hint style="success" %}
Vanuit 'n aanvaller se perspektief kan hierdie diens die aanvaller help om kwesbaarhede en netwerk blootstellings te vind wat hom kan help om ander instansies/houers te kompromitteer.

'n Aanvaller kan egter ook belangstel om hierdie diens te ontwrig sodat die slagoffer nie kwesbaarhede (al of spesifieke) kan sien nie.
{% endhint %}

TODO: PR's is welkom

<details>

<summary><strong>Leer AWS hakwerk van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** 💬 [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hakwerktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
