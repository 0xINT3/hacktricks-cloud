# AWS - Inspector Enum

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Inspector

Usluga Amazon Inspector je **bazirana na agentima**, što znači da zahteva instalaciju softverskih agenata na bilo kojim EC2 instancama koje želite da procenite. Ovo čini uslugu lako konfigurabilnom i dodatnom tačkom za postojeće resurse koji već rade unutar vaše AWS infrastrukture. Ovo pomaže Amazon Inspector-u da postane neprimetna integracija sa bilo kojim postojećim procesima i procedurama za bezbednost.

Ovo su testovi koje AWS Inspector vam omogućava da izvršite:

* **CVEs**
* **CIS Benchmarks**
* **Najbolje prakse za bezbednost**
* **Dostupnost mreže**

Možete pokrenuti bilo koji od ovih testova na EC2 mašinama koje odaberete.

### Elementi AWS Inspector-a

**Uloga**: Kreirajte ili odaberite ulogu koja će omogućiti Amazon Inspector-u samo čitanje pristupa EC2 instancama (DescribeInstances)\
**Ciljevi procene**: Grupa EC2 instanci na kojima želite da pokrenete procenu\
**AWS agenti**: Softverski agenti koji moraju biti instalirani na EC2 instancama radi praćenja. Podaci se šalju Amazon Inspector-u koristeći TLS kanal. Redovno se šalje otkucaj srca sa agenta na inspektora koji traži instrukcije. Može se automatski ažurirati\
**Šabloni procene**: Definišu specifične konfiguracije za pokretanje procene na vašim EC2 instancama. Šablon procene se ne može menjati nakon kreiranja.

* Paketi pravila koji će se koristiti
* Trajanje pokretanja procene 15min/1sat/8sat
* SNS teme, odaberite kada obavestiti: Početak, završetak, promena stanja, prijavljuje pronalazak
* Atributi koji će biti dodeljeni pronalascima

**Paket pravila**: Sadrži nekoliko pojedinačnih pravila koja se proveravaju na EC2 instanci prilikom pokretanja procene. Svako pravilo takođe ima ozbiljnost (visoka, srednja, niska, informativna). Mogućnosti su:

* Common Vulnerabilities and Exposures (CVEs)
* Center for Internet Security (CIS) Benchmark
* Najbolje prakse za bezbednost

Kada ste konfigurisali Amazon Inspector ulogu, instalirali AWS agente, konfigurisali cilj i konfigurisali šablon, moći ćete da ga pokrenete. Pokretanje procene može se zaustaviti, nastaviti ili obrisati.

Amazon Inspector ima unapred definisan set pravila, grupisanih u pakete. Svaki šablon procene definiše koje pakete pravila treba uključiti u test. Instancama se vrši evaluacija na osnovu paketa pravila uključenih u šablon procene.

{% hint style="info" %}
Imajte na umu da AWS danas već omogućava **automatsko kreiranje** svih potrebnih **konfiguracija** i čak automatsko **instaliranje agenata unutar EC2 instanci**.
{% endhint %}

### **Izveštavanje**

**Telemetrija**: podaci koji se prikupljaju sa instance, detalji o njenoj konfiguraciji, ponašanju i procesima tokom pokretanja procene. Nakon prikupljanja, podaci se šalju natrag Amazon Inspector-u u skoro realnom vremenu preko TLS-a, gde se zatim skladište i šifruju na S3 putem privremenog KMS ključa. Amazon Inspector zatim pristupa S3 kanti, dešifruje podatke u memoriji i analizira ih u odnosu na bilo koje pakete pravila korišćene za tu procenu kako bi generisao rezultate.

**Izveštaj o proceni**: Pruža detalje o tome šta je procenjeno i rezultatima procene.

* Izveštaj o **pronalascima** sadrži sažetak procene, informacije o EC2 i pravilima i pronalascima koji su se dogodili.
* **Puni izveštaj** je izveštaj o pronalascima + lista pravila koja su prošla.

## Enumeracija
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Post Eksploatacija

{% hint style="success" %}
Sa perspektive napadača, ovaj servis može pomoći napadaču da pronađe ranjivosti i izloženosti mreže koje mu mogu pomoći da kompromituje druge instance/kontejnere.

Međutim, napadač takođe može biti zainteresovan za ometanje ovog servisa kako bi žrtva ne mogla videti ranjivosti (sve ili određene).
{% endhint %}

TODO: PR-ovi su dobrodošli

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
