# AWS - Inspection Enum

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs exclusifs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Inspector

Le service Amazon Inspector est **bas√© sur des agents**, ce qui signifie qu'il n√©cessite l'installation de logiciels agents sur toutes les instances EC2 que vous souhaitez √©valuer. Cela en fait un service facile √† configurer et √† ajouter √† tout moment aux ressources existantes d√©j√† en fonctionnement au sein de votre infrastructure AWS. Cela aide Amazon Inspector √† s'int√©grer de mani√®re transparente √† tous vos processus et proc√©dures de s√©curit√© existants comme un autre niveau de s√©curit√©.

Voici les tests que AWS Inspector vous permet d'effectuer :

* **CVEs**
* **CIS Benchmarks**
* **Meilleures pratiques de s√©curit√©**
* **Accessibilit√© r√©seau**

Vous pouvez faire ex√©cuter n'importe lequel de ces tests sur les machines EC2 que vous d√©cidez.

### √âl√©ment de AWS Inspector

**R√¥le** : Cr√©er ou s√©lectionner un r√¥le pour permettre √† Amazon Inspector d'avoir un acc√®s en lecture seule aux instances EC2 (DescribeInstances)\
**Cibles d'√©valuation** : Groupe d'instances EC2 sur lesquelles vous souhaitez ex√©cuter une √©valuation\
**Agents AWS** : Agents logiciels qui doivent √™tre install√©s sur les instances EC2 pour la surveillance. Les donn√©es sont envoy√©es √† Amazon Inspector via un canal TLS. Un battement de c≈ìur r√©gulier est envoy√© de l'agent √† l'inspecteur demandant des instructions. Il peut se mettre √† jour automatiquement\
**Mod√®les d'√©valuation** : D√©finir des configurations sp√©cifiques quant √† la mani√®re dont une √©valuation est ex√©cut√©e sur vos instances EC2. Un mod√®le d'√©valuation ne peut pas √™tre modifi√© apr√®s sa cr√©ation.

* Paquets de r√®gles √† utiliser
* Dur√©e de l'√©valuation 15min/1heure/8heures
* Sujets SNS, s√©lectionnez quand notifier : D√©bute, finit, change d'√©tat, rapporte une d√©couverte
* Attributs √† assigner aux d√©couvertes

**Paquet de r√®gles** : Contient un certain nombre de r√®gles individuelles qui sont v√©rifi√©es contre une EC2 lorsqu'une √©valuation est ex√©cut√©e. Chacune a √©galement une gravit√© (√©lev√©e, moyenne, faible, informative). Les possibilit√©s sont :

* Vuln√©rabilit√©s et Expositions Communes (CVEs)
* Benchmark du Centre pour la S√©curit√© Internet (CIS)
* Meilleures pratiques de s√©curit√©

Une fois que vous avez configur√© le R√¥le Amazon Inspector, les Agents AWS sont install√©s, la cible est configur√©e et le mod√®le est configur√©, vous pourrez l'ex√©cuter. Une √©valuation peut √™tre arr√™t√©e, reprise ou supprim√©e.

Amazon Inspector dispose d'un ensemble pr√©d√©fini de r√®gles, regroup√©es en paquets. Chaque mod√®le d'√©valuation d√©finit quels paquets de r√®gles doivent √™tre inclus dans le test. Les instances sont √©valu√©es par rapport aux paquets de r√®gles inclus dans le mod√®le d'√©valuation.

{% hint style="info" %}
Notez qu'aujourd'hui AWS vous permet d√©j√† de **cr√©er automatiquement** toutes les **configurations** n√©cessaires et m√™me d'installer automatiquement les agents √† l'int√©rieur des instances EC2.
{% endhint %}

### **Rapports**

**T√©l√©m√©trie** : donn√©es collect√©es √† partir d'une instance, d√©taillant sa configuration, son comportement et ses processus pendant une √©valuation. Une fois collect√©es, les donn√©es sont ensuite renvoy√©es √† Amazon Inspector en temps r√©el via TLS o√π elles sont ensuite stock√©es et chiffr√©es sur S3 via une cl√© KMS √©ph√©m√®re. Amazon Inspector acc√®de ensuite au Bucket S3, d√©chiffre les donn√©es en m√©moire et les analyse par rapport √† tout paquet de r√®gles utilis√© pour cette √©valuation afin de g√©n√©rer les d√©couvertes.

**Rapport d'√©valuation** : Fournit des d√©tails sur ce qui a √©t√© √©valu√© et les r√©sultats de l'√©valuation.

* Le **rapport de d√©couvertes** contient le r√©sum√© de l'√©valuation, des informations sur l'EC2 et les r√®gles et les d√©couvertes qui se sont produites.
* Le **rapport complet** est le rapport de d√©couvertes + une liste de r√®gles qui ont √©t√© respect√©es.

## √ânum√©ration
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Post Exploitation

{% hint style="success" %}
Du point de vue d'un attaquant, ce service peut aider l'attaquant √† trouver des vuln√©rabilit√©s et des expositions r√©seau qui pourraient l'aider √† compromettre d'autres instances/conteneurs.

Cependant, un attaquant pourrait √©galement √™tre int√©ress√© par la perturbation de ce service afin que la victime ne puisse pas voir les vuln√©rabilit√©s (toutes ou certaines sp√©cifiques).
{% endhint %}

TODO : Les PR sont les bienvenues

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-moi** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
