# AWS - Inspector Enum

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Inspector

Huduma ya Amazon Inspector ni **msingi wa wakala**, maana yake inahitaji mawakala wa programu kuwa **imewekwa kwenye mifano yoyote ya EC2** unayotaka kuchunguza. Hii inafanya iwe huduma rahisi kusanidi na kuongezwa wakati wowote kwenye rasilimali zilizopo tayari zinazoendesha ndani ya miundombinu yako ya AWS. Hii husaidia Amazon Inspector kuwa sehemu isiyoonekana katika mchakato wako wa usalama uliopo na taratibu kama kiwango kingine cha usalama.

Hizi ni vipimo ambavyo AWS Inspector inakuruhusu kufanya:

* **CVEs**
* **Vigezo vya CIS**
* **Mazoea Bora ya Usalama**
* **Ufikiaji wa Mtandao**

Unaweza kufanya mojawapo ya vipimo hivyo kwenye mashine za EC2 unazochagua.

### Elementi ya AWS Inspector

**Jukumu**: Unda au chagua jukumu kuruhusu Amazon Inspector kupata ufikivu wa kusoma tu kwa mifano ya EC2 (DescribeInstances)\
**Malengo ya Tathmini**: Kikundi cha mifano za EC2 unayotaka kufanya tathmini dhidi yake\
**Mawakala wa AWS**: Mawakala wa programu ambao lazima wawe imewekwa kwenye mifano ya EC2 kufuatilia. Data inatumwa kwa Amazon Inspector kwa kutumia kituo cha TLS. Mshipa wa kawaida unatumwa kutoka kwa wakala kwenda kwa mkaguzi kuuliza maagizo. Inaweza kujisasisha yenyewe\
**Mifano ya Tathmini**: Weka vipimo maalum kuhusu jinsi tathmini inavyofanywa kwenye mifano yako ya EC2. Kigezo cha tathmini hakiwezi kuhaririwa baada ya kuundwa.

* Pakiti za sheria zitakazotumiwa
* Muda wa kukimbia kwa tathmini 15min/1saa/8masaa
* Mada za SNS, chagua wakati wa kutuma arifa: Anza, maliza, badilisha hali, ripoti ya kupata
* Sifa za kupewa matokeo

**Pakiti ya Sheria**: Ina sheria kadhaa za kibinafsi ambazo huchunguzwa dhidi ya EC2 wakati tathmini inapofanywa. Kila moja pia ina ukali (juu, wa kati, chini, taarifa). Uwezekano ni:

* Mapungufu na Ufichuzi wa Kawaida (CVEs)
* Kigezo cha Kituo cha Mtandao cha Usalama (CIS)
* Mazoea Bora ya Usalama

Baada ya kusanidi Jukumu la Amazon Inspector, Mawakala wa AWS wamefungwa, lengo limeboreshwa na kigezo kimeboreshwa, utaweza kukimbia. Tathmini inaweza kusitishwa, kuendelea, au kufutwa.

Amazon Inspector ina seti iliyopangwa mapema ya sheria, zilizogawanywa kwenye pakiti. Kila Kigezo cha Tathmini hufafanua ni pakiti zipi za sheria zitakazojumuishwa kwenye jaribio. Mifano inachunguzwa dhidi ya pakiti za sheria zilizojumuishwa kwenye kigezo cha tathmini.

{% hint style="info" %}
Tambua kuwa siku hizi AWS tayari inakuruhusu **kuunda kiotomatiki** mipangilio yote muhimu na hata **kuweka mawakala kiotomatiki ndani ya mifano ya EC2.**
{% endhint %}

### **Ripoti**

**Telemetria**: data inayokusanywa kutoka kwa kifaa, ikielezea usanidi wake, tabia na michakato wakati wa kukimbia kwa tathmini. Mara tu inapokusanywa, data hiyo inatumwa kwa Amazon Inspector karibu wakati halisi kupitia TLS ambapo kisha hufungwa na kusimbwa kwenye S3 kupitia ufunguo wa KMS wa muda mfupi. Amazon Inspector kisha hupata Kikapu cha S3, kusimbua data akilini, na kuchambua dhidi ya pakiti za sheria zilizotumiwa kwa tathmini hiyo ili kuzalisha matokeo.

**Ripoti ya Tathmini**: Toa maelezo kuhusu nini kilichofanyiwa tathmini na matokeo ya tathmini.

* Ripoti ya **matokeo** ina muhtasari wa tathmini, habari kuhusu EC2 na sheria na matokeo yaliyotokea.
* Ripoti ya **kamili** ni ripoti ya matokeo + orodha ya sheria zilizopita.

## Urambazaji
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Baada ya Uvamizi

{% hint style="success" %}
Kutoka mtazamo wa mshambuliaji, huduma hii inaweza kumsaidia mshambuliaji kupata mapungufu na mianya ya mtandao ambayo inaweza kumsaidia kudukua mifano/maakasha mengine.

Hata hivyo, mshambuliaji pia anaweza kuwa na nia ya kuvuruga huduma hii ili muathirika asiweze kuona mapungufu (yote au maalum).
{% endhint %}

TODO: PRs ni karibu

<details>

<summary><strong>Jifunze kuhusu kuvamia AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuvamia kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
