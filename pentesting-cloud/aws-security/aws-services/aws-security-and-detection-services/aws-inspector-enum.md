# AWS - Inspector Enum

<details>

<summary><strong>ゼロからヒーローまでのAWSハッキングを学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をご覧ください！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをご覧ください
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローしてください。**
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを共有してください。

</details>

## Inspector

Amazon Inspectorサービスは**エージェントベース**であり、評価したいEC2インスタンスにソフトウェアエージェントを**インストールする必要があります**。これにより、AWSインフラストラクチャ内で既に実行されている既存のリソースにいつでも簡単に設定して追加できます。これにより、Amazon Inspectorは、セキュリティの別のレベルとして既存のセキュリティプロセスや手順とシームレスに統合されます。

これらはAWS Inspectorで実行できるテストです：

* **CVE**
* **CISベンチマーク**
* **セキュリティベストプラクティス**
* **ネットワークリーチャビリティ**

これらのいずれかを選択したEC2マシンで実行できます。

### AWS Inspectorの要素

**ロール**: EC2インスタンスに対する読み取り専用アクセスを許可するために、Amazon Inspectorにロールを作成または選択する（DescribeInstances）\
**評価対象**: 評価を実行したいEC2インスタンスのグループ\
**AWSエージェント**: EC2インスタンスにインストールする必要があるソフトウェアエージェント。データはTLSチャネルを使用してAmazon Inspectorに送信されます。エージェントからインスペクターへの定期的なハートビートが指示を求めて送信されます。自動更新が可能です\
**評価テンプレート**: EC2インスタンスで評価が実行される方法についての特定の設定を定義します。評価テンプレートは作成後に変更することはできません。

* 使用するルールパッケージ
* 評価実行の期間 15分/1時間/8時間
* SNSトピック、通知するタイミングを選択：開始、終了、状態変更、所見報告
* 所見に割り当てる属性

**ルールパッケージ**: 評価が実行されるときにEC2に対してチェックされる個々のルールが含まれています。それぞれには重大度（高、中、低、情報）もあります。可能性は以下の通りです：

* 一般的な脆弱性と露出（CVE）
* インターネットセキュリティセンター（CIS）ベンチマーク
* セキュリティベストプラクティス

Amazon Inspectorロールが設定され、AWSエージェントがインストールされ、ターゲットが設定され、テンプレートが設定されると、実行できるようになります。評価実行は停止、再開、または削除することができます。

Amazon Inspectorには、パッケージにグループ化された事前定義されたルールセットがあります。各評価テンプレートは、テストに含めるルールパッケージを定義します。インスタンスは、評価テンプレートに含まれるルールパッケージに対して評価されます。

{% hint style="info" %}
現在、AWSでは、必要な**設定**を**自動作成**し、EC2インスタンス内にエージェントを自動的に**インストール**することができます。
{% endhint %}

### **レポーティング**

**テレメトリー**: 評価実行中にインスタンスから収集されるデータで、その設定、動作、プロセスの詳細を示します。収集されたデータは、TLSを介してほぼリアルタイムでAmazon Inspectorに送信され、そこで一時的なKMSキーを介してS3に保存および暗号化されます。Amazon InspectorはS3バケットにアクセスし、メモリ内でデータを復号化し、その評価に使用されたルールパッケージに対して分析し、所見を生成します。

**評価レポート**: 評価された内容と評価の結果についての詳細を提供します。

* **所見レポート**には、評価の要約、EC2とルールに関する情報、発生した所見が含まれています。
* **完全レポート**は、所見レポート + 合格したルールのリストです。

## 列挙
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## ポストエクスプロイテーション

{% hint style="success" %}
攻撃者の視点から、このサービスは攻撃者が脆弱性やネットワークの露出を見つけるのに役立ち、他のインスタンスやコンテナを侵害する手助けとなる可能性があります。

しかし、攻撃者はこのサービスを妨害して、被害者が脆弱性（全てまたは特定のもの）を見つけられないようにすることにも興味を持つかもしれません。
{% endhint %}

TODO: PRs are welcome

<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をチェック！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックしてください。
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)で**フォローしてください。**
* **HackTricks**のGitHubリポジトリ[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)にPRを提出して、あなたのハッキングのコツを共有してください。

</details>
