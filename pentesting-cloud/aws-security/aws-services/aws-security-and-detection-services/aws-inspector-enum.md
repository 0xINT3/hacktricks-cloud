# AWS - Inspector Enum

<details>

<summary><strong>支持 HackTricks 并获得福利！</strong></summary>

* 如果您想在 HackTricks 中看到您的公司广告，或者如果您想访问 PEASS 的最新版本或下载 PDF 版的 HackTricks，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方 PEASS 和 HackTricks 商品**](https://peass.creator-spring.com)
* 发现[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) **和** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github 仓库提交 PR 来分享您的黑客技巧。**

</details>

## Inspector

Amazon Inspector 服务是基于代理的，这意味着它需要在您想要评估的任何 EC2 实例上安装软件代理。这使得它成为一个易于配置和添加到已在您的 AWS 基础架构中运行的现有资源的服务。这有助于 Amazon Inspector 成为您现有安全流程和程序的无缝集成，作为另一层安全。

以下是 AWS Inspector 允许您执行的测试：

* **CVEs**
* **CIS 基准**
* **安全最佳实践**
* **网络可达性**

您可以在您选择的 EC2 机器上运行其中任何一个。

### AWS Inspector 的组成部分

**角色**：创建或选择一个角色，允许 Amazon Inspector 对 EC2 实例具有只读访问权限（DescribeInstances）\
**评估目标**：要对其运行评估的一组 EC2 实例\
**AWS 代理**：必须在 EC2 实例上安装的软件代理，用于监视。数据通过 TLS 通道发送到 Amazon Inspector。代理定期向 Inspector 发送心跳请求指令。它可以自动更新自身\
**评估模板**：定义在 EC2 实例上运行评估的具体配置。创建评估模板后无法修改。

* 要使用的规则包
* 评估运行的持续时间 15 分钟/1 小时/8 小时
* SNS 主题，选择何时通知：开始、完成、状态更改、报告发现
* 分配给发现的属性

**规则包**：包含一系列在运行评估时针对 EC2 进行检查的单个规则。每个规则还具有严重性（高、中、低、信息）。可能性包括：

* 通用漏洞和公开漏洞（CVEs）
* 互联网安全中心（CIS）基准
* 安全最佳实践

一旦配置了 Amazon Inspector 角色，安装了 AWS 代理，配置了目标和模板，您就可以运行它。评估运行可以停止、恢复或删除。

Amazon Inspector 有一组预定义的规则，分组为包。每个评估模板定义了在测试中包含哪些规则包。实例正在根据评估模板中包含的规则包进行评估。

{% hint style="info" %}
请注意，现在 AWS 已经允许您**自动创建**所有必要的**配置**，甚至自动**在 EC2 实例内部安装代理**。
{% endhint %}

### **报告**

**遥测数据**：从实例收集的数据，详细说明了在评估运行期间的配置、行为和进程。收集完成后，数据通过 TLS 近实时发送回 Amazon Inspector，然后使用临时 KMS 密钥将其存储和加密在 S3 上。然后，Amazon Inspector 访问 S3 存储桶，在内存中解密数据，并根据用于该评估的任何规则包对其进行分析以生成发现。

**评估报告**：提供有关评估内容和评估结果的详细信息。

* **发现报告**包含评估的摘要、有关 EC2 和规则的信息以及发现的结果。
* **完整报告**是发现报告 + 通过的规则列表。

<details>

<summary><strong>支持 HackTricks 并获得福利！</strong></summary>

* 如果您想在 HackTricks 中看到您的公司广告，或者如果您想访问 PEASS 的最新版本或下载 PDF 版的 HackTricks，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方 PEASS 和 HackTricks 商品**](https://peass.creator-spring.com)
* 发现[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) **和** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github 仓库提交 PR 来分享您的黑客技巧。**

</details>
