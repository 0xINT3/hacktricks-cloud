# AWS - WAF Enum

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **d√©p√¥ts Github.**

</details>

## WAF

AWS WAF est un **pare-feu d'application Web** qui aide √† **prot√©ger vos applications Web** ou vos API contre les exploits Web courants qui peuvent affecter la disponibilit√©, compromettre la s√©curit√© ou consommer des ressources excessives. AWS WAF vous donne le contr√¥le sur **la fa√ßon dont le trafic atteint vos applications** en vous permettant de cr√©er des **r√®gles de s√©curit√© qui bloquent les mod√®les d'attaque courants**, tels que l'injection SQL ou le cross-site scripting, et des r√®gles qui filtrent des mod√®les de trafic sp√©cifiques que vous d√©finissez.

### Conditions

Les conditions vous permettent de sp√©cifier **quels √©l√©ments de la requ√™te HTTP ou HTTPS entrante vous souhaitez que WAF surveille** (XSS, GEO - filtrage par emplacement -, adresse IP, contraintes de taille, attaques par injection SQL, correspondance de cha√Ænes et d'expressions r√©guli√®res). Notez que si vous restreignez un pays √† partir de CloudFront, cette demande n'arrivera pas au WAF.

Vous pouvez avoir **100 conditions de chaque type**, telles que Geo Match ou les contraintes de taille, cependant, **Regex** est l'**exception** √† cette r√®gle o√π **seules 10 conditions Regex** sont autoris√©es, mais cette limite est possible √† augmenter. Vous pouvez avoir **100 r√®gles et 50 Web ACL par compte AWS**. Vous √™tes limit√© √† **5 r√®gles bas√©es sur le taux** par compte. Enfin, vous pouvez avoir **10 000 demandes par seconde** lors de l'utilisation de WAF dans votre Application Load Balancer.

### R√®gles

En utilisant ces conditions, vous pouvez cr√©er des r√®gles : par exemple, bloquer une demande si 2 conditions sont remplies.\
Lors de la cr√©ation de votre r√®gle, on vous demandera de s√©lectionner un **type de r√®gle** : **r√®gle r√©guli√®re** ou **r√®gle bas√©e sur le taux**.

La seule **diff√©rence** entre une r√®gle bas√©e sur le taux et une r√®gle r√©guli√®re est que les r√®gles bas√©es sur le taux comptent le nombre de demandes qui sont re√ßues √† partir d'une adresse IP particuli√®re sur une p√©riode de temps de **cinq minutes**.

Lorsque vous s√©lectionnez une option de r√®gle bas√©e sur le taux, on vous demande d'**entrer le nombre maximum de demandes d'une seule adresse IP dans une p√©riode de cinq minutes**. Lorsque la limite de comptage est atteinte, **toutes les autres demandes de cette m√™me adresse IP sont alors bloqu√©es**. Si le taux de demande retombe en dessous de la limite de taux sp√©cifi√©e, le trafic est alors autoris√© √† passer et n'est plus bloqu√©. Lorsque vous d√©finissez votre limite de taux, elle **doit √™tre sup√©rieure √† 2000**. Toute demande en dessous de cette limite est consid√©r√©e comme une r√®gle r√©guli√®re.

### Actions

Une action est appliqu√©e √† chaque r√®gle, ces actions peuvent √™tre **Autoriser**, **Bloquer** ou **Compter**.

* Lorsqu'une demande est **autoris√©e**, elle est **transmise** √† la distribution CloudFront ou √† l'Application Load Balancer correspondant.
* Lorsqu'une demande est **bloqu√©e**, la demande est **termin√©e** l√† et aucun traitement ult√©rieur de cette demande n'est effectu√©.
* Une action de **Comptage** va **compter le nombre de demandes qui r√©pondent aux conditions** de cette r√®gle. C'est une option vraiment int√©ressante √† s√©lectionner lors de la test des r√®gles pour s'assurer que la r√®gle capte les demandes comme pr√©vu avant de la d√©finir comme Autoriser ou Bloquer.

Si une **demande entrante ne r√©pond √† aucune r√®gle** dans le Web ACL, la demande prend l'action associ√©e √† une **action par d√©faut** sp√©cifi√©e qui peut √™tre soit **Autoriser** soit **Bloquer**. Un point important √† souligner √† propos de ces r√®gles est qu'elles sont **ex√©cut√©es dans l'ordre dans lequel elles sont r√©pertori√©es dans un Web ACL**. Soyez donc prudent pour architecturer cet ordre correctement pour votre base de r√®gles, **typiquement** elles sont **ordonn√©es** comme suit :

1. Adresses IP en liste blanche en tant qu'Autoriser.
2. Adresses IP en liste noire en tant que Bloquer.
3. Toutes les signatures malveillantes √©galement en tant que Bloquer.

### CloudWatch

Les m√©triques WAF CloudWatch sont rapport√©es **par d√©faut √† intervalles d'une minute** et sont conserv√©es pendant une p√©riode de deux semaines. Les m√©triques surveill√©es sont AllowedRequests, BlockedRequests, CountedRequests et PassedRequests.

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **d√©p√¥ts Github.**

</details>