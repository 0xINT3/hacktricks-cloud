# AWS - Config Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* HackTricks에서 **회사 광고를 보거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 상품**](https://peass.creator-spring.com)을 구매하세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 여러분의 해킹 기법을 공유하세요.

</details>

## AWS Config

AWS Config는 **리소스 변경 사항을 기록**하여 Config에서 지원하는 리소스의 변경 사항을 기록합니다. 이는 변경된 내용과 유용한 메타데이터를 포함하는 구성 항목(configuration item, CI)이라는 파일에 저장됩니다.
이 서비스는 **지역별로** 사용됩니다.

구성 항목 또는 **CI**는 AWS Config의 주요 구성 요소입니다. 이는 지원되는 리소스의 구성 정보, 관계 정보 및 기타 메타데이터를 포함하는 JSON 파일로 구성됩니다. AWS Config가 리소스에 대해 기록할 수 있는 모든 정보는 CI 내에 포함됩니다. CI는 지원되는 리소스의 구성에 변경이 있을 때마다 생성됩니다. 영향을 받은 리소스의 세부 정보를 기록하는 것 외에도, AWS Config는 변경이 해당 리소스에 영향을 미치지 않았는지 확인하기 위해 직접 관련된 리소스에 대한 CI도 기록합니다.

* **메타데이터**: 구성 항목 자체에 대한 세부 정보를 포함합니다. CI를 고유하게 식별하는 버전 ID 및 구성 ID가 포함됩니다. 다른 CI와 비교할 수 있는 MD5 해시도 포함될 수 있습니다.
* **속성**: 실제 리소스에 대한 일반적인 **속성 정보**를 보유합니다. 이 섹션 내에서는 고유한 리소스 ID와 리소스에 연결된 키-값 태그도 포함됩니다. 리소스 유형도 나열됩니다. 예를 들어, EC2 인스턴스에 대한 CI인 경우, 나열된 리소스 유형은 해당 EC2 인스턴스의 네트워크 인터페이스 또는 탄력적 IP 주소일 수 있습니다.
* **관계**: 리소스가 가질 수 있는 모든 **관련 관계에 대한 정보**를 보유합니다. 따라서 이 섹션 내에서는 이 리소스와 관련된 다른 리소스와의 명확한 설명이 표시됩니다. 예를 들어, CI가 EC2 인스턴스에 대한 것이라면, 관계 섹션에는 EC2 인스턴스가 속한 VPC와 서브넷과의 연결이 표시될 수 있습니다.
* **현재 구성**: 이는 AWS CLI에서 수행하는 describe 또는 list API 호출을 수행한 결과와 동일한 정보를 표시합니다. AWS Config는 동일한 정보를 얻기 위해 동일한 API 호출을 사용합니다.
* **관련 이벤트**: 이는 AWS CloudTrail과 관련이 있습니다. 이는 이 CI의 생성을 트리거한 변경과 관련된 **AWS CloudTrail 이벤트 ID**를 표시합니다. 리소스에 대한 변경이 발생할 때마다 새로운 CI가 생성됩니다. 따라서 다른 CloudTrail 이벤트 ID가 생성됩니다.

**구성 기록**: 구성 항목을 통해 리소스의 구성 기록을 얻을 수 있습니다. 구성 기록은 6시간마다 제공되며 특정 리소스 유형에 대한 모든 CI를 포함합니다.

**구성 스트림**: 구성 항목은 데이터 분석을 가능하게 하기 위해 SNS 주제로 전송됩니다.

**구성 스냅샷**: 구성 항목은 지원되는 모든 리소스의 시점 스냅샷을 생성하는 데 사용됩니다.

**S3는** 구성 기록 파일과 데이터의 모든 구성 스냅샷을 단일 버킷에 저장하는 데 사용됩니다. 이는 구성 레코더에서 정의된 것입니다. 여러 AWS 계정이 있는 경우 기본 계정의 S3 버킷에 구성 기록 파일을 집계할 수 있습니다. 그러나 이를 위해 config.amazonaws.com 서비스 주체와 기본 계정의 S3 버킷에 대한 쓰기 액세스 권한을 부여해야 합니다.

### 작동 방식

* 보안 그룹이나 버킷 액세스 제어 목록과 같은 변경 사항을 가할 때 -> AWS Config에서 이벤트로 발생
* 모든 것을 S3 버킷에 저장
* 설정에 따라 변경 사항이 발생하면 람다 함수를 트리거하거나 주기적으로 AWS Config 설정을 확인하는 람다 함수를 예약할 수 있음
* 람다 함수가 Config로 피드백
* 규칙이 위반되면 Config가 SNS를 실행

![](<../../../../.gitbook/assets/image (46).png>)

### Config 규칙

Config 규칙은 **리소스 전체에 대한 특정 준수 검사 및 제어를 강제하는 데 도움이 되는** 좋은 방법이며, 각 리소스 유형에 대해 이상적인 배포 사양을 채택할 수 있도록 해줍니다. 각 규칙은 사실상 람다 함수이며, 호출될 때 리소스를 평가하고 규칙과의 준수 결과를 결정하기 위해 간단한 논리를 수행합니다. 지원되는 리소스 중 하나에 변경이 가해지면 AWS Config는 설정된 모든 구성 규칙에 대해 준수 여부를 확인합니다.\
AWS에는 사용할 준비가 된 보안 범주에 속하는 몇 가지 **미리 정의된 규칙**이 있습니다. 예를 들어, Rds-storage-encrypted입니다. 이는 RDS 데이터베이스 인스턴스에서 저장소 암호화가 활성화되었는지 확인합니다. Encrypted-volumes입니다. 이는 첨부된 상태인 EBS 볼륨 중 암호화된 볼륨이 있는지 확인합니다.

* **AWS 관리 규칙**: 이미 존재할 수 있는 규칙이 있으므로 직접 설정하기 전에 미리 정의된 규칙을 먼저 살펴보는 것이 좋습니다.
* **사용자 정의 규칙**: 특정 사용자 정의 구성을 확인하기 위해 사용자 정의 규칙을 생성할 수 있습니다.

지역당 50개의 구성 규칙 제한이 있으며, 이를 늘리려면 AWS에 문의해야 합니다.\
준수하지 않은 결과는 삭제되지 않습니다.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* HackTricks에서 **회사 광고를 보거나 HackTricks를
