# AWS - Enumerazione di Config

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) di GitHub.

</details>

## AWS Config

AWS Config **registra le modifiche alle risorse**, quindi qualsiasi modifica a una risorsa supportata da Config pu√≤ essere registrata, che **registrer√† cosa √® cambiato insieme ad altri metadati utili, il tutto contenuto in un file noto come elemento di configurazione**, un CI.
Questo servizio √® **specifico per la regione**.

Un elemento di configurazione o **CI**, come √® noto, √® un componente chiave di AWS Config. √à composto da un file JSON che **contiene le informazioni di configurazione, le informazioni sulle relazioni e altri metadati come una vista istantanea a un determinato punto nel tempo di una risorsa supportata**. Tutte le informazioni che AWS Config pu√≤ registrare per una risorsa sono catturate all'interno del CI. Un CI viene creato **ogni volta** che una risorsa supportata subisce una modifica alla sua configurazione in qualsiasi modo. Oltre a registrare i dettagli della risorsa interessata, AWS Config registrer√† anche CI per tutte le risorse direttamente correlate per assicurarsi che la modifica non abbia influenzato anche quelle risorse.

* **Metadati**: Contiene dettagli sull'elemento di configurazione stesso. Un ID di versione e un ID di configurazione, che identificano in modo univoco il CI. Altre informazioni possono includere un MD5Hash che consente di confrontare altri CI gi√† registrati rispetto alla stessa risorsa.
* **Attributi**: Contiene informazioni comuni sugli **attributi effettivi della risorsa**. All'interno di questa sezione, abbiamo anche un ID di risorsa univoco e eventuali tag chiave-valore associati alla risorsa. Viene inoltre elencato il tipo di risorsa. Ad esempio, se si trattasse di un CI per un'istanza EC2, i tipi di risorse elencati potrebbero essere l'interfaccia di rete o l'indirizzo IP elastico per quella istanza EC2.
* **Relazioni**: Contiene informazioni su qualsiasi **relazione connessa che la risorsa pu√≤ avere**. Quindi, all'interno di questa sezione, verr√† mostrata una descrizione chiara di qualsiasi relazione con altre risorse che questa risorsa ha. Ad esempio, se il CI fosse per un'istanza EC2, la sezione delle relazioni potrebbe mostrare la connessione a una VPC insieme alla subnet in cui risiede l'istanza EC2.
* **Configurazione corrente**: Mostra le stesse informazioni che verrebbero generate se si eseguisse una chiamata API di descrizione o elenco effettuata tramite AWS CLI. AWS Config utilizza le stesse chiamate API per ottenere le stesse informazioni.
* **Eventi correlati**: Questo si riferisce ad AWS CloudTrail. Mostra l'**ID evento AWS CloudTrail** che √® correlato alla modifica che ha innescato la creazione di questo CI. Viene creato un nuovo CI per ogni modifica apportata a una risorsa. Di conseguenza, verranno creati diversi ID eventi CloudTrail.

**Cronologia delle configurazioni**: √à possibile ottenere la cronologia delle configurazioni delle risorse grazie agli elementi di configurazione. Una cronologia delle configurazioni viene fornita ogni 6 ore e contiene tutti i CI per un determinato tipo di risorsa.

**Flussi di configurazione**: Gli elementi di configurazione vengono inviati a un argomento SNS per consentire l'analisi dei dati.

**Snapshot delle configurazioni**: Gli elementi di configurazione vengono utilizzati per creare uno snapshot istantaneo di tutte le risorse supportate.

**S3 viene utilizzato per archiviare** i file di cronologia delle configurazioni e gli snapshot di configurazione dei dati all'interno di un singolo bucket, definito nel registratore di configurazione. Se si dispone di pi√π account AWS, √® possibile aggregare i file di cronologia delle configurazioni nel medesimo bucket S3 per il proprio account principale. Tuttavia, sar√† necessario concedere l'accesso in scrittura per questo principio di servizio, config.amazonaws.com, e i propri account secondari con accesso in scrittura al bucket S3 nel proprio account principale.

### Funzionamento

* Quando si apportano modifiche, ad esempio al gruppo di sicurezza o alla lista di controllo degli accessi al bucket ‚Äî> viene generato un evento rilevato da AWS Config
* Tutto viene archiviato nel bucket S3
* A seconda della configurazione, non appena qualcosa cambia potrebbe innescare una funzione lambda O pianificare una funzione lambda per esaminare periodicamente le impostazioni di AWS Config
* Lambda fornisce feedback a Config
* Se viene violata una regola, Config avvia un SNS

![](<../../../../.gitbook/assets/image (46).png>)

### Regole di configurazione

Le regole di configurazione sono un ottimo modo per aiutarti a **applicare controlli e verifiche di conformit√† specifici** **su tutte le tue risorse**, e ti consentono di adottare una specifica di distribuzione ideale per ciascuno dei tuoi tipi di risorse. Ogni regola **√® essenzialmente una funzione lambda** che, quando chiamata, valuta la risorsa e esegue una logica semplice per determinare il risultato di conformit√† con la regola. **Ogni volta che viene apportata una modifica** a una delle risorse supportate, **AWS Config verificher√† la conformit√† rispetto a tutte le regole di configurazione che hai impostato**.\
AWS dispone di una serie di **regole predefinite** che rientrano nell'ambito della sicurezza e che sono pronte all'uso. Ad esempio, Rds-storage-encrypted. Questa verifica se la crittografia dello storage √® attivata dalle istanze del database RDS. Encrypted-volumes. Questa verifica se i volumi EBS che hanno uno stato allegato sono crittografati.

* **Regole gestite da AWS**: Insieme di regole predefinite che coprono molte best practice, quindi vale sempre la pena esaminare queste regole prima di impostare le proprie, poich√© potrebbe gi√† esistere una regola.
* **Regole personalizzate**: √à possibile creare regole personalizzate per verificare configurazioni personalizzate specifiche.

Limite di 50 regole di configurazione per regione prima di dover contattare AWS per un aumento.\
I risultati non conformi NON vengono eliminati.

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter**
