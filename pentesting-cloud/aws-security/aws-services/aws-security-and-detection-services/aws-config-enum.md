# AWS - Enum√©ration de Config

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**d√©p√¥ts GitHub HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## AWS Config

AWS Config **capture les modifications de ressources**, de sorte que toute modification apport√©e √† une ressource prise en charge par Config peut √™tre enregistr√©e, ce qui **enregistrera ce qui a chang√© ainsi que d'autres m√©tadonn√©es utiles, le tout contenu dans un fichier appel√© √©l√©ment de configuration**, un CI.\
Ce service est **sp√©cifique √† la r√©gion**.

Un √©l√©ment de configuration ou **CI**, comme on l'appelle, est un composant cl√© d'AWS Config. Il est compos√© d'un fichier JSON qui **contient les informations de configuration, les informations de relation et d'autres m√©tadonn√©es en tant que vue instantan√©e √† un moment donn√© d'une ressource prise en charge**. Toutes les informations que AWS Config peut enregistrer pour une ressource sont captur√©es dans le CI. Un CI est cr√©√© **chaque fois** qu'une ressource prise en charge subit une modification de sa configuration de quelque mani√®re que ce soit. En plus d'enregistrer les d√©tails de la ressource affect√©e, AWS Config enregistrera √©galement des CIs pour toutes les ressources directement li√©es pour s'assurer que la modification n'a pas affect√© ces ressources √©galement.

* **M√©tadonn√©es** : Contient des d√©tails sur l'√©l√©ment de configuration lui-m√™me. Un ID de version et un ID de configuration, qui identifie de mani√®re unique le CI. D'autres informations peuvent inclure un MD5Hash qui vous permet de comparer d'autres CIs d√©j√† enregistr√©s par rapport √† la m√™me ressource.
* **Attributs** : Cela contient des **informations d'attribut courantes contre la ressource r√©elle**. Dans cette section, nous avons √©galement un ID de ressource unique et toutes les balises cl√©-valeur associ√©es √† la ressource. Le type de ressource est √©galement r√©pertori√©. Par exemple, s'il s'agissait d'un CI pour une instance EC2, les types de ressources r√©pertori√©s pourraient √™tre l'interface r√©seau ou l'adresse IP √©lastique pour cette instance EC2.
* **Relations** : Cela contient des informations pour toute **relation connect√©e que la ressource peut avoir**. Ainsi, dans cette section, il montrerait une description claire de toute relation avec d'autres ressources que cette ressource avait. Par exemple, si le CI √©tait pour une instance EC2, la section de relation pourrait montrer la connexion √† un VPC ainsi que le sous-r√©seau dans lequel l'instance EC2 r√©side.
* **Configuration actuelle** : Cela affichera les m√™mes informations qui seraient g√©n√©r√©es si vous deviez effectuer un appel API de description ou de liste effectu√© par AWS CLI. AWS Config utilise les m√™mes appels API pour obtenir les m√™mes informations.
* **√âv√©nements associ√©s** : Cela concerne AWS CloudTrail. Cela affichera l'**ID d'√©v√©nement AWS CloudTrail qui est li√© √† la modification qui a d√©clench√© la cr√©ation de ce CI**. Un nouveau CI est cr√©√© pour chaque modification apport√©e √† une ressource. Par cons√©quent, diff√©rents ID d'√©v√©nements CloudTrail seront cr√©√©s.

**Historique de configuration** : Il est possible d'obtenir l'historique de configuration des ressources gr√¢ce aux √©l√©ments de configuration. Un historique de configuration est fourni toutes les 6 heures et contient tous les CIs pour un type de ressource particulier.

**Flux de configuration** : Les √©l√©ments de configuration sont envoy√©s √† un sujet SNS pour permettre l'analyse des donn√©es.

**Instantan√©s de configuration** : Les √©l√©ments de configuration sont utilis√©s pour cr√©er un instantan√© √† un moment donn√© de toutes les ressources prises en charge.

**S3 est utilis√© pour stocker** les fichiers d'historique de configuration et tous les instantan√©s de configuration de vos donn√©es dans un seul compartiment, qui est d√©fini dans l'enregistreur de configuration. Si vous avez plusieurs comptes AWS, vous voudrez peut-√™tre agr√©ger vos fichiers d'historique de configuration dans le m√™me compartiment S3 pour votre compte principal. Cependant, vous devrez accorder l'acc√®s en √©criture √† ce principe de service, config.amazonaws.com, et √† vos comptes secondaires avec un acc√®s en √©criture au compartiment S3 de votre compte principal.

### Fonctionnement

* Lorsque des modifications sont apport√©es, par exemple au groupe de s√©curit√© ou √† la liste de contr√¥le d'acc√®s du compartiment -> d√©clenche un √©v√©nement capt√© par AWS Config
* Stocke tout dans le compartiment S3
* Selon la configuration, d√®s qu'un changement se produit, cela peut d√©clencher une fonction lambda OU programmer une fonction lambda pour examiner p√©riodiquement les param√®tres AWS Config
* Lambda renvoie √† Config
* Si une r√®gle est enfreinte, Config lance un SNS

![](<../../../../.gitbook/assets/image (46).png>)

### R√®gles de configuration

Les r√®gles de configuration sont un excellent moyen de vous aider √† **appliquer des v√©rifications de conformit√© et des contr√¥les sp√©cifiques √† travers vos ressources**, et vous permet d'adopter une sp√©cification de d√©ploiement id√©ale pour chacun de vos types de ressources. Chaque r√®gle **est essentiellement une fonction lambda** qui, lorsqu'elle est appel√©e, √©value la ressource et effectue une logique simple pour d√©terminer le r√©sultat de conformit√© avec la r√®gle. **Chaque fois qu'un changement est apport√©** √† l'une de vos ressources prises en charge, **AWS Config v√©rifiera la conformit√© par rapport √† toutes les r√®gles de configuration que vous avez en place**.\
AWS dispose d'un certain nombre de **r√®gles pr√©d√©finies** qui rel√®vent du parapluie de la s√©curit√© et qui sont pr√™tes √† l'emploi. Par exemple, Rds-storage-encrypted. Cela v√©rifie si le chiffrement de stockage est activ√© par vos instances de base de donn√©es RDS. Encrypted-volumes. Cela v√©rifie si des volumes EBS qui ont un √©tat attach√© sont chiffr√©s.

* **R√®gles g√©r√©es par AWS** : Ensemble de r√®gles pr√©d√©finies qui couvrent de nombreuses meilleures pratiques, il vaut donc toujours la peine de parcourir ces r√®gles avant de mettre en place les v√¥tres car il y a une chance que la r√®gle existe d√©j√†.
* **R√®gles personnalis√©es** : Vous pouvez cr√©er vos propres r√®gles pour v√©rifier des configurations personnalis√©es sp√©cifiques.

Limite de 50 r√®gles de configuration par r√©gion avant de devoir contacter AWS pour une augmentation.\
Les r√©sultats non conformes ne sont PAS supprim√©s.

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**d√©p√¥ts GitHub HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>