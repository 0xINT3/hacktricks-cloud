# AWS - Config Enum

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS红队专家）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想看到您的**公司在HackTricks中做广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS＆HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或在**Twitter**上关注我们 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>

## AWS Config

AWS Config **捕获资源更改**，因此任何受Config支持的资源的更改都可以被记录下来，这将**记录更改内容以及其他有用的元数据，所有这些都保存在一个名为配置项（CI）的文件中**。此服务是**特定于区域**的。

配置项或**CI**是AWS Config的一个关键组件。它由一个JSON文件组成，**保存配置信息、关系信息和其他元数据，作为受支持资源的某个时间点的快照视图**。AWS Config可以记录的有关资源的所有信息都包含在CI中。每当受支持的资源的配置发生更改时，都会创建一个CI。除了记录受影响资源的详细信息外，AWS Config还将记录任何直接相关资源的CI，以确保更改不会影响这些资源。

* **元数据**：包含有关配置项本身的详细信息。版本ID和配置ID，用于唯一标识CI。其他信息可能包括MD5哈希，允许您将已记录的其他CI与同一资源进行比较。
* **属性**：此部分保存与实际资源相关的常见**属性信息**。在此部分中，还有一个唯一资源ID和与资源关联的任何键值标签。还列出了资源类型。例如，如果这是一个EC2实例的CI，列出的资源类型可能是网络接口，或该EC2实例的弹性IP地址。
* **关系**：此部分保存资源可能具有的任何连接**关系的信息**。因此，在此部分中，它将显示此资源与其他资源的任何关系的清晰描述。例如，如果CI是针对一个EC2实例的，关系部分可能显示与VPC的连接以及EC2实例所在的子网。
* **当前配置**：这将显示如果您通过AWS CLI执行描述或列出API调用时生成的相同信息。AWS Config使用相同的API调用来获取相同的信息。
* **相关事件**：这与AWS CloudTrail有关。这将显示与触发创建此CI的更改相关的**AWS CloudTrail事件ID**。针对资源进行的每次更改都会创建一个新的CI。因此，将创建不同的CloudTrail事件ID。

**配置历史**：通过配置项，可以获取资源的配置历史。每隔6小时提供一次配置历史，其中包含特定资源类型的所有CI。

**配置流**：配置项被发送到SNS主题，以便对数据进行分析。

**配置快照**：使用配置项创建受支持资源的时间点快照。

**使用S3来存储**配置历史文件和数据的任何配置快照，这些都在一个单独的存储桶中定义，该存储桶在配置记录器中定义。如果您有多个AWS账户，您可能希望将配置历史文件聚合到主账户的同一个S3存储桶中。但是，您需要为此服务主体config.amazonaws.com和具有对主账户中S3存储桶的写入访问权限的辅助账户授予写入访问权限。

### 功能

* 当进行更改时，例如对安全组或存储桶访问控制列表进行更改 —> 触发AWS Config捕获的事件
* 将所有内容存储在S3存储桶中
* 根据设置，一旦发生更改，可能会触发一个Lambda函数，或者安排Lambda函数定期查看AWS Config设置
* Lambda反馈给Config
* 如果违反规则，Config会触发一个SNS

![](<../../../../.gitbook/assets/image (126).png>)

### 配置规则

配置规则是帮助您**强制执行特定合规性检查** **和跨资源控制**的好方法，允许您为每种资源类型采用理想的部署规范。每个规则**本质上是一个Lambda函数**，当调用时评估资源并执行一些简单逻辑以确定规则的合规性结果。**每当对您支持的资源进行更改时**，**AWS Config将检查您设置的任何配置规则的合规性**。\
AWS有许多属于安全范围的**预定义规则**可供使用。例如，Rds-storage-encrypted。这检查您的RDS数据库实例是否已激活存储加密。Encrypted-volumes。这检查任何已附加状态的EBS卷是否已加密。

* **AWS托管规则**：一组涵盖许多最佳实践的预定义规则，因此在设置自己的规则之前，浏览这些规则总是值得的，因为规则可能已经存在。
* **自定义规则**：您可以创建自己的规则来检查特定的自定义配置。

每个区域最多50个配置规则，之后需要联系AWS进行增加。\
不合规结果不会被删除。

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS红队专家）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想看到您的**公司在HackTricks中做广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS＆HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或在**Twitter**上关注我们 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
