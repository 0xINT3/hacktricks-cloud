# AWS - Konfiguracja Enum

<details>

<summary><strong>Dowiedz się, jak hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## AWS Config

AWS Config **rejestruje zmiany zasobów**, więc każda zmiana w zasobie obsługiwanym przez Config może być zarejestrowana, co **zapisuje, co się zmieniło wraz z innymi przydatnymi metadanymi, wszystko przechowywane w pliku znanych jako element konfiguracji**, CI.
Ta usługa jest **specyficzna dla regionu**.

Element konfiguracji lub **CI**, jak jest znany, jest kluczowym elementem AWS Config. Składa się on z pliku JSON, który **zawiera informacje o konfiguracji, informacje o relacjach i inne metadane jako widok migawki w punkcie w czasie obsługiwanego zasobu**. Wszystkie informacje, które AWS Config może zarejestrować dla zasobu, są rejestrowane w CI. CI jest tworzony **za każdym razem**, gdy obsługiwany zasób ma wprowadzoną zmianę w swojej konfiguracji w dowolny sposób. Oprócz rejestrowania szczegółów dotyczących dotkniętego zasobu, AWS Config zarejestruje również CI dla wszystkich bezpośrednio powiązanych zasobów, aby upewnić się, że zmiana nie wpłynęła również na te zasoby.

* **Metadane**: Zawiera szczegóły dotyczące samego elementu konfiguracji. Identyfikator wersji i identyfikator konfiguracji, które jednoznacznie identyfikują CI. Inne informacje mogą obejmować skrót MD5Hash, który umożliwia porównanie innych już zarejestrowanych CI dla tego samego zasobu.
* **Atrybuty**: Zawiera wspólne **informacje o atrybutach dotyczących rzeczywistego zasobu**. W tej sekcji znajduje się również unikalny identyfikator zasobu oraz wszelkie tagi klucz-wartość powiązane z zasobem. Wymieniony jest również typ zasobu. Na przykład, jeśli był to CI dla instancji EC2, wymienione mogą być typy zasobów, takie jak interfejs sieciowy lub adres IP elastyczny dla tej instancji EC2.
* **Relacje**: Zawiera informacje o dowolnych powiązanych **relacjach, jakie zasób może mieć**. W tej sekcji zostanie wyświetlone jasne opisanie każdej relacji z innymi zasobami, jakie ma ten zasób. Na przykład, jeśli CI dotyczył instancji EC2, sekcja relacji może pokazywać połączenie z VPC oraz podsieć, w której znajduje się instancja EC2.
* **Bieżąca konfiguracja**: Wyświetli te same informacje, które byłyby generowane, gdybyś wykonał wywołanie API describe lub list za pomocą AWS CLI. AWS Config używa tych samych wywołań API, aby uzyskać te same informacje.
* **Powiązane zdarzenia**: Dotyczy to AWS CloudTrail. Wyświetli **ID zdarzenia AWS CloudTrail, które jest związane ze zmianą, która spowodowała utworzenie tego CI**. Dla każdej zmiany wprowadzonej w zasobie tworzony jest nowy CI. W rezultacie będą tworzone różne identyfikatory zdarzeń CloudTrail.

**Historia konfiguracji**: Dzięki elementom konfiguracji można uzyskać historię konfiguracji zasobów. Historia konfiguracji jest dostarczana co 6 godzin i zawiera wszystkie CI dla określonego typu zasobu.

**Strumienie konfiguracji**: Elementy konfiguracji są wysyłane do tematu SNS, aby umożliwić analizę danych.

**Migawki konfiguracji**: Elementy konfiguracji są używane do utworzenia migawki w punkcie w czasie wszystkich obsługiwanych zasobów.

**S3 jest używane do przechowywania** plików historii konfiguracji i migawek konfiguracji Twoich danych w jednym kubełku, który jest zdefiniowany w rejestratorze konfiguracji. Jeśli masz wiele kont AWS, możesz chcieć agregować pliki historii konfiguracji do tego samego kubełka S3 dla swojego głównego konta. Jednak będziesz musiał udzielić dostępu do zapisu dla tej usługi, config.amazonaws.com, oraz Twoim kontom podrzędnym z dostępem do zapisu do kubełka S3 w Twoim głównym koncie.

### Funkcjonowanie

* Gdy dokonujesz zmian, na przykład w grupie zabezpieczeń lub liście kontroli dostępu do kubełka —> wywołuje to zdarzenie, które jest wykrywane przez AWS Config
* Wszystko jest przechowywane w kubełku S3
* W zależności od konfiguracji, gdy coś się zmienia, może to spowodować uruchomienie funkcji lambda LUB zaplanowanie funkcji lambda do okresowego przeglądania ustawień AWS Config
* Funkcja lambda przekazuje informacje zwrotne do Config
* Jeśli reguła została naruszona, Config uruchamia SNS

![](<../../../../.gitbook/assets/image (46).png>)

### Reguły konfiguracji

Reguły konfiguracji są doskonałym sposobem **na wymuszanie określonych sprawdzeń zgodności** **i kontroli dla Twoich zasobów**, pozwalając na przyjęcie idealnej specyfikacji wdrożenia dla każdego typu zasobu. Każda reguła **to w zasadzie funkcja lambda**, która po wywołaniu ocenia zasób i wykonuje prostą logikę w celu określenia zgodności z regułą. **Za każdym razem, gdy dokonana zostaje zmiana** w jednym z obsługiwanych zasobów, **AWS Config sprawdzi zgodność z regułami konfiguracji, które masz ustawione**.\
AWS ma wiele **predefiniowanych reguł**, które wpisują się w ramy bezpieczeństwa i są gotowe do użycia. Na przykład, Rds-storage-encrypted. Sprawdza, czy szyfrowanie magazynu jest aktywowane dla instancji bazy danych RDS. Encrypted-volumes. Sprawdza, czy jakiekolwiek woluminy EBS, które mają stan podłączony, są zaszyfrowane.

* **Zarządzane reguły AWS**: Zestaw predefiniowanych reguł, które obejmują wiele najlepszych praktyk, więc zawsze warto najpierw przeglądnąć te reguły, zanim utworzysz własne, ponieważ istnieje szansa, że reguła już istnieje.
* **Własne reguły**: Możesz tworzyć własne reguły, aby sprawdzać określone niestandardowe konfiguracje.

Limit 50 reguł konfiguracji na region
