# AWS - Config Enum

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## AWS Config

O AWS Config **captura mudan√ßas de recursos**, ent√£o qualquer altera√ß√£o em um recurso suportado pelo Config pode ser registrada, o que **registra o que mudou junto com outras metadados √∫teis, todos contidos em um arquivo conhecido como um item de configura√ß√£o**, um CI.\
Este servi√ßo √© **espec√≠fico da regi√£o**.

Um item de configura√ß√£o ou **CI**, como √© conhecido, √© um componente chave do AWS Config. Consiste em um arquivo JSON que **cont√©m as informa√ß√µes de configura√ß√£o, informa√ß√µes de relacionamento e outros metadados como uma vis√£o de instant√¢neo de um recurso suportado**. Todas as informa√ß√µes que o AWS Config pode registrar para um recurso s√£o capturadas dentro do CI. Um CI √© criado **toda vez** que uma mudan√ßa √© feita na configura√ß√£o de um recurso suportado de qualquer forma. Al√©m de registrar os detalhes do recurso afetado, o AWS Config tamb√©m registrar√° CIs para quaisquer recursos diretamente relacionados para garantir que a mudan√ßa n√£o afetou esses recursos tamb√©m.

* **Metadados**: Cont√©m detalhes sobre o pr√≥prio item de configura√ß√£o. Um ID de vers√£o e um ID de configura√ß√£o, que identifica exclusivamente o CI. Outras informa√ß√µes podem incluir um MD5Hash que permite comparar outros CIs j√° registrados contra o mesmo recurso.
* **Atributos**: Isso cont√©m **informa√ß√µes comuns de atributos contra o pr√≥prio recurso**. Dentro desta se√ß√£o, tamb√©m temos um ID de recurso √∫nico, e quaisquer tags de valor-chave que est√£o associadas ao recurso. O tipo de recurso tamb√©m √© listado. Por exemplo, se este fosse um CI para uma inst√¢ncia EC2, os tipos de recursos listados poderiam ser a interface de rede ou o endere√ßo IP el√°stico para essa inst√¢ncia EC2.
* **Relacionamentos**: Isso cont√©m informa√ß√µes para qualquer **relacionamento conectado que o recurso possa ter**. Ent√£o, dentro desta se√ß√£o, mostraria uma descri√ß√£o clara de qualquer relacionamento com outros recursos que este recurso tinha. Por exemplo, se o CI fosse para uma inst√¢ncia EC2, a se√ß√£o de relacionamento pode mostrar a conex√£o com um VPC junto com a sub-rede em que a inst√¢ncia EC2 reside.
* **Configura√ß√£o atual**: Isso exibir√° as mesmas informa√ß√µes que seriam geradas se voc√™ realizasse uma chamada de API de descrever ou listar feita pelo AWS CLI. O AWS Config usa as mesmas chamadas de API para obter as mesmas informa√ß√µes.
* **Eventos relacionados**: Isso se relaciona com o AWS CloudTrail. Isso exibir√° o **ID do evento AWS CloudTrail que est√° relacionado √† mudan√ßa que desencadeou a cria√ß√£o deste CI**. Um novo CI √© feito para cada mudan√ßa feita contra um recurso. Como resultado, diferentes IDs de eventos CloudTrail ser√£o criados.

**Hist√≥rico de Configura√ß√£o**: √â poss√≠vel obter o hist√≥rico de configura√ß√£o dos recursos gra√ßas aos itens de configura√ß√£o. Um hist√≥rico de configura√ß√£o √© entregue a cada 6 horas e cont√©m todos os CIs para um tipo de recurso espec√≠fico.

**Streams de Configura√ß√£o**: Itens de configura√ß√£o s√£o enviados para um T√≥pico SNS para permitir a an√°lise dos dados.

**Snapshots de Configura√ß√£o**: Itens de configura√ß√£o s√£o usados para criar um snapshot de ponto no tempo de todos os recursos suportados.

**S3 √© usado para armazenar** os arquivos de Hist√≥rico de Configura√ß√£o e quaisquer Snapshots de Configura√ß√£o dos seus dados dentro de um √∫nico bucket, que √© definido dentro do gravador de Configura√ß√£o. Se voc√™ tem v√°rias contas AWS, talvez queira agregar seus arquivos de hist√≥rico de configura√ß√£o no mesmo bucket S3 para sua conta principal. No entanto, voc√™ precisar√° conceder acesso de escrita para este princ√≠pio de servi√ßo, config.amazonaws.com, e suas contas secund√°rias com acesso de escrita ao bucket S3 em sua conta principal.

### Funcionamento

* Quando faz mudan√ßas, por exemplo, no grupo de seguran√ßa ou na lista de controle de acesso do bucket ‚Äî> dispara como um Evento capturado pelo AWS Config
* Armazena tudo em um bucket S3
* Dependendo da configura√ß√£o, assim que algo mudar, isso poderia disparar uma fun√ß√£o lambda OU agendar uma fun√ß√£o lambda para periodicamente verificar as configura√ß√µes do AWS Config
* Lambda retorna informa√ß√µes para o Config
* Se uma regra for violada, Config dispara um SNS

![](<../../../../.gitbook/assets/image (46).png>)

### Regras de Config

As regras de config s√£o uma √≥tima maneira de ajudar a **aplicar verifica√ß√µes de conformidade espec√≠ficas** **e controles em seus recursos**, e permite que voc√™ adote uma especifica√ß√£o de implanta√ß√£o ideal para cada um dos seus tipos de recursos. Cada regra **√© essencialmente uma fun√ß√£o lambda** que, quando chamada, avalia o recurso e executa alguma l√≥gica simples para determinar o resultado da conformidade com a regra. **Cada vez que uma mudan√ßa √© feita** em um dos seus recursos suportados, **o AWS Config verificar√° a conformidade contra quaisquer regras de config que voc√™ tenha configurado**.\
A AWS tem uma s√©rie de **regras predefinidas** que se enquadram no guarda-chuva de seguran√ßa que est√£o prontas para uso. Por exemplo, Rds-storage-encrypted. Isso verifica se a criptografia de armazenamento est√° ativada para suas inst√¢ncias de banco de dados RDS. Encrypted-volumes. Isso verifica se os volumes EBS que t√™m um estado anexado est√£o criptografados.

* **Regras gerenciadas pela AWS**: Conjunto de regras predefinidas que cobrem muitas das melhores pr√°ticas, ent√£o vale sempre a pena navegar por essas regras primeiro antes de configurar as suas pr√≥prias, pois h√° uma chance de que a regra j√° exista.
* **Regras personalizadas**: Voc√™ pode criar suas pr√≥prias regras para verificar configura√ß√µes personalizadas espec√≠ficas.

Limite de 50 regras de config por regi√£o antes de precisar contatar a AWS para um aumento.\
Resultados n√£o conformes N√ÉO s√£o exclu√≠dos.

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
