# AWS - Config Enum

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## AWS Config

AWS Config **captura cambios en recursos**, por lo que cualquier cambio en un recurso compatible con Config puede ser registrado, lo cual **registrar√° qu√© cambi√≥ junto con otros metadatos √∫tiles, todo contenido en un archivo conocido como un elemento de configuraci√≥n**, un CI.\
Este servicio es **espec√≠fico de la regi√≥n**.

Un elemento de configuraci√≥n o **CI**, como se conoce, es un componente clave de AWS Config. Consiste en un archivo JSON que **contiene la informaci√≥n de configuraci√≥n, informaci√≥n de relaciones y otros metadatos como una vista de instant√°nea en un punto espec√≠fico en el tiempo de un recurso compatible**. Toda la informaci√≥n que AWS Config puede registrar para un recurso se captura dentro del CI. Se crea un CI **cada vez** que se realiza un cambio en la configuraci√≥n de un recurso compatible de cualquier manera. Adem√°s de registrar los detalles del recurso afectado, AWS Config tambi√©n registrar√° CIs para cualquier recurso directamente relacionado para asegurar que el cambio no afect√≥ a esos recursos tambi√©n.

* **Metadatos**: Contiene detalles sobre el propio elemento de configuraci√≥n. Un ID de versi√≥n y un ID de configuraci√≥n, que identifica de manera √∫nica al CI. Otra informaci√≥n puede incluir un MD5Hash que permite comparar otros CIs ya registrados contra el mismo recurso.
* **Atributos**: Esto contiene **informaci√≥n com√∫n de atributos contra el recurso real**. Dentro de esta secci√≥n, tambi√©n tenemos un ID de recurso √∫nico, y cualquier etiqueta de clave-valor que est√© asociada al recurso. Tambi√©n se lista el tipo de recurso. Por ejemplo, si esto fuera un CI para una instancia EC2, los tipos de recursos listados podr√≠an ser la interfaz de red, o la direcci√≥n IP el√°stica para esa instancia EC2.
* **Relaciones**: Esto contiene informaci√≥n para cualquier **relaci√≥n conectada que el recurso pueda tener**. As√≠ que dentro de esta secci√≥n, mostrar√≠a una descripci√≥n clara de cualquier relaci√≥n con otros recursos que este recurso tuviera. Por ejemplo, si el CI fuera para una instancia EC2, la secci√≥n de relaciones podr√≠a mostrar la conexi√≥n a un VPC junto con la subred en la que reside la instancia EC2.
* **Configuraci√≥n actual**: Esto mostrar√° la misma informaci√≥n que se generar√≠a si se realizara una llamada a la API de describir o listar hecha por el AWS CLI. AWS Config utiliza las mismas llamadas a la API para obtener la misma informaci√≥n.
* **Eventos relacionados**: Esto se relaciona con AWS CloudTrail. Esto mostrar√° el **ID del evento de AWS CloudTrail que est√° relacionado con el cambio que provoc√≥ la creaci√≥n de este CI**. Se crea un nuevo CI para cada cambio realizado contra un recurso. Como resultado, se crear√°n diferentes IDs de eventos de CloudTrail.

**Historial de Configuraci√≥n**: Es posible obtener el historial de configuraci√≥n de los recursos gracias a los elementos de configuraci√≥n. Un historial de configuraci√≥n se entrega cada 6 horas y contiene todos los CI para un tipo de recurso en particular.

**Flujos de Configuraci√≥n**: Los elementos de configuraci√≥n se env√≠an a un Tema SNS para permitir el an√°lisis de los datos.

**Instant√°neas de Configuraci√≥n**: Los elementos de configuraci√≥n se utilizan para crear una instant√°nea en un punto en el tiempo de todos los recursos compatibles.

**S3 se utiliza para almacenar** los archivos de Historial de Configuraci√≥n y cualquier Instant√°nea de Configuraci√≥n de tus datos dentro de un solo bucket, que se define dentro del grabador de Configuraci√≥n. Si tienes varias cuentas de AWS, es posible que desees agregar tus archivos de historial de configuraci√≥n en el mismo bucket de S3 para tu cuenta principal. Sin embargo, necesitar√°s otorgar acceso de escritura para este principio de servicio, config.amazonaws.com, y tus cuentas secundarias con acceso de escritura al bucket de S3 en tu cuenta principal.

### Funcionamiento

* Cuando se realizan cambios, por ejemplo en un grupo de seguridad o en la lista de control de acceso de un bucket ‚Äî> se dispara como un Evento detectado por AWS Config
* Almacena todo en un bucket de S3
* Dependiendo de la configuraci√≥n, tan pronto como algo cambie podr√≠a activar una funci√≥n lambda O programar una funci√≥n lambda para que peri√≥dicamente revise las configuraciones de AWS Config
* Lambda retroalimenta a Config
* Si se ha roto una regla, Config activa un SNS

![](<../../../../.gitbook/assets/image (46).png>)

### Reglas de Config

Las reglas de Config son una excelente manera de ayudarte a **hacer cumplir controles y verificaciones de cumplimiento espec√≠ficos** **en tus recursos**, y te permite adoptar una especificaci√≥n de despliegue ideal para cada uno de tus tipos de recursos. Cada regla **es esencialmente una funci√≥n lambda** que al ser llamada eval√∫a el recurso y lleva a cabo una l√≥gica simple para determinar el resultado de cumplimiento con la regla. **Cada vez que se realiza un cambio** en uno de tus recursos compatibles, **AWS Config verificar√° el cumplimiento contra cualquier regla de Config que tengas establecida**.\
AWS tiene una serie de **reglas predefinidas** que caen bajo el paraguas de seguridad que est√°n listas para usar. Por ejemplo, Rds-storage-encrypted. Esto verifica si la encriptaci√≥n de almacenamiento est√° activada por tus instancias de base de datos RDS. Encrypted-volumes. Esto verifica si cualquier volumen EBS que tenga un estado adjunto est√° encriptado.

* **Reglas administradas por AWS**: Conjunto de reglas predefinidas que cubren muchas de las mejores pr√°cticas, por lo que siempre vale la pena explorar estas reglas primero antes de configurar las tuyas propias, ya que hay una posibilidad de que la regla ya exista.
* **Reglas personalizadas**: Puedes crear tus propias reglas para verificar configuraciones personalizadas espec√≠ficas.

L√≠mite de 50 reglas de Config por regi√≥n antes de que necesites contactar a AWS para un aumento.\
Los resultados no conformes NO se eliminan.

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
