# AWS - Firewall Manager Aufz√§hlung

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## Firewall Manager

**AWS Firewall Manager** vereinfacht das Management und die Wartung von **AWS WAF, AWS Shield Advanced, Amazon VPC-Sicherheitsgruppen und Netzwerkzugriffssteuerungslisten (ACLs), AWS Network Firewall, AWS Route 53 Resolver DNS Firewall und Firewalls von Drittanbietern** √ºber mehrere Konten und Ressourcen hinweg. Es erm√∂glicht Ihnen, Ihre Firewall-Regeln, Shield Advanced-Schutzma√ünahmen, VPC-Sicherheitsgruppen und Netzwerk-Firewall-Einstellungen nur einmal zu konfigurieren, wobei der Dienst **diese Regeln und Schutzma√ünahmen automatisch √ºber Ihre Konten und Ressourcen hinweg durchsetzt**, einschlie√ülich neu hinzugef√ºgter.

Der Dienst bietet die M√∂glichkeit, **bestimmte Ressourcen zusammenzufassen und zu sch√ºtzen**, wie z. B. solche, die ein gemeinsames Tag teilen oder alle Ihre CloudFront-Verteilungen. Ein wesentlicher Vorteil des Firewall Managers ist seine F√§higkeit, **den Schutz automatisch auf neu hinzugef√ºgte Ressourcen** in Ihrem Konto auszudehnen.

Eine **Regelgruppe** (eine Sammlung von WAF-Regeln) kann in eine AWS Firewall Manager-Richtlinie eingebunden werden, die dann mit spezifischen AWS-Ressourcen wie CloudFront-Verteilungen oder Anwendungs-Load-Balancern verkn√ºpft ist.

AWS Firewall Manager bietet **verwaltete Anwendungs- und Protokolllisten** zur Vereinfachung der Konfiguration und Verwaltung von Sicherheitsgruppenrichtlinien. Diese Listen erm√∂glichen es Ihnen, die von Ihren Richtlinien erlaubten oder verweigerten Protokolle und Anwendungen zu definieren. Es gibt zwei Arten von verwalteten Listen:

* **Firewall Manager verwaltete Listen**: Diese Listen umfassen **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** und **FMS-Default-Protocols-Allowed**. Sie werden von Firewall Manager verwaltet und enthalten h√§ufig verwendete Anwendungen und Protokolle, die der Allgemeinheit erlaubt oder verweigert werden sollten. Es ist nicht m√∂glich, sie zu bearbeiten oder zu l√∂schen, jedoch k√∂nnen Sie deren Version ausw√§hlen.
* **Benutzerdefinierte verwaltete Listen**: Diese Listen verwalten Sie selbst. Sie k√∂nnen benutzerdefinierte Anwendungs- und Protokolllisten erstellen, die auf die Bed√ºrfnisse Ihrer Organisation zugeschnitten sind. Im Gegensatz zu den von Firewall Manager verwalteten Listen haben diese Listen keine Versionen, aber Sie haben die volle Kontrolle √ºber benutzerdefinierte Listen, sodass Sie sie bei Bedarf erstellen, bearbeiten und l√∂schen k√∂nnen.

Es ist wichtig zu beachten, dass **Firewall Manager-Richtlinien nur "Block" oder "Count" Aktionen** f√ºr eine Regelgruppe zulassen, ohne eine "Erlauben"-Option.

### Voraussetzungen

Die folgenden Voraussetzungen m√ºssen erf√ºllt sein, bevor Sie mit der Konfiguration des Firewall Managers beginnen k√∂nnen, um die Ressourcen Ihrer Organisation effektiv zu sch√ºtzen. Diese Schritte stellen die grundlegende Einrichtung bereit, die f√ºr den Firewall Manager erforderlich ist, um Sicherheitsrichtlinien durchzusetzen und die Einhaltung in Ihrer AWS-Umgebung sicherzustellen:

1. **Treten Sie AWS Organizations bei und konfigurieren Sie diese:** Stellen Sie sicher, dass Ihr AWS-Konto Teil der AWS Organizations-Organisation ist, in der die AWS Firewall Manager-Richtlinien implementiert werden sollen. Dies erm√∂glicht eine zentrale Verwaltung von Ressourcen und Richtlinien √ºber mehrere AWS-Konten innerhalb der Organisation.
2. **Erstellen Sie ein Standardadministrator-Konto f√ºr AWS Firewall Manager:** Richten Sie ein Standardadministrator-Konto ein, das speziell f√ºr die Verwaltung von Sicherheitsrichtlinien des Firewall Managers zust√§ndig ist. Dieses Konto ist daf√ºr verantwortlich, Sicherheitsrichtlinien in der Organisation zu konfigurieren und durchzusetzen. Nur das Verwaltungskonto der Organisation kann Standardadministrator-Konten f√ºr den Firewall Manager erstellen.
3. **Aktivieren Sie AWS Config:** Aktivieren Sie AWS Config, um dem Firewall Manager die erforderlichen Konfigurationsdaten und Einblicke bereitzustellen, die f√ºr die effektive Durchsetzung von Sicherheitsrichtlinien erforderlich sind. AWS Config hilft dabei, Ressourcenkonfigurationen und -√§nderungen zu analysieren, zu √ºberpr√ºfen, zu √ºberwachen und zu √ºberpr√ºfen, was eine bessere Sicherheitsverwaltung erm√∂glicht.
4. **F√ºr Richtlinien von Drittanbietern, abonnieren Sie im AWS Marketplace und konfigurieren Sie die Einstellungen von Drittanbietern:** Wenn Sie vorhaben, Richtlinien von Drittanbietern f√ºr Firewalls zu nutzen, abonnieren Sie diese im AWS Marketplace und konfigurieren Sie die erforderlichen Einstellungen. Dieser Schritt stellt sicher, dass der Firewall Manager Richtlinien von vertrauensw√ºrdigen Drittanbietern integrieren und durchsetzen kann.
5. **F√ºr Netzwerk-Firewall- und DNS-Firewall-Richtlinien, aktivieren Sie die Ressourcenfreigabe:** Aktivieren Sie die Ressourcenfreigabe speziell f√ºr Netzwerk-Firewall- und DNS-Firewall-Richtlinien. Dadurch kann der Firewall Manager Firewall-Schutzma√ünahmen auf die VPCs und die DNS-Aufl√∂sung Ihrer Organisation anwenden und die Netzwerksicherheit verbessern.
6. **Um AWS Firewall Manager in standardm√§√üig deaktivierten Regionen zu verwenden:** Wenn Sie beabsichtigen, den Firewall Manager in AWS-Regionen zu verwenden, die standardm√§√üig deaktiviert sind, stellen Sie sicher, dass Sie die erforderlichen Schritte unternehmen, um dessen Funktionalit√§t in diesen Regionen zu aktivieren. Dies gew√§hrleistet eine konsistente Sicherheitsdurchsetzung in allen Regionen, in denen Ihre Organisation t√§tig ist.

Weitere Informationen finden Sie unter: [Erste Schritte mit AWS Firewall Manager AWS WAF-Richtlinien](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Arten von Schutzrichtlinien

AWS Firewall Manager verwaltet mehrere Arten von Richtlinien, um Sicherheitskontrollen √ºber verschiedene Aspekte der Infrastruktur Ihrer Organisation durchzusetzen:

1. **AWS WAF-Richtlinie:** Dieser Richtlinientyp unterst√ºtzt sowohl AWS WAF als auch AWS WAF Classic. Sie k√∂nnen festlegen, welche Ressourcen durch die Richtlinie gesch√ºtzt werden. F√ºr AWS WAF-Richtlinien k√∂nnen Sie Sets von Regelgruppen festlegen, die zuerst und zuletzt im Web-ACL ausgef√ºhrt werden sollen. Dar√ºber hinaus k√∂nnen Kontoinhaber Regeln und Regelgruppen hinzuf√ºgen, die zwischen diesen Sets ausgef√ºhrt werden sollen.
2. **Shield Advanced-Richtlinie:** Diese Richtlinie wendet Shield Advanced-Schutzma√ünahmen auf Ihre Organisation f√ºr bestimmte Ressourcentypen an. Sie hilft, sich gegen DDoS-Angriffe und andere Bedrohungen zu sch√ºtzen.
3. **Amazon VPC-Sicherheitsgruppenrichtlinie:** Mit dieser Richtlinie k√∂nnen Sie Sicherheitsgruppen verwalten, die in Ihrer Organisation verwendet werden, und eine Grundmenge von Regeln in Ihrer AWS-Umgebung durchsetzen, um den Netzwerkzugriff zu steuern.
4. **Amazon VPC-Netzwerkzugriffssteuerungslisten (ACL)-Richtlinie:** Dieser Richtlinientyp gibt Ihnen die Kontrolle √ºber Netzwerk-ACLs, die in Ihrer Organisation verwendet werden, und erm√∂glicht es Ihnen, eine Grundmenge von Netzwerk-ACLs in Ihrer AWS-Umgebung durchzusetzen.
5. **Netzwerk-Firewall-Richtlinie:** Diese Richtlinie wendet den AWS Network Firewall-Schutz auf die VPCs Ihrer Organisation an und verbessert die Netzwerksicherheit, indem der Datenverkehr basierend auf vordefinierten Regeln gefiltert wird.
6. **Amazon Route 53 Resolver DNS Firewall-Richtlinie:** Diese Richtlinie wendet DNS Firewall-Schutzma√ünahmen auf die VPCs Ihrer Organisation an, um b√∂sartige Domainaufl√∂sungsversuche zu blockieren und Sicherheitsrichtlinien f√ºr den DNS-Datenverkehr durchzusetzen.
7. **Richtlinie f√ºr Firewalls von Drittanbietern:** Dieser Richtlinientyp wendet Schutzma√ünahmen von Firewalls von Drittanbietern an, die √ºber das AWS Marketplace-Konsole abonniert werden k√∂nnen. Sie erm√∂glicht es Ihnen, zus√§tzliche Sicherheitsma√ünahmen von vertrauensw√ºrdigen Anbietern in Ihre AWS-Umgebung zu integrieren.
1. **Palo Alto Networks Cloud NGFW-Richtlinie:** Diese Richtlinie wendet Palo Alto Networks Cloud Next Generation Firewall (NGFW)-Schutzma√ünahmen und Regelstapel auf die VPCs Ihrer Organisation an und bietet erweiterte Bedrohungspr√§vention und Sicherheitskontrollen auf Anwendungsebene.
2. **Fortigate Cloud Native Firewall (CNF) as a Service-Richtlinie:** Diese Richtlinie wendet Fortigate Cloud Native Firewall (CNF) as a Service-Schutzma√ünahmen an, die branchenf√ºhrende Bedrohungspr√§vention, Web Application Firewall (WAF) und API-Schutz bieten, die speziell f√ºr Cloud-Infrastrukturen entwickelt wurden.
### Administrator-Konten

AWS Firewall Manager bietet Flexibilit√§t bei der Verwaltung von Firewall-Ressourcen innerhalb Ihrer Organisation durch ihren administrativen Umfang und zwei Arten von Administrator-Konten.

**Der administrative Umfang definiert die Ressourcen, die ein Firewall Manager-Administrator verwalten kann**. Nachdem ein AWS Organizations-Verwaltungskonto eine Organisation in den Firewall Manager aufgenommen hat, kann es zus√§tzliche Administratoren mit unterschiedlichen administrativen Umf√§ngen erstellen. Diese Umf√§nge k√∂nnen umfassen:

- Konten oder organisatorische Einheiten (OUs), auf die der Administrator Richtlinien anwenden kann.
- Regionen, in denen der Administrator Aktionen ausf√ºhren kann.
- Firewall Manager-Richtlinientypen, die der Administrator verwalten kann.

Der administrative Umfang kann entweder **vollst√§ndig oder eingeschr√§nkt** sein. Ein vollst√§ndiger Umfang gew√§hrt dem Administrator Zugriff auf **alle angegebenen Ressourcentypen, Regionen und Richtlinientypen**. Im Gegensatz dazu gew√§hrt ein **eingeschr√§nkter Umfang administrative Berechtigungen nur f√ºr eine Teilmenge von Ressourcen, Regionen oder Richtlinientypen**. Es ist ratsam, Administratoren nur die Berechtigungen zu erteilen, die sie ben√∂tigen, um ihre Aufgaben effektiv zu erf√ºllen. Sie k√∂nnen eine beliebige Kombination dieser administrativen Umfangsbedingungen auf einen Administrator anwenden, um die Einhaltung des Prinzips des geringsten Privilegs sicherzustellen.

Es gibt zwei verschiedene Arten von Administrator-Konten, die jeweils spezifische Rollen und Verantwortlichkeiten erf√ºllen:

- **Standardadministrator:**
- Das Standardadministrator-Konto wird vom AWS Organizations-Verwaltungskonto der Organisation w√§hrend des Onboarding-Prozesses zum Firewall Manager erstellt.
- Dieses Konto hat die M√∂glichkeit, Drittanbieter-Firewalls zu verwalten und besitzt einen vollen administrativen Umfang.
- Es dient als prim√§res Administrator-Konto f√ºr den Firewall Manager, das f√ºr die Konfiguration und Durchsetzung von Sicherheitsrichtlinien in der gesamten Organisation verantwortlich ist.
- W√§hrend der Standardadministrator vollen Zugriff auf alle Ressourcentypen und administrativen Funktionen hat, arbeitet er auf der gleichen Peer-Ebene wie andere Administratoren, wenn mehrere Administratoren in der Organisation eingesetzt werden.
- **Firewall Manager-Administratoren:**
- Diese Administratoren k√∂nnen Ressourcen innerhalb des vom AWS Organizations-Verwaltungskonto festgelegten Umfangs verwalten, wie in der Konfiguration des administrativen Umfangs definiert.
- Firewall Manager-Administratoren werden erstellt, um spezifische Rollen innerhalb der Organisation zu erf√ºllen, was eine Delegation von Verantwortlichkeiten erm√∂glicht, w√§hrend Sicherheits- und Compliance-Standards eingehalten werden.
- Beim Erstellen √ºberpr√ºft der Firewall Manager bei AWS Organizations, ob das Konto bereits ein delegierter Administrator ist. Wenn nicht, ruft der Firewall Manager bei Organizations an, um das Konto als delegierten Administrator f√ºr den Firewall Manager zu kennzeichnen.

Die Verwaltung dieser Administrator-Konten umfasst deren Erstellung im Firewall Manager und die Definition ihrer administrativen Umf√§nge gem√§√ü den Sicherheitsanforderungen der Organisation und dem Prinzip des geringsten Privilegs. Durch die Zuweisung geeigneter administrativer Rollen k√∂nnen Organisationen eine effektive Sicherheitsverwaltung sicherstellen und gleichzeitig eine granulare Kontrolle √ºber den Zugriff auf sensible Ressourcen aufrechterhalten.

Es ist wichtig zu betonen, dass **nur ein Konto innerhalb einer Organisation als Standardadministrator f√ºr den Firewall Manager fungieren kann**, unter Einhaltung des Prinzips "**first in, last out**". Um einen neuen Standardadministrator zu bestimmen, m√ºssen eine Reihe von Schritten befolgt werden:

- Zun√§chst muss jedes Firewall-Manager-Administrator-Konto sein eigenes Konto widerrufen.
- Dann kann der bestehende Standardadministrator sein eigenes Konto widerrufen und die Organisation effektiv vom Firewall Manager abmelden. Dieser Vorgang f√ºhrt zur L√∂schung aller vom widerrufenen Konto erstellten Firewall-Manager-Richtlinien.
- Abschlie√üend muss das AWS Organizations-Verwaltungskonto den Firewall Manager-Standardadministrator bestimmen.

## Enumeration
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post-Exploitation / Umgehung der Erkennung

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
Ein Angreifer mit der Berechtigung **`fms:AssociateAdminAccount`** k√∂nnte das Standard-Administratorkonto des Firewall-Managers festlegen. Mit der Berechtigung **`fms:PutAdminAccount`** k√∂nnte ein Angreifer ein Firewall-Manager-Administratorkonto erstellen oder aktualisieren, und mit der Berechtigung **`fms:DisassociateAdminAccount`** k√∂nnte ein potenzieller Angreifer die aktuelle Zuordnung des Firewall-Manager-Administratorkontos entfernen.

- Die Trennung des **Standard-Administrators des Firewall-Managers folgt der First-In-Last-Out-Richtlinie**. Alle Firewall-Manager-Administratoren m√ºssen sich trennen, bevor der Standard-Administrator des Firewall-Managers das Konto trennen kann.
- Um einen Firewall-Manager-Administrator durch **PutAdminAccount** zu erstellen, muss das Konto der Organisation angeh√∂ren, die zuvor mit **AssociateAdminAccount** beim Firewall-Manager an Bord gegangen ist.
- Die Erstellung eines Firewall-Manager-Administratorkontos kann nur vom Managementkonto der Organisation durchgef√ºhrt werden.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Potenzielle Auswirkungen:** Verlust der zentralisierten Verwaltung, Umgehung von Richtlinien, Versto√ü gegen Compliance und St√∂rung der Sicherheitskontrollen innerhalb der Umgebung.

### `fms:PutPolicy`, `fms:DeletePolicy`

Ein Angreifer mit den Berechtigungen **`fms:PutPolicy`** und **`fms:DeletePolicy`** k√∂nnte eine AWS Firewall Manager-Richtlinie erstellen, √§ndern oder dauerhaft l√∂schen.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
Ein Beispiel f√ºr eine gro√üz√ºgige Richtlinie durch eine gro√üz√ºgige Sicherheitsgruppe, um die Erkennung zu umgehen, k√∂nnte folgende sein:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Potenzielle Auswirkungen:** Abbau von Sicherheitskontrollen, Umgehung von Richtlinien, Versto√ü gegen Compliance, Betriebsunterbrechungen und potenzielle Datenverst√∂√üe innerhalb der Umgebung.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

Ein Angreifer mit den Berechtigungen **`fms:BatchAssociateResource`** und **`fms:BatchDisassociateResource`** kann Ressourcen mit einem Firewall Manager-Ressourcensatz verkn√ºpfen oder davon trennen. Dar√ºber hinaus w√ºrde es einem Angreifer mit den Berechtigungen **`fms:PutResourceSet`** und **`fms:DeleteResourceSet`** erm√∂glichen, diese Ressourcens√§tze im AWS Firewall Manager zu erstellen, zu √§ndern oder zu l√∂schen.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Potenzielle Auswirkungen:** Die Hinzuf√ºgung einer unn√∂tigen Menge von Elementen zu einem Ressourcensatz erh√∂ht das Rauschen im Service und kann potenziell zu einem DoS f√ºhren. Dar√ºber hinaus k√∂nnten √Ñnderungen an den Ressourcens√§tzen zu einer Ressourcenunterbrechung, zur Umgehung von Richtlinien, zur Verletzung von Compliance-Vorschriften und zur St√∂rung von Sicherheitskontrollen in der Umgebung f√ºhren.

### `fms:PutAppsList`, `fms:DeleteAppsList`

Ein Angreifer mit den Berechtigungen **`fms:PutAppsList`** und **`fms:DeleteAppsList`** kann Anwendungslisten von AWS Firewall Manager erstellen, √§ndern oder l√∂schen. Dies k√∂nnte kritisch sein, da nicht autorisierten Anwendungen m√∂glicherweise Zugriff auf die Allgemeinheit gew√§hrt wird oder der Zugriff auf autorisierte Anwendungen verweigert wird, was zu einem DoS f√ºhren k√∂nnte.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potenzielle Auswirkungen:** Dies k√∂nnte zu Fehlkonfigurationen, Umgehung von Richtlinien, Verst√∂√üen gegen die Compliance und St√∂rungen von Sicherheitskontrollen in der Umgebung f√ºhren.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

Ein Angreifer mit den Berechtigungen **`fms:PutProtocolsList`** und **`fms:DeleteProtocolsList`** k√∂nnte Protokolllisten von AWS Firewall Manager erstellen, √§ndern oder l√∂schen. √Ñhnlich wie bei Anwendungslisten k√∂nnte dies kritisch sein, da nicht autorisierte Protokolle von der Allgemeinheit verwendet oder die Verwendung autorisierter Protokolle verweigert werden k√∂nnten, was zu einem DoS f√ºhren k√∂nnte.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Potenzielle Auswirkungen:** Dies k√∂nnte zu Fehlkonfigurationen, Umgehung von Richtlinien, Verst√∂√üen gegen die Compliance und zur Beeintr√§chtigung von Sicherheitskontrollen in der Umgebung f√ºhren.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

Ein Angreifer mit den Berechtigungen **`fms:PutNotificationChannel`** und **`fms:DeleteNotificationChannel`** k√∂nnte die IAM-Rolle und das Amazon Simple Notification Service (SNS)-Thema l√∂schen und festlegen, die Firewall Manager verwendet, um SNS-Protokolle aufzuzeichnen.

Um **`fms:PutNotificationChannel`** au√üerhalb der Konsole zu verwenden, m√ºssen Sie die Zugriffsrichtlinie des SNS-Themas einrichten, die es dem angegebenen **SnsRoleName** erlaubt, SNS-Protokolle zu ver√∂ffentlichen. Wenn der bereitgestellte **SnsRoleName** eine Rolle ist, die nicht der **`AWSServiceRoleForFMS`** entspricht, ist eine Vertrauensbeziehung erforderlich, die konfiguriert ist, um dem Firewall Manager-Dienstprinzipal **fms.amazonaws.com** zu gestatten, diese Rolle anzunehmen.

F√ºr Informationen zur Konfiguration einer SNS-Zugriffsrichtlinie:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Potenzielle Auswirkungen:** Dies k√∂nnte potenziell zu fehlenden Sicherheitswarnungen, verz√∂gerter Reaktion auf Vorf√§lle, potenziellen Datenverlusten und Betriebsunterbrechungen in der Umgebung f√ºhren.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
Ein Angreifer mit den Berechtigungen **`fms:AssociateThirdPartyFirewall`** und **`fms:DisssociateThirdPartyFirewall`** k√∂nnte Drittanbieter-Firewalls mit dem AWS Firewall Manager zentral verwalten oder die Verkn√ºpfung aufheben.
{% hint style="warning" %}
Nur der Standardadministrator kann Drittanbieter-Firewalls erstellen und verwalten.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Potenzielle Auswirkungen:** Die Trennung w√ºrde zu einer Umgehung der Richtlinien, Verst√∂√üen gegen die Compliance und zur St√∂rung der Sicherheitskontrollen in der Umgebung f√ºhren. Die Assoziation hingegen w√ºrde zu einer St√∂rung der Kosten- und Budgetzuweisung f√ºhren.

### `fms:TagResource`, `fms:UntagResource`

Ein Angreifer k√∂nnte Tags zu Firewall Manager-Ressourcen hinzuf√ºgen, √§ndern oder entfernen, was die Kostenzuweisung, die Ressourcenverfolgung und die Zugriffskontrollrichtlinien Ihrer Organisation auf der Grundlage von Tags st√∂ren w√ºrde.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Potenzielle Auswirkungen**: St√∂rung der Kostenzuweisung, Ressourcenverfolgung und tagbasierten Zugriffskontrollrichtlinien.

## Referenzen

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
