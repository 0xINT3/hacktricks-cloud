# AWS - Macie Enum

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy in HackTricks wil adverteer** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

# Macie

Amazon Macie steek uit as 'n diens wat ontwerp is om outomaties data binne 'n AWS-rekening te **ontdek, klassifiseer en identifiseer**. Dit maak gebruik van **masjienleer** om deurlopend data te monitor en analiseer, met die prim√™re fokus op die opspoor en waarsku teen ongewone of verdagte aktiwiteite deur die ondersoek van **wolkspoorgebeurtenis**-data en gebruikersgedragspatrone.

Kernkenmerke van Amazon Macie:

1. **Aktiewe Data-oorsig**: Maak gebruik van masjienleer om data aktief te oorsien terwyl verskeie aksies binne die AWS-rekening plaasvind.
2. **Anomaliedeteksie**: Identifiseer onre√´lmatige aktiwiteite of toegangspatrone en genereer waarskuwings om potensi√´le blootstellingsrisiko's van data te verminder.
3. **Deurlopende Monitering**: Monitor outomaties en ontdek nuwe data in Amazon S3 deur masjienleer en kunsmatige intelligensie te gebruik om aan te pas by data-toegangspatrone oor tyd.
4. **Dataklassifikasie met NLP**: Maak gebruik van natuurlike taalverwerking (NLP) om verskillende datatipes te klassifiseer en te interpreteer, en ken risikoskore toe om bevindinge te prioritiseer.
5. **Sekuriteitsmonitering**: Identifiseer data wat sensitief is vir sekuriteit, insluitend API-sleutels, geheime sleutels en persoonlike inligting, om datalekke te voorkom.

Amazon Macie is 'n **streekdiens** en vereis die 'AWSMacieServiceCustomerSetupRole' IAM Rol en 'n geaktiveerde AWS CloudTrail vir funksionaliteit.

## Waarskuwingstelsel

Macie kategoriseer waarskuwings in vooraf gedefinieerde kategorie√´ soos:

- Geanonimiseerde toegang
- Data-nakoming
- Verlies van geloofsbriewe
- Bevoorregte eskalasie
- Ransomware
- Verdagte toegang, ens.

Hierdie waarskuwings bied gedetailleerde beskrywings en resultaatontledings vir effektiewe reaksie en oplossing.

## Dashboardkenmerke

Die dashboard kategoriseer data in verskeie afdelings, insluitend:

- S3-voorwerpe (volgens tydperk, ACL, PII)
- Ho√´-risiko CloudTrail-gebeurtenisse/gebruikers
- Aktiwiteitsplekke
- CloudTrail-gebruikersidentiteitstipes, en meer.

## Gebruikersklassifikasie

Gebruikers word geklassifiseer in vlakke gebaseer op die risikovlak van hul API-oproepe:

- **Platinum**: Ho√´-risiko API-oproepe, dikwels met administratiewe voorregte.
- **Goud**: API-oproepe verband hou met infrastruktuur.
- **Silwer**: Medium-risiko API-oproepe.
- **Brons**: Lae-risiko API-oproepe.

## Identiteitstipes

Identiteitstipes sluit in Root, IAM-gebruiker, Aanvaarde Rol, Gefedereerde Gebruiker, AWS-rekening en AWS-diens, wat die bron van versoeke aandui.

## Dataklassifikasie

Dataklassifikasie behels:

- Inhoudstipe: Gebaseer op opgespoorde inhoudstipe.
- L√™eruitbreiding: Gebaseer op l√™eruitbreiding.
- Tema: Gekategoriseer deur sleutelwoorde binne l√™ers.
- Regex: Gekategoriseer op grond van spesifieke regex-patrone.

Die hoogste risiko onder hierdie kategorie√´ bepaal die finale risikovlak van die l√™er.

## Navorsing en Analise

Die navorsingsfunksie van Amazon Macie maak dit moontlik om aangepaste navrae oor alle Macie-data vir diepgaande analise uit te voer. Filtre sluit CloudTrail-data, S3-emmer-eienskappe en S3-voorwerpe in. Dit ondersteun ook die uitnodiging van ander rekeninge om Amazon Macie te deel, wat samewerkende datamanagement en sekuriteitsmonitering fasiliteer.


## Enumerasie
```
# Get buckets
aws macie2 describe-buckets

# Org config
aws macie2 describe-organization-configuration

# Get admin account (if any)
aws macie2 get-administrator-account
aws macie2 list-organization-admin-accounts # Run from the management account of the org

# Get macie account members (run this form the admin account)
aws macie2 list-members

# Check if automated sensitive data discovey is enabled
aws macie2 get-automated-discovery-configuration

# Get findings
aws macie2 list-findings
aws macie2 get-findings --finding-ids <ids>
aws macie2 list-findings-filters
aws macie2 get -findings-filters --id <id>

# Get allow lists
aws macie2 list-allow-lists
aws macie2 get-allow-list --id <id>

# Get different info
aws macie2 list-classification-jobs
aws macie2 list-classification-scopes
aws macie2 list-custom-data-identifiers
```
### Na-Exploit

{% hint style="success" %}
Vanuit 'n aanvaller se perspektief is hierdie diens nie ontwerp om die aanvaller op te spoor nie, maar om sensitiewe inligting in die gestoorde l√™ers op te spoor. Daarom kan hierdie diens **'n aanvaller help om sensitiewe inligting** binne die emmers te vind.\
Dalk kan 'n aanvaller egter ook belangstel om dit te ontwrig ten einde te voorkom dat die slagoffer waarskuwings ontvang en om daardie inligting makliker te steel.
{% endhint %}

TODO: PR's is welkom!

# Verwysings
* [https://cloudacademy.com/blog/introducing-aws-security-hub/](https://cloudacademy.com/blog/introducing-aws-security-hub/)

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
