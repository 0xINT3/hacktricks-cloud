# AWS - Enumeración de Macie

<details>

<summary><strong>¡Apoya a HackTricks y obtén beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **última versión de PEASS o descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>

## Macie

La función principal del servicio es proporcionar un método automático de **detección, identificación y clasificación de datos** que se almacenan en su cuenta de AWS.

El servicio está respaldado por **aprendizaje automático**, lo que permite que sus datos sean revisados activamente a medida que se realizan diferentes acciones dentro de su cuenta de AWS. El aprendizaje automático puede detectar patrones de acceso y **comportamiento del usuario** analizando los datos de eventos de **cloud trail** para **alertar contra cualquier actividad inusual o irregular**. Cualquier hallazgo realizado por Amazon Macie se presenta en un panel que puede activar alertas, lo que le permite resolver rápidamente cualquier posible amenaza de exposición o compromiso de sus datos.

Amazon Macie monitorea y detecta automáticamente y de manera continua **nuevos datos que se almacenan en Amazon S3**. Utilizando las capacidades de aprendizaje automático e inteligencia artificial, este servicio tiene la capacidad de familiarizarse con el tiempo, los patrones de acceso a los datos.\
Amazon Macie también utiliza métodos de procesamiento de lenguaje natural para **clasificar e interpretar diferentes tipos y contenidos de datos**. El PNL utiliza principios de ciencias de la computación y lingüística computacional para analizar las interacciones entre las computadoras y el lenguaje humano. En particular, cómo programar computadoras para comprender y descifrar datos de lenguaje. El **servicio puede asignar automáticamente valores comerciales a los datos que se evalúan en forma de puntaje de riesgo**. Esto permite que Amazon Macie ordene los hallazgos en función de la prioridad, lo que le permite centrarse en las alertas más críticas primero. Además de esto, Amazon Macie también tiene la ventaja adicional de poder **monitorear y descubrir cambios de seguridad que rigen sus datos**. Además, identifica datos específicos centrados en la seguridad, como claves de acceso que se encuentran dentro de un bucket de S3.

Este monitoreo de seguridad protector y proactivo permite que Amazon Macie **identifique datos críticos, sensibles y enfocados en la seguridad, como claves de API, claves secretas, además de datos de PII (información de identificación personal) y PHI**.

Esto es útil para evitar fugas de datos ya que Macie detectará si está exponiendo información de personas en Internet.

Es un servicio **regional**.

Requiere la existencia del rol IAM 'AWSMacieServiceCustomerSetupRole' y necesita que AWS CloudTrail esté habilitado.

Categorías de alertas predefinidas:

* Acceso anonimizado
* Cumplimiento de configuración
* Pérdida de credenciales
* Cumplimiento de datos
* Alojamiento de archivos
* Enumeración de identidad
* Pérdida de información
* Anomalía de ubicación
* Permisos abiertos
* Escalada de privilegios
* Ransomware
* Disrupción del servicio
* Acceso sospechoso

El **resumen de alertas** proporciona información detallada para permitirle responder adecuadamente. Tiene una descripción que proporciona un nivel más profundo de comprensión de por qué se generó. También tiene un desglose de los resultados.

El usuario tiene la posibilidad de crear nuevas alertas personalizadas.

**Categorización del panel**: 

* Objetos S3 para el rango de tiempo seleccionado
* Objetos S3
* Objetos S3 por PII - Información de identificación personal
* Objetos S3 por ACL
* Eventos de CloudTrail de alto riesgo y usuarios asociados
* Errores de CloudTrail de alto riesgo y usuarios asociados
* Ubicación de actividad
* Eventos de CloudTrail
* ISP de actividad
* Tipos de identidad de usuario de CloudTrail

**Categorías de usuario**: Macie categoriza a los usuarios en las siguientes categorías:

* **Platinum**: Usuarios o roles considerados que realizan llamadas API de alto riesgo. A menudo tienen privilegios de administrador. Debe monitorearlos bastante bien en caso de que sean comprometidos.
* **Gold**: Usuarios o roles con historial de llamadas a API relacionadas con cambios de infraestructura. También debe monitorearlos.
* **Silver**: Usuarios o roles que realizan llamadas API de nivel de riesgo medio.
* **Bronze**: Usuarios o roles que utilizan el nivel más bajo de riesgo basado en llamadas API.

**Tipos de identidad**:

* Root: Solicitud realizada por el usuario raíz
* Usuario IAM: Solicitud realizada por el usuario IAM
* Rol asumido: Solicitud realizada por credenciales temporales asumidas (API AssumeRole para STS)
* Usuario federado: Solicitud realizada utilizando credenciales temporales (API GetFederationToken para STS)
* Cuenta de AWS: Solicitud realizada por una cuenta de AWS diferente
* Servicio de AWS: Solicitud realizada por un servicio de AWS

**Clasificación de datos**: existen 4 clasificaciones de archivos:

* Tipo de contenido: lista archivos basados en el tipo de contenido detectado. El riesgo dado se determina por el tipo de contenido detectado.
* Extensión de archivo: lo mismo que el tipo de contenido pero basado en la extensión
* Tema: categoriza en función de una serie de palabras clave detectadas dentro de los archivos
* Regex: categorías basadas en expresiones regulares específicas

El riesgo final de un archivo será el riesgo más alto encontrado entre esas 4 categorías.

La función de investigación permite crear sus propias consultas nuevamente en todos los datos de Amazon Macie y realizar un análisis detallado de los datos. Puede filtrar los resultados en función de: datos de CloudTrail, propiedades de bucket de S3 y objetos de S3.

Es posible invitar a otras cuentas a Amazon Macie para que varias cuentas compartan Amazon Macie.

<details>

<summary><strong>¡Apoya a HackTricks y obtén beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **última versión de PEASS o descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>