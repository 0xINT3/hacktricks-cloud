# AWS - ECS Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>

## ECS

### Temel Bilgiler

Amazon **Elastic Container Services** veya ECS, bulut ortamında **konteynerize uygulamaları barındırmak** için bir platform sağlar. ECS'nin iki **dağıtım** yöntemi vardır, EC2 örneği ve **serverless** seçeneği olan Fargate. Bu hizmet, konteynerleri bulutta çalıştırmayı çok kolay ve sorunsuz hale getirir.

ECS, aşağıdaki üç yapı bloğunu kullanarak çalışır: **Kümeler**, **Hizmetler** ve **Görev Tanımları**.

* **Kümeler**, bulutta çalışan **konteyner gruplarıdır**. Daha önce belirtildiği gibi, konteynerler için iki başlatma türü vardır: EC2 ve Fargate. AWS, EC2 başlatma türünü, müşterilere "konteynerize uygulamalarını yönettiğiniz bir Amazon EC2 örneği kümesinde çalıştırmanıza izin verir" şeklinde tanımlar. Fargate ise benzer şekilde, "arka uç altyapıyı sağlamak ve yönetmek için ihtiyaç duymadan konteynerize uygulamalarınızı çalıştırmanıza izin verir" şeklinde tanımlanır.
* **Hizmetler**, bir kümeye içeride **çalışacak görevleri çalıştırmaktan sorumludur**. Bir hizmet tanımı içinde, çalıştırılacak görev sayısını, otomatik ölçeklendirmeyi, kapasite sağlayıcıyı (Fargate/EC2/Harici), VPC'ler, alt ağlar ve güvenlik grupları gibi **ağ bilgilerini** tanımlarsınız.
* **2 tür uygulama** vardır:
* **Hizmet**: Durdurulup yeniden başlatılabilen uzun süreli bir hesaplama işini yöneten görevlerin bir grubu. Örneğin, bir web uygulaması.
* **Görev**: Çalışan ve sona eren bağımsız bir görev. Örneğin, bir toplu iş.
* Hizmet uygulamaları arasında **2 tür hizmet planlayıcısı** bulunur:
* [**REPLICA**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Kopya planlama stratejisi, istenen sayıda görevi kümenize yerleştirir ve **sürdürür**. Herhangi bir nedenle bir görev kapanırsa, aynı veya farklı bir düğümde yeni bir görev başlatılır.
* [**DAEMON**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): İhtiyaç duyulan gereksinimlere sahip her aktif konteyner örneğine tam olarak bir görev dağıtır. Belirli bir görev sayısı, görev yerleştirme stratejisi veya Hizmet Otomatik Ölçeklendirme politikaları belirtmeye gerek yoktur.
* **Görev Tanımları**, **çalışacak konteynerleri tanımlamaktan** ve konteynerlerle ilgili **çeşitli parametreleri yapılandırmaktan** sorumludur, örneğin ana makineyle **port eşlemeleri**, **env değişkenleri**, Docker **entrypoint**...
* **Hassas bilgiler için env değişkenlerini kontrol edin**!

### Görev Tanımlarında Hassas Veri

Görev tanımları, ECS'de çalışacak **gerçek konteynerleri yapılandırmaktan sorumludur**. Görev tanımları, konteynerlerin nasıl çalışacağını tanımladığı için birçok bilgi içerebilir.

Pacu, ECS'yi (list-clusters, list-container-instances, list-services, list-task-definitions) numaralandırabilir ve görev tanımlarını da dökümleyebilir.

### Numaralandırma
```bash
# Clusters info
aws ecs list-clusters
aws ecs describe-clusters --clusters <cluster>

# Container instances
## An Amazon ECS container instance is an Amazon EC2 instance that is running the Amazon ECS container agent and has been registered into an Amazon ECS cluster.
aws ecs list-container-instances --cluster <cluster>
aws ecs describe-container-instances --cluster <cluster> --container-instances <container_instance_arn>

# Services info
aws ecs list-services --cluster <cluster>
aws ecs describe-services --cluster <cluster> --services <services>
aws ecs describe-task-sets --cluster <cluster> --service <service>

# Task definitions
aws ecs list-task-definition-families
aws ecs list-task-definitions
aws ecs list-tasks --cluster <cluster>
aws ecs describe-tasks --cluster <cluster> --tasks <tasks>
## Look for env vars and secrets used from the task definition
aws ecs describe-task-definition --task-definition <TASK_NAME>:<VERSION>
```
### Kimlik Doğrulama Gerektirmeyen Erişim

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md" %}
[aws-ecs-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md)
{% endcontent-ref %}

### İst Privileges

Aşağıdaki sayfada, **ECS izinlerini kötüye kullanarak ayrıcalıkları yükseltme** yöntemlerini kontrol edebilirsiniz:

{% content-ref url="../aws-privilege-escalation/aws-ecs-privesc.md" %}
[aws-ecs-privesc.md](../aws-privilege-escalation/aws-ecs-privesc.md)
{% endcontent-ref %}

### Saldırı Sonrası

{% content-ref url="../aws-post-exploitation/aws-ecs-post-exploitation.md" %}
[aws-ecs-post-exploitation.md](../aws-post-exploitation/aws-ecs-post-exploitation.md)
{% endcontent-ref %}

### Kalıcılık

{% content-ref url="../aws-persistence/aws-ecs-persistence.md" %}
[aws-ecs-persistence.md](../aws-persistence/aws-ecs-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman olmak için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>'ı öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>
