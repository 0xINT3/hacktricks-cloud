# AWS - ECS Enum

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## ECS

### Basiese Inligting

Amazon **Elastic Container Services** of ECS bied 'n platform om **gekonteineriseerde toepassings in die wolk te huisves**. ECS het twee **implementeringsmetodes**, die EC2-instansietipe en 'n **serverlose** opsie, Fargate. Die diens maak dit baie maklik en pynloos om houers in die wolk te laat loop.

ECS werk met die volgende drie boublokke: **Clusters**, **Dienste**, en **Taakdefinisies**.

* **Clusters** is **groepe houers** wat in die wolk loop. Soos voorheen genoem, is daar twee tipes lancerings vir houers, EC2 en Fargate. AWS definieer die **EC2**-lanceringsmetode as die toelaat van kli√´nte "om \[hul] gekonteineriseerde toepassings op 'n groep Amazon EC2-instansies wat \[hulle] **bestuur**" te laat loop. **Fargate** is soortgelyk en word gedefinieer as "om jou gekonteineriseerde toepassings te laat loop **sonder die nodigheid om die agterste infrastruktuur te voorsien en te bestuur**".
* **Dienste** word binne 'n groep geskep en is verantwoordelik vir die **loop van die take**. Binne 'n diensdefinisie **definieer jy die aantal take wat moet loop, outomatiese skaalvergroting, kapasiteitsverskaffer (Fargate/EC2/Extern),** **netwerkinligting** soos VPC's, subnette, en sekuriteitsgroepe.
* Daar is **2 tipes toepassings**:
* **Dienste**: 'n Groep take wat 'n langdurige berekeningstaak hanteer wat gestop en herbegin kan word. Byvoorbeeld, 'n webtoepassing.
* **Taak**: 'n Losstaande taak wat loop en be√´indig. Byvoorbeeld, 'n lottoepassing.
* Onder die dienstetoepassings is daar **2 tipes diensbeplanners**:
* [**REPLICA**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Die replika-beplanningsstrategie plaas en **handhaaf die gewenste aantal** take oor jou groep. As 'n taak om een of ander rede afgeskakel word, word 'n nuwe een in dieselfde of 'n ander nodus geloods.
* [**DAEMON**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Plaas presies een taak op elke aktiewe houer-instantie wat aan die nodige vereistes voldoen. Daar is geen behoefte om 'n gewenste aantal take, 'n taakplaasingsstrategie, of diens outomatiese skaalvergrotingsbeleide te spesifiseer nie.
* **Taakdefinisies** is verantwoordelik vir die **definisie van watter houers moet loop** en die verskeie parameters wat met die houers gekonfigureer sal word, soos **poortafbeeldings** met die gasheer, **omgewingsveranderlikes**, Docker **entrypoint**...
* Kyk na **omgewingsveranderlikes vir sensitiewe inligting**!

### Sensitiewe Data in Taakdefinisies

Taakdefinisies is verantwoordelik vir die **konfigurasie van die werklike houers wat in ECS sal loop**. Aangesien taakdefinisies bepaal hoe houers sal loop, kan 'n oorvloed van inligting binne-in gevind word.

Pacu kan ECS opnoem (list-clusters, list-container-instances, list-services, list-task-definitions), dit kan ook taakdefinisies dump.

### Opnoeming
```bash
# Clusters info
aws ecs list-clusters
aws ecs describe-clusters --clusters <cluster>

# Container instances
## An Amazon ECS container instance is an Amazon EC2 instance that is running the Amazon ECS container agent and has been registered into an Amazon ECS cluster.
aws ecs list-container-instances --cluster <cluster>
aws ecs describe-container-instances --cluster <cluster> --container-instances <container_instance_arn>

# Services info
aws ecs list-services --cluster <cluster>
aws ecs describe-services --cluster <cluster> --services <services>
aws ecs describe-task-sets --cluster <cluster> --service <service>

# Task definitions
aws ecs list-task-definition-families
aws ecs list-task-definitions
aws ecs list-tasks --cluster <cluster>
aws ecs describe-tasks --cluster <cluster> --tasks <tasks>
## Look for env vars and secrets used from the task definition
aws ecs describe-task-definition --task-definition <TASK_NAME>:<VERSION>
```
### Ongeverifieerde Toegang

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md" %}
[aws-ecs-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md)
{% endcontent-ref %}

### Privilege Escalation

Op die volgende bladsy kan jy sien hoe om **ECS-permissies te misbruik om voorregte te verhoog**:

{% content-ref url="../aws-privilege-escalation/aws-ecs-privesc.md" %}
[aws-ecs-privesc.md](../aws-privilege-escalation/aws-ecs-privesc.md)
{% endcontent-ref %}

### Post Exploitatie

{% content-ref url="../aws-post-exploitation/aws-ecs-post-exploitation.md" %}
[aws-ecs-post-exploitation.md](../aws-post-exploitation/aws-ecs-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../aws-persistence/aws-ecs-persistence.md" %}
[aws-ecs-persistence.md](../aws-persistence/aws-ecs-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>
