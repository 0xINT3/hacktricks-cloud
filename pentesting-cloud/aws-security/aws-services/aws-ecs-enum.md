# AWS - ECS Enum

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## ECS

### Taarifa Msingi

Amazon **Elastic Container Services** au ECS hutoa jukwaa la **kuhosti programu zilizowekwa kwenye kontena kwenye wingu**. ECS ina njia mbili za **kupeleka**, aina ya **mfano wa EC2** na chaguo la **bila seva**, **Fargate**. Huduma hiyo **inafanya kuendesha kontena kwenye wingu kuwa rahisi na bila maumivu**.

ECS inafanya kazi kwa kutumia vijenzi vifuatavyo vitatu: **Vikundi**, **Huduma**, na **Ufafanuzi wa Kazi**.

* **Vikundi** ni **vikundi vya kontena** vinavyoendesha kwenye wingu. Kama ilivyotajwa awali, kuna aina mbili za uzinduzi kwa kontena, EC2 na Fargate. AWS inaelezea aina ya **EC2** kama kuruhusu wateja "kuendesha programu zao zilizowekwa kwenye kontena kwenye kikundi cha visa vya Amazon EC2 ambavyo **wanavisimamia**". **Fargate** ni sawa na hiyo na inaelezwa kama "kuruhusu kuendesha programu zilizowekwa kwenye kontena **bila haja ya kutoa na kusimamia** miundombinu ya nyuma".
* **Huduma** zinaundwa ndani ya kikundi na zinahusika na **kuendesha kazi**. Ndani ya ufafanuzi wa huduma **unafafanua idadi ya kazi za kuendesha, upanuzi wa moja kwa moja, mtoa huduma wa uwezo (Fargate/EC2/External),** **habari za mtandao** kama VPC's, subneti, na vikundi vya usalama.
* Kuna **aina 2 za programu**:
  * **Huduma**: Kikundi cha kazi zinazoshughulikia kazi ndefu ya kompyuta ambayo inaweza kusimamishwa na kuanzishwa upya. Kwa mfano, programu ya wavuti.
  * **Kazi**: Kazi ya kujitegemea inayoendesha na kumalizika. Kwa mfano, kazi ya kundi.
* Kati ya programu za huduma, kuna **aina 2 za wakala wa huduma**:
  * [**REPLICA**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Mkakati wa upangaji wa nakala unaweka na **kuhifadhi idadi inayotakiwa** ya kazi kwenye kikundi chako. Ikiwa kwa sababu fulani kazi inazimwa, mpya inazinduliwa kwenye nodi ile ile au tofauti.
  * [**DAEMON**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html): Inapeleka kazi moja tu kwenye kila kifaa cha kontena kilicho hai ambacho kina mahitaji yanayohitajika. Hakuna haja ya kutaja idadi inayotakiwa ya kazi, mkakati wa mahali pa kazi, au kutumia sera za upanuzi wa huduma.
* **Ufafanuzi wa Kazi** unahusika na **kufafanua ni kontena zipi zitaendeshwa** na vigezo mbalimbali vitakavyoconfigurewa na kontena kama **ramani za bandari** na mwenyeji, **mazingira ya mazingira**, **entrypoint** ya Docker...
* Angalia **mazingira ya mazingira kwa habari nyeti**!

### Data Nyeti Katika Ufafanuzi wa Kazi

Ufafanuzi wa kazi unahusika na **kuweka mipangilio ya kontena halisi zitakazoendeshwa kwenye ECS**. Kwa kuwa ufafanuzi wa kazi unadefini jinsi kontena zitaendeshwa, habari nyingi zinaweza kupatikana ndani yake.

Pacu inaweza kuchambua ECS (orodha- vikundi, orodha-vifaa-vya-kontena, orodha-huduma, orodha-ufafanuzi-wa-kazi), inaweza pia kudump ufafanuzi wa kazi.

### Uchambuzi
```bash
# Clusters info
aws ecs list-clusters
aws ecs describe-clusters --clusters <cluster>

# Container instances
## An Amazon ECS container instance is an Amazon EC2 instance that is running the Amazon ECS container agent and has been registered into an Amazon ECS cluster.
aws ecs list-container-instances --cluster <cluster>
aws ecs describe-container-instances --cluster <cluster> --container-instances <container_instance_arn>

# Services info
aws ecs list-services --cluster <cluster>
aws ecs describe-services --cluster <cluster> --services <services>
aws ecs describe-task-sets --cluster <cluster> --service <service>

# Task definitions
aws ecs list-task-definition-families
aws ecs list-task-definitions
aws ecs list-tasks --cluster <cluster>
aws ecs describe-tasks --cluster <cluster> --tasks <tasks>
## Look for env vars and secrets used from the task definition
aws ecs describe-task-definition --task-definition <TASK_NAME>:<VERSION>
```
### Upatikanaji usiothibitishwa

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md" %}
[aws-ecs-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

Kwenye ukurasa ufuatao unaweza kuangalia jinsi ya **kutumia ruhusa za ECS kuboresha mamlaka**:

{% content-ref url="../aws-privilege-escalation/aws-ecs-privesc.md" %}
[aws-ecs-privesc.md](../aws-privilege-escalation/aws-ecs-privesc.md)
{% endcontent-ref %}

### Baada ya Uvamizi

{% content-ref url="../aws-post-exploitation/aws-ecs-post-exploitation.md" %}
[aws-ecs-post-exploitation.md](../aws-post-exploitation/aws-ecs-post-exploitation.md)
{% endcontent-ref %}

### Uthabiti

{% content-ref url="../aws-persistence/aws-ecs-persistence.md" %}
[aws-ecs-persistence.md](../aws-persistence/aws-ecs-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
