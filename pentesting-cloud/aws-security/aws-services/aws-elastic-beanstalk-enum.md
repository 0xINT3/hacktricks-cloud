# AWS - Elastic Beanstalk Enum

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## Elastic Beanstalk

Amazon Elastic Beanstalk bied 'n vereenvoudigde platform vir **implementering, bestuur en skaalstelling van webtoepassings en -dienste**. Dit ondersteun 'n verskeidenheid van programmeertale en raamwerke, soos Java, .NET, PHP, Node.js, Python, Ruby en Go, sowel as Docker-houers. Die diens is versoenbaar met algemeen gebruikte bedieners, insluitend Apache, Nginx, Passenger en IIS.

Elastic Beanstalk bied 'n eenvoudige en aanpasbare manier om **jou toepassings na die AWS-wolks te implementeer**, sonder om oor die onderliggende infrastruktuur bekommerd te wees. Dit hanteer outomaties die besonderhede van kapasiteitsvoorsiening, vragbalansering, skaalstelling en toepassingsgesondheidsmonitering, sodat jy kan fokus op die skryf en implementering van jou kode.

Die infrastruktuur wat deur Elastic Beanstalk geskep word, word bestuur deur **Autoscaling**-groepe in **EC2** (met 'n vragbalanser). Dit beteken dat as jy die gasheer **kompromitteer**, jy moet weet van EC2:

{% content-ref url="../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Verder, as Docker gebruik word, is dit moontlik om **ECS** te gebruik.

{% content-ref url="../../aws-security/aws-services/aws-eks-enum.md" %}
[aws-eks-enum.md](../../aws-security/aws-services/aws-eks-enum.md)
{% endcontent-ref %}

### Toepassing en omgewings

In AWS Elastic Beanstalk dien die konsepte van 'n "toepassing" en 'n "omgewing" verskillende doeleindes en het hulle onderskeie rolle in die implementeringsproses.

#### Toepassing

* 'n Toepassing in Elastic Beanstalk is 'n **logiese houer vir jou toepassing se bronkode, omgewings en konfigurasies**. Dit groepeer verskillende weergawes van jou toepassingskode saam en stel jou in staat om hulle as 'n enkele entiteit te bestuur.
* Wanneer jy 'n toepassing skep, verskaf jy 'n naam en beskrywing, maar geen hulpbronne word op hierdie stadium voorsien nie. Dit is eenvoudig 'n manier om jou kode en verwante hulpbronne te organiseer en te bestuur.
* Jy kan **verskeie toepassingsweergawes** binne 'n toepassing h√™. Elke weergawe stem ooreen met 'n spesifieke vrystelling van jou kode, wat na een of meer omgewings ge√Ømplementeer kan word.

#### Omgewing

* 'n Omgewing is 'n **voorsiene instansie van jou toepassing** wat op AWS-infrastruktuur loop. Dit is **waar jou toepassingskode ge√Ømplementeer en uitgevoer word**. Elastic Beanstalk voorsien die nodige hulpbronne (bv. EC2-instansies, vragbalanser, outomatiese skaalgroepe, databasisse) gebaseer op die omgewingskonfigurasie.
* **Elke omgewing voer 'n enkele weergawe van jou toepassing uit**, en jy kan verskeie omgewings h√™ vir verskillende doeleindes, soos ontwikkeling, toetsing, opstelling en produksie.
* Wanneer jy 'n omgewing skep, kies jy 'n platform (bv. Java, .NET, Node.js, ens.) en 'n omgewingstipe (bv. webbediener of werker). Jy kan ook die omgewingskonfigurasie aanpas om verskillende aspekte van die infrastruktuur en toepassingsinstellings te beheer.

### 2 tipes omgewings

1. **Webbediener-omgewing**: Dit is ontwerp om **webtoepassings en API's te huisves en te bedien**. Hierdie toepassings hanteer tipies inkomende HTTP/HTTPS-versoeke. Die webbediener-omgewing voorsien hulpbronne soos **EC2-instansies, vragbalansers en outomatiese skaalgroepe** om inkomende verkeer te hanteer, kapasiteit te bestuur en die ho√´ beskikbaarheid van die toepassing te verseker.
2. **Werkeromgewing**: Dit is ontwerp om **agtergrondtake** te verwerk, wat dikwels tydrowende of hulpbron-intensiewe operasies is wat nie onmiddellike reaksies aan kli√´nte vereis nie. Die werkeromgewing voorsien hulpbronne soos **EC2-instansies en outomatiese skaalgroepe**, maar dit het **nie 'n vragbalanser** nie omdat dit nie HTTP/HTTPS-versoeke direk hanteer nie. In plaas daarvan verbruik dit take van 'n **Amazon Simple Queue Service (SQS) wachtrij**, wat as 'n buffer optree tussen die werkeromgewing en die take wat dit verwerk.

### Sekuriteit

Wanneer jy 'n toepassing in Beanstalk skep, is daar 3 baie belangrike sekuriteitsopsies om te kies:

* **EC2-sleutelpaar**: Dit sal die **SSH-sleutel** wees wat toegang sal h√™ tot die EC2-instansies wat die toepassing uitvoer
* **IAM-instansieprofiel**: Dit is die **instansieprofiel** wat die instansies sal h√™ (**IAM-voorregte**)
* Die outomatiese gegenereerde rol word genoem **`aws-elasticbeanstalk-ec2-role`** en het 'n paar interessante toegang oor alle ECS, alle SQS, DynamoDB elasticbeanstalk en elasticbeanstalk S3 deur die AWS-bestuurde beleide: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Diensrol**: Dit is die **rol wat die AWS-diens** sal gebruik om al die nodige aksies uit te voer. Vir sover ek weet, kan 'n gewone AWS-gebruiker nie toegang tot daardie rol verkry nie.
* Hierdie rol wat deur AWS gegenereer word, word genoem **`aws-elasticbeanstalk-service-role`** en gebruik die AWS-bestuurde beleide [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) en [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

Standaard is **metadataversie 1 gedeaktiveer**:

<figure><img src="../../../.gitbook/assets/image (18) (1) (2).png" alt=""><figcaption></figcaption></figure>
### Blootstelling

Beanstalk-data word gestoor in 'n **S3-emmer** met die volgende naam: **`elasticbeanstalk-<streek>-<rekening-id>`** (as dit in die AWS-konsole geskep is). Binne hierdie emmer sal jy die opgelaaide **bronkode van die toepassing** vind.

Die **URL** van die geskepte webblad is **`http://<webapp-naam>-env.<willekeurig>.<streek>.elasticbeanstalk.com/`**

{% hint style="warning" %}
As jy **leestoegang** tot die emmer kry, kan jy die **bronkode lees** en selfs **sensitiewe geloofsbriewe** daarin vind.

As jy **skryftoegang** tot die emmer kry, kan jy die bronkode **verander** om die **IAM-rol** wat die toepassing volgende keer gebruik, te **kompromitteer**.
{% endhint %}

### Enumerasie

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### Ongeverifieerde Toegang

{% content-ref url="../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Privilege Escalation

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Post Exploitatie

{% content-ref url="../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

<details>

<summary><strong>Leer AWS hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere manieren om HackTricks te ondersteunen:

* Als je je **bedrijf geadverteerd wilt zien in HackTricks** of **HackTricks in PDF wilt downloaden**, bekijk dan de [**ABONNEMENTSPAKKETTEN**](https://github.com/sponsors/carlospolop)!
* Koop de [**offici√´le PEASS & HackTricks merchandise**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), onze collectie exclusieve [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit je aan bij de** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of de [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel je hackingtrucs door PR's in te dienen bij de** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>
