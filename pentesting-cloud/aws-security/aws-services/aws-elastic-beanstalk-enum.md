# AWS - Elastic Beanstalk Enum

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositorys einreichen.

</details>

## Elastic Beanstalk

Amazon Elastic Beanstalk bietet eine vereinfachte Plattform zum **Bereitstellen, Verwalten und Skalieren von Webanwendungen und -diensten**. Es unterst√ºtzt eine Vielzahl von Programmiersprachen und Frameworks wie Java, .NET, PHP, Node.js, Python, Ruby und Go sowie Docker-Container. Der Dienst ist kompatibel mit weit verbreiteten Servern wie Apache, Nginx, Passenger und IIS.

Elastic Beanstalk bietet eine einfache und flexible M√∂glichkeit, **Ihre Anwendungen in die AWS-Cloud zu deployen**, ohne sich um die zugrunde liegende Infrastruktur k√ºmmern zu m√ºssen. Es **handhabt automatisch** Details wie Kapazit√§ts-**Bereitstellung**, Lastenausgleich, **Skalierung** und √úberwachung der Anwendungsgesundheit, sodass Sie sich auf das Schreiben und Bereitstellen Ihres Codes konzentrieren k√∂nnen.

Die von Elastic Beanstalk erstellte Infrastruktur wird von **Autoscaling**-Gruppen in **EC2** (mit einem Lastenausgleicher) verwaltet. Das bedeutet, dass Sie am Ende des Tages, wenn Sie den Host **kompromittieren**, √ºber EC2 Bescheid wissen sollten:

{% content-ref url="aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/](aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Dar√ºber hinaus, wenn Docker verwendet wird, ist es m√∂glich, **ECS** zu verwenden.

{% content-ref url="aws-eks-enum.md" %}
[aws-eks-enum.md](aws-eks-enum.md)
{% endcontent-ref %}

### Anwendung & Umgebungen

In AWS Elastic Beanstalk dienen die Konzepte einer "Anwendung" und einer "Umgebung" unterschiedlichen Zwecken und haben unterschiedliche Rollen im Bereitstellungsprozess.

#### Anwendung

* Eine Anwendung in Elastic Beanstalk ist ein **logischer Container f√ºr den Quellcode Ihrer Anwendung, Umgebungen und Konfigurationen**. Sie gruppiert verschiedene Versionen Ihres Anwendungscode und erm√∂glicht es Ihnen, sie als eine einzelne Entit√§t zu verwalten.
* Wenn Sie eine Anwendung erstellen, geben Sie einen Namen und eine Beschreibung an, aber es werden keine Ressourcen bereitgestellt. Es handelt sich lediglich um eine M√∂glichkeit, Ihren Code und die zugeh√∂rigen Ressourcen zu organisieren und zu verwalten.
* Sie k√∂nnen **mehrere Anwendungsversionen** innerhalb einer Anwendung haben. Jede Version entspricht einem bestimmten Release Ihres Codes, der in einer oder mehreren Umgebungen bereitgestellt werden kann.

#### Umgebung

* Eine Umgebung ist eine **bereitgestellte Instanz Ihrer Anwendung**, die auf der AWS-Infrastruktur l√§uft. Hier wird Ihr Anwendungscode bereitgestellt und ausgef√ºhrt. Elastic Beanstalk stellt die erforderlichen Ressourcen (z. B. EC2-Instanzen, Lastenausgleicher, Auto-Scaling-Gruppen, Datenbanken) basierend auf der Umgebungskonfiguration bereit.
* **Jede Umgebung f√ºhrt eine einzige Version Ihrer Anwendung aus**, und Sie k√∂nnen mehrere Umgebungen f√ºr verschiedene Zwecke haben, wie Entwicklung, Test, Staging und Produktion.
* Beim Erstellen einer Umgebung w√§hlen Sie eine Plattform (z. B. Java, .NET, Node.js usw.) und einen Umgebungstyp (z. B. Webserver oder Worker). Sie k√∂nnen auch die Umgebungskonfiguration anpassen, um verschiedene Aspekte der Infrastruktur und Anwendungseinstellungen zu steuern.

### 2 Arten von Umgebungen

1. **Webserver-Umgebung**: Sie ist darauf ausgelegt, **Webanwendungen und APIs zu hosten und bereitzustellen**. Diese Anwendungen verarbeiten in der Regel eingehende HTTP/HTTPS-Anfragen. Die Webserver-Umgebung stellt Ressourcen wie **EC2-Instanzen, Lastenausgleicher und Auto-Scaling-Gruppen** bereit, um den eingehenden Datenverkehr zu handhaben, die Kapazit√§t zu verwalten und die hohe Verf√ºgbarkeit der Anwendung sicherzustellen.
2. **Worker-Umgebung**: Sie ist darauf ausgelegt, **Hintergrundaufgaben** zu verarbeiten, die oft zeitaufw√§ndige oder ressourcenintensive Operationen sind, die keine sofortigen Antworten an Clients erfordern. Die Worker-Umgebung stellt Ressourcen wie **EC2-Instanzen und Auto-Scaling-Gruppen** bereit, hat jedoch **keinen Lastenausgleicher**, da sie keine HTTP/HTTPS-Anfragen direkt verarbeitet. Stattdessen verbraucht sie Aufgaben aus einer **Amazon Simple Queue Service (SQS)-Warteschlange**, die als Puffer zwischen der Worker-Umgebung und den von ihr verarbeiteten Aufgaben fungiert.

### Sicherheit

Beim Erstellen einer App in Beanstalk gibt es 3 sehr wichtige Sicherheitsoptionen zur Auswahl:

* **EC2-Schl√ºsselpaar**: Dies ist der **SSH-Schl√ºssel**, mit dem auf die EC2-Instanzen zugegriffen werden kann, auf denen die App l√§uft.
* **IAM-Instanzprofil**: Dies ist das **Instanzprofil**, das die Instanzen haben werden (**IAM-Berechtigungen**).
* Die automatisch generierte Rolle hei√üt **`aws-elasticbeanstalk-ec2-role`** und hat einige interessante Zugriffe auf alle ECS, alle SQS, DynamoDB Elastic Beanstalk und Elastic Beanstalk S3 unter Verwendung der AWS-Managed-Richtlinien: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Service-Rolle**: Dies ist die **Rolle, die der AWS-Dienst** verwenden wird, um alle erforderlichen Aktionen auszuf√ºhren. Soweit ich wei√ü, kann ein regul√§rer AWS-Benutzer nicht auf diese Rolle zugreifen.
* Diese von AWS generierte Rolle hei√üt **`aws-elasticbeanstalk-service-role`** und verwendet die AWS-Managed-Richtlinien [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) und [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

Standardm√§√üig ist **Metadaten-Version 1 deaktiviert**:

<figure><img src="../../../.gitbook/assets/image (103).png" alt=""><figcaption></figcaption></figure>
### Exposition

Die Beanstalk-Daten werden in einem **S3-Bucket** mit dem folgenden Namen gespeichert: **`elasticbeanstalk-<region>-<acc-id>`** (wenn es in der AWS-Konsole erstellt wurde). In diesem Bucket finden Sie den hochgeladenen **Quellcode der Anwendung**.

Die **URL** der erstellten Webseite lautet **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
Wenn Sie **Lesezugriff** auf den Bucket erhalten, k√∂nnen Sie den **Quellcode lesen** und sogar **sensible Anmeldeinformationen** darin finden.

Wenn Sie **Schreibzugriff** auf den Bucket erhalten, k√∂nnten Sie den **Quellcode √§ndern**, um die **IAM-Rolle** zu **kompromittieren**, die die Anwendung beim n√§chsten Ausf√ºhren verwendet.
{% endhint %}

### Aufz√§hlung

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### Nicht authentifizierter Zugriff

{% content-ref url="../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Persistenz

{% content-ref url="../aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Privilege Escalation

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Post-Exploitation

{% content-ref url="../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
