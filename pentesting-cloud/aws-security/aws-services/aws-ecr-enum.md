# AWS - ECR Enum

<details>

<summary><strong>рдмрдврд╝рд┐рдпрд╛ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## ECR

### рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

рдЕрдореЗрдЬрд╝реЕрди **рдЗрд▓рд╛рд╕реНрдЯрд┐рдХ рдХрдВрдЯреЗрдирд░ рд░рдЬрд┐рд╕реНрдЯреНрд░реА** (Amazon ECR) рдПрдХ **рдкреНрд░рдмрдВрдзрд┐рдд рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗрд╡рд╛** рд╣реИред рдЧреНрд░рд╛рд╣рдХ рджреЙрдХрд░ CLI рдпрд╛ рдЕрдкрдиреЗ рдкрд╕рдВрджреАрджрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдореЗрдЬ рдкрд╢реБ, рдЦреАрдВрдЪреЗрдВ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

ECR 2 рдкреНрд░рдХрд╛рд░ рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирд╛ рд╣реИ: **рд░рдЬрд┐рд╕реНрдЯреНрд░реА** рдФрд░ **рд░реЗрдкреЛрдЬрд┐рдЯрд░реА**ред

#### рд░рдЬрд┐рд╕реНрдЯреНрд░реА

рд╣рд░ AWS рдЦрд╛рддреЗ рдореЗрдВ 2 рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╣реЛрддреА рд╣реИ: **рдирд┐рдЬреА** рдФрд░ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ**ред

1. **рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА**:

* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рдЬреА**: рдПрдХ рдЕрдореЗрдЬрд╝реЕрди ECR рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬреЗрдЬ рдХреЗрд╡рд▓ рдЕрдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╣реА рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЗ AWS рдЦрд╛рддреЗ рдХреЗ рднреАрддрд░ рд╣реИрдВ рдпрд╛ рдЬрд┐рдиреНрд╣реЗрдВ рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рд╣реИред
* **рдирд┐рдЬреА рд░реЗрдкреЛрдЬрд┐рдЯрд░реА** рдХрд╛ URI рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ `<account_id>.dkr.ecr.<region>.amazonaws.com/<repo-name>`
* **рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг**: рдЖрдк рдЕрдкрдиреА рдирд┐рдЬреА рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬреЗрдЬ рдХреА рдкрд╣реБрдВрдЪ рдХреЛ **IAM рдиреАрддрд┐рдпреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдпрд╛ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рд╕реНрддреГрдд рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **AWS рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг**: рдЕрдореЗрдЬрд╝реЕрди ECR рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ **рдЕрдиреНрдп AWS рд╕реЗрд╡рд╛рдУрдВ** рдХреЗ рд╕рд╛рде рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ EKS, ECS...
* **рдЕрдиреНрдп рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╡рд┐рдХрд▓реНрдк**:
* рдЯреИрдЧ рдЕрд╡рд┐рдЪрд▓рдирддрд╛ рд╕реНрддрдВрдн рдЙрд╕рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ рдЯреИрдЧ рдЕрд╡рд┐рдЪрд▓рдирддрд╛ рд╕рдХреНрд╖рдо рд╣реИ рддреЛ рдпрд╣ рдЫрд╡рд┐ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдЯреИрдЧ рдХреЗ рд╕рд╛рде рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рд╕реЗ **рд░реЛрдХреЗрдЧрд╛**ред
* **рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдкреНрд░рдХрд╛рд░** рд╕реНрддрдВрдн рд░реЗрдкреЛрдЬрд┐рдЯрд░реА рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдЧреБрдгреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдкреНрд░рдХрд╛рд░ рдЬреИрд╕реЗ AES-256 рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ, рдпрд╛ **KMS** рд╕рдХреНрд╖рдо рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИред
* **рдкреБрд▓ рдереНрд░реВ рдХреИрд╢** рд╕реНрддрдВрдн рдЙрд╕рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ рдкреБрд▓ рдереНрд░реВ рдХреИрд╢ рд╕реНрдерд┐рддрд┐ рд╕рдХреНрд░рд┐рдп рд╣реИ рддреЛ рдпрд╣ рдмрд╛рд╣рд░реА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реЗрдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд░реЗрдкреЛрдЬрд┐рдЯрд░реА рдХреЛ рдЖрдкрдХреЗ рдирд┐рдЬреА рд░реЗрдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ рдХреИрд╢ рдХрд░реЗрдЧрд╛ред
* рд╡рд┐рд╢реЗрд╖ **IAM рдиреАрддрд┐рдпрд╛рдБ** рд╡рд┐рднрд┐рдиреНрди **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
* **рд╕реНрдХреИрдирд┐рдВрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди** рдЫрд╡рд┐рдпреЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдЫрд╡рд┐рдпреЛрдВ рдореЗрдВ рд╕рдВрдХрдЯрд╛рд╕реНрдкрджрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

2. **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА**:

* **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкрд╣реБрдВрдЪ**: ECR рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬреЗрдЬ рдХреЛ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд┐рдирд╛ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдХреЛрдИ рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред**
* **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реЗрдкреЛрдЬрд┐рдЯрд░реА** рдХрд╛ URI `public.ecr.aws/<random>/<name>` рдХреА рддрд░рд╣ рд╣реЛрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, `<random>` рднрд╛рдЧ рдХреЛ рдкреНрд░рд╢рд╛рд╕рдХ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдФрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдпрд╛рдж рд░рдЦрдиреЗ рдореЗрдВ рдЖрд╕рд╛рди рд╣реЛред

#### **рд░реЗрдкреЛрдЬрд┐рдЯрд░реА**

рдпреЗ рд╣реИрдВ **рдЫрд╡рд┐рдпрд╛рдБ** рдЬреЛ **рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА** рдпрд╛ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ** рдореЗрдВ рд╣реЛрддреА рд╣реИрдВред

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ рдЫрд╡рд┐ рдХреЛ рд░реЗрдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **ECR рд░реЗрдкреЛрдЬрд┐рдЯрд░реА рдХрд╛ рдирд╛рдо рдЫрд╡рд┐ рдХреЗ рдирд╛рдо рдХреЗ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП**ред
{% endhint %}

### рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдФрд░ рд░реЗрдкреЛрдЬрд┐рдЯрд░реА рдиреАрддрд┐рдпрд╛рдБ

**рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдФрд░ рд░реЗрдкреЛрдЬрд┐рдЯрд░реА** рдореЗрдВ рднреА **рдиреАрддрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдиреНрдп рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓/рдЦрд╛рддреЛрдВ рдХреЛ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реЗрдкреЛрдЬрд┐рдЯрд░реА рдиреАрддрд┐ рдЫрд╡рд┐ рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╕рдВрдЧрдарди рдХреЗ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
```bash
# Get repos
aws ecr describe-repositories
aws ecr describe-registry

# Get image metadata
aws ecr list-images --repository-name <repo_name>
aws ecr describe-images --repository-name <repo_name>
aws ecr describe-image-replication-status --repository-name <repo_name> --image-id <image_id>
aws ecr describe-image-scan-findings --repository-name <repo_name> --image-id <image_id>
aws ecr describe-pull-through-cache-rules --repository-name <repo_name> --image-id <image_id>

# Get public repositories
aws ecr-public describe-repositories

# Get policies
aws ecr get-registry-policy
aws ecr get-repository-policy --repository-name <repo_name>
```
{% endcode %}

### рдЕрдирд╡реИрдз рдЬрд╛рдБрдЪ

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md" %}
[aws-ecr-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ **ECR рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="../aws-privilege-escalation/aws-ecr-privesc.md" %}
[aws-ecr-privesc.md](../aws-privilege-escalation/aws-ecr-privesc.md)
{% endcontent-ref %}

### рдкреЛрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

{% content-ref url="../aws-post-exploitation/aws-ecr-post-exploitation.md" %}
[aws-ecr-post-exploitation.md](../aws-post-exploitation/aws-ecr-post-exploitation.md)
{% endcontent-ref %}

### рд╕реНрдерд┐рд░рддрд╛

{% content-ref url="../aws-persistence/aws-ecr-persistence.md" %}
[aws-ecr-persistence.md](../aws-persistence/aws-ecr-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХрд╛ рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ рдЯреНрд╡рд┐рдЯрд░ рдкрд░ рдлрд╝реЙрд▓реЛ рдХрд░реЗрдВ** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
