# AWS - Relational Database (RDS) Enum

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Taarifa Msingi

**Huduma ya Database ya Kirekodi (RDS)** inayotolewa na AWS imeundwa kusaidia kuweka, kutekeleza, na kupanua **database ya kirekodi kwenye wingu**. Huduma hii inatoa faida za ufanisi wa gharama na upanuzi wakati inaotomatisha kazi zenye kazi nyingi kama utoaji wa vifaa, usanidi wa database, kusasisha, na nakala rudufu.

AWS RDS inasaidia injini mbalimbali za database za kirekodi zinazotumiwa sana ikiwa ni pamoja na MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server, na Amazon Aurora, na uwezo wa kufanya kazi na MySQL na PostgreSQL.

Vipengele muhimu vya RDS ni pamoja na:

* **Usimamizi wa mifano ya database** umepunguzwa.
* Uundaji wa **nakala za kusoma** ili kuboresha utendaji wa kusoma.
* Usanidi wa **mipangilio ya eneo la upatikanaji (AZ)** kuhakikisha upatikanaji wa juu na mifumo ya kufeli.
* **Ushirikiano** na huduma zingine za AWS, kama vile:
* Utambulisho na Usimamizi wa Upatikanaji wa AWS (**IAM**) kwa udhibiti imara wa upatikanaji.
* AWS **CloudWatch** kwa ufuatiliaji na takwimu kamili.
* Huduma ya Usimamizi wa Kifunguo cha AWS (**KMS**) kwa kuhakikisha encryption wakati wa kupumzika.

## Sifa za Kuingia

Wakati wa kuunda kikundi cha DB, jina la **mtumiaji mkuu** linaweza kusanidiwa (**`admin`** kwa chaguo-msingi). Ili kuzalisha nenosiri la mtumiaji huyu unaweza:

* **Taja** nenosiri **mwenyewe**
* Ambia RDS kuli **jenereta moja kwa moja**
* Ambia RDS kulihifadhi katika **Meneja wa Siri wa AWS** iliyofichwa na ufunguo wa KMS

<figure><img src="../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### Uthibitishaji

Kuna aina 3 za chaguo za uthibitishaji, lakini kutumia **nenosiri la mtumiaji mkuu daima kuruhusiwa**:

<figure><img src="../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### Upatikanaji wa Umma & VPC

Kwa chaguo **hakuna upatikanaji wa umma unaruhusiwa** kwa databases, hata hivyo **unaweza kuruhusiwa**. Kwa hiyo, kwa chaguo-msingi tu mashine kutoka kwenye VPC moja itaweza kufikia ikiwa kikundi cha **usalama** kilichochaguliwa (kimehifadhiwa katika EC2 SG) kinairuhusu.

Badala ya kufunua kifaa cha DB, niwezekanavyo kuunda **RDS Proxy** ambayo **inaimarisha** **upanuzi** & **upatikanaji** wa kikundi cha DB.

Zaidi, **bandari ya database inaweza kubadilishwa** pia.

### Encryption

**Ufichamishaji umewezeshwa kwa chaguo-msingi** kwa kutumia ufunguo uliosimamiwa na AWS (CMK inaweza kuchaguliwa badala yake).

Kwa kuwezesha ufichamishaji wako, unawezesha **ufichamishaji wakati wa kupumzika kwa uhifadhi wako, nakala rudufu, nakala za kusoma na nakala zako za kurejesha**. Vifunguo vya kusimamia ufichamishaji huu vinaweza kutolewa kwa kutumia **KMS**.\
Haipatikani kuongeza kiwango hiki cha ufichamishaji baada ya database yako kuundwa. **Inapaswa kufanywa wakati wa uundaji wake**.

Hata hivyo, kuna **njia mbadala inayoruhusu wewe kuficha database isiyofichwa kama ifuatavyo**. Unaweza kuunda nakala ya database yako isiyofichwa, kuunda nakala iliyofichwa ya nakala hiyo, kutumia nakala iliyofichwa hiyo kuunda database mpya, na kisha, hatimaye, database yako itakuwa imefichwa.

#### Ufichamishaji wa Data wa Wazi (TDE)

Pamoja na uwezo wa ufichamishaji uliojumuishwa kwenye RDS kwenye kiwango cha maombi, RDS pia inasaidia **mifumo ya ziada ya ufichamishaji kwenye jukwaa** kulinda data wakati wa kupumzika. Hii ni pamoja na **Ufichamishaji wa Data wa Wazi (TDE)** kwa Oracle na SQL Server. Hata hivyo, ni muhimu kutambua kwamba wakati TDE inaboresha usalama kwa kuficha data wakati wa kupumzika, inaweza pia **kuathiri utendaji wa database**. Athari hii ya utendaji inaonekana hasa wakati inatumika pamoja na MySQL cryptographic functions au Microsoft Transact-SQL cryptographic functions.

Kutumia TDE, hatua fulani za awali zinahitajika:

1. **Ushirikiano wa Kikundi cha Chaguo**:

* Database lazima iwe imeunganishwa na kikundi cha chaguo. Vikundi vya chaguo vinatumika kama vyombo vya kuhifadhi mipangilio na vipengele, kusaidia usimamizi wa database, ikiwa ni pamoja na kuboresha usalama.
* Hata hivyo, ni muhimu kutambua kwamba vikundi vya chaguo vinapatikana tu kwa injini maalum za database na toleo.

2. **Kuingiza TDE katika Kikundi cha Chaguo**:

* Mara baada ya kuunganishwa na kikundi cha chaguo, chaguo la Ufichamishaji wa Data wa Wazi wa Oracle linahitaji kuingizwa katika kikundi hicho.
* Ni muhimu kutambua kwamba mara tu chaguo la TDE linapoongezwa kwenye kikundi cha chaguo, linakuwa sehemu ya kudumu na haliwezi kuondolewa.

3. **Modes za Ufichamishaji wa TDE**:

* TDE inatoa modes mbili tofauti za ufichamishaji:
* **Ufichamishaji wa Nafasi ya Jedwali la TDE**: Mode huu unaficha meza nzima, ukiwezesha wigo mpana wa ulinzi wa data.
* **Ufichamishaji wa Safu ya TDE**: Mode huu unazingatia kuficha vipengele maalum, binafsi ndani ya database, kuruhusu udhibiti zaidi juu ya ni data gani inayofichwa.

Kuelewa mahitaji haya ya awali na utata wa uendeshaji wa TDE ni muhimu kwa utekelezaji na usimamizi wa uchafuzi ndani ya RDS, kuhakikisha usalama wa data na kufuata viwango muhimu.

### Urambazaji

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Upatikanaji usiothibitishwa

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Baada ya Uvamizi

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### Uthabiti

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### Uingizaji wa SQL

Kuna njia za kupata data ya DynamoDB na **muundo wa SQL**, hivyo, **uingizaji wa SQL wa kawaida pia ni wa kufanyika**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka mwanzo hadi kuwa shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
