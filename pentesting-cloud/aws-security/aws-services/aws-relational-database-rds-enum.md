# AWS - Relational Database (RDS) Enum

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy in HackTricks wil adverteer** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## Basiese Inligting

Die **Relasionele Databasisdiens (RDS)** wat deur AWS aangebied word, is ontwerp om die implementering, bedryf en skaalbaarheid van 'n **relasionele databasis in die wolk** te stroomlyn. Hierdie diens bied die voordele van koste-effektiwiteit en skaalbaarheid terwyl dit arbeidsintensiewe take soos hardewarevoorsiening, databasiskonfigurasie, patching en rugsteun outomatiseer.

AWS RDS ondersteun verskeie algemeen gebruikte relasionele databasis-enjins, insluitend MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server en Amazon Aurora, met ondersteuning vir beide MySQL en PostgreSQL.

Belangrike kenmerke van RDS sluit in:

* Vereenvoudigde **bestuur van databasisinstansies**.
* Skepping van **lees-replicas** om leesprestasie te verbeter.
* Konfigurasie van **multi-Beskikbaarheidsone (AZ) implementasies** om ho√´ beskikbaarheid en oorskakelingsmeganismes te verseker.
* **Integrasie** met ander AWS-dienste, soos:
* AWS Identity and Access Management (**IAM**) vir robuuste toegangsbeheer.
* AWS **CloudWatch** vir omvattende monitering en metriek.
* AWS Key Management Service (**KMS**) vir versekering van versleuteling in rus.

## Gelde

Wanneer die DB-kluster geskep word, kan die hoof **gebruikersnaam** gekonfigureer word (**standaard `admin`**). Om die wagwoord van hierdie gebruiker te genereer, kan jy:

* **'n Wagwoord** self aandui
* RDS s√™ om dit **outomaties te genereer**
* RDS s√™ om dit te bestuur in **AWS Secret Manager** wat versleutel is met 'n KMS-sleutel

<figure><img src="../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### Verifikasie

Daar is 3 tipes verifikasie-opsies, maar die gebruik van die **hoofwagwoord is altyd toegelaat**:

<figure><img src="../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### Openbare Toegang & VPC

Standaard word **geen openbare toegang verleen** tot die databasisse nie, maar dit **kan verleen word**. Daarom sal slegs masjiene van dieselfde VPC toegang daartoe h√™ as die gekose **sekuriteitsgroep** (wat in EC2 SG gestoor word) dit toelaat.

In plaas daarvan om 'n DB-instansie bloot te stel, is dit moontlik om 'n **RDS Proxy** te skep wat die **skaalbaarheid** en **beskikbaarheid** van die DB-kluster verbeter.

Verder kan die **databasispoort ook gewysig** word.

### Versleuteling

**Versleuteling is standaard geaktiveer** deur gebruik te maak van 'n AWS-bestuurde sleutel (daar kan 'n CMK gekies word).

Deur jou versleuteling te aktiveer, aktiveer jy **versleuteling in rus vir jou stoor, afskrifte, lees-replicas en rugsteun**. Sleutels om hierdie versleuteling te bestuur, kan uitgereik word deur gebruik te maak van **KMS**.\
Dit is nie moontlik om hierdie vlak van versleuteling by te voeg nadat jou databasis geskep is nie. **Dit moet gedoen word tydens die skepping daarvan**.

Daar is egter 'n **omweg wat jou in staat stel om 'n onversleutelde databasis te versleutel soos volg**. Jy kan 'n afskrif van jou onversleutelde databasis skep, 'n versleutelde kopie van daardie afskrif skep, daardie versleutelde afskrif gebruik om 'n nuwe databasis te skep, en dan sal jou databasis uiteindelik versleutel wees.

#### Deursigtige Data Versleuteling (TDE)

Tesame met die versleutelingsvermo√´ns wat inherent is aan RDS op die toepassingsvlak, ondersteun RDS ook **bykomende platformvlak-versleutelingsmeganismes** om data in rus te beskerm. Dit sluit **Deursigtige Data Versleuteling (TDE)** vir Oracle en SQL Server in. Dit is egter belangrik om daarop te let dat terwyl TDE sekuriteit verbeter deur data in rus te versleutel, dit ook die databasisprestasie kan **be√Ønvloed**. Hierdie prestasie-impak is veral merkbaar wanneer dit saam met MySQL-kriptografiese funksies of Microsoft Transact-SQL-kriptografiese funksies gebruik word.

Om TDE te gebruik, is sekere voorbereidende stappe vereis:

1. **Opsie Groep Assosiasie**:

* Die databasis moet geassosieer word met 'n opsie groep. Opsie groepe dien as houers vir instellings en funksies, wat databasisbestuur fasiliteer, insluitend sekuriteitsverbeterings.
* Dit is egter belangrik om daarop te let dat opsie groepe slegs beskikbaar is vir spesifieke databasis-enjins en -weergawes.

2. **Insluiting van TDE in Opsie Groep**:

* Sodra dit geassosieer is met 'n opsie groep, moet die Oracle Transparent Data Encryption-opsie in daardie groep ingesluit word.
* Dit is noodsaaklik om te besef dat sodra die TDE-opsie by 'n opsie groep gevoeg word, dit 'n permanente kenmerk word en nie verwyder kan word nie.

3. **TDE Versleutelingsmodusse**:

* TDE bied twee onderskeie versleutelingsmodusse:
* **TDE Tablespace Versleuteling**: Hierdie modus versleutel hele tabelle en bied 'n wyer omvang van databeskywing.
* **TDE Kolom Versleuteling**: Hierdie modus fokus op die versleuteling van spesifieke, individuele elemente binne die databasis, wat meer fynkontrole oor watter data versleutel word, moontlik maak.

Om hierdie voorvereistes en die operasionele ingewikkeldhede van TDE te verstaan, is noodsaaklik vir die doeltreffende implementering en bestuur van versleuteling binne RDS, om sodoende data-sekuriteit en nakoming van nodige standaarde te verseker.

### Enumerasie

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Ongeverifieerde Toegang

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Privilege Escalation

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Post Exploitatie

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Injeksie

Daar is maniere om toegang tot DynamoDB-data te verkry met **SQL-sintaksis**, daarom is tipiese **SQL-injeksies ook moontlik**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou hacktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
