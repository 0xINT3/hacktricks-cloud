# AWS - EMR Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)でAWSハッキングをゼロからヒーローまで学ぶ</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* **HackTricks**の[**GitHubリポジトリ**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)にPRを提出して、あなたのハッキングのコツを共有する。

</details>

## EMR

AWSのElastic MapReduce (EMR) サービスは、バージョン4.8.0から**セキュリティ設定**機能を導入し、EMRクラスタ内のデータの暗号化設定を指定することで、データ保護を強化しました。EMRクラスタは、Apache HadoopやSparkなどのビッグデータフレームワークを処理するために設計された、スケーラブルなEC2インスタンスのグループです。

主な特徴は以下の通りです:

- **クラスタ暗号化デフォルト**: デフォルトでは、クラスタ内のデータは暗号化されていません。しかし、暗号化を有効にすると、いくつかの機能にアクセスできます:
- **Linux Unified Key Setup**: EBSクラスタボリュームを暗号化します。ユーザーはAWS Key Management Service (KMS)またはカスタムキープロバイダを選択できます。
- **オープンソースHDFS暗号化**: Hadoopに対して2つの暗号化オプションを提供します:
- プライバシーに設定されたSecure Hadoop RPC (Remote Procedure Call)は、Simple Authentication Security Layerを利用します。
- trueに設定されたHDFSブロック転送暗号化は、AES-256アルゴリズムを利用します。

- **転送中の暗号化**: 転送中のデータを保護することに焦点を当てています。オプションには以下が含まれます:
- **オープンソースTransport Layer Security (TLS)**: 証明書プロバイダを選択することで暗号化を有効にできます:
- **PEM**: PEM証明書を手動で作成し、zipファイルにまとめて、S3バケットから参照します。
- **カスタム**: カスタムJavaクラスを証明書プロバイダとして追加し、暗号化アーティファクトを提供します。

TLS証明書プロバイダがセキュリティ設定に統合されると、EMRバージョンに基づいて異なる、以下のアプリケーション固有の暗号化機能を有効にすることができます:

- **Hadoop**:
- TLSを使用した暗号化シャッフルを減らす可能性があります。
- Secure Hadoop RPCとSimple Authentication Security LayerおよびAES-256を使用したHDFSブロック転送は、データ保管時の暗号化と共に有効になります。

- **Presto** (EMRバージョン5.6.0+):
- Prestoノード間の内部通信はSSLとTLSを使用して保護されます。

- **Tez Shuffle Handler**:
- 暗号化にTLSを利用します。

- **Spark**:
- AkkaプロトコルにTLSを使用します。
- Simple Authentication Security Layerと3DESをBlock Transfer Serviceに使用します。
- 外部シャッフルサービスはSimple Authentication Security Layerで保護されます。

これらの機能は、特にデータ保護の観点から、EMRクラスタのセキュリティ姿勢を全体的に強化します。


### Enumeration
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### 権限昇格

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

# 参考文献
* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)でAWSハッキングをゼロからヒーローまで学ぶ</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションをチェックしてください。
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)で**フォローしてください。**
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを**共有してください。**

</details>
