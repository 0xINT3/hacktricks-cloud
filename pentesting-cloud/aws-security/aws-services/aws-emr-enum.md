# AWS - EMR Enum

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* **HackTricksで会社を宣伝したい**場合や、**PEASSの最新バージョンを見たい**場合、または**HackTricksをPDFでダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローする 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)
* **ハッキングのトリックを共有する**ために、[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>

## EMR

EMRは、AWSのマネージドサービスであり、Apache HadoopやSparkなどのビッグデータフレームワークを処理および実行するための**EC2インスタンスのクラスタ**で構成されています。

EMRバージョン4.8.0以降では、**セキュリティ設定**を作成して、クラスタ内のデータの暗号化を**どのように管理するか**を指定することができます。データを静止状態で暗号化するか、データを転送中に暗号化するか、必要に応じて両方を行うことができます。これらのセキュリティ設定の素晴らしい点は、実際にはEC2クラスタの一部ではないということです。

EMRの重要なポイントの1つは、**デフォルトでは、クラスタ内のインスタンスはデータを静止状態で暗号化しない**ということです。有効にすると、次の機能が利用できます。

* **Linux Unified Key Setup:** この方法を使用して、EBSクラスタボリュームを暗号化することができます。AWS **KMS**をキー管理プロバイダとして指定するか、カスタムキープロバイダを使用することができます。
* **オープンソースのHDFS暗号化:** これにより、2つのHadoop暗号化オプションが提供されます。プライバシーに設定されたセキュアHadoop RPCは、単純な認証セキュリティレイヤを使用し、AES-256アルゴリズムを使用するHDFSブロック転送のデータ暗号化が設定されます。

転送中の暗号化に関しては、**オープンソースのトランスポートレイヤーセキュリティ**暗号化機能を有効にし、証明書プロバイダのタイプを選択することができます。PEMでは、手動でPEM証明書を作成し、それらをzipファイルにまとめてS3で参照する必要があります。カスタムでは、暗号化アーティファクトを提供するJavaクラスとしてカスタム証明書プロバイダを追加します。

TLS証明書プロバイダがセキュリティ設定ファイルに設定された後、次の暗号化アプリケーション固有の暗号化機能を有効にすることができます。これは、EMRのバージョンによって異なります。

* Hadoopは、TLSを使用する暗号化シャッフルを削減する場合があります。セキュアHadoop RPCはSimple Authentication Security Layerを使用し、HDFSブロック転送のデータ暗号化はAES-256を使用するため、静止状態の暗号化がセキュリティ設定で有効になっている場合、両方がアクティブになります。
* Presto: EMRバージョン5.6.0以降を使用する場合、Prestoノード間の内部通信はSSLとTLSを使用します。
* Tez Shuffle HandlerはTLSを使用します。
* Spark: AkkaプロトコルはTLSを使用します。ブロック転送サービスはSimple Authentication Security Layerと3DESを使用します。外部シャッフルサービスはSimple Authentication Security Layerを使用します。

### 列挙
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* もし、あなたの**会社をハックトリックで宣伝したい**場合や、**PEASSの最新バージョンを見たい**場合、または**HackTricksをPDFでダウンロード**したい場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを発見しましょう
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローしてください 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)
* **ハッキングのトリックを共有するために、PRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) **および** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **のGitHubリポジトリに提出してください。**

</details>
