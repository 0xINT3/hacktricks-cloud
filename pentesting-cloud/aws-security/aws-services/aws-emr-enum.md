# AWS - Enumeración de EMR

<details>

<summary><strong>Aprende hacking en AWS de cero a héroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colección de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## EMR

EMR es un servicio gestionado por AWS y consiste en un **cluster de instancias EC2 altamente escalable** para procesar y ejecutar frameworks de big data como Apache Hadoop y Spark.

Desde la versión 4.8.0 de EMR en adelante, tenemos la capacidad de crear una **configuración de seguridad** especificando diferentes ajustes sobre **cómo gestionar la encriptación de tus datos dentro de tus clusters**. Puedes encriptar tus datos en reposo, datos en tránsito, o si es necesario, ambos juntos. Lo mejor de estas configuraciones de seguridad es que no son realmente parte de tus clusters EC2.

Un punto clave de EMR es que **por defecto, las instancias dentro de un cluster no encriptan los datos en reposo**. Una vez habilitado, están disponibles las siguientes características.

* **Configuración Unificada de Claves de Linux:** Los volúmenes de clusters EBS pueden ser encriptados usando este método donde puedes especificar AWS **KMS** como tu proveedor de gestión de claves, o usar un proveedor de claves personalizado.
* **Encriptación de HDFS de código abierto:** Esto proporciona dos opciones de encriptación de Hadoop. RPC de Hadoop seguro que se configuraría para privacidad que usa capa de seguridad de autenticación simple, y encriptación de datos de transferencia de bloques de HDFS que se configuraría en verdadero para usar el algoritmo AES-256.

Desde una perspectiva de encriptación en tránsito, podrías habilitar **características de encriptación de seguridad de la capa de transporte de código abierto** y seleccionar un tipo de proveedor de certificados que puede ser PEM donde necesitarás crear manualmente certificados PEM, agruparlos en un archivo zip y luego referenciar el archivo zip en S3 o personalizado donde añadirías un proveedor de certificados personalizado como una clase Java que proporciona artefactos de encriptación.

Una vez que el proveedor de certificados TLS ha sido configurado en el archivo de configuración de seguridad, se pueden habilitar las siguientes aplicaciones específicas de características de encriptación que variarán dependiendo de tu versión de EMR.

* Hadoop podría reducir la mezcla encriptada que usa TLS. Tanto RPC de Hadoop seguro que usa Capa de Seguridad de Autenticación Simple, y encriptación de datos de transferencia de bloques de HDFS que usa AES-256, ambos se activan cuando la encriptación en reposo está habilitada en la configuración de seguridad.
* Presto: Al usar la versión 5.6.0 de EMR y posteriores, cualquier comunicación interna entre nodos de Presto usará SSL y TLS.
* El Manejador de Mezcla de Tez usa TLS.
* Spark: El protocolo Akka usa TLS. El Servicio de Transferencia de Bloques usa Capa de Seguridad de Autenticación Simple y 3DES. El servicio de mezcla externo usa la Capa de Seguridad de Autenticación Simple.

### Enumeración
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

<details>

<summary><strong>Aprende hacking en AWS de cero a héroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colección de [**NFTs exclusivos**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sigue** a **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
