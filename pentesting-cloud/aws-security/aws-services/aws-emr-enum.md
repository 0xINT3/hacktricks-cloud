# AWS - EMR Enum

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs exclusivos**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## EMR

O EMR √© um servi√ßo gerenciado pela AWS e consiste em um **cluster de inst√¢ncias EC2 altamente escal√°vel** para processar e executar frameworks de big data como Apache Hadoop e Spark.

A partir da vers√£o 4.8.0 do EMR, temos a capacidade de criar uma **configura√ß√£o de seguran√ßa** especificando diferentes configura√ß√µes sobre **como gerenciar a criptografia dos seus dados dentro dos seus clusters**. Voc√™ pode criptografar seus dados em repouso, dados em tr√¢nsito ou, se necess√°rio, ambos juntos. O grande diferencial dessas configura√ß√µes de seguran√ßa √© que elas n√£o s√£o de fato parte dos seus clusters EC2.

Um ponto chave do EMR √© que **por padr√£o, as inst√¢ncias dentro de um cluster n√£o criptografam dados em repouso**. Uma vez habilitado, as seguintes funcionalidades est√£o dispon√≠veis.

* **Linux Unified Key Setup:** Volumes de cluster EBS podem ser criptografados usando este m√©todo, onde voc√™ pode especificar o **KMS** da AWS como seu provedor de gerenciamento de chaves, ou usar um provedor de chaves personalizado.
* **Criptografia HDFS de c√≥digo aberto:** Isso fornece duas op√ß√µes de criptografia Hadoop. Secure Hadoop RPC que seria configurado para privacidade, que usa camada de seguran√ßa de autentica√ß√£o simples, e criptografia de dados de transfer√™ncia de bloco HDFS que seria configurada para verdadeiro para usar o algoritmo AES-256.

Do ponto de vista da criptografia em tr√¢nsito, voc√™ poderia habilitar **recursos de criptografia de seguran√ßa da camada de transporte de c√≥digo aberto** e selecionar um tipo de provedor de certificado que pode ser PEM, onde voc√™ precisar√° criar manualmente certificados PEM, agrup√°-los em um arquivo zip e depois referenciar o arquivo zip no S3, ou personalizado, onde voc√™ adicionaria um provedor de certificado personalizado como uma classe Java que fornece artefatos de criptografia.

Uma vez que o provedor de certificado TLS tenha sido configurado no arquivo de configura√ß√£o de seguran√ßa, os seguintes recursos de criptografia espec√≠ficos de aplicativos de criptografia podem ser habilitados, o que variar√° dependendo da sua vers√£o do EMR.

* Hadoop pode reduzir a mistura criptografada que usa TLS. Tanto o Secure Hadoop RPC que usa Camada de Seguran√ßa de Autentica√ß√£o Simples, quanto a criptografia de dados de transfer√™ncia de bloco HDFS que usa AES-256, s√£o ambos ativados quando a criptografia em repouso √© habilitada na configura√ß√£o de seguran√ßa.
* Presto: Ao usar a vers√£o EMR 5.6.0 ou posterior, qualquer comunica√ß√£o interna entre os n√≥s do Presto usar√° SSL e TLS.
* Tez Shuffle Handler usa TLS.
* Spark: O protocolo Akka usa TLS. O servi√ßo de transfer√™ncia de bloco usa Camada de Seguran√ßa de Autentica√ß√£o Simples e 3DES. O servi√ßo de mistura externa usa a Camada de Seguran√ßa de Autentica√ß√£o Simples.

### Enumera√ß√£o
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### Escalonamento de Privil√©gios

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Participe do grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou do grupo [**telegram**](https://t.me/peass) ou **siga**-me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
