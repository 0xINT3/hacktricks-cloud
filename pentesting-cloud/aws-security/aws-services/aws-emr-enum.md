# AWS - EMR枚举

<details>

<summary><strong>支持HackTricks并获得福利！</strong></summary>

* 如果您想在HackTricks中看到您的公司广告，或者如果您想访问PEASS的最新版本或下载PDF格式的HackTricks，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram群组**](https://t.me/peass) 或 **关注**我在**Twitter**上的🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) **和** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github仓库提交PR来分享您的黑客技巧。**

</details>

## EMR

EMR是AWS的托管服务，由一组高度可扩展的EC2实例组成，用于处理和运行诸如Apache Hadoop和Spark等大数据框架。

从EMR版本4.8.0开始，我们可以创建一个**安全配置**，指定不同的设置来**管理集群内数据的加密方式**。您可以选择对数据在静态状态下进行加密、在传输过程中进行加密，或者两者同时加密。这些安全配置的好处是它们实际上不是您的EC2集群的一部分。

EMR的一个关键点是，**默认情况下，集群内的实例不会对数据进行静态状态下的加密**。一旦启用，将可用以下功能。

* **Linux统一密钥设置：**可以使用此方法对EBS集群卷进行加密，您可以指定AWS **KMS**作为密钥管理提供商，或使用自定义密钥提供商。
* **开源HDFS加密：**提供了两种Hadoop加密选项。安全的Hadoop RPC将设置为使用简单身份验证安全层，HDFS块传输的数据加密将设置为使用AES-256算法。

从传输中的加密角度来看，您可以启用**开源传输层安全**加密功能，并选择证书提供商类型，可以是PEM，您需要手动创建PEM证书，将它们与zip文件捆绑在一起，然后在S3中引用该zip文件，或者是自定义类型，您可以将自定义证书提供商添加为提供加密工件的Java类。

一旦在安全配置文件中配置了TLS证书提供商，将可以启用以下特定于加密应用程序的加密功能，具体取决于您的EMR版本。

* Hadoop可能会减少使用TLS的加密洗牌。当在安全配置中启用静态状态下的加密时，安全的Hadoop RPC使用简单身份验证安全层，HDFS块传输使用AES-256算法，两者都会被激活。
* Presto：在使用EMR版本5.6.0及更高版本时，Presto节点之间的任何内部通信都将使用SSL和TLS。
* Tez Shuffle Handler使用TLS。
* Spark：Akka协议使用TLS。块传输服务使用简单身份验证安全层和3DES。外部洗牌服务使用简单身份验证安全层。

### 枚举
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### 提权

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

<details>

<summary><strong>支持 HackTricks 并获得福利！</strong></summary>

* 如果您想在 HackTricks 中看到您的公司广告，或者如果您想访问 PEASS 的最新版本或下载 HackTricks 的 PDF，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方 PEASS 和 HackTricks 商品**](https://peass.creator-spring.com)
* 发现[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) **和** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github 仓库提交 PR 来分享您的黑客技巧。**

</details>
