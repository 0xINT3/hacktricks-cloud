# AWS - EMR Enum

<details>

<summary><strong>ゼロからヒーローまでのAWSハッキングを学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をご覧ください！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをご覧ください
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローしてください。**
* **HackTricks**の[**GitHubリポジトリ**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)にPRを提出して、あなたのハッキングのコツを共有してください。

</details>

## EMR

EMRはAWSによって管理されるサービスであり、Apache HadoopやSparkなどのビッグデータフレームワークを処理し実行するために、**高度にスケーラブルなEC2インスタンスのクラスター**で構成されています。

EMRバージョン4.8.0以降では、クラスター内のデータの暗号化を管理する方法に関するさまざまな設定を指定する**セキュリティ設定**を作成する機能があります。データを休止状態で暗号化することも、転送中のデータを暗号化することも、必要に応じて両方を一緒に行うこともできます。これらのセキュリティ設定の素晴らしい点は、実際にはEC2クラスターの一部ではないということです。

EMRの重要な点の一つは、**デフォルトでは、クラスター内のインスタンスは休止状態のデータを暗号化しない**ということです。有効にすると、以下の機能が利用可能になります。

* **Linux Unified Key Setup:** EBSクラスターボリュームは、AWS **KMS**をキーマネジメントプロバイダーとして指定するか、カスタムキープロバイダーを使用してこの方法で暗号化できます。
* **オープンソースHDFS暗号化:** これには2つのHadoop暗号化オプションがあります。プライバシーに設定されたセキュアHadoop RPCと、AES-256アルゴリズムを使用するためにtrueに設定されたHDFSブロック転送のデータ暗号化です。

転送中の暗号化の観点からは、**オープンソーストランスポート層セキュリティ**暗号化機能を有効にし、PEM（手動でPEM証明書を作成し、それらをzipファイルにまとめてからS3でzipファイルを参照する必要があります）またはカスタム（カスタム証明書プロバイダーを暗号化アーティファクトを提供するJavaクラスとして追加する）のいずれかの証明書プロバイダータイプを選択できます。

TLS証明書プロバイダーがセキュリティ設定ファイルで設定されると、EMRバージョンに応じて異なる暗号化アプリケーション固有の暗号化機能を有効にすることができます。

* HadoopはTLSを使用する暗号化シャッフルを減らすかもしれません。セキュリティ設定で休止状態の暗号化が有効になっている場合、セキュアHadoop RPC（シンプル認証セキュリティレイヤーを使用）とHDFSブロック転送のデータ暗号化（AES-256を使用）の両方がアクティブになります。
* Presto: EMRバージョン5.6.0以降を使用する場合、Prestoノード間の内部通信はSSLとTLSを使用します。
* Tez Shuffle HandlerはTLSを使用します。
* Spark: AkkaプロトコルはTLSを使用します。ブロック転送サービスはシンプル認証セキュリティレイヤーと3DESを使用します。外部シャッフルサービスはシンプル認証セキュリティレイヤーを使用します。

### 列挙
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### 権限昇格

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)で</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>AWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加する、または**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを**共有する**。

</details>
