# AWS - EMR Enum

<details>

<summary><strong>Aprende hacking en AWS de cero a héroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colección de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## EMR

El servicio de Elastic MapReduce (EMR) de AWS, a partir de la versión 4.8.0, introdujo una característica de **configuración de seguridad** que mejora la protección de datos al permitir a los usuarios especificar ajustes de cifrado para los datos en reposo y en tránsito dentro de los clústeres de EMR, que son grupos escalables de instancias EC2 diseñados para procesar frameworks de big data como Apache Hadoop y Spark.

Las características clave incluyen:

- **Cifrado predeterminado del clúster**: Por defecto, los datos en reposo dentro de un clúster no están cifrados. Sin embargo, habilitar el cifrado proporciona acceso a varias características:
- **Configuración de clave unificada de Linux**: Cifra los volúmenes de clúster de EBS. Los usuarios pueden optar por el Servicio de Gestión de Claves (KMS) de AWS o un proveedor de claves personalizado.
- **Cifrado HDFS de código abierto**: Ofrece dos opciones de cifrado para Hadoop:
- RPC (Llamada a Procedimiento Remoto) de Hadoop seguro, configurado para privacidad, aprovechando la Capa de Seguridad de Autenticación Simple.
- Cifrado de transferencia de bloques HDFS, configurado en verdadero, utiliza el algoritmo AES-256.

- **Cifrado en Tránsito**: Se centra en asegurar los datos durante la transferencia. Las opciones incluyen:
- **Seguridad de la capa de transporte (TLS) de código abierto**: El cifrado se puede habilitar eligiendo un proveedor de certificados:
- **PEM**: Requiere la creación manual y el agrupamiento de certificados PEM en un archivo zip, referenciado desde un bucket de S3.
- **Personalizado**: Implica agregar una clase Java personalizada como proveedor de certificados que suministra artefactos de cifrado.

Una vez que se integra un proveedor de certificados TLS en la configuración de seguridad, se pueden activar las siguientes características de cifrado específicas de la aplicación, que varían según la versión de EMR:

- **Hadoop**:
- Podría reducir el mezclado cifrado utilizando TLS.
- RPC de Hadoop seguro con Capa de Seguridad de Autenticación Simple y Transferencia de Bloques HDFS con AES-256 se activan con el cifrado en reposo.

- **Presto** (versión de EMR 5.6.0+):
- La comunicación interna entre los nodos de Presto está asegurada utilizando SSL y TLS.

- **Tez Shuffle Handler**:
- Utiliza TLS para el cifrado.

- **Spark**:
- Emplea TLS para el protocolo Akka.
- Utiliza Capa de Seguridad de Autenticación Simple y 3DES para el Servicio de Transferencia de Bloques.
- El servicio de mezclado externo está asegurado con la Capa de Seguridad de Autenticación Simple.

Estas características mejoran colectivamente la postura de seguridad de los clústeres de EMR, especialmente en lo que respecta a la protección de datos durante las fases de almacenamiento y transmisión.


### Enumeración
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### Escalación de Privilegios

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

# Referencias
* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

<details>

<summary><strong>Aprende hacking en AWS de cero a héroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colección de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
