# AWS - EMR 枚举

<details>

<summary><strong>从零开始学习 AWS 黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS 红队专家）</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想看到您的**公司在 HackTricks 中做广告**或**下载 PDF 版的 HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 探索[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或在 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)** 上**关注我们。
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>

## EMR

AWS 的弹性 MapReduce（EMR）服务从版本 4.8.0 开始引入了一个**安全配置**功能，通过允许用户为 EMR 集群内的数据的静态和传输指定加密设置，增强了数据保护。EMR 集群是设计用于处理大数据框架（如 Apache Hadoop 和 Spark）的可扩展的 EC2 实例组。

关键特点包括：

- **集群加密默认值**：默认情况下，集群内的静态数据未加密。但是，启用加密会提供访问多个功能的权限：
- **Linux 统一密钥设置**：加密 EBS 集群卷。用户可以选择 AWS 密钥管理服务（KMS）或自定义密钥提供程序。
- **开源 HDFS 加密**：为 Hadoop 提供两种加密选项：
- 安全的 Hadoop RPC（远程过程调用），设置为隐私，利用简单认证安全层。
- HDFS 块传输加密，设置为 true，利用 AES-256 算法。

- **传输中的加密**：侧重于保护传输中的数据。选项包括：
- **开源传输层安全性（TLS）**：通过选择证书提供程序可以启用加密：
- **PEM**：需要手动创建和捆绑 PEM 证书到一个 zip 文件中，从一个 S3 存储桶引用。
- **自定义**：涉及添加一个自定义 Java 类作为证书提供程序，提供加密工件。

一旦 TLS 证书提供程序集成到安全配置中，可以激活以下特定于应用程序的加密功能，根据 EMR 版本的不同而变化：

- **Hadoop**：
- 可能通过 TLS 减少加密的洗牌。
- 使用简单认证安全层和 HDFS 块传输的 AES-256 激活静态加密。

- **Presto**（EMR 版本 5.6.0+）：
- Presto 节点之间的内部通信使用 SSL 和 TLS 进行保护。

- **Tez Shuffle Handler**：
- 使用 TLS 进行加密。

- **Spark**：
- 采用 TLS 用于 Akka 协议。
- 使用简单认证安全层和 3DES 用于块传输服务。
- 外部洗牌服务使用简单认证安全层进行保护。

这些功能共同增强了 EMR 集群的安全姿态，特别是在存储和传输阶段的数据保护方面。

### 枚举
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### 提权

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

# 参考
* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

支持HackTricks的其他方式：

* 如果您想看到您的**公司在HackTricks中做广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks周边产品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或 **关注**我们的**Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
