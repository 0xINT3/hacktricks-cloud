# AWS - Enumeración de EMR

<details>

<summary><strong>¡Apoya a HackTricks y obtén beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **última versión de PEASS o descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## EMR

EMR es un servicio administrado por AWS y está compuesto por un **grupo de instancias EC2 altamente escalable** para procesar y ejecutar grandes marcos de datos como Apache Hadoop y Spark.

A partir de la versión 4.8.0 de EMR, tenemos la capacidad de crear una **configuración de seguridad** que especifica diferentes ajustes sobre **cómo administrar la encriptación de sus datos dentro de sus clústeres**. Puede cifrar sus datos en reposo, datos en tránsito o, si es necesario, ambos juntos. Lo bueno de estas configuraciones de seguridad es que en realidad no forman parte de sus clústeres EC2.

Un punto clave de EMR es que **por defecto, las instancias dentro de un clúster no cifran los datos en reposo**. Una vez habilitadas, están disponibles las siguientes características.

* **Configuración unificada de claves de Linux:** Los volúmenes del clúster EBS se pueden cifrar mediante este método, en el que puede especificar AWS **KMS** como su proveedor de administración de claves, o utilizar un proveedor de claves personalizado.
* **Cifrado de HDFS de código abierto:** Esto proporciona dos opciones de cifrado de Hadoop. Secure Hadoop RPC, que se establecería en privacidad y que utiliza una capa de seguridad de autenticación simple, y el cifrado de datos de la transferencia de bloques de HDFS, que se establecería en verdadero para utilizar el algoritmo AES-256.

Desde una perspectiva de cifrado en tránsito, podría habilitar características de cifrado de **seguridad de capa de transporte de código abierto** y seleccionar un tipo de proveedor de certificados que puede ser PEM, donde deberá crear manualmente certificados PEM, agruparlos en un archivo zip y luego hacer referencia al archivo zip en S3, o personalizado, donde agregaría un proveedor de certificados personalizado como una clase Java que proporciona artefactos de cifrado.

Una vez que se ha configurado el proveedor de certificados TLS en el archivo de configuración de seguridad, se pueden habilitar las siguientes características de cifrado específicas de la aplicación de cifrado que variarán según su versión de EMR.

* Hadoop podría reducir el shuffle cifrado que utiliza TLS. Tanto Secure Hadoop RPC, que utiliza Simple Authentication Security Layer, como el cifrado de datos de la transferencia de bloques de HDFS, que utiliza AES-256, se activan cuando se habilita el cifrado en reposo en la configuración de seguridad.
* Presto: Cuando se utiliza la versión 5.6.0 o posterior de EMR, cualquier comunicación interna entre nodos Presto utilizará SSL y TLS.
* Tez Shuffle Handler utiliza TLS.
* Spark: El protocolo Akka utiliza TLS. El servicio de transferencia de bloques utiliza Simple Authentication Security Layer y 3DES. El servicio de mezcla externa utiliza Simple Authentication Security Layer.

### Enumeración

```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Obtener URLs de estudio
```

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

<details>

<summary><strong>¡Apoya a HackTricks y obtén beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **última versión de PEASS o descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sígueme** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>