# GCP - Enum√©ration des instances de calcul

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **d√©p√¥ts Github.**

</details>

## GCP VPC et r√©seau

En savoir plus sur le fonctionnement de cela dans :

{% content-ref url="gcp-vpc-and-networking.md" %}
[gcp-vpc-and-networking.md](gcp-vpc-and-networking.md)
{% endcontent-ref %}

### √ânum√©ration

{% code overflow="wrap" %}
```bash
# Liste des r√©seaux
gcloud compute networks list
gcloud compute networks describe <network>

# Liste des sous-r√©seaux
gcloud compute networks subnets list
gcloud compute networks subnets get-iam-policy <name> --region <region>
gcloud compute networks subnets describe <name> --region <region>

# Liste des r√®gles de pare-feu dans les r√©seaux
gcloud compute firewall-rules list --format="table(
                name,
                network,
                direction,
                priority,
                sourceRanges.list():label=SRC_RANGES,
                destinationRanges.list():label=DEST_RANGES,
                allowed[].map().firewall_rule().list():label=ALLOW,
                denied[].map().firewall_rule().list():label=DENY,
                sourceTags.list():label=SRC_TAGS,
                sourceServiceAccounts.list():label=SRC_SVC_ACCT,
                targetTags.list():label=TARGET_TAGS,
                targetServiceAccounts.list():label=TARGET_SVC_ACCT,
                disabled
            )"

# Liste des pare-feux hi√©rarchiques
gcloud compute firewall-policies list  (--folder <value>| --organization <value>)
gcloud compute firewall-policies describe <fw_policy>
gcloud compute firewall-policies list-rules <fw_policy>

# Obtenir les pare-feux de chaque r√©gion
gcloud compute network-firewall-policies list
## Obtenir les pare-feux finaux appliqu√©s dans une r√©gion
gcloud compute network-firewall-policies get-effective-firewalls --network=<vpc_name> --region <region>
```
{% endcode %}

Vous pouvez facilement trouver des instances de calcul avec des r√®gles de pare-feu ouvertes avec [https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/gcp\_firewall\_enum](https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/gcp\_firewall\_enum)

## Instances de calcul

Ce sont les moyens de **lancer des machines virtuelles dans GCP.**

{% content-ref url="./" %}
[.](./)
{% endcontent-ref %}

### √ânum√©ration

```bash
# Obtenir la liste des zones
# Il est int√©ressant de savoir quelles zones sont utilis√©es
gcloud compute regions list | grep -E "NAME|[^0]/"

# Liste des instances de calcul et obtenir des informations
gcloud compute instances list
gcloud compute instances describe <instance name>
gcloud compute instances get-iam-policy <instance> --zone=ZONE
gcloud compute instances get-screenshot <instance name> # L'instance doit avoir "Display Device" activ√©
gcloud compute instances os-inventory list-instances # Obtenir des informations sur le syst√®me d'exploitation des instances (l'agent OS Config s'ex√©cute sur les instances)


# √ânum√©rer les disques
gcloud compute disks list
gcloud compute disks describe <disk>
gcloud compute disks get-iam-policy <disk>
```

Pour plus d'informations sur la fa√ßon de **SSH** ou **modifier les m√©tadonn√©es** d'une instance pour **escalader les privil√®ges,** consultez cette page :

{% content-ref url="../../../gcp-security/gcp-privilege-escalation/gcp-local-privilege-escalation-ssh-pivoting.md" %}
[gcp-local-privilege-escalation-ssh-pivoting.md](../../../gcp-security/gcp-privilege-escalation/gcp-local-privilege-escalation-ssh-pivoting.md)
{% endcontent-ref %}

### √âl√©vation de privil√®ges

Dans la page suivante, vous pouvez v√©rifier comment **abuser des autorisations de calcul pour escalader les privil√®ges** :

{% content-ref url="../../gcp-privilege-escalation/gcp-compute-privesc/" %}
[gcp-compute-privesc](../../gcp-privilege-escalation/gcp-compute-privesc/)
{% endcontent-ref %}

### Journaux de console s√©rie

Les journaux de console s√©rie de Compute Engine sont une fonctionnalit√© qui vous permet de **visualiser et de diagnostiquer les journaux de d√©marrage et du syst√®me d'exploitation** de vos instances de machine virtuelle.

Les journaux de console s√©rie fournissent une **vue de bas niveau du processus de d√©marrage de l'instance**, y compris les messages du noyau, les scripts d'initialisation et autres √©v√©nements syst√®me qui se produisent pendant le d√©marrage. Cela peut √™tre utile pour d√©bog