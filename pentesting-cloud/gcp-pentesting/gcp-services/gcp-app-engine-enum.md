# GCP - App Engine Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>에서 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* HackTricks에서 **회사 광고를 보거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**를** 팔로우하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 자신의 해킹 기법을 공유하세요.

</details>

## 기본 정보 <a href="#reviewing-app-engine-configurations" id="reviewing-app-engine-configurations"></a>


Google Cloud Platform(GCP)의 App Engine은 대규모 웹 애플리케이션의 개발과 호스팅을 위해 특별히 설계된 **강력한 서버리스 플랫폼**입니다. 이 플랫폼의 설계는 개발 프로세스를 간소화하고 애플리케이션의 관리성을 향상시키는 데 중점을 두고 있습니다. GCP의 App Engine의 주요 기능과 이점은 다음과 같습니다:

1. **서버리스 아키텍처**: App Engine은 서버 프로비저닝, 구성 및 스케일링을 포함한 인프라를 자동으로 처리합니다. 이를 통해 개발자는 하드웨어에 대해 걱정하지 않고 코드 작성에 집중할 수 있습니다.
2. **자동 스케일링**: App Engine은 애플리케이션이 받는 트래픽 양에 따라 자동으로 애플리케이션을 확장할 수 있습니다. 트래픽이 증가하면 확장되고, 트래픽이 감소하면 축소되어 비용과 성능을 최적화하는 데 도움이 됩니다.
3. **언어 및 런타임 지원**: Java, Python, Node.js, Go, Ruby, PHP 및 .NET과 같은 인기있는 프로그래밍 언어를 지원합니다. 표준 환경 또는 유연한 환경에서 애플리케이션을 실행할 수 있습니다. 표준 환경은 제한적이지만 특정 언어에 대해 매우 최적화되어 있으며, 유연한 환경은 더 많은 사용자 정의가 가능합니다.
4. **통합 서비스**: App Engine은 Cloud SQL, Cloud Storage, Cloud Datastore 등 많은 다른 GCP 서비스와 통합됩니다. 이 통합은 클라우드 기반 애플리케이션의 아키텍처를 간소화합니다.
5. **버전 관리 및 트래픽 분할**: 여러 버전의 애플리케이션을 쉽게 배포하고 A/B 테스트 또는 점진적인 롤아웃을 위해 트래픽을 분할할 수 있습니다.
6. **애플리케이션 인사이트**: App Engine은 로깅, 사용자 인증 및 애플리케이션 모니터링 및 관리를 위한 개발자 도구와 같은 내장 서비스를 제공합니다.
7. **보안**: 애플리케이션 버전 관리, 안전한 연결을 위한 SSL/TLS 인증서 및 식별 및 액세스 관리와 같은 내장 보안 기능을 제공합니다.

### 방화벽

다음 옵션으로 Apps를 실행하는 인스턴스에 간단한 **방화벽**을 구성할 수 있습니다:

<figure><img src="../../../.gitbook/assets/image (3) (1) (2).png" alt=""><figcaption></figcaption></figure>

### SA

이러한 Apps에서 사용되는 기본 서비스 계정은 **`<proj-name>@appspot.gserviceaccount.com`**이며 프로젝트와 APP Engine 인스턴스 내의 SAs에 대해 **Editor** 역할을 가지고 있습니다.

### 스토리지

소스 코드와 메타데이터는 `<proj-id>.appspot.com` 및 `staging.<proj-id>.appspot.com` 및 `<country>.<proj-id>.appspot.com`과 같은 이름의 버킷에 **자동으로 저장**됩니다.

앱의 **모든 파일**은 **콘텐츠의 sha1을 파일 이름으로 사용하여 저장**됩니다:

<figure><img src="../../../.gitbook/assets/image (4) (6).png" alt=""><figcaption></figcaption></figure>

`staging.<proj-id>.appspot.com`의 **`ae`** 폴더 안에는 **버전별로 하나의 폴더**가 있으며 **소스 코드** 파일과 앱의 구성 요소를 **설명하는** **`manifest.json`** 파일이 있습니다:

{% code overflow="wrap" %}
```json
{"requirements.txt":{"sourceUrl":"https://storage.googleapis.com/staging.onboarding-host-98efbf97812843.appspot.com/a270eedcbe2672c841251022b7105d340129d108","sha1Sum":"a270eedc_be2672c8_41251022_b7105d34_0129d108"},"main_test.py":{"sourceUrl":"https://storage.googleapis.com/staging.onboarding-host-98efbf97812843.appspot.com/0ca32fd70c953af94d02d8a36679153881943f32","sha1Sum":"0ca32fd7_0c953af9_4d02d8a ...
```
{% endcode %}

### 컨테이너

웹 앱은 **컨테이너 내에서 실행**되며 **Code Build**를 사용하여 컨테이너를 빌드합니다.

### URL 및 지역

**기본** 웹 페이지는 URL **`<project-uniq-name>.appspot.com`**에 노출됩니다. 그러나 이전 버전의 URL은 약간 다를 수 있습니다. 예를 들어 **`https://20240117t001540-dot-<project-uniq-name>.uc.r.appspot.com`** (초기 타임스탬프를 참고하세요).

한 지역당 1개의 앱 엔진 웹 애플리케이션만 배포할 수 있는 것처럼 보일 수 있지만, **`app.yml`**에서 **`service: <servicename>`**을 지정하고 새로운 서비스(새로운 웹)를 생성할 수 있습니다. 이 새로운 웹의 URL 형식은 **`<servicename>-dot-<project-uniq-name>.appspot.com`**입니다.

### 열거

{% hint style="danger" %}
앱에 새 코드를 업로드할 때마다 **새 버전이 생성**됩니다. **모든 버전이 저장**되며, 이들은 심지어 **접근할 수 있는 URL**을 가지고 있습니다. 따라서 이전 버전의 코드를 수정하는 것은 **영속성 기법**으로 사용될 수 있습니다.
{% endhint %}

Cloud Functions와 마찬가지로, **애플리케이션이 실행될 때 런타임에서 환경 변수를 통해 액세스되는 비밀 정보에 의존할 수 있습니다**. 이러한 변수는 **`app.yaml`** 파일에 저장되어 있으며 다음과 같이 액세스할 수 있습니다:
```bash
# List the apps
gcloud app services list
gcloud app services describe <app-name>
# Access via browser to the specified app
gcloud app services browse <app-name>

# Get App versions
gcloud app versions list
# Get all the info of the app and version, included specific verion URL and the env
gcloud app versions describe -s <app-name> <version-id>

# Logs
gcloud app logs tail -s <app-name>

# Instances
## This is only valid if a flexible environment is used and not a standard one
gcloud app instances list
gcloud app instances describe -s <app-name> --version <version-id> <ID>
## Connect to the instance via ssh
gcloud app instances ssh --service <app-name> --version <version-id> <ID>

# Firewalls
gcloud app firewall-rules list
gcloud app firewall-rules describe <num_fw>

# Get domains
gcloud app domain-mappings list
gcloud app domain-mappings describe <name>

# SSl certificates
gcloud app ssl-certificates list
gcloud app ssl-certificates describe <name>
```
### 권한 상승

{% content-ref url="../gcp-privilege-escalation/gcp-appengine-privesc.md" %}
[gcp-appengine-privesc.md](../gcp-privilege-escalation/gcp-appengine-privesc.md)
{% endcontent-ref %}

### 인증되지 않은 열거

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-app-engine-unauthenticated-enum.md" %}
[gcp-app-engine-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-app-engine-unauthenticated-enum.md)
{% endcontent-ref %}

### 사후 침투

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-app-engine-post-exploitation.md" %}
[gcp-app-engine-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-app-engine-post-exploitation.md)
{% endcontent-ref %}

### 지속성

{% content-ref url="../../gcp-security/gcp-persistence/gcp-app-engine-persistence.md" %}
[gcp-app-engine-persistence.md](../../gcp-security/gcp-persistence/gcp-app-engine-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* 회사를 **HackTricks에서 광고**하거나 **PDF로 HackTricks 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 상품**](https://peass.creator-spring.com)을 구매하세요.
* 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 기법을 공유**하세요.

</details>
