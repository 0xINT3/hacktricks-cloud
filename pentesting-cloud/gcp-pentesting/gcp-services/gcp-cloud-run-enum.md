# GCP - Απαρίθμηση Cloud Run

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ τρικς σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Το Cloud Run είναι μια διαχειριζόμενη πλατφόρμα υπολογισμού χωρίς διακομιστή που σας επιτρέπει να **εκτελείτε εφαρμογές εντολής** απευθείας πάνω στην κλιμακούμενη υποδομή της Google.

Μπορείτε να εκτελέσετε τον δικό σας εφαρμογέα ή, εάν χρησιμοποιείτε Go, Node.js, Python, Java, .NET Core ή Ruby, μπορείτε να χρησιμοποιήσετε την επιλογή [ανάπτυξης βάσει πηγαίου κώδικα](https://cloud.google.com/run/docs/deploying-source-code) που **δημιουργεί τον εφαρμογέα για εσάς.**

Η Google έχει δημιουργήσει το Cloud Run για να **λειτουργεί καλά με άλλες υπηρεσίες στο Google Cloud**, έτσι μπορείτε να δημιουργήσετε πλήρως λειτουργικές εφαρμογές.

### Υπηρεσίες και εργασίες <a href="#services-and-jobs" id="services-and-jobs"></a>

Στο Cloud Run, ο κώδικάς σας μπορεί να εκτελείται είτε συνεχώς ως _**υπηρεσία**_ είτε ως _**εργασία**_. Και οι δύο υπηρεσίες και εργασίες εκτελούνται στον ίδιο περιβάλλοντα χώρο και μπορούν να χρησιμοποιήσουν τις ίδιες ενσωματωμένες λειτουργίες με άλλες υπηρεσίες στο Google Cloud.

* **Υπηρεσίες Cloud Run.** Χρησιμοποιούνται για την εκτέλεση κώδικα που ανταποκρίνεται σε αιτήματα ιστού ή συμβάντα.
* **Εργασίες Cloud Run.** Χρησιμοποιούνται για την εκτέλεση κώδικα που εκτελεί μια εργασία και τερματίζει όταν ολοκληρωθεί η εργασία.

## Υπηρεσία Cloud Run

Το [Cloud Run](https://cloud.google.com/run) της Google είναι μια άλλη προσφορά χωρίς διακομιστή όπου μπορείτε να αναζητήσετε μεταβλητές περιβάλλοντος. Το Cloud Run δημιουργεί έναν μικρό διακομιστή ιστού που εκτελείται προεπιλεγμένα στη θύρα 8080 μέσα στον εφαρμογέα, περιμένοντας ένα αίτημα HTTP GET. Όταν λαμβάνεται το αίτημα, εκτελείται μια εργασία και το αρχείο καταγραφής της εργασίας εξάγεται μέσω μιας απάντησης HTTP.

### Σχετικές λεπτομέρειες

* Από προεπιλογή, η πρόσβαση στον διακομιστή ιστού είναι **δημόσια**, αλλά μπορεί επίσης να περιοριστεί σε **εσωτερική κίνηση** (VPC...)\
Επιπλέον, η **πιστοποίηση** για να επικοινωνήσετε με τον διακομιστή ιστού μπορεί να είναι **επιτρεπτή για όλους** ή να **απαιτεί πιστοποίηση μέσω IAM**.
* Από προεπιλογή, η **κρυπτογράφηση** χρησιμοποιεί ένα **διαχειριζόμενο κλειδί της Google**, αλλά μπορεί επίσης να επιλεγεί ένα **CMEK** (Προσαρμοσμένο Κλειδί Κρυπτογράφησης που Διαχειρίζεται ο Πελάτης) από το **KMS**.
* Από προεπιλογή, ο λογαριασμός υπηρεσίας που χρησιμοποιείται είναι ο προεπιλεγμένος λογαριασμός Compute Engine που έχει πρόσβαση **Editor** στο έργο και έχει το **scope `cloud-platform`.**
* Είναι δυνατή η καθορισμός **καθαρών μεταβλητών περιβάλλοντος** για την εκτέλεση και ακόμα και η **προσάρτηση μυστικών του cloud** ή η **προσθήκη μυστικών του cloud στις μεταβλητές περιβάλλοντος.**
* Είναι επίσης δυνατή η **προσθήκη συνδέσεων με το Cloud SQL** και η **προσάρτηση ενός συστήματος αρχείων.**
* Οι **URL** των υπηρεσιών που έχουν αναπτυχθεί είναι παρόμοιες με **`https://<svc-name>-<random>.a.run.app`**
* Μια υπηρεσία Run μπορεί να έχει **περισσότερες από 1 έκδοση ή αναθεώρηση**, και να **διαιρεί την κίνηση** μεταξύ πολλαπλών αναθεωρήσεων.

### Απαρίθμηση
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Εργασίες Cloud Run

Οι εργασίες Cloud Run είναι πιο κατάλληλες για **εφαρμογές που εκτελούνται μέχρι την ολοκλήρωσή τους και δεν εξυπηρετούν αιτήσεις**. Οι εργασίες δεν έχουν τη δυνατότητα να εξυπηρετούν αιτήσεις ή να ακούνε σε έναν θύρα. Αυτό σημαίνει ότι, αντίθετα από τις υπηρεσίες Cloud Run, οι εργασίες δεν πρέπει να περιλαμβάνουν έναν διακομιστή ιστού. Αντί αυτού, οι εργασίες πρέπει να τερματίζουν τον εαυτό τους όταν ολοκληρωθούν.

### Απαρίθμηση
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Ανέβασμα Προνομίων

Στην ακόλουθη σελίδα, μπορείτε να ελέγξετε πώς να **καταχραστείτε τα δικαιώματα του cloud run για να ανεβάσετε προνόμια**:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Μη εξουσιοδοτημένη Πρόσβαση

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Μετά την Εκμετάλλευση

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Διατήρηση

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Αναφορές

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

<details>

<summary><strong>Μάθετε το hacking του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Αν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα κόλπα σας για το hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
