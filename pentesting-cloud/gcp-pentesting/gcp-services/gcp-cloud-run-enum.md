# GCP - Cloud Run Enum

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run je serverless upravljana računarska platforma koja vam omogućava da **pokrećete kontejnere** direktno na Google-ovoj skalabilnoj infrastrukturi.

Možete pokrenuti svoj kontejner ili, ako koristite Go, Node.js, Python, Java, .NET Core ili Ruby, možete koristiti opciju [izvorne implementacije](https://cloud.google.com/run/docs/deploying-source-code) koja **gradi kontejner za vas.**

Google je izgradio Cloud Run da **dobro funkcioniše zajedno sa drugim uslugama na Google Cloud-u**, tako da možete izgraditi aplikacije sa svim funkcionalnostima.

### Usluge i poslovi <a href="#services-and-jobs" id="services-and-jobs"></a>

Na Cloud Run-u, vaš kod može da se izvršava kontinuirano kao _**usluga**_ ili kao _**posao**_. I usluge i poslovi se izvršavaju u istom okruženju i mogu koristiti iste integracije sa drugim uslugama na Google Cloud-u.

* **Cloud Run usluge.** Koriste se za izvršavanje koda koji odgovara na web zahteve ili događaje.
* **Cloud Run poslovi.** Koriste se za izvršavanje koda koji obavlja posao i završava se kada je posao završen.

## Cloud Run Usluga

Google [Cloud Run](https://cloud.google.com/run) je još jedna serverless ponuda gde možete pretraživati env promenljive. Cloud Run kreira malog veb servera koji podrazumevano radi na portu 8080 unutar kontejnera i čeka HTTP GET zahtev. Kada zahtev bude primljen, izvršava se posao i log posla se prikazuje putem HTTP odgovora.

### Relevantni detalji

* Podrazumevano, **pristup** veb serveru je **javni**, ali može biti **ograničen na interni saobraćaj** (VPC...)\
Osim toga, **autentifikacija** za kontaktiranje veb servera može biti **dozvoljena za sve** ili **zahtevati autentifikaciju putem IAM**.
* Podrazumevano, **enkripcija** koristi **Google upravljani ključ**, ali može se izabrati i **CMEK** (Customer Managed Encryption Key) iz **KMS**.
* Podrazumevano, koristi se **servisni nalog** koji je podrazumevani nalog za Compute Engine i ima **Editor** pristup projektu i ima **scope `cloud-platform`.**
* Moguće je definisati **čitljive environment promenljive** za izvršavanje, čak i **montirati cloud tajne** ili **dodati cloud tajne u environment promenljive.**
* Takođe je moguće **dodati konekcije sa Cloud SQL-om** i **montirati fajl sistem.**
* **URL-ovi** deploy-ovanih usluga su slični **`https://<svc-name>-<random>.a.run.app`**
* Run Usluga može imati **više od 1 verzije ili reviziju**, i **podeliti saobraćaj** između nekoliko revizija.

### Enumeracija
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Cloud Run poslovi

Cloud Run poslovi su bolje rešenje za **kontejnere koji se izvršavaju do kraja i ne služe zahtevima**. Poslovi nemaju mogućnost da služe zahtevima ili osluškuju na portu. To znači da, za razliku od Cloud Run servisa, poslovi ne bi trebalo da sadrže veb server. Umesto toga, kontejneri poslova treba da se završe kada završe svoj posao.

### Enumeracija
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Eskalacija privilegija

Na sledećoj stranici možete proveriti kako **zloupotrebiti dozvole cloud run-a da biste eskalirali privilegije**:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Neautentifikovan pristup

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Post eksploatacija

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Upornost

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Reference

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
