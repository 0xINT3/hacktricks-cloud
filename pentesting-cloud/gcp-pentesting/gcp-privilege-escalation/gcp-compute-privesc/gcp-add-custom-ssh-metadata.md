# GCP - Ajouter des m√©tadonn√©es SSH personnalis√©es

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous voulez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** r√©f√©rentiels Github [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Modification des m√©tadonn√©es <a href="#modifying-the-metadata" id="modifying-the-metadata"></a>

Si vous pouvez **modifier les m√©tadonn√©es de l'instance**, il existe de nombreuses fa√ßons d'escalader les privil√®ges localement. Il existe quelques sc√©narios qui peuvent conduire √† un compte de service avec cette autorisation :

_**Compte de service par d√©faut**_\
Si l'acc√®s au compte de service est d√©fini sur **un acc√®s complet** ou s'il permet explicitement **l'acc√®s √† l'API de calcul**, alors cette configuration est **vuln√©rable** √† l'escalade. La **port√©e** par d√©faut n'est **pas** **vuln√©rable**.

_**Compte de service personnalis√©**_\
Lors de l'utilisation d'un compte de service personnalis√©, **l'une** des autorisations IAM suivantes **est** **n√©cessaire** pour escalader les privil√®ges :

* `compute.instances.setMetadata` (pour affecter une seule instance)
* `compute.projects.setCommonInstanceMetadata` (pour affecter toutes les instances du projet)

Bien que Google [recommande](https://cloud.google.com/compute/docs/access/service-accounts#associating\_a\_service\_account\_to\_an\_instance) de ne pas utiliser les port√©es d'acc√®s pour les comptes de service personnalis√©s, il est toujours possible de le faire. Vous aurez besoin de l'une des port√©es d'acc√®s suivantes :

* `https://www.googleapis.com/auth/compute`
* `https://www.googleapis.com/auth/cloud-platform`

### **Ajouter des cl√©s SSH aux m√©tadonn√©es personnalis√©es**

Les **s