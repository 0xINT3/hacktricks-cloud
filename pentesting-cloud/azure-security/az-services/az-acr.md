# Az - ACR

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Taarifa Msingi

Azure Container Registry (ACR) ni huduma iliyosimamiwa inayotolewa na Microsoft Azure kwa **kuhifadhi na kusimamia picha za kontena za Docker na vitu vingine**. Inatoa huduma kama zana za maendeleo zilizounganishwa, ugeuzaji wa eneo, hatua za usalama kama kudhibiti upatikanaji kulingana na jukumu na uchunguzi wa picha, ujenzi wa moja kwa moja, vitanzi na kichocheo, na kufungwa kwa mtandao. Inafanya kazi na zana maarufu kama Docker CLI na Kubernetes, na inaunganisha vizuri na huduma zingine za Azure.

### Kuchunguza

Kutambua huduma unaweza kutumia script [**Get-AzACR.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/Misc/Get-AzACR.ps1):

{% code overflow="wrap" %}
```bash
# List Docker images inside the registry
IEX (New-Object Net.Webclient).downloadstring("https://raw.githubusercontent.com/NetSPI/MicroBurst/master/Misc/Get-AzACR.ps1")

Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Internet Explorer\Main" -Name "DisableFirstRunCustomize" -Value 2

Get-AzACR -username <username> -password <password> -registry <corp-name>.azurecr.io
```
### Kudhibiti Upatikanaji wa Azure Container Registry (ACR)

#### Angalia Mipangilio ya Usalama
```bash
az acr show --name <acr_name> --query "networkRuleSet.defaultAction"
```

#### Weka Kanuni za Kizuizi cha Upatikanaji
```bash
az acr update --name <acr_name> --default-action Deny
```

#### Ongeza Kanuni za Kuingia
```bash
az acr update --name <acr_name> --add networkRule myIP
```

#### Ondoa Kanuni za Kuingia
```bash
az acr update --name <acr_name> --remove networkRule myIP
```

#### Weka Kanuni za Kuingia kwa Rangi
```bash
az acr update --name <acr_name> --add networkRule --ip-address <ip_address> --subnet <subnet_id>
```

#### Weka Kanuni za Kutoa Rangi
```bash
az acr update --name <acr_name> --remove networkRule --ip-address <ip_address> --subnet <subnet_id>
```
```bash
az acr list --output table
az acr show --name MyRegistry --resource-group MyResourceGroup
```
{% endtab %}

{% tab title="Az Powershell" %}  
### Az Powershell

1. **Install Az Powershell Module**
   ```bash
   Install-Module -Name Az -AllowClobber -Scope CurrentUser -Force -Repository PSGallery
   ```

2. **Connect to Azure**
   ```bash
   Connect-AzAccount
   ```

3. **List all Azure Container Registries**
   ```bash
   Get-AzContainerRegistry
   ```

4. **Get detailed information about a specific Azure Container Registry**
   ```bash
   Get-AzContainerRegistry -ResourceGroupName <resource_group_name> -Name <registry_name>
   ```

5. **List all repositories in an Azure Container Registry**
   ```bash
   Get-AzContainerRegistryRepository -RegistryName <registry_name> -ResourceGroupName <resource_group_name>
   ```

6. **List all images in a specific repository**
   ```bash
   Get-AzContainerRegistryTag -RegistryName <registry_name> -Repository <repository_name> -ResourceGroupName <resource_group_name>
   ```

7. **Delete an image from a repository**
   ```bash
   Remove-AzContainerRegistryTag -RegistryName <registry_name> -Repository <repository_name> -Tag <tag_name> -ResourceGroupName <resourcejson_name>
   ```

8. **List all webhooks in an Azure Container Registry**
   ```bash
   Get-AzContainerRegistryWebhook -RegistryName <registry_name> -ResourceGroupName <resource_group_name>
   ```

9. **Delete a webhook from an Azure Container Registry**
   ```bash
   Remove-Awebhook -RegistryName <registry_name> -ResourceGroupName <resource_group_name> -ServiceUri <service_uri>
   ```

10. **List all tasks in an Azure Container Registry**
    ```bash
    Get-AzContainerRegistryTask -RegistryName <registry_name> -ResourceGroupName <resource_group_name>
    ```

11. **Get detailed information about a specific task in an Azure Container Registry**
    ```bash
    Get-AzContainerRegistryTask -RegistryName <registry_name> -ResourceGroupName <resource_group_name> -TaskName <task_name>
    ```

12. **Delete a task from an Azure Container Registry**
    ```bash
    Remove-AzContainerRegistryTask -RegistryName <registry_name> -ResourceGroupName <resource_group_name> -TaskName <task_name>
    ```  
{% endtab %}
```powershell
# List all ACRs in your subscription
Get-AzContainerRegistry

# Get a specific ACR
Get-AzContainerRegistry -ResourceGroupName "MyResourceGroup" -Name "MyRegistry"
```
{% endtab %}
{% endtabs %}

Ingia & Piga kutoka kwenye rejista
```bash
docker login <corp-name>.azurecr.io --username <username> --password <password>
docker pull <corp-name>.azurecr.io/<image>:<tag>
```
<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
