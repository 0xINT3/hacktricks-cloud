# Az - ACR

<details>

<summary><strong>支持 HackTricks 并获得福利！</strong></summary>

* 如果您想在 HackTricks 中看到您的公司广告，或者如果您想访问 PEASS 的最新版本或下载 HackTricks 的 PDF，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方 PEASS 和 HackTricks 商品**](https://peass.creator-spring.com)
* 发现[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFT**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) **和** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github 仓库提交 PR 来分享您的黑客技巧。**

</details>

## 基本信息

Azure Container Registry (ACR) 是由 Microsoft Azure 提供的托管服务，用于**存储和管理 Docker 容器镜像和其他工件**。它提供了集成的开发工具、地理复制、诸如基于角色的访问控制和镜像扫描等安全措施、自动构建、Webhooks 和触发器以及网络隔离等功能。它与 Docker CLI 和 Kubernetes 等常用工具配合使用，并与其他 Azure 服务良好集成。

### 枚举

要枚举该服务，您可以使用脚本 [**Get-AzACR.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/Misc/Get-AzACR.ps1)：

{% code overflow="wrap" %}
```bash
# List Docker images inside the registry
IEX (New-Object Net.Webclient).downloadstring("https://raw.githubusercontent.com/NetSPI/MicroBurst/master/Misc/Get-AzACR.ps1")

Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Internet Explorer\Main" -Name "DisableFirstRunCustomize" -Value 2

Get-AzACR -username <username> -password <password> -registry <corp-name>.azurecr.io
```
{% tab title="az cli" %}
```bash
az acr list --output table
az acr show --name MyRegistry --resource-group MyResourceGroup
```
{% tab title="Az Powershell" %}

## Az ACR

### 获取 ACR 信息

```powershell
az acr show --name <acr_name> --resource-group <resource_group_name>
```

### 列出 ACR 中的镜像仓库

```powershell
az acr repository list --name <acr_name> --resource-group <resource_group_name>
```

### 列出镜像仓库中的镜像

```powershell
az acr repository show-tags --name <acr_name> --repository <repository_name> --resource-group <resource_group_name>
```

### 删除 ACR 中的镜像仓库

```powershell
az acr repository delete --name <acr_name> --repository <repository_name> --resource-group <resource_group_name>
```

### 删除 ACR 中的镜像

```powershell
az acr repository delete --name <acr_name> --repository <repository_name> --tag <tag_name> --resource-group <resource_group_name>
```

### 导出 ACR 中的镜像

```powershell
az acr repository show-manifests --name <acr_name> --repository <repository_name> --resource-group <resource_group_name> --query "[].{digest:digest, tags:tags}" --output table
```

### 导入镜像到 ACR

```powershell
az acr import --name <acr_name> --source <source_image> --image <target_image> --resource-group <resource_group_name>
```

### 创建 ACR 注册表

```powershell
az acr create --name <acr_name> --resource-group <resource_group_name> --sku <sku> --admin-enabled true
```

### 更新 ACR 注册表

```powershell
az acr update --name <acr_name> --resource-group <resource_group_name> --sku <sku> --admin-enabled true
```

### 删除 ACR 注册表

```powershell
az acr delete --name <acr_name> --resource-group <resource_group_name>
```

### 列出 ACR 注册表

```powershell
az acr list --resource-group <resource_group_name>
```

### 列出 ACR 注册表的访问密钥

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name>
```

### 列出 ACR 注册表的登录服务器

```powershell
az acr show --name <acr_name> --resource-group <resource_group_name> --query "loginServer" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录用户名

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "username" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录凭据

```powershell
az acr credential show --name <acr_name> --resource-group <resource_group_name> --query "passwords[].value" --output tsv
```

### 列出 ACR 注册表的登录密码

```powershell
az acr credential show --name <acr
```powershell
# List all ACRs in your subscription
Get-AzContainerRegistry

# Get a specific ACR
Get-AzContainerRegistry -ResourceGroupName "MyResourceGroup" -Name "MyRegistry"
```
{% endtab %}
{% endtabs %}

登录并从注册表中拉取镜像
```bash
docker login <corp-name>.azurecr.io --username <username> --password <password>
docker pull <corp-name>.azurecr.io/<image>:<tag>
```
<details>

<summary><strong>支持HackTricks并获得好处！</strong></summary>

* 如果您想在HackTricks中看到您的公司广告，或者如果您想访问PEASS的最新版本或下载PDF格式的HackTricks，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获得[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* 发现我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品，[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或者 [**Telegram群组**](https://t.me/peass)，或者在**Twitter**上**关注**我 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
