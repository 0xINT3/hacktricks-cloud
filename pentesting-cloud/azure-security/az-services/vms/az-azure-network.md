# Az - Azure ネットワーク

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) で AWS ハッキングをゼロからヒーローまで学ぶ</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks にあなたの会社を広告掲載したい場合**や **HackTricks を PDF でダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式 PEASS & HackTricks グッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を発見し、独占的な [**NFT**](https://opensea.io/collection/the-peass-family) コレクションをチェックする
* 💬 [**Discord グループ**](https://discord.gg/hRep4RUj7f) に**参加する**か、[**telegram グループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) を**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) の github リポジトリに PR を提出して、あなたのハッキングのコツを共有する。

</details>

## 基本情報

Azure 内のネットワークは、さまざまな Azure サービスとリソース間の**接続と通信を可能にする**、クラウドコンピューティングプラットフォームの不可欠な部分として機能します。Azure のネットワークアーキテクチャは、高いスケーラビリティ、セキュリティ、カスタマイズ性を備えて設計されています。

Azure は、ユーザーが Azure クラウド内で**分離されたネットワーク**を作成できる**仮想ネットワーク (VNet)** を提供しています。これらの VNets 内では、仮想マシン、アプリケーション、データベースなどのリソースを安全にホストおよび管理できます。Azure のネットワーキングは、クラウド内の通信（Azure サービス間）と外部ネットワークやインターネットへの接続の両方をサポートしています。

**セキュリティ**は Azure ネットワーキングの重要な側面であり、データの保護、アクセスの管理、コンプライアンスの確保に利用できるさまざまなツールやサービスがあります。これらのセキュリティ対策には、**ファイアウォール**、**ネットワークセキュリティグループ**、および**暗号化**機能が含まれ、トラフィックとアクセスを高いレベルで制御できます。

全体として、Azure のネットワーキング機能は、特定のアプリケーションやワークロードのニーズに合わせたネットワーク環境をユーザーが作成できる柔軟性を提供するように設計されており、セキュリティと信頼性に強い重点を置いています。

## 仮想ネットワーク (VNET) とサブネット

Azure の VNet は、クラウド内の自分のネットワークの表現です。これは、あなたの**サブスクリプションに専用の Azure クラウドの論理的な分離**です。VNet を使用すると、Azure で仮想プライベートネットワーク (VPN) をプロビジョニングおよび管理でき、仮想マシン (VM)、データベース、アプリケーションサービスなど、**さまざまな種類の Azure リソースをホストおよび管理するために使用できます**。

VNets は、**IP アドレス範囲**、サブネットの作成、ルートテーブル、ネットワークゲートウェイなど、ネットワーク設定を完全に制御できます。

**サブネット**は、VNet 内の**IP アドレスの範囲**です。組織とセキュリティのために、VNet を複数のサブネットに分割できます。VNet の各サブネットは、ネットワークおよびアプリケーションアーキテクチャに従ってリソースを分離およびグループ化するために使用できます。

さらに、サブネットを使用すると、VNet を一つ以上のサブネットワークに**セグメント化**し、リソースが使用できる IP アドレスの範囲を提供できます。

### **例**

* `MyVNet` という名前の VNet があり、IP アドレス範囲が `10.0.0.0/16` であるとします。この VNet 内に `Subnet-1` というサブネットを作成し、IP アドレス範囲 `10.0.0.0/24` でウェブサーバーをホストすることができます。別のサブネット `Subnet-2` は、範囲 `10.0.1.0/24` でデータベースサーバー用に使用できます。このセグメンテーションにより、ネットワーク内での効率的な管理とセキュリティ制御が可能になります。

### 列挙

Azure アカウント内のすべての VNets とサブネットをリストするには、Azure コマンドラインインターフェース (CLI) を使用できます。以下が手順です：

{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}

## ネットワークセキュリティグループ（NSG）

Azureのネットワークセキュリティグループ（NSG）は、Azureの仮想ネットワーク（**VNet**）内のAzureリソースへの、またはそこからの**ネットワークトラフィックをフィルタリングするために使用されます**。NSGには、いくつかの種類のAzureリソースへの入力ネットワークトラフィックを許可または拒否する、またはそこからの出力ネットワークトラフィックを許可または拒否する**セキュリティルール**が含まれています。

NSG内の各ルールは、**ソース/宛先IPアドレス、ポート、およびプロトコルに基づいてフィルターを定義します**。これにより、ネットワークトラフィックを細かく制御し、Azureリソースにアクセスまたはそこから出ることができるのは承認されたトラフィックのみであることを保証します。

### **例**

* VNet内のサブネットまたは特定の仮想マシンに適用された`MyNSG`というNSGを想像してください。次のようなルールを作成できます：
* 任意のソースからのHTTPトラフィック（ポート80）を許可する入力ルール。
* 特定の宛先IPアドレス範囲へのSQLトラフィックのみを許可する出力ルール（ポート1433）。

### 列挙

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewallは、**Azure Virtual Networkリソースを保護するクラウドベースの管理されたネットワークセキュリティサービス**です。完全にステートフルなファイアウォールとしてのサービスであり、組み込まれた高可用性とスケーラビリティ機能を備えています。

Azure Firewallは**NSGs**よりも**より高度な**機能を提供し、**アプリケーションレベルのフィルタリング**、ネットワークレベルのフィルタリング、脅威インテリジェンスに基づくフィルタリング、およびログと分析のためのAzure Monitorとの統合を含みます。\
アウトバウンド、インバウンド、スポーク間、VPN、ExpressRouteトラフィックをフィルタリングできます。**FQDN（完全修飾ドメイン名）、IPアドレス、ポートに基づいてファイアウォールルールを作成できます**。

### Azure FirewallとNSGsの違い&#x20;

1. **範囲:**
* **NSG:** サブネットまたはネットワークインターフェースレベルで動作します。ネットワークインターフェース（NIC）、VM、またはサブネットからのインバウンドおよびアウトバウンドトラフィックの基本的なフィルタリングを提供することを目的としています。
* **Azure Firewall:** VNetレベルで動作し、より広範な保護の範囲を提供します。VNetのリソースを保護し、VNetへの流入および流出トラフィックを管理するように設計されています。
2. **機能:**
* **NSG:** IPアドレス、ポート、プロトコルに基づく基本的なフィルタリング機能を提供します。アプリケーションレベルの検査や脅威インテリジェンスのような高度な機能はサポートしていません。
* **Azure Firewall:** アプリケーションレベル（レイヤー7）のトラフィックフィルタリング、脅威インテリジェンスに基づくフィルタリング、ネットワークトラフィックフィルタリングなどの高度な機能を提供します。また、複数のパブリックIPアドレスをサポートしています。
3. **使用例:**
* **NSG:** 基本的なネットワークレベルのトラフィックフィルタリングに適しています。
* **Azure Firewall:** アプリケーションレベルの制御、ログ、脅威インテリジェンスが必要なより複雑なフィルタリングシナリオに適しています。
4. **管理とモニタリング:**
* **NSG:** 基本的なログとAzure Monitorとの統合を提供します。
* **Azure Firewall:** Azure Monitorを通じて高度なログと分析機能を提供し、トラフィックの性質とパターンを理解するために不可欠です。

### 列挙

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## ネットワーク仮想アプライアンス (NVA)

Azureにおけるネットワーク仮想アプライアンス（**NVA**）は、仮想ネットワーク内で**ネットワーク機能を実行する**仮想アプライアンスです。NVAは、Azureで**ネイティブに利用できない**ネットワーク機能が必要な場合や、よりカスタマイズが求められる場合に使用されます。これらは基本的に、ファイアウォール、WAN最適化装置、またはロードバランサーなどのネットワークアプリケーションやサービスを実行する**VM**です。

NVAは複雑なルーティング、**セキュリティ**、および**ネットワークトラフィック管理**のタスクに使用されます。Azure **マーケットプレイス**からデプロイでき、多くのサードパーティベンダーがAzure環境に統合するためのアプライアンスを提供しています。

### **例**

* 組織は、AzureにNVAをデプロイして**カスタムファイアウォールソリューション**を作成することができます。このNVAは**サードパーティのファイアウォールソフトウェア**を実行し、侵入検知、パケット検査、またはVPN接続のような高度な機能を提供することができます。NVAは、それを通過するトラフィックを検査およびフィルタリングするように設定され、組織のポリシーに従って強化されたセキュリティ対策が講じられていることを保証します。

### **列挙**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
## Azure ルートテーブル & ユーザー定義ルート (UDR)

**Azure ルートテーブル** は、Microsoft Azure 内で **Azure Virtual Networks (VNets) 内のネットワークトラフィックのルーティングを制御する** 機能です。基本的に、これらは VNets 内のサブネット間、VNets 間、または外部ネットワークへの **パケット** の **転送方法** を定義します。各ルートテーブルには、パケットがその宛先 IP アドレスに基づいてどのようにルーティングされるべきかを指定するルールのセット、つまりルートが含まれています。

**ユーザー定義ルート (UDR)** は、Azure 内の Azure ルートテーブル内で作成する **カスタムルート** で、Azure Virtual Networks (VNets) 内および外部接続への **ネットワークトラフィックの流れを制御します**。UDR は、Azure のデフォルトのルーティング決定を上書きし、特定の要件に応じてネットワークトラフィックを指示する柔軟性を提供します。

これらのルートは、特に **仮想アプライアンスを通じてトラフィックをルーティングする必要がある場合**、セキュリティやポリシーの遵守のために特定の経路を強制する場合、またはオンプレミスネットワークとの統合が必要な場合に役立ちます。

### **例**

* VNet 内のサブネット間のトラフィックを検査するために Network Virtual Appliance (NVA) をデプロイしたとします。あるサブネットから別のサブネットへのすべてのトラフィックが NVA を通過するように UDR を作成できます。この UDR は、トラフィックが目的地に到達する前にセキュリティ目的で NVA がトラフィックを検査することを保証します。

### **列挙**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Private Link

Azure Private Linkは、**Azureサービスへのプライベートアクセスを可能にする**Azureのサービスであり、**トラフィックがお客様のAzure仮想ネットワーク（VNet）とサービスの間で完全にMicrosoftのAzureバックボーンネットワーク内を移動することを保証します**。これにより、サービスをVNet内に効果的に取り込むことができます。この設定は、データを公開インターネットに露出させないことでセキュリティを強化します。

Private Linkは、Azure Storage、Azure SQL Database、Private Link経由で共有されるカスタムサービスなど、さまざまなAzureサービスで使用できます。これにより、自身のVNet内、または異なるAzureサブスクリプションからでも、サービスを安全に利用する方法を提供します。

{% hint style="danger" %}
NSGはプライベートエンドポイントには適用されません。これは、プライベートリンクを含むサブネットにNSGを関連付けても効果がないことを明確に意味します。
{% endhint %}

### **例**

* **Azure SQL Databaseに安全にアクセスしたい**というシナリオを考えてみましょう。通常、これには公開インターネットを経由することが含まれるかもしれません。Private Linkを使用すると、Azure SQL Databaseサービスに直接接続する**VNet内にプライベートエンドポイントを作成**できます。このエンドポイントにより、データベースは自身のVNetの一部であるかのように見え、プライベートIPアドレスを介してアクセス可能になり、安全かつプライベートなアクセスを保証します。

### **列挙**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure サービスエンドポイント

Azure サービスエンドポイントは、直接接続を介して、仮想ネットワークのプライベートアドレス空間とVNetのアイデンティティをAzureサービスに拡張します。サービスエンドポイントを有効にすることで、**VNet内のリソースがAzureのバックボーンネットワークを使用してAzureサービスに安全に接続できます**。これにより、**VNetからAzureサービスへのトラフィックがAzureネットワーク内に留まる**ことが保証され、より安全で信頼性の高いパスが提供されます。

### **例**

* 例えば、**Azure Storage** アカウントはデフォルトで公開インターネット経由でアクセス可能です。VNet内で **Azure Storageのサービスエンドポイントを有効にする** ことで、VNetからのトラフィックのみがストレージアカウントにアクセスできるようになります。その後、ストレージアカウントのファイアウォールをVNetからのトラフィックのみを受け入れるように設定できます。

### **列挙**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
### サービスエンドポイントとプライベートリンクの違い

Microsoftは[**ドキュメント**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints)でプライベートリンクの使用を推奨しています：

<figure><img src="../../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**サービスエンドポイント：**

* VNetからAzureサービスへのトラフィックは、公共インターネットを迂回してMicrosoft Azureバックボーンネットワークを経由します。
* エンドポイントはAzureサービスへの直接接続であり、VNet内にサービスのプライベートIPを提供しません。
* サービス自体は、サービスのファイアウォールを設定してそのようなトラフィックをブロックしない限り、VNetの外部からその公共エンドポイントを介してアクセス可能です。
* サブネットとAzureサービスの間の一対一の関係です。
* プライベートリンクよりも費用がかかりません。

**プライベートリンク：**

* プライベートリンクは、VNet内のプライベートエンドポイントを介してAzureサービスをVNetにマッピングします。これは、VNet内にプライベートIPアドレスを持つネットワークインターフェースです。
* Azureサービスは、このプライベートIPアドレスを使用してアクセスされ、あたかもネットワークの一部であるかのように見えます。
* プライベートリンクを介して接続されたサービスは、VNetまたは接続されたネットワークからのみアクセス可能であり、サービスへの公共インターネットアクセスはありません。
* Azureサービスへの安全な接続、またはAzureでホストされている自分のサービスへの接続、他者によって共有されているサービスへの接続を可能にします。
* サービスエンドポイントのサブネットレベルでのより広範なアクセス制御とは対照的に、VNet内のプライベートエンドポイントを介してより細かいアクセス制御を提供します。

要約すると、サービスエンドポイントとプライベートリンクの両方がAzureサービスへの安全な接続を提供する一方で、**プライベートリンクはサービスを公共インターネットに露出させることなくプライベートにアクセスすることを保証することで、より高いレベルの隔離とセキュリティを提供します**。一方、サービスエンドポイントは、VNet内にプライベートIPが必要ない一般的なケースでAzureサービスへのシンプルで安全なアクセスを設定するためにはより簡単です。

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door**は、グローバルなWebアプリケーションの高速配信のためのスケーラブルで安全なエントリーポイントです。グローバルな**ロードバランシング、サイトアクセラレーション、SSLオフロード、Webアプリケーションファイアウォール（WAF）**の機能を一つのサービスに**組み合わせて**います。Azure Front Doorは、**ユーザーに最も近いエッジロケーションに基づいた**インテリジェントなルーティングを提供し、最適なパフォーマンスと信頼性を保証します。さらに、URLベースのルーティング、複数サイトホスティング、セッションアフィニティ、アプリケーションレイヤーのセキュリティを提供します。

**Azure Front Door WAF**は、バックエンドコードの変更なしに**Webベースの攻撃からWebアプリケーションを保護する**ように設計されています。SQLインジェクション、クロスサイトスクリプティング、その他の一般的な攻撃に対抗するカスタムルールと管理されたルールセットが含まれています。

### **例**

* 世界中にユーザーを持つグローバルに分散されたアプリケーションを想像してください。Azure Front Doorを使用して、**ユーザーリクエストをアプリケーションをホストしている最も近い地域データセンターにルーティングする**ことで、遅延を減らし、ユーザーエクスペリエンスを向上させ、**WAF機能でWeb攻撃から守る**ことができます。特定の地域でダウンタイムが発生した場合、Azure Front Doorは自動的にトラフィックを次善のロケーションに再ルーティングし、高可用性を保証します。

### 列挙

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure Application Gateway と Azure Application Gateway WAF

Azure Application Gateway は、**ウェブ**アプリケーションへのトラフィックを管理するための**ウェブトラフィックのロードバランサー**です。これは、サービスとしてのアプリケーションデリバリーコントローラー（ADC）内で**レイヤー7のロードバランシング、SSL終了、およびウェブアプリケーションファイアウォール（WAF）機能**を提供します。主な機能には、URLベースのルーティング、クッキーベースのセッションアフィニティ、およびセキュアソケットレイヤー（SSL）オフロードが含まれており、グローバルルーティングやパスベースのルーティングなど、複雑なロードバランシング機能を必要とするアプリケーションにとって重要です。

### 例

* 複数のサブドメインを持つ電子商取引ウェブサイトを運営しているシナリオを考えてみましょう。これらのサブドメインは、ユーザーアカウントや支払い処理などの異なる機能を担っています。Azure Application Gateway は、**URLパスに基づいて適切なウェブサーバーへトラフィックをルーティング**することができます。例えば、`example.com/accounts`へのトラフィックはユーザーアカウントサービスに、`example.com/pay`へのトラフィックは支払い処理サービスにそれぞれ向けられることができます。\
そして、**WAF機能を使用してウェブサイトを攻撃から保護します。**

### **列挙**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering** は、異なる Virtual Networks (VNets) を直接かつシームレスに接続することを可能にする Azure のネットワーキング機能です。VNet ピアリングを通じて、ある VNet のリソースは、**同じネットワーク内にあるかのように**、別の VNet のリソースとプライベート IP アドレスを使用して通信できます。\
**VNet ピアリングは、オンプレミスネットワークとも使用できます**。これは、サイト間 VPN や Azure ExpressRoute を設定することで実現します。

**Azure Hub and Spoke** は、Azure でネットワークトラフィックを管理・整理するために使用されるネットワークトポロジーです。**"ハブ" は、異なる "スポーク" 間のトラフィックを制御し、ルーティングする中心点です**。ハブには、ネットワーク仮想アプライアンス (NVAs)、Azure VPN Gateway、Azure Firewall、または Azure Bastion などの共有サービスが含まれることが一般的です。**"スポーク" は、ワークロードをホストし、VNet ピアリングを使用してハブに接続する VNets です**。これにより、ハブ内の共有サービスを活用できます。このモデルは、異なる VNets の複数のワークロードが使用できる共通サービスを中央集権化することで、クリーンなネットワークレイアウトを促進し、複雑さを減らします。

{% hint style="danger" %}
**Azure での VNET ピアリングは非推移的です**。つまり、スポーク 1 がスポーク 2 に接続され、スポーク 2 がスポーク 3 に接続されている場合、スポーク 1 はスポーク 3 と直接通信することはできません。
{% endhint %}

### 例

* 例えば、営業部、人事部、開発部など、**それぞれが独自の VNet (スポーク) を持つ会社**を想像してください。これらの VNets は、中央データベース、ファイアウォール、インターネットゲートウェイなどの**共有リソースへのアクセスが必要です**。これらはすべて、**別の VNet (ハブ) に位置しています**。ハブとスポークモデルを使用することで、各部門は、公共インターネットにそれらのリソースを露出させることなく、また複雑なネットワーク構造を多数の接続で作成することなく、**ハブ VNet を通じて共有リソースに安全に接続できます**。

### 列挙

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## サイト間VPN

Azureのサイト間VPNを使用すると、**オンプレミスネットワークをAzure Virtual Network (VNet)に接続できます**。これにより、Azure内のリソース（VMなど）がローカルネットワーク上にあるかのように見えます。この接続は、**2つのネットワーク間のトラフィックを暗号化するVPNゲートウェイを通じて確立されます**。

### **例**

* ニューヨークに本社を置く企業がオンプレミスのデータセンターを持っており、そのデータセンターをAzureにホストされている仮想化されたワークロードを持つVNetに安全に接続する必要があります。**サイト間VPNを設定することで、企業はオンプレミスサーバーとAzure VM間の暗号化された接続を確保できます**。これにより、両環境のリソースを同じローカルネットワーク内にあるかのように安全にアクセスできます。

### **列挙**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRouteは、**オンプレミスインフラストラクチャとAzureデータセンター間のプライベートで専用の高速接続を提供するサービス**です。この接続は接続プロバイダーを介して行われ、公共インターネットを迂回し、一般的なインターネット接続よりも信頼性が高く、速度が速く、遅延が少なく、セキュリティが高いです。

### **例**

* 多国籍企業は、**大量のデータと高いスループットを必要とするため、Azureサービスへの一貫性と信頼性のある接続が必要です**。同社はAzure ExpressRouteを選択し、オンプレミスのデータセンターをAzureに直接接続することで、日々のバックアップやリアルタイムデータ分析などの大規模データ転送を、プライバシーと速度を向上させながら容易に行います。

### **列挙**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
```markdown
{% endcode %}

<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をチェックしてください！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* **HackTricks**の[**GitHubリポジトリ**](https://github.com/carlospolop/hacktricks)や[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)にPRを提出して、あなたのハッキングテクニックを共有する。

</details>
```
