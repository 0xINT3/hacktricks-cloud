# Az - Azure Netwerk

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien jou **maatskappy geadverteer in HackTricks** of **laai HackTricks af in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** 💬 [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Basiese Inligting

Netwerke binne Azure funksioneer as 'n integrale deel van sy wolkrekenplatform, wat die **verbindings en kommunikasie tussen verskeie Azure dienste en hulpbronne** moontlik maak. Die netwerkargitektuur in Azure is ontwerp om hoogs skaalbaar, veilig en aanpasbaar te wees.

In die kern bied Azure 'n **virtuele netwerk (VNet)** wat gebruikers in staat stel om **geïsoleerde netwerke** binne die Azure-wolk te skep. Binne hierdie VNets kan hulpbronne soos virtuele masjiene, toepassings en databasisse veilig gehuisves en bestuur word. Die netwerking in Azure ondersteun beide die kommunikasie binne die wolk (tussen Azure dienste) en die koppeling na eksterne netwerke en die internet.

**Sekuriteit** is 'n kritieke aspek van Azure-netwerke, met verskeie gereedskap en dienste beskikbaar vir die beskerming van data, die bestuur van toegang en die versekering van nakoming. Hierdie sekuriteitsmaatreëls sluit **vuurmuure**, **netwerksekuriteitsgroepe**, en **versleuteling**-vermoëns in, wat 'n hoë vlak van beheer oor verkeer en toegang moontlik maak.

Oor die algemeen is die netwerkkapasiteite van Azure ontwerp om buigsaamheid te bied, sodat gebruikers 'n netwerkomgewing kan skep wat voldoen aan hul spesifieke toepassing- en werkladingbehoeftes terwyl daar 'n sterk klem gelê word op sekuriteit en betroubaarheid.

## Virtuele Netwerk (VNET) & Subnetwerke

'n VNet in Azure is in wese 'n voorstelling van jou eie netwerk in die wolk. Dit is 'n **logiese isolasie van die Azure-wolk toegewy aan jou inskrywing**. 'n VNet stel jou in staat om virtuele privaat netwerke (VPNs) in Azure te voorsien en te bestuur en kan gebruik word om verskeie tipes Azure-hulpbronne, soos Virtuele Masjiene (VM's), databasisse, en toepassingsdiens te huisves en te **bestuur**.

VNets bied jou **volle beheer oor jou netwerkinstellings**, insluitend **IP-adres**-reeks, subnet-skepping, roetetabelle, en netwerkgateways.

'n **Subnet** is 'n **reeks IP-adresse in jou VNet**. Jy kan 'n VNet in meerdere subnets verdeel vir organisasie en sekuriteit. Elke subnet in 'n VNet kan gebruik word om hulpbronne te isoleer en te groepeer volgens jou netwerk- en toepassingsargitektuur.

Verder laat subnets jou toe om jou VNet in een of meer sub-netwerke te **segmenteer**, wat 'n reeks IP-adresse bied wat hulpbronne kan gebruik.

### **Voorbeeld**

* Stel jy het 'n VNet genaamd `MyVNet` met 'n IP-adresreeks van `10.0.0.0/16`. Jy kan 'n subnet binne hierdie VNet skep, sê `Subnet-1`, met 'n IP-adresreeks van `10.0.0.0/24` vir die huisves van jou webbedieners. 'n Ander subnet, `Subnet-2` met 'n reeks van `10.0.1.0/24`, kan gebruik word vir jou databasisbedieners. Hierdie segmentering maak doeltreffende bestuur en sekuriteitsbeheer binne die netwerk moontlik.

### Enumerasie

Om al die VNets en subnets in 'n Azure-rekening te lys, kan jy die Azure-opdraglynkoppelvlak (CLI) gebruik. Hier is die stappe:

{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
## Netwerk Sekuriteitsgroepe (NSG)

In Azure dien 'n **Netwerk Sekuriteitsgroep (NSG)** die primêre funksie van die filter van netwerkverkeer na en vanaf Azure-bronne binne 'n Azure Virtuele Netwerk (VNet). Dit bevat 'n stel **sekuriteitsreëls** wat noukeurig die vloei van netwerkverkeer bepaal.

Belangrike aspekte van NSG sluit in:

- **Verkeersbeheer**: Elke NSG bevat reëls wat instrumenteel is om inkomende en uitgaande netwerkverkeer wat verband hou met verskeie Azure-bronne toe te laat of te belemmer.
- **Reëlkomponente**: Die reëls binne 'n NSG is baie spesifiek en filter verkeer op grond van kriteria soos bron-/bestemmings-IP-adres, poort, en protokol. Hierdie spesifisiteit maak dit moontlik om netwerkverkeer fynmazig te bestuur.
- **Sekuriteitsverbetering**: Deur te verseker dat slegs gemagtigde verkeer jou Azure-bronne kan betree of verlaat, speel NSG's 'n kritieke rol in die versterking van die sekuriteitspostuur van jou netwerkinfrastruktuur.

### **Voorbeeld**

- Stel jou het 'n NSG met die naam `MyNSG` wat toegepas word op 'n subnet of 'n spesifieke virtuele masjien binne jou VNet. Jy kan reëls soos die volgende skep:
- 'n Inkomende reël wat HTTP-verkeer (poort 80) van enige bron na jou webbediener toelaat.
- 'n Uitgaande reël wat slegs SQL-verkeer (poort 1433) na 'n spesifieke bestemmings-IP-adresreeks toelaat.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall is 'n bestuurde, wolk-gebaseerde **netwerksekuriteitsdiens wat jou Azure Virtuele Netwerkbronne beskerm**. Dit is 'n ten volle staatlike firewall as 'n diens met ingeboude hoë beskikbaarheid en skaalbaarheidskenmerke.

Azure Firewall bied **meer gevorderde** kenmerke as **NSGs**, insluitend **toepassingsvlakfiltering**, netwerkvlakfiltering, dreigingsintelligensie-gebaseerde filtering, en integrasie met Azure Monitor vir logging en analise.\
Dit kan uitgaande, inkomende, spreek-tot-spreek, VPN, en ExpressRoute-verkeer filter. **Firewall-reëls kan geskep word op grond van FQDN (Fully Qualified Domain Name), IP-adresse, en poorte**.

### Verskille tussen Azure Firewall en NSGs

1. **Omvang:**
* **NSG:** Werk op subnet- of netwerkinterfasevlak. Dit is bedoel om basiese filter van inkomende en uitgaande verkeer van netwerkinterfase (NIC), VM's, of subnets te voorsien.
* **Azure Firewall:** Werk op die VNet-vlak en bied 'n wyer omvang van beskerming. Dit is ontwerp om jou virtuele netwerkbronne te beveilig en die vloei van verkeer in en uit die VNet te bestuur.
2. **Vermoeëns:**
* **NSG:** Voorsien basiese filtervermoëns gebaseer op IP-adres, poort, en protokol. Dit ondersteun nie gevorderde kenmerke soos toepassingsvlak-inspeksie of dreigingsintelligensie nie.
* **Azure Firewall:** Bied gevorderde kenmerke soos toepassingsvlak (Laag 7) verkeersfiltering, dreigingsintelligensie-gebaseerde filtering, netwerkverkeersfiltering, en meer. Dit ondersteun ook verskeie openbare IP-adresse.
3. **Gebruiksfases:**
* **NSG:** Ideaal vir basiese netwerkvlakverkeersfiltering.
* **Azure Firewall:** Geskik vir meer komplekse filter scenarios waar toepassingsvlakbeheer, logging, en dreigingsintelligensie benodig word.
4. **Bestuur en Monitering:**
* **NSG:** Bied basiese logging en integrasie met Azure Monitor.
* **Azure Firewall:** Voorsien gevorderde logging en analitiese vermoëns deur Azure Monitor, wat noodsaaklik is vir die begrip van die aard en patroon van die verkeer.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
## Netwerk Virtuele Toestel (NVA)

'n Netwerk Virtuele Toestel (**NVA**) in Azure is 'n virtuele toestel wat **netwerkfunksies binne 'n virtuele netwerk uitvoer**. NVA's word tipies gebruik vir netwerkfunksies wat **nie outomaties beskikbaar** is in Azure nie of wanneer meer aanpassing benodig word. Hulle is essensieel **VM's wat netwerktoepassings of -dienste hardloop**, soos firewalls, WAN-optimaliseerders, of vragbalanserders.

NVA's word gebruik vir komplekse roetetaking, **sekuriteit**, en **netwerkverkeerbestuurstake**. Hulle kan vanaf die Azure **Markplek** ingespan word, waar baie derdeparty-verkopers hul toestelle gereed aanbied vir integrasie in Azure-omgewings.

### **Voorbeeld**

* 'n Organisasie kan 'n NVA in Azure inspan om 'n **aangepaste firewall-oplossing** te skep. Hierdie NVA kan 'n **derdeparty-firewall sagteware** hardloop, wat gevorderde kenmerke soos indringingsopsporing, pakketsinspeksie, of VPN-konnektiwiteit bied. Die NVA kan ingestel word om verkeer wat deur hom beweeg, te inspekteer en te filter, om te verseker dat verhoogde sekuriteitsmaatreëls volgens die organisasie se beleid in plek is.

### **Opsomming**
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
## Azure Roetetabelle & Gebruikersgedefinieerde Roetes (UDR)

**Azure Roetetabelle** is 'n kenmerk binne Microsoft Azure wat die **beheer van netwerkverkeersroetes binne Azure Virtuele Netwerke (VNets)** moontlik maak. Essensieelik definieer hulle hoe **pakkies** tussen subnets binne VNets, tussen VNets, of na eksterne netwerke **gestuur** word. Elke roetetabel bevat 'n stel reëls, bekend as roetes, wat spesifiseer hoe pakkies gestuur moet word gebaseer op hul bestemmings-IP-adresse.

**Gebruikersgedefinieerde Roetes (UDR)** in Azure is **aangepaste roetes wat jy binne Azure Roetetabelle skep** om die **vloei van netwerkverkeer** binne en tussen Azure Virtuele Netwerke (VNets), en na eksterne verbindinge te beheer. UDR's gee jou die buigsaamheid om netwerkverkeer te rig volgens jou spesifieke vereistes, waardeur Azure se verstekroetebesluite oorskryf word.

Hierdie roetes is veral nuttig vir scenario's waar jy verkeer deur 'n virtuele toestel moet **roeteer**, 'n spesifieke pad vir sekuriteits- of beleidsnakoming moet afdwing, of moet integreer met plaaslike netwerke.

### **Voorbeeld**

* Stel jy het 'n Netwerk Virtuele Toestel (NVA) geïmplementeer om verkeer tussen subnets binne 'n VNet te inspekteer. Jy kan 'n UDR skep wat al die verkeer van die een subnet na 'n ander subnet deur die NVA stuur. Hierdie UDR verseker dat die NVA die verkeer vir sekuriteitsdoeleindes inspekteer voordat dit sy bestemming bereik.

### **Opsomming**
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Private Link

Azure Private Link is 'n diens in Azure wat **privaat toegang tot Azure dienste moontlik maak** deur te verseker dat **verkeer tussen jou Azure virtuele netwerk (VNet) en die diens heeltemal binne Microsoft se Azure ruggraatnetwerk reis**. Dit bring die diens effektief in jou VNet. Hierdie opstelling verbeter sekuriteit deur die data nie aan die openbare internet bloot te stel nie.

Private Link kan gebruik word met verskeie Azure dienste, soos Azure Storage, Azure SQL Database, en aangepaste dienste wat gedeel word via Private Link. Dit bied 'n veilige manier om dienste te verbruik van binne jou eie VNet of selfs vanuit verskillende Azure intekeninge.

{% hint style="danger" %}
NSGs is nie van toepassing op private eindpunte nie, wat duidelik beteken dat die assosiasie van 'n NSG met 'n subnet wat die Private Link bevat, geen effek sal hê nie.
{% endhint %}

### **Voorbeeld**

* Oorweeg 'n scenario waar jy 'n **Azure SQL Database het wat jy veilig vanuit jou VNet wil benader**. Normaalweg mag dit die openbare internet betrek. Met Private Link kan jy 'n **privaat eindpunt in jou VNet skep** wat direk koppel aan die Azure SQL Database-diens. Hierdie eindpunt laat die databasis voorkom asof dit deel is van jou eie VNet, toeganklik via 'n privaat IP-adres, wat sodoende sekere en private toegang verseker.

### **Opsomming**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure Diens Eindpunte

Azure Diens Eindpunte brei jou virtuele netwerk se privaat adresruimte en die identiteit van jou VNet uit na Azure dienste oor 'n direkte verbinding. Deur diens eindpunte te aktiveer, **kan bronne in jou VNet veilig koppel aan Azure dienste**, soos Azure Stoor en Azure SQL-databasis, deur gebruik te maak van Azure se ruggraatnetwerk. Dit verseker dat die **verkeer van die VNet na die Azure-diens binne die Azure-netwerk bly**, wat 'n meer veilige en betroubare roete bied.

### **Voorbeeld**

* Byvoorbeeld, 'n **Azure Stoor**-rekening is standaard toeganklik oor die openbare internet. Deur 'n **diens eindpunt vir Azure Stoor binne jou VNet te aktiveer**, kan jy verseker dat slegs verkeer van jou VNet toegang tot die stoorrekening kan verkry. Die stoorrekening se vuurwal kan dan ingestel word om slegs verkeer van jou VNet te aanvaar.

### **Opsomming**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}

### Verskille Tussen Diens-eindpunte en Privaat Skakels

Microsoft beveel aan om Privaat Skakels te gebruik in die [**dokumentasie**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints):\\

<figure><img src="../../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Dienste-eindpunte:**

* Verkeer vanaf jou VNet na die Azure-diens reis oor die Microsoft Azure ruggraatnetwerk en vermy die openbare internet.
* Die eindpunt is 'n direkte verbinding met die Azure-diens en verskaf nie 'n privaat IP vir die diens binne die VNet nie.
* Die diens self is nog steeds toeganklik via sy openbare eindpunt van buite jou VNet tensy jy die diens se vuurwal konfigureer om sulke verkeer te blokkeer.
* Dit is 'n een-tot-een verhouding tussen die subnet en die Azure-diens.
* Goedkoper as Privaat Skakels.

**Privaat Skakels:**

* Privaat Skakels karteer Azure-diens na jou VNet via 'n privaat eindpunt, wat 'n netwerkinterface met 'n privaat IP-adres binne jou VNet is.
* Die Azure-diens word benader deur hierdie privaat IP-adres te gebruik, wat dit laat lyk asof dit deel is van jou netwerk.
* Dienste wat via Privaat Skakels gekoppel is, kan slegs vanaf jou VNet of gekoppelde netwerke benader word; daar is geen openbare internettoegang tot die diens nie.
* Dit maak 'n veilige verbinding met Azure-diens of jou eie dienste wat in Azure gehuisves word, asook 'n verbinding met dienste wat deur ander gedeel word, moontlik.
* Dit bied meer fynkorrelige toegangsbeheer via 'n privaat eindpunt in jou VNet, in teenstelling met breër toegangsbeheer op subnetvlak met dienste-eindpunte.

Kortom, terwyl beide Diens-eindpunte en Privaat Skakels veilige konnektiwiteit na Azure-diens verskaf, bied **Privaat Skakels 'n hoër vlak van isolasie en sekuriteit deur te verseker dat dienste privaat benader word sonder om hulle aan die openbare internet bloot te stel**. Diens-eindpunte daarenteen is makliker om op te stel vir algemene gevalle waar eenvoudige, veilige toegang tot Azure-diens benodig word sonder die behoefte aan 'n privaat IP in die VNet.

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door** is 'n skaalbare en veilige toegangspunt vir **vinnige aflewering** van jou globale webtoepassings. Dit **kombineer** verskeie dienste soos globale **ladingbalansering, webversnelling, SSL-ontlasting, en Webtoepassingsvuurwal (WAF)**-vermoëns in 'n enkele diens. Azure Front Door bied intelligente roetkaarting gebaseer op die **nabyste randlokasie tot die gebruiker**, wat optimale prestasie en betroubaarheid verseker. Daarbenewens bied dit URL-gebaseerde roetkaarting, meervoudige-webwerf-gasheer, sessie-affiniteit, en toepassingslaag-sekuriteit.

**Azure Front Door WAF** is ontwerp om webtoepassings teen webgebaseerde aanvalle te **beskerm sonder wysiging aan agterste-kode**. Dit sluit aanpasbare reëls en bestuurde reëlreeks in om te beskerm teen bedreigings soos SQL-inspuiting, kruisskripskrywing, en ander algemene aanvalle.

### **Voorbeeld**

* Stel jou het 'n wêreldwyd verspreide toepassing met gebruikers regoor die wêreld. Jy kan Azure Front Door gebruik om **gebruikersversoeke te roeteer na die naaste streekdata-sentrum** wat jou toepassing gasheer, wat sodoende latensie verminder, gebruikerervaring verbeter en **dit teen webaanvalle beskerm met die WAF-vermoëns**. As 'n spesifieke streek afbreek ervaar, kan Azure Front Door outomaties verkeer na die volgende beste lokasie herroeteer om hoë beskikbaarheid te verseker.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure-toepassingshek en Azure-toepassingshek WAF

Azure-toepassingshek is 'n **webverkeer-laaibalansierder** wat jou in staat stel om verkeer na jou **webtoepassings** te bestuur. Dit bied **Laag 7-laaibalansering, SSL-beëindiging, en webtoepassingsmuur (WAF) vermoëns** in die Toepassingsafleweringskontroleerder (ADC) as 'n diens. Sleutelkenmerke sluit URL-gebaseerde roetes, koekie-gebaseerde sessie-affiniteit, en veilige sokkellaag (SSL) afgelading in, wat noodsaaklik is vir toepassings wat komplekse laaibalanseringvermoëns soos globale roetes en pad-gebaseerde roetes benodig.

### Voorbeeld

* Oorweeg 'n scenario waar jy 'n e-handelswebwerf het wat verskeie subdomeine vir verskillende funksies insluit, soos gebruikersrekeninge en betalingsverwerking. Azure-toepassingshek kan **verkeer na die toepaslike webbedieners roeteer op grond van die URL-pad**. Byvoorbeeld, verkeer na `voorbeeld.com/rekeninge` kan na die gebruikersrekeningsdiens gerig word, en verkeer na `voorbeeld.com/betaal` kan na die betalingsverwerkingsdiens gerig word.\
En **beskerm jou webwerf teen aanvalle deur die WAF-vermoëns te gebruik.**

### **Opsomming**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering** is 'n netwerkfunksie in Azure wat **verskillende Virtuele Netwerke (VNets) toelaat om direk en vlot met mekaar verbind te word**. Deur VNet-peering kan bronne in een VNet kommunikeer met bronne in 'n ander VNet deur privaat IP-adresse te gebruik, **asof hulle in dieselfde netwerk was**.\
**VNet Peering kan ook gebruik word met 'n on-prem-netwerke** deur 'n site-to-site VPN of Azure ExpressRoute op te stel.

**Azure Hub en Spoke** is 'n netwerk-topologie wat in Azure gebruik word om netwerkverkeer te bestuur en te organiseer. **Die "hub" is 'n sentrale punt wat verkeer tussen verskillende "spokes" beheer en roeteer**. Die hub bevat tipies gedeelde dienste soos netwerk virtuele toestelle (NVAs), Azure VPN Gateway, Azure Firewall, of Azure Bastion. Die **"spokes" is VNets wat werklaste huisves en met die hub verbind deur VNet-peering te gebruik**, wat hulle in staat stel om die gedeelde dienste binne die hub te benut. Hierdie model bevorder 'n skoon netwerkontwerp, verminder kompleksiteit deur algemene dienste te sentraliseer wat verskeie werklaste regoor verskillende VNets kan gebruik.

{% hint style="danger" %}
**VNET-koppeling is nie-transitief in Azure nie**, wat beteken dat as spoke 1 met spoke 2 verbind is en spoke 2 met spoke 3 verbind is, kan spoke 1 nie direk met spoke 3 praat nie.
{% endhint %}

### Voorbeelde

* Stel jou 'n maatskappy voor met aparte departemente soos Verkope, HR, en Ontwikkeling, **elk met sy eie VNet (die spokes)**. Hierdie VNets **benodig toegang tot gedeelde bronne** soos 'n sentrale databasis, 'n firewall, en 'n internetgateway, wat almal geleë is in **'n ander VNet (die hub)**. Deur die gebruik van die Hub en Spoke-model kan elke departement **veilig verbind met die gedeelde bronne deur die hub VNet sonder om daardie bronne aan die openbare internet bloot te stel** of 'n komplekse netwerkstruktuur met talle verbindings te skep.

### Opsomming

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
## Plek-tot-Plek VPN

'n Plek-tot-Plek VPN in Azure maak dit moontlik om **jou plaaslike netwerk te koppel aan jou Azure Virtuele Netwerk (VNet)**, wat hulpbronne soos VM's binne Azure laat voorkom asof hulle op jou plaaslike netwerk is. Hierdie verbinding word tot stand gebring deur 'n **VPN-hek wat verkeer tussen die twee netwerke versleutel**.

### **Voorbeeld**

* 'n Besigheid met sy hoofkantoor in New York het 'n plaaslike data-sentrum wat veilig moet koppel aan sy VNet in Azure, wat sy gevirtualiseerde werklade huisves. Deur 'n **Plek-tot-Plek VPN op te stel, kan die maatskappy verseker dat daar versleutelde konnektiwiteit is tussen die plaaslike bedieners en die Azure VM's**, wat hulpbronne toelaat om veilig oor beide omgewings toeganklik te wees asof hulle in dieselfde plaaslike netwerk was.

### **Opsomming**
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRoute is 'n diens wat 'n **privaat, toegewyde, hoëspoedverbinding tussen jou plaaslike infrastruktuur en Azure data sentrums** bied. Hierdie verbinding word deur 'n konnektiwiteitsverskaffer gemaak, wat die openbare internet omseil en meer betroubaarheid, vinniger spoed, laer latensie en hoër sekuriteit as tipiese internetverbindinge bied.

### **Voorbeeld**

* 'n Multinasionale maatskappy benodig 'n **konstante en betroubare verbinding met sy Azure dienste as gevolg van die hoë volume data** en die behoefte aan hoë deurbraak. Die maatskappy kies vir Azure ExpressRoute om sy plaaslike data sentrum direk met Azure te verbind, wat groot-skaalse data-oordragte fasiliteer, soos daaglikse rugsteun en werklike data-analise, met verbeterde privaatheid en spoed.

### **Opsomming**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS-familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** 💬 [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag. 

</details>
