# Az - Azure Mreža

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne Informacije

Mreže unutar Azure funkcionišu kao integralni deo njegove cloud računarske platforme, omogućavajući **povezivanje i komunikaciju između različitih Azure servisa i resursa**. Arhitektura mreže u Azure-u je dizajnirana da bude visoko skalabilna, sigurna i prilagodljiva.

U suštini, Azure pruža **virtuelnu mrežu (VNet)** koja korisnicima omogućava kreiranje **izolovanih** **mreža** unutar Azure oblaka. U okviru ovih VNet-ova, resursi poput virtuelnih mašina, aplikacija i baza podataka mogu biti sigurno smešteni i upravljani. Mrežno povezivanje u Azure-u podržava kako komunikaciju unutar oblaka (između Azure servisa), tako i povezivanje sa spoljnim mrežama i internetom.

**Bezbednost** je ključni aspekt Azure mrežiranja, sa različitim alatima i servisima dostupnim za zaštitu podataka, upravljanje pristupom i osiguravanje usaglašenosti. Ove bezbednosne mere uključuju **firewallove**, **grupe za bezbednost mreže** i mogućnosti **šifrovanja**, omogućavajući visok nivo kontrole nad saobraćajem i pristupom.

Sveukupno, mogućnosti mrežiranja u Azure-u su dizajnirane da pruže fleksibilnost, omogućavajući korisnicima da kreiraju mrežno okruženje koje odgovara specifičnim potrebama aplikacije i opterećenja, uz snažan naglasak na sigurnost i pouzdanost.

## Virtuelna Mreža (VNET) & Podmreže

VNet u Azure-u je suštinski predstava vaše sopstvene mreže u oblaku. To je **logička izolacija Azure oblaka posvećena vašoj pretplati**. VNet vam omogućava da obezbedite i upravljate virtuelnim privatnim mrežama (VPN-ovima) u Azure-u i može se koristiti za smeštanje i **upravljanje različitim vrstama Azure resursa**, poput virtuelnih mašina (VM-ova), baza podataka i aplikacionih servisa.

VNet-ovi vam pružaju **potpunu kontrolu nad postavkama vaše mreže**, uključujući **opsege IP adresa**, kreiranje podmreža, tabele ruta i mrežne gateway-e.

**Podmreža** je **opseg IP adresa u vašem VNet-u**. Možete podeliti VNet u više podmreža radi organizacije i bezbednosti. Svaka podmreža u VNet-u može se koristiti za izolaciju i grupisanje resursa prema vašoj mrežnoj i aplikacionoj arhitekturi.

Osim toga, podmreže vam omogućavaju da **segmentirate svoj VNet u jednu ili više pod-mreža**, pružajući opseg IP adresa koje resursi mogu koristiti.

### **Primer**

* Recimo da imate VNet nazvan `MyVNet` sa opsegom IP adresa `10.0.0.0/16`. Možete kreirati podmrežu unutar ovog VNet-a, recimo `Podmreža-1`, sa opsegom IP adresa `10.0.0.0/24` za smeštanje vaših web servera. Druga podmreža, `Podmreža-2` sa opsegom `10.0.1.0/24`, može se koristiti za vaše serverske baze podataka. Ova segmentacija omogućava efikasno upravljanje i kontrolu bezbednosti unutar mreže.

### Enumeracija

Da biste naveli sve VNet-ove i podmreže u Azure nalogu, možete koristiti Azure Command-Line Interface (CLI). Evo koraka:

{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
## Grupi bezbednosti mreže (NSG)

U Azuru, **Grupa bezbednosti mreže (NSG)** služi osnovnoj funkciji filtriranja mrežnog saobraćaja kako ka tako i od resursa u okviru Virtuelne mreže (VNet) u Azuru. Ona sadrži skup **pravila bezbednosti** koja detaljno određuju tok mrežnog saobraćaja.

Ključni aspekti NSG uključuju:

- **Kontrola saobraćaja**: Svaka NSG sadrži pravila koja su od suštinskog značaja za dozvoljavanje ili blokiranje dolaznog i odlaznog mrežnog saobraćaja povezanog sa različitim Azure resursima.
- **Komponente pravila**: Pravila unutar NSG su veoma specifična, filtrirajući saobraćaj na osnovu kriterijuma kao što su izvorna/odredišna IP adresa, port i protokol. Ova specifičnost omogućava granularno upravljanje mrežnim saobraćajem.
- **Poboljšanje bezbednosti**: Osiguravajući da samo ovlašćeni saobraćaj može da ulazi ili izlazi iz vaših Azure resursa, NSG igra ključnu ulogu u jačanju bezbednosnog položaja vaše mrežne infrastrukture.

### **Primer**

- Zamislite da imate NSG nazvanu `MojaNSG` primenjenu na podmrežu ili određenu virtuelnu mašinu unutar vaše VNet. Možete kreirati pravila kao što su:
- Dolazno pravilo koje dozvoljava HTTP saobraćaj (port 80) sa bilo koje izvorne lokacije ka vašim veb serverima.
- Odlazno pravilo koje dozvoljava samo SQL saobraćaj (port 1433) ka određenom opsegu odredišnih IP adresa.

### Nabrojavanje

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall je upravljana, cloud-based **usluga za mrežnu sigurnost koja štiti vaše Azure Virtual Network resurse**. To je potpuno stanje firewall kao usluga sa ugrađenim mogućnostima visoke dostupnosti i skalabilnosti.

Azure Firewall pruža **naprednije** funkcije od **NSG-ova**, uključujući **filtriranje na nivou aplikacije**, filtriranje na nivou mreže, filtriranje zasnovano na obaveštajima o pretnjama i integraciju sa Azure Monitor-om za beleženje i analitiku.\
Može filtrirati odlazni, dolazni, komunikaciju između špiceva, VPN i ExpressRoute saobraćaj. **Pravila firewall-a mogu biti kreirana na osnovu FQDN (Potpuno kvalifikovano ime domena), IP adresa i portova**.

### Razlike između Azure Firewall-a i NSG-ova

1. **Opseg:**
* **NSG:** Radi na nivou podmreže ili mrežnog interfejsa. Namijenjen je pružanju osnovnog filtriranja dolaznog i odlaznog saobraćaja sa mrežnih interfejsa (NIC), VM-ova ili podmreža.
* **Azure Firewall:** Deluje na nivou VNet-a, pružajući širi opseg zaštite. Dizajniran je da obezbedi vaše virtualne mrežne resurse i upravlja saobraćajem koji ulazi i izlazi iz VNet-a.
2. **Mogućnosti:**
* **NSG:** Pruža osnovne mogućnosti filtriranja zasnovane na IP adresi, portu i protokolu. Ne podržava napredne funkcije poput inspekcije na nivou aplikacije ili obaveštajima o pretnjama.
* **Azure Firewall:** Nudi napredne funkcije poput filtriranja saobraćaja na nivou aplikacije (Sloj 7), filtriranja zasnovanog na obaveštajima o pretnjama, filtriranja mrežnog saobraćaja i još mnogo toga. Takođe podržava više javnih IP adresa.
3. **Upotrebe:**
* **NSG:** Idealno za osnovno filtriranje saobraćaja na nivou mreže.
* **Azure Firewall:** Pogodan za složenije scenarije filtriranja gde su potrebna kontrola na nivou aplikacije, beleženje i obaveštaji o pretnjama.
4. **Upravljanje i Praćenje:**
* **NSG:** Nudi osnovno beleženje i integraciju sa Azure Monitor-om.
* **Azure Firewall:** Pruža napredne mogućnosti beleženja i analitike putem Azure Monitor-a, što je ključno za razumevanje prirode i obrasca saobraćaja.

### Enumeracija

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## Mrežni virtuelni uređaj (NVA)

Mrežni virtuelni uređaj (**NVA**) u Azuru je virtuelni uređaj koji **vrši mrežne funkcije unutar virtuelne mreže**. NVA se obično koriste za mrežne funkcije koje **nisu dostupne nativno** u Azuru ili kada je potrebna veća prilagodljivost. Oni su suštinski **VM-ovi koji pokreću mrežne aplikacije ili usluge**, poput firewall-a, WAN optimizatora ili load balansera.

NVA se koriste za složeno rutiranje, **bezbednost** i **upravljanje mrežnim saobraćajem**. Mogu se implementirati sa Azure **Marketplace**-a, gde mnogi treći proizvođači nude svoje uređaje spremne za integraciju u Azure okruženja.

### **Primer**

* Organizacija može implementirati NVA u Azuru kako bi kreirala **prilagođeno rešenje firewall-a**. Ovaj NVA bi mogao pokretati **softver firewall-a trećeg proizvođača**, pružajući napredne funkcije poput detekcije upada, inspekcije paketa ili VPN konektivnosti. NVA se može konfigurisati da inspicira i filtrira saobraćaj koji prolazi kroz njega, obezbeđujući unapređene bezbednosne mere u skladu sa politikama organizacije.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
## Azure Tabele ruta i korisnički definisane rute (UDR)

**Azure Tabele ruta** su funkcija unutar Microsoft Azure platforme koja omogućava **kontrolu rutiranja mrežnog saobraćaja unutar Azure virtuelnih mreža (VNets)**. U osnovi, one definišu kako se **paketi** **prosleđuju** između podmreža unutar VNets-a, između VNets-a ili ka spoljnim mrežama. Svaka tabela ruta sadrži skup pravila, poznatih kao rute, koje specificiraju kako bi paketi trebalo da budu rutirani na osnovu njihovih odredišnih IP adresa.

**Korisnički definisane rute (UDR)** u Azure-u su **prilagođene rute koje kreirate unutar Azure Tabela ruta** kako biste kontrolisali **tok mrežnog saobraćaja** unutar i između Azure virtuelnih mreža (VNets), kao i ka spoljnim konekcijama. UDR-ovi vam pružaju fleksibilnost da usmeravate mrežni saobraćaj prema vašim specifičnim zahtevima, premošćujući Azure-ove podrazumevane odluke o rutiranju.

Ove rute su posebno korisne u scenarijima gde je potrebno **rutirati saobraćaj kroz virtuelni uređaj**, primeniti specifičan put za bezbednost ili usklađenost sa pravilima, ili integrisati se sa lokalnim mrežama.

### **Primer**

* Recimo da ste implementirali Mrežni Virtuelni Aparat (NVA) za inspekciju saobraćaja između podmreža unutar VNet-a. Možete kreirati UDR koji usmerava sav saobraćaj iz jedne podmreže ka drugoj podmreži da prolazi kroz NVA. Ovaj UDR osigurava da NVA inspektuje saobraćaj iz bezbednosnih razloga pre nego što stigne do odredišta.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Privatna veza

Azure Privatna veza je usluga u okviru Azure platforme koja omogućava **privatan pristup Azure uslugama** tako što se **saobraćaj između vaše Azure virtuelne mreže (VNet) i usluge odvija isključivo unutar Microsoftove Azure osnovne mreže**. Na taj način se usluga efikasno integriše u vašu VNet. Ova postavka poboljšava bezbednost tako što ne izlaže podatke javnom internetu.

Privatna veza može biti korišćena sa različitim Azure uslugama, poput Azure Storage, Azure SQL Database, i prilagođenih usluga deljenih putem Privatne veze. Pruža siguran način za korišćenje usluga unutar vaše VNet ili čak iz različitih Azure pretplata.

{% hint style="danger" %}
NSG-ovi se ne primenjuju na privatne krajnje tačke, što jasno znači da povezivanje NSG-a sa podmrežom koja sadrži Privatnu vezu neće imati efekta.
{% endhint %}

### **Primer**

* Razmotrite scenarijo gde imate **Azure SQL bazu podataka koju želite bezbedno pristupiti iz vaše VNet**. Obično, ovo bi uključivalo prolazak kroz javni internet. Sa Privatnom vezom, možete kreirati **privatnu krajnju tačku u vašoj VNet** koja se direktno povezuje sa Azure SQL bazom podataka. Ova krajnja tačka čini da baza podataka izgleda kao da je deo vaše VNet, dostupna putem privatne IP adrese, čime se obezbeđuje siguran i privatni pristup.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
## Azure servisne tačke

Azure servisne tačke proširuju privatni adresni prostor virtuelne mreže i identitet vaše VNet na Azure servise preko direktnog povezivanja. Omogućavanjem servisnih tačaka, resursi u vašoj VNet mogu sigurno da se povežu sa Azure servisima, poput Azure Storage i Azure SQL baze podataka, koristeći Azure-ovu osnovnu mrežu. Ovo osigurava da saobraćaj iz VNet-a ka Azure servisu ostane unutar Azure mreže, pružajući sigurniju i pouzdaniju putanju.

### **Primer**

* Na primer, Azure Storage nalog je podrazumevano dostupan preko javnog interneta. Omogućavanjem servisne tačke za Azure Storage unutar vaše VNet, možete osigurati da samo saobraćaj iz vaše VNet može pristupiti nalogu za skladištenje. Zatim se firewall naloga za skladištenje može konfigurisati da prihvati saobraćaj samo iz vaše VNet. 

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
### Razlike između Servisnih Tačaka i Privatnih Linkova

Microsoft preporučuje korišćenje Privatnih Linkova u [**dokumentaciji**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints):\\

<figure><img src="../../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Servisne Tačke:**

* Saobraćaj iz vaše VNet ka Azure servisu putuje preko Microsoft Azure mreže, zaobilazeći javni internet.
* Tačka je direktna veza sa Azure servisom i ne pruža privatnu IP adresu za servis unutar VNet-a.
* Sam servis je i dalje dostupan putem svog javnog endpointa izvan vašeg VNet-a osim ako konfigurišete firewall servisa da blokira takav saobraćaj.
* Postoji jedan-na-jedan odnos između podmreže i Azure servisa.
* Jeftinije su od Privatnih Linkova.

**Privatni Linkovi:**

* Privatni Link mapira Azure servise u vaš VNet putem privatne tačke, koja je mrežni interfejs sa privatnom IP adresom unutar vašeg VNet-a.
* Azure servis se pristupa korišćenjem ove privatne IP adrese, čineći da izgleda kao da je deo vaše mreže.
* Servisi povezani putem Privatnih Linkova mogu se pristupiti samo iz vašeg VNet-a ili povezanih mreža; nema pristupa javnom internetu servisu.
* Omogućava sigurnu vezu sa Azure servisima ili vašim sopstvenim servisima smeštenim u Azure-u, kao i vezu sa servisima koje dele drugi.
* Pruža detaljniju kontrolu pristupa putem privatne tačke u vašem VNet-u, za razliku od šire kontrole pristupa na nivou podmreže sa servisnim tačkama.

U suštini, dok i Servisne Tačke i Privatni Linkovi pružaju sigurnu povezanost sa Azure servisima, **Privatni Linkovi nude viši nivo izolacije i sigurnosti osiguravajući da se servisi pristupaju privatno bez izlaganja javnom internetu**. Servisne Tačke, s druge strane, lakše se postavljaju za opšte slučajeve gde je potrebno jednostavno, sigurno pristupanje Azure servisima bez potrebe za privatnom IP adresom u VNet-u.

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door** je skalabilna i sigurna ulazna tačka za **brzu isporuku** vaših globalnih web aplikacija. **Kombinuje** različite usluge poput globalnog **balansiranja opterećenja, ubrzanja sajta, SSL dekripcije, i mogućnosti Web Application Firewall (WAF)** u jednu uslugu. Azure Front Door pruža inteligentno rutiranje zasnovano na **najbližoj lokaciji ivice korisniku**, osiguravajući optimalne performanse i pouzdanost. Dodatno, nudi rutiranje zasnovano na URL-u, hosting više sajtova, afinitet sesije, i sigurnost na nivou aplikacije.

**Azure Front Door WAF** je dizajniran da **štiti web aplikacije od napada putem web-a** bez modifikacije koda na serverskoj strani. Uključuje prilagođena pravila i upravljane skupove pravila za zaštitu od pretnji poput SQL injection-a, cross-site scripting-a i drugih čestih napada.

### **Primer**

* Zamislite da imate globalno distribuiranu aplikaciju sa korisnicima širom sveta. Možete koristiti Azure Front Door da **rutirate zahteve korisnika do najbližeg regionalnog data centra** koji hostuje vašu aplikaciju, smanjujući latenciju, poboljšavajući korisničko iskustvo i **braneći je od web napada uz WAF mogućnosti**. Ako određena regija doživi prekid rada, Azure Front Door automatski može preusmeriti saobraćaj ka sledećoj najboljoj lokaciji, osiguravajući visoku dostupnost.

### Nabrojavanje

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure aplikaciona kapija i Azure aplikaciona kapija WAF

Azure aplikaciona kapija je **balanser opterećenja veb saobraćaja** koji vam omogućava da upravljate saobraćajem ka vašim **veb** aplikacijama. Nudi **balansiranje opterećenja na nivou sloja 7, SSL prekidanje i sposobnosti veb aplikacionog zida (WAF)** u kontroloru isporuke aplikacija (ADC) kao uslugu. Ključne funkcije uključuju rutiranje na osnovu URL-a, afinitet sesije na osnovu kolačića i prebacivanje sloja sigurnosnog sloja (SSL), što je ključno za aplikacije koje zahtevaju kompleksne mogućnosti balansiranja opterećenja poput globalnog rutiranja i rutiranja na osnovu putanje.

### Primer

* Razmotrite scenarij u kojem imate veb sajt za elektronsku trgovinu koji uključuje više poddomena za različite funkcije, poput korisničkih naloga i obrade plaćanja. Azure aplikaciona kapija može **rutirati saobraćaj ka odgovarajućim veb serverima na osnovu URL putanje**. Na primer, saobraćaj ka `primer.com/nalozi` može biti usmeren ka servisu za korisničke naloge, a saobraćaj ka `primer.com/plati` može biti usmeren ka servisu za obradu plaćanja.\
I **zaštititi vaš veb sajt od napada koristeći sposobnosti WAF-a.**

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering** je funkcija umrežavanja u Azure-u koja **omogućava direktno i besprekidno povezivanje različitih virtuelnih mreža (VNets)**. Kroz VNet peering, resursi u jednoj VNet mogu komunicirati sa resursima u drugoj VNet korišćenjem privatnih IP adresa, **kao da su u istoj mreži**.\
**VNet Peering se takođe može koristiti sa on-prem mrežama** postavljanjem site-to-site VPN-a ili Azure ExpressRoute-a.

**Azure Hub i Spoke** je topologija mreže koja se koristi u Azure-u za upravljanje i organizovanje saobraćaja u mreži. **"Hub" je centralna tačka koja kontroliše i usmerava saobraćaj između različitih "spoke-ova"**. Hub obično sadrži deljene usluge poput virtuelnih mrežnih uređaja (NVAs), Azure VPN Gateway-a, Azure Firewall-a ili Azure Bastion-a. **"Spoke-ovi" su VNets koji hostuju radne opterećenja i povezuju se sa hub-om korišćenjem VNet peering-a**, omogućavajući im da iskoriste deljene usluge unutar hub-a. Ovaj model promoviše čist raspored mreže, smanjujući kompleksnost centralizovanjem zajedničkih usluga koje mogu koristiti višestruka radna opterećenja širom različitih VNets.

{% hint style="danger" %}
**VNET uparivanje nije tranzitivno u Azure-u**, što znači da ako je spoke 1 povezan sa spoke 2 i spoke 2 je povezan sa spoke 3, tada spoke 1 ne može direktno komunicirati sa spoke 3.
{% endhint %}

### Primeri

* Zamislite kompaniju sa odvojenim odeljenjima poput Prodaje, HR-a i Razvoja, **svako sa svojim VNet-om (spoke-ovima)**. Ovi VNets **zahtevaju pristup deljenim resursima** poput centralne baze podataka, firewall-a i internet gateway-a, koji se nalaze u **drugom VNet-u (hub-u)**. Korišćenjem Hub i Spoke modela, svako odeljenje može **sigurno povezati se sa deljenim resursima kroz hub VNet bez izlaganja tih resursa javnom internetu** ili kreiranja kompleksne mrežne strukture sa brojnim povezivanjima.

### Enumeracija

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## Site-to-Site VPN

Site-to-Site VPN u Azure-u vam omogućava da **povežete svoju lokalnu mrežu sa vašom Azure virtuelnom mrežom (VNet)**, omogućavajući resursima poput VM-ova unutar Azure-a da izgledaju kao da su na vašoj lokalnoj mreži. Ova veza se uspostavlja putem **VPN gateway-a koji enkriptuje saobraćaj** između ove dve mreže.

### **Primer**

* Poslovni subjekat sa glavnim sedištem u Njujorku ima lokalni data centar koji treba bezbedno da se poveže sa svojom VNet-om u Azure-u, gde se nalaze njegovi virtualizovani radni tereti. Postavljanjem **Site-to-Site VPN-a, kompanija može obezbediti enkriptovanu konekciju između on-premises servera i Azure VM-ova**, omogućavajući resursima da se bezbedno pristupaju u oba okruženja kao da su u istoj lokalnoj mreži.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRoute je usluga koja pruža **privatnu, posvećenu, visokobrzinsku vezu između vaše infrastrukture na lokaciji i Azure data centara**. Ova veza se uspostavlja preko pružaoca konektivnosti, zaobilazeći javni internet i pružajući veću pouzdanost, brže brzine, niže latencije i veću sigurnost od tipičnih internet veza.

### **Primer**

* Multinacionalna korporacija zahteva **konstantnu i pouzdanu vezu sa svojim Azure uslugama zbog velike količine podataka** i potrebe za visokim protokom. Kompanija se odlučuje za Azure ExpressRoute kako bi direktno povezala svoj data centar na lokaciji sa Azure-om, olakšavajući prenos podataka velikih razmera, kao što su dnevne rezervne kopije i analitika podataka u realnom vremenu, sa unapređenom privatnošću i brzinom.

### **Enumeracija**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJSTVO**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
