# Az - Azure App Service & Function Apps

<details>

<summary><strong>Soutenez HackTricks et obtenez des avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Informations de base sur Azure App Service

_Azure App Service_ est un service bas√© sur HTTP pour l'h√©bergement d'applications web, d'API REST et de back-ends mobiles. Vous pouvez d√©velopper dans votre langage pr√©f√©r√©, que ce soit .NET, .NET Core, Java, Ruby, Node.js, PHP ou Python. Les applications s'ex√©cutent et se mettent √† l'√©chelle facilement sur des environnements bas√©s sur Windows et Linux.

Chaque application s'ex√©cute dans un bac √† sable, mais l'isolation d√©pend des plans de service d'application :

* Les applications dans les niveaux Free et Shared s'ex√©cutent sur des VM partag√©es.
* Les applications dans les niveaux Standard et Premium s'ex√©cutent sur des VM d√©di√©es.

{% hint style="warning" %}
Notez que **aucune** de ces isolations ne **pr√©vient** les autres **vuln√©rabilit√©s web** courantes (comme le t√©l√©chargement de fichiers ou les injections). Et si une **identit√© de gestion** est utilis√©e, elle pourrait √™tre en mesure de **compromettre ses autorisations**.
{% endhint %}

### √ânum√©ration

{% tabs %}
{% tab title="az" %}
{% code overflow="wrap" %}
```bash
# Liste des webapps
az webapp list

## Moins d'informations
az webapp list --query "[].{hostName: defaultHostName, state: state, name: name, resourcegroup: resourceGroup}"

# Obtenir les restrictions d'acc√®s
az webapp config access-restriction show --resource-group <res-group> -n <name>

# Supprimer les restrictions d'acc√®s
az webapp config access-restriction remove --resource-group <res-group> -n <name> --rule-name <rule-name>

# Obtenir des instantan√©s
az webapp config snapshot list --resource-group <res-group> -n <name>

# Restaurer un instantan√©
az webapp config snapshot restore -g <res-group> -n <name> --time 2018-12-11T23:34:16.8388367

# Red√©marrer l'application web
az webapp restart --name <name> --resource-group <res-group>
```
{% endcode %}
{% endtab %}

{% tab title="Az Powershell" %}
```powershell
# Obtenir les App Services et les Function Apps
Get-AzWebApp
# Obtenir uniquement les App Services
Get-AzWebApp | ?{$_.Kind -notmatch "functionapp"}
```
{% endtab %}
{% endtabs %}

#### Obtenir des informations d'identification et acc√©der au code de l'application web

```bash
# Obtenir les cha√Ænes de connexion qui pourraient contenir des informations d'identification (avec des bases de donn√©es, par exemple)
az webapp config connection-string list --name <name> --resource-group <res-group>
## V√©rifiez comment utiliser les cha√Ænes de connexion de la base de donn√©es dans la page SQL

# Obtenir les informations d'identification pour acc√©der au code et aux informations d'identification de la base de donn√©es si elles sont configur√©es.
az webapp deployment list-publishing-profiles --resource-group <res-group> -n <name>


# Obtenir l'URL git pour acc√©der au code
az webapp deployment source config-local-git --resource-group <res-group> -n <name>

# Acc√©der/Modifier le code via git
git clone 'https://<username>:<password>@name.scm.azurewebsites.net/repo-name.git'
## Dans mon cas, le nom d'utilisateur √©tait : $nameofthewebapp et le mot de passe √©tait constitu√© de caract√®res al√©atoires
## Si vous modifiez le code et effectuez un push, l'application est automatiquement red√©ploy√©e
```

#### Acc√©der au conteneur Docker avec l'application web via ssh :

```bash
# Obtenir une session ssh
az webapp create-remote-connection --subscription <SUBSCRIPTION-ID> --resource-group <RG-NAME> -n <APP-SERVICE-NAME>

## Si r√©ussi, vous obtiendrez un message tel que :
#V√©rification si l'application est en cours d'ex√©cution....
#L'application est en cours d'ex√©cution. Tentative d'√©tablissement d'une connexion de tunnel...
#Ouverture du tunnel sur le port : 39895
#SSH est disponible { username: root, password: Docker! }

## Donc, √† partir de cette machine, ssh dans ce port (vous devrez peut-√™tre g√©n√©rer une nouvelle session ssh vers l'h√¥te de saut)
ssh root@127.0.0.1 -p 39895

```

## Informations de base sur les Function Apps

Azure Functions est une solution **sans serveur** qui vous permet d'√©crire moins de code, de maintenir moins d'infrastructure et d'√©conomiser sur les co√ªts. Au lieu de vous soucier du d√©ploiement et de la maintenance des serveurs, l'infrastructure cloud fournit toutes les ressources √† jour n√©cessaires pour faire fonctionner vos applications.

**Les Function Apps prennent en charge les identit√©s g√©r√©es.**

### √ânum√©ration

```powershell
# Obtenir uniquement les Function Apps
Get-AzFunctionApp
```

## R√©f√©rences

* [https://learn.microsoft.com/en-in/azure/app-service/overview](https://learn.microsoft.com/en-in/azure/app-service/overview)
* [https://app.gitbook.com/s/5uvPQhxNCPYYTqpRwsuS/\~/changes/en8rTJy7DsFQXWyNeiqE/pentesting-cloud/azure-security/az-services/az-function-apps#references](https://app.gitbook.com/s/5uvPQhxNCPYYTqpRwsuS/\~/changes/en8rTJy7DsFQXWyNeiqE/pentesting-cloud/azure-security/az-services/az-function-apps#references)

<details>

<summary><strong>Soutenez HackTricks et obtenez des avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>