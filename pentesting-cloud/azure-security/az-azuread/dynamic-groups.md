# Az - рдбрд╛рдпрдирд╛рдорд┐рдХ рд╕рдореВрд╣ рдкреНрд░рд╛рдЗрд╡реЗрд╕реНрдХ

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> рдХреЗ рд╕рд╛рде рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live) **рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

**рдбрд╛рдпрдирд╛рдорд┐рдХ рд╕рдореВрд╣** рдРрд╕реЗ рд╕рдореВрд╣ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдПрдХ рд╕реЗрдЯ рдХреЗ **рдирд┐рдпрдо** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╕рднреА **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рдЙрдкрдХрд░рдг** рдЬреЛ рдирд┐рдпрдореЛрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВ, рд╕рдореВрд╣ рдореЗрдВ рдЬреЛрдбрд╝ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рд╣рд░ рдмрд╛рд░ рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рдЙрдкрдХрд░рдг **рд╡рд┐рд╢реЗрд╖рддрд╛** рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ рдбрд╛рдпрдирд╛рдорд┐рдХ рдирд┐рдпрдореЛрдВ рдХреЛ **рдкреБрдирдГ рдЬрд╛рдВрдЪрд╛** рдЬрд╛рддрд╛ рд╣реИред рдФрд░ рдЬрдм рдПрдХ **рдирдпрд╛ рдирд┐рдпрдо** **рдмрдирд╛рдпрд╛** рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рднреА рдЙрдкрдХрд░рдг рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдЬрд╛рдВрдЪреЗ** рдЬрд╛рддреЗ рд╣реИрдВред

рдбрд╛рдпрдирд╛рдорд┐рдХ рд╕рдореВрд╣реЛрдВ рдХреЛ **Azure RBAC рднреВрдорд┐рдХрд╛рдПрдБ рд╕реМрдВрдкреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**, рд▓реЗрдХрд┐рди рдбрд╛рдпрдирд╛рдорд┐рдХ рд╕рдореВрд╣реЛрдВ рдореЗрдВ **AzureAD рднреВрдорд┐рдХрд╛рдПрдБ** рдЬреЛрдбрд╝рдирд╛ **рд╕рдВрднрд╛рд╡рдирд╛** рдирд╣реАрдВ рд╣реИред

рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП Azure AD рдкреНрд░реАрдорд┐рдпрдо P1 рд▓рд╛рдЗрд╕реЗрдВрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

## рдкреНрд░рд╛рдЗрд╡реЗрд╕реНрдХ

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ Azure AD рдореЗрдВ рдореЗрд╣рдорд╛рди рдЖрдордВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рдбрд╛рдпрдирд╛рдорд┐рдХ рд╕рдореВрд╣ **рдирд┐рдпрдо** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рджреЗрддрд╛ рд╣реИ рдЬреЛ **рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ** рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВ рдЬреЛ рдПрдХ **рдирдпрд╛ рдореЗрд╣рдорд╛рди** рдореЗрдВ **рд╕реЗрдЯ** рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рддреЛ рдЗрд╕ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рд╡рд╛рд▓реЗ рдПрдХ рдореЗрд╣рдорд╛рди рдХреЛ рдмрдирд╛рдирд╛ рдФрд░ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ** рдХреЛ **рдЙрдиреНрдирдд рдХрд░рдирд╛** рд╕рдВрднрд╡ рд╣реИред рдПрдХ рдореЗрд╣рдорд╛рди рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдирд╛ рдФрд░ рдЗрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдмрджрд▓рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред

рдбрд╛рдпрдирд╛рдорд┐рдХ рд╕рджрд╕реНрдпрддрд╛ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╕рдореВрд╣ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ: `Get-AzureADMSGroup | ?{$_.GroupTypes -eq 'DynamicMembership'}`

### рдЙрджрд╛рд╣рд░рдг

* **рдирд┐рдпрдо рдЙрджрд╛рд╣рд░рдг**: `(user.otherMails -any (_ -contains "tester")) -and (user.userType -eq "guest")`
* **рдирд┐рдпрдо рд╡рд┐рд╡рд░рдг**: 'tester' рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╡рд╛рд▓реЗ рдПрдХ рд╕реЗрдХреЗрдВрдбрд░реА рдИрдореЗрд▓ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рдореЗрд╣рдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕рдореВрд╣ рдореЗрдВ рдЬреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

1. **Azure Active Directory** рдкрд░ рдЬрд╛рдПрдВ -> **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдФрд░ **рдХреНрд▓рд┐рдХ** рдХрд░реЗрдВ `Want to switch back to the legacy users list experience? Click here to leave the preview`
2. **`New guest user`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдПрдХ рдИрдореЗрд▓ **рдЖрдордВрддреНрд░рд┐рдд** рдХрд░реЗрдВ
3. рдЖрдордВрддреНрд░рдг рднреЗрдЬрдиреЗ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЛ Azure AD рдореЗрдВ **рдЬреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓реЗрдВ рдФрд░ **Invitation accepted** рдХреЗ рддрд╣рдд **(manage) рдкрд░ рдХреНрд▓рд┐рдХ** рдХрд░реЗрдВред
* ![](<../../../.gitbook/assets/image (87) (1).png>)
4. **`Resend invite?`** рдХреЛ **Yes** рдкрд░ рдмрджрд▓реЗрдВ рдФрд░ рдЖрдкрдХреЛ рдПрдХ рдЖрдордВрддреНрд░рдг URL рдорд┐рд▓реЗрдЧрд╛:
* ![](<../../../.gitbook/assets/image (11) (1) (2) (1).png>)
5. **URL** рдХреЙрдкреА рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ **рдЦреЛрд▓реЗрдВ**, рдЖрдордВрддреНрд░рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ **рд▓реЙрдЧрд┐рди** рдХрд░реЗрдВ рдФрд░ рдЖрдордВрддреНрд░рдг рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ
6. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░реЗрдВ рдФрд░ рд╕реЗрдХреЗрдВрдбрд░реА рдИрдореЗрд▓ рд╕реЗрдЯ рдХрд░реЗрдВ

{% code overflow="wrap" %}
```powershell
# рд▓реЙрдЧрд┐рди
$password = ConvertTo-SecureString 'password' - AsPlainText -Force
$creds = New-Object
System.Management.Automation.PSCredential('externaltester@somedomain.onmicrosoft.com', $Password)
Connect-AzureAD -Credential $creds -TenantId <tenant_id_of_attacked_domain>

# OtherMails рд╕реЗрдЯрд┐рдВрдЧ рдмрджрд▓реЗрдВ
Set-AzureADUser -ObjectId <OBJECT-ID> -OtherMails <Username>@<TENANT_NAME>.onmicrosoft.com -Verbose
```
{% endcode %}

## рд╕рдВрджрд░реНрдн

* [https://www.mnemonic.io/resources/blog/abusing-dynamic-groups-in-azure-ad-for-privilege-escalation/](https://www.mnemonic.io/resources/blog/abusing-dynamic-groups-in-azure-ad-for-privilege-escalation/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> рдХреЗ рд╕рд╛рде рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live) **рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
