# Az - Dinamiese Groepe Privesc

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Basiese Inligting

**Dinamiese groepe** is groepe wat 'n stel **re√´ls** geconfigureer het en al die **gebruikers of toestelle** wat aan die re√´ls voldoen, by die groep gevoeg word. Elke keer as 'n gebruiker of toestel se **eienskap** verander word, word die dinamiese re√´ls **herkontroleer**. En wanneer 'n **nuwe re√´l** geskep word, word alle toestelle en gebruikers **nagegaan**.

Dinamiese groepe kan **Azure RBAC-rolle toegewys** kry, maar dit is **nie moontlik** om **AzureAD-rolle** by dinamiese groepe te voeg nie.

Hierdie kenmerk vereis 'n Azure AD premium P1 lisensie.

## Privesc

Let daarop dat enige gebruiker standaard gaste in Azure AD kan uitnooi, so, as 'n dinamiese groep **re√´l** **toestemmings** aan gebruikers gee gebaseer op **eienskappe** wat in 'n nuwe **gas** **gestel** kan word, is dit moontlik om 'n gas met hierdie eienskappe te **skep** en **privileges te eskaleer**. Dit is ook moontlik vir 'n gas om sy eie profiel te bestuur en hierdie eienskappe te verander.

Kry groepe wat Dinamiese lidmaatskap toelaat: `Get-AzureADMSGroup | ?{$_.GroupTypes -eq 'DynamicMembership'}`

### Voorbeeld

* **Re√´lvoorbeeld**: `(user.otherMails -any (_ -contains "tester")) -and (user.userType -eq "guest")`
* **Re√´lbeskrywing**: Enige gasgebruiker met 'n sekond√™re e-pos met die string 'tester' sal by die groep gevoeg word

1. Gaan na **Azure Active Directory** -> **Gebruikers** en **klik** op `Wil jy terugschakel na die ou gebruikerslys-ervaring? Klik hier om die voorskou te verlaat`
2. Klik op **`Nuwe gasgebruiker`** en **nooi** 'n e-pos uit
3. Die **gebruikersprofiel** sal by die Azure AD gevoeg word sodra die uitnodiging gestuur is. Maak die gebruikersprofiel oop en **klik op (bestuur) onder Uitnodiging aanvaar**.
* ![](<../../../.gitbook/assets/image (281).png>)
4. Verander **`Stuur uitnodiging weer?`** na **Ja** en jy sal 'n uitnodigings-URL kry:
* ![](<../../../.gitbook/assets/image (205).png>)
5. Kopieer die **URL** en **open** dit, **teken in** as die genooide gebruiker en **aanvaar** die uitnodiging
6.  **Teken in** in die opdraggewerktuig as die gebruiker en stel die sekond√™re e-pos in

{% code overflow="wrap" %}
```powershell
# Teken in
$wagwoord = ConvertTo-SecureString 'wagwoord' - AsPlainText -Force
$creds = New-Object
System.Management.Automation.PSCredential('externaltester@somedomain.onmicrosoft.com', $Password)
Connect-AzureAD -Credential $creds -TenantId <tenant_id_of_attacked_domain>

# Verander OtherMails-instelling
Set-AzureADUser -ObjectId <OBJECT-ID> -OtherMails <Gebruikersnaam>@<TENANT_NAME>.onmicrosoft.com -Verbose
```
{% endcode %}

## Verwysings

* [https://www.mnemonic.io/resources/blog/abusing-dynamic-groups-in-azure-ad-for-privilege-escalation/](https://www.mnemonic.io/resources/blog/abusing-dynamic-groups-in-azure-ad-for-privilege-escalation/)

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
