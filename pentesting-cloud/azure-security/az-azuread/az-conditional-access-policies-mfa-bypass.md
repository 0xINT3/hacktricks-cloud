# Az - Conditional Access Policies / MFA Bypass

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

Azure Conditional Access policies рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдПрдЬрд╝реНрдпреВрд░ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рдирд┐рдпрдо рд╣реИрдВ рдЬреЛ рдХреБрдЫ **рд╢рд░реНрддреЛрдВ** рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдПрдЬрд╝реНрдпреВрд░ рд╕реЗрд╡рд╛рдУрдВ рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВред рдпреЗ рдиреАрддрд┐рдпрд╛рдБ рд╕рдВрдЧрдардиреЛрдВ рдХреА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИрдВ рдЬреЛ рд╕рд╣реА рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рддрд╣рдд рд╕рд╣реА рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рд▓рд╛рдЧреВ рдХрд░рдХреЗред\
рд╢рд░реНрддрдореБрдХреНрдд рдкрд╣реБрдВрдЪ рдиреАрдд
```bash
roadrecon auth -u user@email.com -r https://outlook.office.com/ -c 1fec8e78-bce4-4aaf-ab1b-5451cc387264 --tokrns-stdout

<token>
```
рдЬреИрд╕реЗ рдХрд┐ Microsoft Teams рдРрдк рдореЗрдВ рдХрдИ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ, рдЖрдк рдЙрд╕ рдПрдХреНрд╕реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВрдЧреЗред

{% hint style="success" %}
рдЖрдк рд░реЛрдбрдЯреВрд▓реНрд╕ рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд Office365 рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЕрдзрд┐рдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХрд╛ рдЖрдИрдбреА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```sql
SELECT appId, displayName FROM ApplicationRefs WHERE publicCLient = 1 ORDER BY displayName ASC
```
{% endcode %}
{% endhint %}

рдпрд╣ рд╣рдорд▓рд╛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ Office365 рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреБрдЫ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд░рдЦреЗрдВрдЧреЗред

### рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдирд╣реАрдВ рд╣реЛрдВрдЧреА рдФрд░ рд╡реЗ рдирд┐рдЬреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рднреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдХреБрдЫ **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐ рдЬрд╣рд╛рдБ рдПрдХ рдиреАрддрд┐ рд╕реЗрдЯ рдХреА рдЧрдИ рд╣реИ **рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП MFA рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛** рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ **рдмреНрд░рд╛рдЙрдЬрд╝рд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ (рд╢рд╛рдпрдж рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдФрд░ рдЗрд╕рд▓рд┐рдП рдпрд╣ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рд╣реЛрдЧрд╛), рдЕрдЧрд░ рдПрдХ **рдкреНрд░реЙрдХреНрд╕реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рд╣реИ -рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдУрд░ рд╕реЗ рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди-, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдкреНрд░реЙрдХреНрд╕реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд▓реЙрдЧрд┐рди** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕ рдкреНрд░реЙрдХреНрд╕реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдкрд╣рд▓реЗ рд╕реЗ рд╣реА MFA рд╕реБрд░рдХреНрд╖рд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд▓реЙрдЧрд┐рди** рдХрд░ рд╕рдХрддрд╛ рд╣реИред

[**Invoke-MFASweep**](az-conditional-access-policies-mfa-bypass.md#invoke-mfasweep) рдФрд░ [**donkeytoken**](az-conditional-access-policies-mfa-bypass.md#donkeytoken) рддрдХрдиреАрдХреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

## рдЕрдиреНрдп Az MFA рдмрд╛рдпрдкрд╛рд╕

### рд░рд┐рдВрдЧ рдЯреЛрди

рдПрдХ Azure MFA рд╡рд┐рдХрд▓реНрдк рд╣реИ **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рдлрд╝реЛрди рдирдВрдмрд░ рдореЗрдВ рдПрдХ рдХреЙрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛** рдЬрд╣рд╛рдБ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ **рдЪрд╛рд░ `#` рднреЗрдЬрдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд╣рд╛ рдЬрд╛рдПрдЧрд╛ред

{% hint style="danger" %}
рдЪрд╛рд░реНрд╕ рдХреЗрд╡рд▓ **рдЯреЛрдиреНрд╕** рд╣реЛрддреЗ рд╣реИрдВ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рдлрд╝реЛрди рдирдВрдмрд░ рдХреЗ рд╡реЙрдпрд╕рдореЗрд▓** рд╕рдВрджреЗрд╢ рдХреЛ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╕рдВрджреЗрд╢ рдХреЗ рд░реВрдк рдореЗрдВ **`#` рдХрд╛ рдЯреЛрди** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░, MFA рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╕рдордп рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдкреАрдбрд╝рд┐рдд рдХрд╛ рдлрд╝реЛрди рд╡реНрдпрд╕реНрдд рд╣реИ** (рдЙрд╕реЗ рдХреЙрд▓ рдХрд░ рд░рд╣рд╛ рд╣реИ) рддрд╛рдХрд┐ Azure рдХреЙрд▓ рдХреЛ рд╡реЙрдпрд╕рдореЗрд▓ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред
{% endhint %}

### рдЕрдиреБрд░реВрдк рдЙрдкрдХрд░рдг

рдиреАрддрд┐рдпрд╛рдБ рдЕрдХреНрд╕рд░ рдПрдХ рдЕрдиреБрд░реВрдк рдЙрдкрдХрд░рдг рдпрд╛ MFA рдХреА рдорд╛рдВрдЧ рдХрд░рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЕрдиреБрд░реВрдк рдЙрдкрдХрд░рдг рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**, рдПрдХ **PRT** рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ MFA рдХреЛ рдмрд╛рдпрдкрд╛рд╕** рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ **Intune рдореЗрдВ рдПрдХ рдЕрдиреБрд░реВрдк рдЙрдкрдХрд░рдг рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░реЗрдВ**, рдлрд┐рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд╕рд╛рде **PRT рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**:

<figure><img src="../../../.gitbook/assets/image (131).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрд░ рдЬрд╛рдПрдВ:

{% content-ref url="../az-lateral-movement-cloud-on-prem/pass-the-prt.md" %}
[pass-the-prt.md](../az-lateral-movement-cloud-on-prem/pass-the-prt.md)
{% endcontent-ref %}

## рдЯреВрд▓рд┐рдВрдЧ

### [roadrecon](https://github.com/dirkjanm/ROADtools)

рд╕рднреА рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
```bash
roadrecon plugin policies
```
### [Invoke-MFASweep](https://github.com/dafthack/MFASweep)

MFASweep рдПрдХ PowerShell рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИ рдЬреЛ рдПрдХ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╕реЗрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ рдФрд░ рдпрд╣ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ MFA рд╕рдХреНрд╖рдо рд╣реИред рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдпрджрд┐ рд╢рд░реНрддрд╛рдзрд╛рд░рд┐рдд рдкрд╣реБрдВрдЪ рдиреАрддрд┐рдпрд╛рдБ рдФрд░ рдЕрдиреНрдп рдмрд╣реБ-рдХрд╛рд░рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреИрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЧрдИ рд╣реИрдВ, рддреЛ рдХреБрдЫ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдПрдХрд▓ рдХрд╛рд░рдХ рд░рд╣ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдореЗрдВ ADFS рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдВрдЪ рднреА рд╣реИ рдФрд░ рдпрджрд┐ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдСрди-рдкреНрд░реЗрдо ADFS рд╕рд░реНрд╡рд░ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```bash
Invoke-MFASweep -Username <username> -Password <pass>
```
### [donkeytoken](https://github.com/silverhack/donkeytoken)

рдбреЙрдирдХреА рдЯреЛрдХрди рдПрдХ рд╕реЗрдЯ рдХрд╛рд░реНрдпреЛрдВ рд╣реИ рдЬрд┐рдирдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╕реБрд░рдХреНрд╖рд╛ рд╕рд▓рд╛рд╣рдХрд╛рд░реЛрдВ рдХреА рдорджрдж рдХрд░рдирд╛ рд╣реИ рдЬреЛ рд╢рд░реНрддрд╛рдзрд╛рд░рд┐рдд рдкрд╣реБрдВрдЪ рдиреАрддрд┐рдпреЛрдВ рдХреА рдорд╛рдиреНрдпрддрд╛ рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, 2FA рд╕рдХреНрд╖рдо Microsoft рдкреЛрд░реНрдЯрд▓ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рддрд╛ рд╣реИ, рдЖрджрд┐ред
```powershell
Import-Module 'C:\Users\Administrador\Desktop\Azure\Modulos ps1\donkeytoken' -Force
```
**рдкреНрд░рддреНрдпреЗрдХ рдкреЛрд░реНрдЯрд▓** рдХрд╛ **рдЬрд╛рдВрдЪ рдХрд░реЗрдВ** рдпрджрд┐ **MFA рдХреЗ рдмрд┐рдирд╛ рд▓реЙрдЧрд┐рди** рд╕рдВрднрд╡ рд╣реИ:
```powershell
Test-MFA -credential $cred -Verbose -Debug -InformationAction Continue
```
<figure><img src="../../../.gitbook/assets/2023-03-06 17_02_47-.png" alt=""><figcaption></figcaption></figure>

рдХреНрдпреЛрдВрдХрд┐ **Azure** **рдкреЛрд░реНрдЯрд▓** **рд╕реАрдорд┐рдд рдирд╣реАрдВ** рд╣реИ, рдЗрд╕рд╕реЗ **рдкреЛрд░реНрдЯрд▓ рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╕реЗ рдЯреЛрдХрди рдПрдХрддреНрд░рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ рдкрд┐рдЫрд▓реЗ рдирд┐рд╖реНрдкрд╛рджрди рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдиреА рдЧрдИ рдХрд┐рд╕реА рднреА рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХреЗ**ред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╢реЗрдпрд░рдкреЙрдЗрдВрдЯ рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреЛрдХрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛:

{% code overflow="wrap" %}
```powershell
$token = Get-DelegationTokenFromAzurePortal -credential $cred -token_type microsoft.graph -extension_type Microsoft_Intune
Read-JWTtoken -token $token.access_token
```
{% endcode %}

<figure><img src="../../../.gitbook/assets/2023-03-06 17_11_28-Window.png" alt=""><figcaption></figcaption></figure>

рдЯреЛрдХрди рдХреЗ рдкрд╛рд╕ рдЕрдиреБрдорддрд┐ рд╣реИ Sites.Read.All (Sharepoint рд╕реЗ):

<figure><img src="../../../.gitbook/assets/2023-03-06 17_11_43-Window.png" alt=""><figcaption></figcaption></figure>

рдпрджреНрдпрдкрд┐ рдЖрдк MFA рдХреЗ рдХрд╛рд░рдг рд╡реЗрдм рд╕реЗ Sharepoint рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╕рдХрддреЗ, рддреЛ рдЙрд╕ рддреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрдирд░реЗрдЯ рдХрд┐рдП рдЧрдП рдЯреЛрдХрди рдХреЗ рд╕рд╛рде рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```powershell
$data = Get-SharePointFilesFromGraph -authentication $token $data[0].downloadUrl
```
## рд╕рдВрджрд░реНрдн

* [https://www.youtube.com/watch?v=yOJ6yB9anZM\&t=296s](https://www.youtube.com/watch?v=yOJ6yB9anZM\&t=296s)
* [https://www.youtube.com/watch?v=xei8lAPitX8](https://www.youtube.com/watch?v=xei8lAPitX8)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
