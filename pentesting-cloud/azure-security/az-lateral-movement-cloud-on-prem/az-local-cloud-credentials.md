# Az - Credenciales de la Nube Local

<details>

<summary><strong>Aprende a hackear AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Equipo Rojo de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **síguenos** en **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Almacenamiento Local de Tokens y Consideraciones de Seguridad

### Azure CLI (Interfaz de Línea de Comandos)

Los tokens y datos sensibles se almacenan localmente en Azure CLI, lo que plantea preocupaciones de seguridad:

1. **Tokens de Acceso**: Almacenados en texto plano dentro de `accessTokens.json` ubicado en `C:\Users\<username>\.Azure`.
2. **Información de Suscripción**: `azureProfile.json`, en el mismo directorio, contiene detalles de suscripción.
3. **Archivos de Registro**: La carpeta `ErrorRecords` dentro de `.azure` podría contener registros con credenciales expuestas, como:
- Comandos ejecutados con credenciales incrustadas.
- URLs accedidas utilizando tokens, revelando potencialmente información sensible.

### Azure PowerShell

Azure PowerShell también almacena tokens y datos sensibles, que pueden ser accedidos localmente:

1. **Tokens de Acceso**: `TokenCache.dat`, ubicado en `C:\Users\<username>\.Azure`, almacena tokens de acceso en texto plano.
2. **Secretos de Principales de Servicio**: Estos se almacenan sin cifrar en `AzureRmContext.json`.
3. **Función de Guardado de Tokens**: Los usuarios tienen la capacidad de persistir tokens utilizando el comando `Save-AzContext`, el cual debe ser utilizado con precaución para prevenir accesos no autorizados.

## Herramientas Automáticas para encontrarlos

* [**Winpeas**](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS/winPEASexe)
* [**Get-AzurePasswords.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/AzureRM/Get-AzurePasswords.ps1)

## Recomendaciones de Seguridad

Considerando el almacenamiento de datos sensibles en texto plano, es crucial asegurar estos archivos y directorios mediante:
- Limitar los derechos de acceso a estos archivos.
- Monitorear y auditar regularmente estos directorios en busca de accesos no autorizados o cambios inesperados.
- Emplear cifrado para archivos sensibles cuando sea posible.
- Educar a los usuarios sobre los riesgos y las mejores prácticas para manejar esta información sensible.
