# Az AD Connect - Hibriede Identiteit

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## Basiese Inligting

Integrasie tussen **On-premises Active Directory (AD)** en **Azure AD** word gefasiliteer deur **Azure AD Connect**, wat verskeie metodes bied wat **Enkeltekenaanmelding (SSO)** ondersteun. Elke metode, hoewel nuttig, bied potensi√´le sekuriteitskwesbaarhede wat uitgebuit kan word om die wolk- of on-premises-omgewing in gevaar te bring:

* **Pass-Through Authentication (PTA)**:
- Moontlike kompromittering van die agent op die on-prem AD, wat validering van gebruikerswagwoorde vir Azure-verbindinge (on-prem na Cloud) moontlik maak.
- Moontlikheid om 'n nuwe agent te registreer om validering van outentifikasies op 'n nuwe plek moontlik te maak (Cloud na on-prem).

{% content-ref url="pta-pass-through-authentication.md" %}
[pta-pass-through-authentication.md](pta-pass-through-authentication.md)
{% endcontent-ref %}

* **Password Hash Sync (PHS)**:
- Potensi√´le ontginning van klaarteks wagwoorde van bevoorregte gebruikers uit die AD, insluitend legitimasie van 'n ho√´-bevoorregte, outomaties gegenereerde AzureAD-gebruiker.

{% content-ref url="phs-password-hash-sync.md" %}
[phs-password-hash-sync.md](phs-password-hash-sync.md)
{% endcontent-ref %}

* **Federasie**:
- Diefstal van die privaat sleutel wat gebruik word vir SAML-ondertekening, wat die verpersoonliking van on-prem en wolk-identiteite moontlik maak.

{% content-ref url="federation.md" %}
[federation.md](federation.md)
{% endcontent-ref %}

* **Naadlose SSO:**
- Diefstal van die wagwoord van die `AZUREADSSOACC`-gebruiker, wat gebruik word vir die ondertekening van Kerberos silwermiddels, wat die verpersoonliking van enige wolk-gebruiker moontlik maak.

{% content-ref url="seamless-sso.md" %}
[seamless-sso.md](seamless-sso.md)
{% endcontent-ref %}

* **Cloud Kerberos Trust**:
- Moontlikheid om van Global Admin na on-prem Domain Admin te eskaleer deur AzureAD-gebruikersname en SIDs te manipuleer en TGT's van AzureAD aan te vra.

{% content-ref url="az-cloud-kerberos-trust.md" %}
[az-cloud-kerberos-trust.md](az-cloud-kerberos-trust.md)
{% endcontent-ref %}

* **Verstektoepassings**:
- Kompromittering van 'n Application Administrator-rekening of die on-premises Sync-rekening maak dit moontlik om aanpassing van gidsinstellings, groepslidmaatskappe, gebruikersrekeninge, SharePoint-webwerwe en OneDrive-l√™ers toe te laat.

{% content-ref url="az-default-applications.md" %}
[az-default-applications.md](az-default-applications.md)
{% endcontent-ref %}

Vir elke integrasiemetode word gebruikerssinsronisering uitgevoer, en 'n `MSOL_<installationidentifier>`-rekening word in die on-prem AD geskep. Dit is vermeldenswaardig dat beide die **PHS**- en **PTA**-metodes **Naadlose SSO** fasiliteer, wat outomatiese aanmelding vir Azure AD-rekenaars wat by die on-prem-domein aangesluit is, moontlik maak.

Om die installasie van **Azure AD Connect** te verifieer, kan die volgende PowerShell-opdrag, wat gebruik maak van die **AzureADConnectHealthSync**-module (standaard ge√Ønstalleer met Azure AD Connect), gebruik word:
```powershell
Get-ADSyncConnector
```
<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
