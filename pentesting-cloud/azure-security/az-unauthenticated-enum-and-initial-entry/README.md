# Az - рдЕрдкреНрд░рдорд╛рдгрд┐рдд Enum рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреНрд░рд╡реЗрд╢

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ PRs рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ.

</details>

## Azure Tenant

### Tenant Enumeration

рдХреБрдЫ **public Azure APIs** рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЬрд╛рдирдХрд░ **tenant рдХреЗ рдбреЛрдореЗрди** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ.\
рдЖрдк рд╕реАрдзреЗ API рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ [**AADInternals**](https://github.com/Gerenios/AADInternals) **PowerShell рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:**

| API                                                                  | Information                                                                                                                                                                                                                                           | AADInternals function                             |
| -------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- |
| login.microsoftonline.com/\<domain>/.well-known/openid-configuration | **Login information**, рдЬрд┐рд╕рдореЗрдВ tenant ID рд╢рд╛рдорд┐рд▓ рд╣реИ                                                                                                                                                                                                     | `Get-AADIntTenantID -Domain <domain>`             |
| autodiscover-s.outlook.com/autodiscover/autodiscover.svc             | **Tenant рдХреЗ рд╕рднреА рдбреЛрдореЗрди**                                                                                                                                                                                                                              | `Get-AADIntTenantDomains -Domain <domain>`        |
| login.microsoftonline.com/GetUserRealm.srf?login=\<UserName>         | <p><strong>Login information</strong> рдЯреЗрдиреЗрдВрдЯ рдХреА, рдЬрд┐рд╕рдореЗрдВ tenant Name рдФрд░ рдбреЛрдореЗрди <strong>authentication type</strong> рд╢рд╛рдорд┐рд▓ рд╣реИ.<br>рдЕрдЧрд░ <code>NameSpaceType</code> <strong><code>Managed</code></strong> рд╣реИ, рдЗрд╕рдХрд╛ рдорддрд▓рдм <strong>AzureAD</strong> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ.</p> | `Get-AADIntLoginInformation -UserName <UserName>` |
| login.microsoftonline.com/common/GetCredentialType                   | Login information, рдЬрд┐рд╕рдореЗрдВ **Desktop SSO information** рд╢рд╛рдорд┐рд▓ рд╣реИ                                                                                                                                                                                       | `Get-AADIntLoginInformation -UserName <UserName>` |

рдЖрдк **рдХреЗрд╡рд▓ рдПрдХ рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде** [**AADInternals**](https://github.com/Gerenios/AADInternals) **рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ** Azure tenant рдХреА рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреНрд╡реЗрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```powershell
Invoke-AADIntReconAsOutsider -DomainName corp.onmicrosoft.com | Format-Table
```
рдЖрдЙрдЯрдкреБрдЯ рдЙрджрд╛рд╣рд░рдг Azure рдЯреЗрдиреЗрдВрдЯ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛:
```
Tenant brand:       Company Ltd
Tenant name:        company
Tenant id:          05aea22e-32f3-4c35-831b-52735704feb3
DesktopSSO enabled: True

Name                           DNS   MX    SPF  Type      STS
----                           ---   --    ---  ----      ---
company.com                   True  True  True  Federated sts.company.com
company.mail.onmicrosoft.com  True  True  True  Managed
company.onmicrosoft.com       True  True  True  Managed
int.company.com              False False False  Managed
```
рдЖрдЙрдЯрдкреБрдЯ рд╕реЗ рд╣рдо рд▓рдХреНрд╖рд┐рдд рд╕рдВрдЧрдарди рдХреА рдЯреЗрдиреЗрдВрдЯ рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЯреЗрдиреЗрдВрдЯ рдХрд╛ рдирд╛рдо, рдЖрдИрдбреА рдФрд░ "рдмреНрд░рд╛рдВрдб" рдирд╛рдо рд╢рд╛рдорд┐рд▓ рд╣реИред рд╣рдо рдпрд╣ рднреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рдХреНрдпрд╛ рдбреЗрд╕реНрдХрдЯреЙрдк SSO (рдЙрд░реНрдл** [**Seamless SSO**](https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-sso)**) рд╕рдХреНрд╖рдо рд╣реИ**ред рдпрджрд┐ рд╕рдХреНрд╖рдо рд╣реИ, рддреЛ рд╣рдо рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓рдХреНрд╖рд┐рдд рд╕рдВрдЧрдарди рдореЗрдВ рдореМрдЬреВрдж рд╣реИ рдпрд╛ рдирд╣реАрдВ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реВрдЪреАрдХрд░рдг)ред

рд╣рдо рд▓рдХреНрд╖рд┐рдд рдЯреЗрдиреЗрдВрдЯ рдХреЗ рд╕рднреА (рд╕рддреНрдпрд╛рдкрд┐рдд) рдбреЛрдореЗрдиреЛрдВ рдХреЗ рдирд╛рдо рдФрд░ рдЙрдирдХреЗ рдкрд╣рдЪрд╛рди рдкреНрд░рдХрд╛рд░ рднреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдВрдШреАрдп рдбреЛрдореЗрдиреЛрдВ рдХреЗ рд▓рд┐рдП, рдкреНрд░рдпреБрдХреНрдд рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ (рдЖрдорддреМрд░ рдкрд░ ADFS рд╕рд░реНрд╡рд░) рдХрд╛ FQDN рднреА рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред MX рдХреЙрд▓рдо рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдИрдореЗрд▓ Exchange рдСрдирд▓рд╛рдЗрди рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред SPF рдХреЙрд▓рдо рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ Exchange рдСрдирд▓рд╛рдЗрди рдХреЛ рдИрдореЗрд▓ рдкреНрд░реЗрд╖рдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред **рдзреНрдпрд╛рди рджреЗрдВ!** рд╡рд░реНрддрдорд╛рди рдореЗрдВ рд░реЗрдХреЙрди рдлрд╝рдВрдХреНрд╢рди SPF рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреЗ рдЗрдирдХреНрд▓реВрдб рд╕реНрдЯреЗрдЯрдореЗрдВрдЯреНрд╕ рдХрд╛ рдкрд╛рд▓рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЧрд▓рдд-рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реВрдЪреАрдХрд░рдг

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рдП рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдореМрдЬреВрдж рд╣реИ** рдПрдХ рдЯреЗрдиреЗрдВрдЯ рдХреЗ рдЕрдВрджрд░ред рдЗрд╕рдореЗрдВ **рдЕрддрд┐рдерд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдЗрд╕ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ:
```
<email>#EXT#@<tenant name>.onmicrosoft.com
```
рдИрдореЗрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдИрдореЗрд▓ рдкрддрд╛ рд╣реИ рдЬрд╣рд╛рдВ "@" рдХреЛ рдЕрдВрдбрд░рд╕реНрдХреЛрд░ "_" рд╕реЗ рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

[**AADInternals**](https://github.com/Gerenios/AADInternals) рдХреЗ рд╕рд╛рде, рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореМрдЬреВрдж рд╣реИ рдпрд╛ рдирд╣реАрдВ:
```powershell
# Check does the user exist
Invoke-AADIntUserEnumerationAsOutsider -UserName "user@company.com"
```
```
# Azure рдЕрдкреНрд░рдорд╛рдгрд┐рдд рд╕реВрдЪреАрдмрджреНрдзрддрд╛ рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреНрд░рд╡реЗрд╢

Azure рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХрд░рддреЗ рд╕рдордп, рдЕрдкреНрд░рдорд╛рдгрд┐рдд рд╕реВрдЪреАрдмрджреНрдзрддрд╛ рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреНрд░рд╡реЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЪрд░рдг рд╣реИред рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЙрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ Azure рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рд╕реВрдЪреАрдмрджреНрдзрддрд╛ рдФрд░ рдЙрдирдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## рддрдХрдиреАрдХреЗрдВ

### Azure CLI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реВрдЪреАрдмрджреНрдзрддрд╛

Azure CLI рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдЖрдкрдХреЛ Azure рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рд╕реВрдЪреАрдмрджреНрдзрддрд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
az account list
az group list
az storage account list
```

### Azure рдкреЛрд░реНрдЯрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реВрдЪреАрдмрджреНрдзрддрд╛

Azure рдкреЛрд░реНрдЯрд▓ рдПрдХ рд╡реЗрдм-рдЖрдзрд╛рд░рд┐рдд рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЕрдкрдиреЗ Azure рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЖрдк рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рд╕реВрдЪреАрдмрджреНрдзрддрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Azure PowerShell рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реВрдЪреАрдмрджреНрдзрддрд╛

Azure PowerShell рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рднрд╛рд╖рд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ Azure рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

```powershell
Get-AzSubscription
Get-AzResourceGroup
Get-AzStorageAccount
```

### Azure REST API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реВрдЪреАрдмрджреНрдзрддрд╛

Azure REST API рдЖрдкрдХреЛ HTTP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Azure рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдЙрдиреНрдирдд рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдЕрдзрд┐рдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИред

## рдирд┐рд╖реНрдХрд░реНрд╖

Azure рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди, рдЕрдкреНрд░рдорд╛рдгрд┐рдд рд╕реВрдЪреАрдмрджреНрдзрддрд╛ рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреНрд░рд╡реЗрд╢ рддрдХрдиреАрдХреЗрдВ рдЖрдкрдХреЛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рдЖрдЧреЗ рдХреЗ рдЪрд░рдгреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк Azure рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рд╕реВрдЪреАрдмрджреНрдзрддрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
```
UserName         Exists
--------         ------
user@company.com True
```
рдЖрдк рдПрдХ рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддрд┐ рдкрдВрдХреНрддрд┐ рдПрдХ рдИрдореЗрд▓ рдкрддрд╛ рд╣реЛ:
```
user@company.com
user2@company.com
admin@company.com
admin2@company.com
external.user_gmail.com#EXT#@company.onmicrosoft.com
external.user_outlook.com#EXT#@company.onmicrosoft.com
```

```powershell
# Invoke user enumeration
Get-Content .\users.txt | Invoke-AADIntUserEnumerationAsOutsider -Method Normal
```
**рддреАрди рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЧрдгрдирд╛ рд╡рд┐рдзрд┐рдпрд╛рдВ** рдЪреБрдирдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ:

| рд╡рд┐рдзрд┐      | рд╡рд┐рд╡рд░рдг                                                                                                                                                                                                 |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| рд╕рд╛рдорд╛рдиреНрдп    | рдпрд╣ GetCredentialType API рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдКрдкрд░ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡рд┐рдзрд┐ред                                                                                                                      |
| рд▓реЙрдЧрд┐рди     | <p>рдпрд╣ рд╡рд┐рдзрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреА рд╣реИред<br><strong>рдиреЛрдЯ:</strong> рдкреНрд░рд╢реНрди рд╕рд╛рдЗрди-рдЗрди рд▓реЙрдЧ рдореЗрдВ рд▓реЙрдЧ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред</p>                                                                                   |
| рдСрдЯреЛрд▓реЙрдЧреЛрди | <p>рдпрд╣ рд╡рд┐рдзрд┐ рдСрдЯреЛрд▓реЙрдЧреЛрди рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреА рд╣реИред<br><strong>рдкреНрд░рд╢реНрди рд▓реЙрдЧ рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ</strong> рд╕рд╛рдЗрди-рдЗрди рд▓реЙрдЧ рдореЗрдВ! рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдкреНрд░реЗ рдФрд░ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рднреА рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред</p> |

рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдореЛрдВ рдХреА рдЦреЛрдЬ рдХреЗ рдмрд╛рдж рдЖрдк **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```powershell
Get-AADIntLoginInformation -UserName root@corp.onmicrosoft.com
```
рд╕реНрдХреНрд░рд┐рдкреНрдЯ [**o365creeper**](https://github.com/LMGsec/o365creeper) рдЖрдкрдХреЛ рдпрд╣ рднреА рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдХрд┐ **рдХреНрдпрд╛ рдПрдХ рдИрдореЗрд▓ рдорд╛рдиреНрдп рд╣реИ**ред
```powershell
# Put in emails.txt emails such as:
# - root@corp.onmicrosoft.com
python.exe .\o365creeper\o365creeper.py -f .\emails.txt -o validemails.txt
```
## Azure рд╕реЗрд╡рд╛рдПрдБ

рдЕрдм рдЬрдм рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ **Azure tenant рдХреЗ рдбреЛрдореЗрдиреНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕рдордп рд╣реИ **Azure рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ** рдХрд░рдиреЗ рдХрд╛ рдЬреЛ рдЙрдЬрд╛рдЧрд░ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

рдЖрдк рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП [**MicroBust**](https://github.com/NetSPI/MicroBurst) рд╕реЗ рдПрдХ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдлрдВрдХреНрд╢рди рдмреЗрд╕ рдбреЛрдореЗрди рдирд╛рдо (рдФрд░ рдХреБрдЫ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ) рдХреЛ рдХрдИ **azure рд╕реЗрд╡рд╛ рдбреЛрдореЗрдиреНрд╕** рдореЗрдВ рдЦреЛрдЬреЗрдЧрд╛:
```powershell
Import-Module .\MicroBurst\MicroBurst.psm1 -Verbose
Invoke-EnumerateAzureSubDomains -Base corp -Verbose
```
## рдУрдкрди рд╕реНрдЯреЛрд░реЗрдЬ

рдЖрдк [**InvokeEnumerateAzureBlobs.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/Misc/Invoke-EnumerateAzureBlobs.ps1) рдЬреИрд╕реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдУрдкрди рд╕реНрдЯреЛрд░реЗрдЬ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **`Microburst/Misc/permitations.txt`** рдлрд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХреЗ рд╕рд░рд▓ рдкрд░рд┐рд╡рд░реНрддрди (рдмрд╣реБрдд рд╕рд░рд▓) рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ рддрд╛рдХрд┐ **рдУрдкрди рд╕реНрдЯреЛрд░реЗрдЬ рдЕрдХрд╛рдЙрдВрдЯреНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред
```powershell
Import-Module .\MicroBurst\MicroBurst.psm1
Invoke-EnumerateAzureBlobs -Base corp
[...]
https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
[...]

# Access https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
# Check: <Name>ssh_info.json</Name>
# Access then https://corpcommon.blob.core.windows.net/secrets/ssh_info.json
```
### SAS URLs

_**рд╕рд╛рдЭрд╛ рдкрд╣реБрдБрдЪ рд╣рд╕реНрддрд╛рдХреНрд╖рд░**_ (SAS) URL рдПрдХ URL рд╣реИ рдЬреЛ **рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ** Storage account рдХреЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рднрд╛рдЧ (рдкреВрд░рд╛ рдХрдВрдЯреЗрдирд░, рдПрдХ рдлрд╛рдЗрд▓...) рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдиреБрдорддрд┐рдпреЛрдВ (рдкрдврд╝рдирд╛, рд▓рд┐рдЦрдирд╛...) рдХреЗ рд╕рд╛рде рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдкрд░ред рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ рд▓реАрдХ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдЖрдк рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рд╡реЗ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддреЗ рд╣реИрдВ (рдпрд╣ рдПрдХ рдХрдВрдЯреЗрдирд░ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ, рдЕрдЧрд░ рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдлрд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░ рд░рд╣рд╛ рдерд╛ рддреЛ URL рдХрд╛ рдкрде рдЙрд╕ рдлрд╛рдЗрд▓ рдХреЛ рднреА рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░реЗрдЧрд╛):

`https://<storage_account_name>.blob.core.windows.net/newcontainer?sp=r&st=2021-09-26T18:15:21Z&se=2021-10-27T02:14:21Z&spr=https&sv=2021-07-08&sr=c&sig=7S%2BZySOgy4aA3Dk0V1cJyTSIf1cW%2Fu3WFkhHV32%2B4PE%3D`

[**Storage Explorer**](https://azure.microsoft.com/en-us/features/storage-explorer/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪреЗрдВ

## рд╕рдордЭреМрддрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

### рдлрд╝рд┐рд╢рд┐рдВрдЧ

* [**рд╕рд╛рдорд╛рдиреНрдп рдлрд╝рд┐рд╢рд┐рдВрдЧ**](https://book.hacktricks.xyz/generic-methodologies-and-resources/phishing-methodology) (рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдпрд╛ OAuth App -[Illicit Consent Grant Attack](az-illicit-consent-grant.md)-)
* [**Device Code Authentication** рдлрд╝рд┐рд╢рд┐рдВрдЧ](az-device-code-authentication-phishing.md)

### рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдкреНрд░реЗрдЗрдВрдЧ / рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕

{% content-ref url="az-password-spraying.md" %}
[az-password-spraying.md](az-password-spraying.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://o365blog.com/post/just-looking/](https://o365blog.com/post/just-looking/)

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ.**
* **HackTricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
