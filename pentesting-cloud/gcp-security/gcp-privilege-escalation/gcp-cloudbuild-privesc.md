# GCP - Privil√®ge d'escalade Cloudbuild

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**d√©p√¥ts GitHub HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## cloudbuild

### `cloudbuild.builds.create`

Avec cette autorisation, vous pouvez **soumettre une construction cloud**. La machine cloudbuild aura par d√©faut dans son syst√®me de fichiers un jeton du puissant compte de service cloudbuild : `<PROJECT_NUMBER>@cloudbuild.gserviceaccount.com`. Cependant, vous pouvez **indiquer n'importe quel compte de service √† l'int√©rieur du projet** dans la configuration de cloudbuild.\
Par cons√©quent, vous pouvez simplement faire exfiltrer √† votre serveur le jeton ou **obtenir un shell invers√© √† l'int√©rieur et obtenir vous-m√™me le jeton** (le fichier contenant le jeton peut changer).

Vous pouvez trouver le script d'exploitation original [**ici sur GitHub**](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation/blob/master/ExploitScripts/cloudbuild.builds.create.py) (mais l'emplacement √† partir duquel il prend le jeton n'a pas fonctionn√© pour moi). Par cons√©quent, v√©rifiez un script pour automatiser la [**cr√©ation, l'exploitation et le nettoyage d'un environnement vuln√©rable ici**](https://github.com/carlospolop/gcp\_privesc\_scripts/blob/main/tests/f-cloudbuild.builds.create.sh) et un script python pour obtenir un shell invers√© √† l'int√©rieur de la machine cloudbuild et [**le voler ici**](https://github.com/carlospolop/gcp\_privesc\_scripts/blob/main/tests/f-cloudbuild.builds.create.py) (dans le code, vous pouvez trouver comment sp√©cifier d'autres comptes de service).

Pour une explication plus approfondie, visitez [https://rhinosecuritylabs.com/gcp/iam-privilege-escalation-gcp-cloudbuild/](https://rhinosecuritylabs.com/gcp/iam-privilege-escalation-gcp-cloudbuild/)

### `cloudbuild.builds.update`

**Potentiellement** avec cette autorisation, vous pourrez **mettre √† jour une construction cloud et simplement voler le jeton de compte de service** comme cela a √©t√© fait avec la permission pr√©c√©dente (mais malheureusement, au moment de la r√©daction de cet article, je n'ai trouv√© aucun moyen d'appeler cette API).