# GCP - Serviceusage 权限提升

<details>

<summary><strong>从零开始学习 AWS 黑客技术，成为</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您希望在 **HackTricks 中看到您的公司广告** 或 **下载 HackTricks 的 PDF 版本**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取 [**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 探索 [**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家的 [**NFT 集合**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>

## serviceusage

以下权限对于创建和窃取 API 密钥很有用，注意文档中的说明：_API 密钥是一个简单的加密字符串，它**不涉及任何主体地标识应用程序**。它们对于匿名访问**公共数据**很有用，并用于将 API 请求与您的项目关联，以便进行配额和**计费**。_

因此，使用 API 密钥，您可以使该公司为您使用 API 支付费用，但您将无法提升权限。

要了解其他权限和生成 API 密钥的方法，请查看：

{% content-ref url="gcp-apikeys-privesc.md" %}
[gcp-apikeys-privesc.md](gcp-apikeys-privesc.md)
{% endcontent-ref %}

### `serviceusage.apiKeys.create`

发现了一个未记录的 API，可以用来**创建 API 密钥：**

{% code overflow="wrap" %}
```bash
curl -XPOST "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
### `serviceusage.apiKeys.list`

发现了另一个未记录的API，用于列出已创建的API密钥（API密钥显示在响应中）：

{% code overflow="wrap" %}
```bash
curl "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
{% endcode %}

### **`serviceusage.services.enable`**，**`serviceusage.services.use`**

拥有这些权限的攻击者可以在项目中启用和使用新服务。这可能允许**攻击者启用像admin或cloudidentity这样的服务**，尝试访问Workspace信息，或其他服务以访问有趣的数据。

## **参考资料**

* [https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/](https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/)

<details>

<summary><strong>支持HackTricks并获得好处！</strong></summary>

你在**网络安全公司**工作吗？你想在**HackTricks中看到你的公司广告**吗？或者你想要访问**最新版本的PEASS或下载HackTricks的PDF**？查看[**订阅计划**](https://github.com/sponsors/carlospolop)！

发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)

获取[**官方的PEASS & HackTricks商品**](https://peass.creator-spring.com)

**加入**[**💬**](https://emojipedia.org/speech-balloon/)[**Discord群组**](https://discord.gg/hRep4RUj7f)或[**telegram群组**](https://t.me/peass)或在**Twitter上**[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**关注我**](https://twitter.com/carlospolopm)**。**

**通过向**[**hacktricks github仓库提交PR来分享你的黑客技巧**](https://github.com/carlospolop/hacktricks)\*\*\*\*

**。**

</details>
