# GCP - Genel Kovalar Yetki Yükseltme

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)'u **takip edin**.
* **Hacking hilelerinizi paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gönderin**.

</details>

## Kovalar Yetki Yükseltme

Eğer kova politikası "allUsers" veya "allAuthenticatedUsers"ın kova politikasını **değiştirmesine izin veriyorsa** (storage.buckets.setIamPolicy izni), herhangi biri kova politikasını değiştirip kendisine tam erişim sağlayabilir.

### İzinleri Kontrol Etme

Bir kova üzerindeki izinleri kontrol etmek için 2 yöntem vardır. İlk yöntem, `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam` adresine bir istek yaparak veya `gsutil iam get gs://BUCKET_NAME` komutunu çalıştırarak izinleri sormaktır.

Ancak, kullanıcınızın (potansiyel olarak allUsers veya allAuthenticatedUsers'a ait olabilir) kova iam politikasını okuma izni (storage.buckets.getIamPolicy) yoksa, bu çalışmayacaktır.

Her zaman çalışacak diğer seçenek, kovanın testPermissions uç noktasını kullanarak belirli bir izne sahip olup olmadığınızı belirlemektir. Örneğin, şu adrese erişerek: `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam/testPermissions?permissions=storage.buckets.delete&permissions=storage.buckets.get&permissions=storage.buckets.getIamPolicy&permissions=storage.buckets.setIamPolicy&permissions=storage.buckets.update&permissions=storage.objects.create&permissions=storage.objects.delete&permissions=storage.objects.get&permissions=storage.objects.list&permissions=storage.objects.update`

### Yükseltme

`Storage Admin` yetkisini `allAuthenticatedUsers`a vermek için aşağıdaki komutu çalıştırabilirsiniz:
```
gsutil iam ch group:allAuthenticatedUsers:admin gs://BUCKET_NAME
```
Başka bir saldırı, sahipliği çalmak için kovayı kaldırmak ve kendi hesabınızda yeniden oluşturmaktır.

## Referanslar

* [https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/](https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek paylaşın**.

</details>
