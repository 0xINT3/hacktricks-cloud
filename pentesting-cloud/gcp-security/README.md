# GCP рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **рддреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

**GCP** рдкрд░рд┐рд╡реЗрд╢ рдХреА **рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ**, рдЖрдкрдХреЛ рдХреБрдЫ **рдореВрд▓рднреВрдд рдЪреАрдЬреЗрдВ рдЬрд╛рдирдиреА рдЪрд╛рд╣рд┐рдП** рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреЛ рд╕рдордЭ рдореЗрдВ рдЖрдПрдЧрд╛ рдХрд┐ рдЖрдкрдХреЛ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИ, рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреИрд╕реЗ рдвреВрдВрдврд╝реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рд╢реЛрд╖рдг рдХрд░реЗрдВред

**рд╕рдВрдЧрдарди** рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛, **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рдФрд░ рдЕрдиреНрдп рдореВрд▓рднреВрдд рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рд╕рдордЭрд╛рдИ рдЧрдИ рд╣реИрдВ:

{% content-ref url="gcp-basic-information.md" %}
[gcp-basic-information.md](gcp-basic-information.md)
{% endcontent-ref %}

## рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд▓реИрдмреНрд╕

* [https://gcpgoat.joshuajebaraj.com/](https://gcpgoat.joshuajebaraj.com/)
* [https://github.com/ine-labs/GCPGoat](https://github.com/ine-labs/GCPGoat)
* [https://github.com/lacioffi/GCP-pentest-lab/](https://github.com/lacioffi/GCP-pentest-lab/)
* [https://github.com/carlospolop/gcp\_privesc\_scripts](https://github.com/carlospolop/gcp\_privesc\_scripts)

## GCP рдкреЗрдВрдЯреЗрд╕реНрдЯрд░/рд░реЗрдб рдЯреАрдо рдореЗрдердбреЛрд▓реЙрдЬреА

GCP рдкрд░рд┐рд╡реЗрд╢ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЖрдк рдЬрд╛рдиреЗрдВ: рдХреМрди рд╕реЗ **рд╕реЗрд╡рд╛рдПрдВ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣реА рд╣реИрдВ**, рдХреНрдпрд╛ **рдЙрдЬреНрдЬреНрд╡рд▓ рд╣реЛ рд░рд╣рд╛ рд╣реИ**, рдХрд┐рд╕рдХреЗ рдкрд╛рд╕ рдХреНрдпрд╛ **рдкрд╣реБрдВрдЪ** рд╣реИ, рдФрд░ рдЖрдВрддрд░рд┐рдХ GCP рд╕реЗрд╡рд╛рдУрдВ рдФрд░ **рдмрд╛рд╣рд░реА рд╕реЗрд╡рд╛рдУрдВ** рдХрд╛ рдХреИрд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред

рд░реЗрдб рдЯреАрдо рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, GCP рдкрд░рд┐рд╡реЗрд╢ рдХреЛ **рдЕрдкрдиреЗ рдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рдкрд╣рд▓рд╛ рдХрджрдо** рд╣реИ рдХреБрдЫ **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛**ред рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рдХреБрдЫ рд╡рд┐рдЪрд╛рд░ рд╣реИрдВ рдХрд┐ рдЗрд╕реЗ рдХреИрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* рдЧрд┐рдЯрд╣рдм (рдпрд╛ рд╕рдорд╛рди) рдореЗрдВ **рд▓реАрдХ** - OSINT
* **рд╕рд╛рдорд╛рдЬрд┐рдХ** рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ (рдкреГрд╖реНрда [**Workspace Security**](../workspace-security.md) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ)
* **рдкрд╛рд╕рд╡рд░реНрдб** рдкреБрди: рдкреНрд░рдпреЛрдЧ (рдкрд╛рд╕рд╡рд░реНрдб рд▓реАрдХ)
* GCP-Hosted рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдХрдордЬреЛрд░рд┐рдпрд╛рдВ
* [**рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлрд╝реЙрд░реНрдЬрд░реА**](https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf) рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪ рдХреЗ рд╕рд╛рде
* **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ**
* `/home/USERNAME/.config/gcloud/*`
* `C:\Users\USERNAME\.config\gcloud\*`
* рддреГрддреАрдп рдкрдХреНрд╖ **рднрдВрдЧ**
* **рдЖрдВрддрд░рд┐рдХ** рдХрд░реНрдордЪрд╛рд░реА

рдпрд╛ **рдЕрдкреНрд░рдорд╛рдгрд┐рдд рд╕реЗрд╡рд╛** рдХреЛ рдХрдВрдкреНрд░рдорд╛рдЗрдЬрд╝ рдХрд░рдХреЗ:

{% content-ref url="gcp-unauthenticated-enum/" %}
[gcp-unauthenticated-enum](gcp-unauthenticated-enum/)
{% endcontent-ref %}

рдпрд╛ рдпрджрд┐ рдЖрдк рд╕рдореАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рдЖрдк рд╕реАрдзреЗ **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд▓рд┐рдП рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВ** рдЗрди рд░реЛрд▓реНрд╕ рдХреЗ рд╕рд╛рде:

{% content-ref url="gcp-permissions-for-a-pentest.md" %}
[gcp-permissions-for-a-pentest.md](gcp-permissions-for-a-pentest.md)
{% endcontent-ref %}

{% hint style="info" %}
рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдХрд┐ рд╡реЗ рдХрд┐рд╕рдХреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХреА рдкрд╣реБрдВрдЪ рдХреНрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдХреБрдЫ рдореВрд▓рднреВрдд рдЬрд╛рдВрдЪ рдХрд░рдиреА рд╣реЛрдЧреА:
{% endhint %}

## рдореВрд▓рднреВрдд рдЬрд╛рдВрдЪ

### **SSRF**

GCP рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреА **рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдкреЗрдЬ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#6440" %}

### Whoami

GCP рдореЗрдВ рдЖрдк рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рд╡рд┐рдХрд▓реНрдк рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдХреМрди рд╣реИрдВ:
```bash
#If you are inside a compromise machine
gcloud auth list
curl -H "Content-Type: application/x-www-form-urlencoded" -d "access_token=$(gcloud auth print-access-token)" https://www.googleapis.com/oauth2/v1/tokeninfo
gcloud auth print-identity-token #Get info from the token

#If you compromised a metadata token or somehow found an OAuth token
curl -H "Content-Type: application/x-www-form-urlencoded" -d "access_token=<token>" https://www.googleapis.com/oauth2/v1/tokeninfo
```
### рд╕рдВрдЧрдарди рдЬрд╛рдБрдЪ

Org enumeration is the process of gathering information about an organization's structure, resources, and services. This information can be useful for identifying potential attack vectors and vulnerabilities in the organization's cloud infrastructure.

рд╕рдВрдЧрдарди рдЬрд╛рдБрдЪ рд╕рдВрдЧрдарди рдХреЗ рд╕рдВрд░рдЪрдирд╛, рд╕рдВрд╕рд╛рдзрди рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдВрдЧрдарди рдХреЗ рдХреНрд▓рд╛рдЙрдб рдмрдирд╛рд╡рдЯ рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рд╣рдорд▓рд╛ рджреНрд╡рд╛рд░ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### Project Enumeration

### рдкрд░рд┐рдпреЛрдЬрдирд╛ рдЬрд╛рдБрдЪ

Project enumeration involves identifying and gathering information about the projects within an organization's cloud environment. This includes details such as project names, project IDs, project owners, and project permissions.

рдкрд░рд┐рдпреЛрдЬрдирд╛ рдЬрд╛рдБрдЪ рдореЗрдВ рд╕рдВрдЧрдарди рдХреЗ рдХреНрд▓рд╛рдЙрдб рдорд╛рд╣реМрд▓ рдореЗрдВ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХрд╛ рд╕рдореНрдорд┐рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдирд╛рдо, рдкрд░рд┐рдпреЛрдЬрдирд╛ рдЖрдИрдбреА, рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдорд╛рд▓рд┐рдХ рдФрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдЬреИрд╕реЗ рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред

### Service Account Enumeration

### рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдЬрд╛рдБрдЪ

Service account enumeration involves identifying and gathering information about the service accounts used within an organization's cloud environment. This includes details such as service account names, service account IDs, and the roles assigned to each service account.

рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдЬрд╛рдБрдЪ рдореЗрдВ рд╕рдВрдЧрдарди рдХреЗ рдХреНрд▓рд╛рдЙрдб рдорд╛рд╣реМрд▓ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕реЗрд╡рд╛ рдЦрд╛рддреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХрд╛ рд╕рдореНрдорд┐рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдХреЗ рдирд╛рдо, рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдЖрдИрдбреА рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд╡рд╛ рдЦрд╛рддреЗ рдХреЛ рд╕реМрдВрдкреЗ рдЧрдП рднреВрдорд┐рдХрд╛рдПрдВ рдЬреИрд╕реЗ рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред

### IAM Policy Enumeration

### IAM рдиреАрддрд┐ рдЬрд╛рдБрдЪ

IAM policy enumeration involves identifying and gathering information about the IAM (Identity and Access Management) policies within an organization's cloud environment. This includes details such as policy names, policy IDs, and the permissions granted by each policy.

IAM рдиреАрддрд┐ рдЬрд╛рдБрдЪ рдореЗрдВ рд╕рдВрдЧрдарди рдХреЗ рдХреНрд▓рд╛рдЙрдб рдорд╛рд╣реМрд▓ рдореЗрдВ IAM (рдкрд╣рдЪрд╛рди рдФрд░ рдкрд╣реБрдВрдЪ рдкреНрд░рдмрдВрдзрди) рдиреАрддрд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХрд╛ рд╕рдореНрдорд┐рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдиреАрддрд┐ рдХреЗ рдирд╛рдо, рдиреАрддрд┐ рдЖрдИрдбреА рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдиреАрддрд┐ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдЬреИрд╕реЗ рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред

### Bucket Enumeration

### рдмрдХреЗрдЯ рдЬрд╛рдБрдЪ

Bucket enumeration involves identifying and gathering information about the storage buckets within an organization's cloud environment. This includes details such as bucket names, bucket IDs, and the permissions assigned to each bucket.

рдмрдХреЗрдЯ рдЬрд╛рдБрдЪ рдореЗрдВ рд╕рдВрдЧрдарди рдХреЗ рдХреНрд▓рд╛рдЙрдб рдорд╛рд╣реМрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣ рдмрдХреЗрдЯреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХрд╛ рд╕рдореНрдорд┐рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдмрдХреЗрдЯ рдХреЗ рдирд╛рдо, рдмрдХреЗрдЯ рдЖрдИрдбреА рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдмрдХреЗрдЯ рдХреЛ рд╕реМрдВрдкреА рдЧрдИ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдЬреИрд╕реЗ рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред
```bash
# Get organizations
gcloud organizations list #The DIRECTORY_CUSTOMER_ID is the Workspace ID
gcloud resource-manager folders list --organization <org_number> # Get folders
gcloud projects list # Get projects
```
### рдореВрд▓рднреВрдд рдФрд░ IAM рдЬрд╛рдВрдЪ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ, рддреЛ **GCP рдЦрд╛рддреЗ рдХреЗ рдЕрдВрджрд░ рд╣рд░ рдПрдВрдЯрд┐рдЯреА рдХреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛** рдЖрдкрдХреЛ рд╕рдордЭрдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ рдХрд┐ рдЖрдк рдФрд░ рдЕрдиреНрдп рдкрд╣рдЪрд╛рди рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ **рдмрдврд╝рд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдХрд░реЗрдВред

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ IAM рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ **рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдХреЗ** рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╕рдордЭ рд╕рдХреЗрдВред\
рдЗрд╕рдореЗрдВ **рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="gcp-services/gcp-iam-and-org-policies-enum.md" %}
[gcp-iam-and-org-policies-enum.md](gcp-services/gcp-iam-and-org-policies-enum.md)
{% endcontent-ref %}

{% hint style="info" %}
рдЕрдм рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдЕрдкрдиреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рд╣реИ** (рдФрд░ рдпрджрд┐ рдЖрдк рдПрдХ рд░реЗрдб рдЯреАрдо рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ), рддреЛ рдпрд╣ рд╕рдордп рд╣реИ рдХрд┐ рдЖрдк рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдХрд┐ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХреМрди рд╕реА рд╕реЗрд╡рд╛рдПрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИрдВред\
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЦрдВрдб рдореЗрдВ рдЖрдк рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреА **рдЬрд╛рдВрдЪ рдХрд░рдиреЗ** рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
{% endhint %}

## рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ, рдкреЛрд╕реНрдЯ-рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди рдФрд░ рд╕реНрдерд╛рдпрд┐рддреНрд╡

GCP рдореЗрдВ рдЕрджреНрднреБрдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╕реЗрд╡рд╛рдПрдВ рд╣реИрдВ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ рдЖрдкрдХреЛ рдХреБрдЫ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА, рдЬрд╛рдВрдЪ** рдЪреАрдЯрд╢реАрдЯ, рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рддрд░реАрдХреЗ, рдкрд╣рдЪрд╛рди рдХреЛ **рдЫрд┐рдкрд╛рдиреЗ** рдХреЗ рддрд░реАрдХреЗ, **рд╕реНрдерд╛рдпрд┐рддреНрд╡** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдФрд░ рдЕрдиреНрдп **рдкреЛрд╕реНрдЯ-рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди** рдЯреНрд░рд┐рдХреНрд╕ рдорд┐рд▓реЗрдВрдЧреЗ:

{% content-ref url="gcp-services/" %}
[gcp-services](gcp-services/)
{% endcontent-ref %}

{% content-ref url="gcp-non-svc-persistance.md" %}
[gcp-non-svc-persistance.md](gcp-non-svc-persistance.md)
{% endcontent-ref %}

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдкрдХреЛ рд╕рднреА рдХрд╛рдо рдХреЛ **рдореИрдиреНрдпреБрдЕрд▓** рдирд╣реАрдВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЗ рдиреАрдЪреЗ рдЖрдкрдХреЛ [**рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдгреЛрдВ**](./#automatic-tools) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдЦрдВрдб рдорд┐рд▓реЗрдЧрд╛ред

рдЗрд╕ рдЪрд░рдг рдореЗрдВ, рдЖрдкрдиреЗ рд╢рд╛рдпрдж **рдЕрдирдЕрдереЗрдВрдЯрд┐рдХреЗрдЯреЗрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд╕реЗрд╡рд╛рдПрдВ** рдЦреЛрдЬ рд▓реА рд╣реЛрдВрдЧреА, рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╢рд╛рдпрдж рд╢реЛрдз рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="gcp-unauthenticated-enum/" %}
[gcp-unauthenticated-enum](gcp-unauthenticated-enum/)
{% endcontent-ref %}

## рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдирд╛

рдЬрдм рдЖрдкрдиреЗ рдХреБрдЫ рдХреНрд▓рд╛рдЙрдб рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рд╣реЛрдВ рдпрд╛ рдХреБрдЫ рд╕реЗрд╡рд╛ рдХреЛ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рд╣реЛ рдЬреЛ рдХрд┐ рдХреНрд▓рд╛рдЙрдб рдХреЗ рдЕрдВрджрд░ рдЪрд▓ рд░рд╣реА рд╣реЛ, рддреЛ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдЖрдкрдХреЛ рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдЦрд╛рддрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдкрд╣рд▓реА рдЪреАрдЬ рдЬреЛ рдЖрдкрдХреЛ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рд╡рд╣ рд╣реИ рдЕрдкрдиреА рдорд╛рдиреНрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЗ рджреМрд░рд╛рди рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдЕрдиреБрдорддрд┐рдпрд╛рдБ "рд╕рдВрдЧрдарди" рдХреЗ рд╕рдмрд╕реЗ рдЙрдЪреНрдЪ рд╕реНрддрд░ рдкрд░ рд╕реЗрдЯ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ** рднреАред

{% content-ref url="gcp-privilege-escalation/" %}
[gcp-privilege-escalation](gcp-privilege-escalation/)
{% endcontent-ref %}

## рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрднрд░реА рд╣реБрдИ рд╕реЗрд╡рд╛рдПрдВ

GCP рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╕рдордп рдЖрдкрдиреЗ рд╢рд╛рдпрдж рдХреБрдЫ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ **рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рддрддреНрд╡реЛрдВ рдХреЛ рдЙрднрд╛рд░рддреЗ** рд╣реБрдП рдкрд╛рдпрд╛ рд╣реЛрдЧрд╛ (VM/рдХрдВрдЯреЗрдирд░ рдкреЛрд░реНрдЯ, рдбреЗрдЯрд╛рдмреЗрд╕ рдпрд╛ рдХрддрд╛рд░ рд╕реЗрд╡рд╛рдПрдВ, рд╕реНрдиреИрдкрд╢реЙрдЯ рдпрд╛ рдмрдХреЗрдЯ... )ред\
рдкреЗрдВрдЯреЗрд╕реНрдЯрд░/рд░реЗрдб рдЯреАрдорд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдкрдХреЛ рд╣рдореЗрд╢рд╛ рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЙрдирдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА / рд╕рдВрдХрдЯрдХрд╛рд░рдХрддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдЖрдкрдХреЛ **AWS рдЦрд╛рддреЗ рдореЗрдВ рдЖрдЧреЗ рдХреА рдкрд╣реБрдВрдЪ** рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдкреБрд╕реНрддрдХ рдореЗрдВ рдЖрдкрдХреЛ **рдЬрд╛рдирдХрд╛рд░реА** рдорд┐рд▓реЗрдЧреА рдХрд┐ **рдЙрднрд░реА рд╣реБрдИ AWS рд╕реЗрд╡рд╛рдПрдВ рдХреИрд╕реЗ рдЦреЛрдЬреЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рдЬрд╛рдВрдЪреЗрдВ**ред рдЙрднрд░реА рд╣реБрдИ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ **рд╕рдВрдХрдЯрдХрд╛рд░рдХрддрд╛ рдЦреЛрдЬрдиреЗ** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореИрдВ рдЖрдкрдХреЛ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░реВрдВрдЧрд╛ рдХрд┐ рдЖрдк рд╡рд┐рд╢реЗрд╖ **рд╕реЗрд╡рд╛** рдХреЗ рд▓рд┐рдП **рдЦреЛрдЬреЗрдВ**:

{% embed url="https://book.hacktricks.xyz/" %}

## рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг

* **GCloud рдХрдВрд╕реЛрд▓** рдореЗрдВ, [https://console.cloud.google.com/iam-admin/asset-inventory/dashboard](https://console.cloud.google.com/iam-admin/asset-inventory/dashboard) рдкрд░ рдЖрдк рдкреНрд░реЛрдЬреЗрдХреНрдЯ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ IAM рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* рдпрд╣рд╛рдВ рдЖрдк рдЗрд╕ API рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: [https://cloud.google.com/asset-inventory/docs/supported-asset-types](https://cloud.google.com/asset-inventory/docs/supported-asset-types)
* рдЗрд╕ рд▓рд┐рдВрдХ рдкрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреМрди рд╕реЗ [**рдЙрдкрдХрд░рдг**](../pentesting-cloud-methodology.md) рдХрдИ рдХреНрд▓рд╛рдЙрдб рдореЗрдВ **рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред
* [**gcp\_scanner**](https://github.com/google/gcp\_scanner): рдпрд╣ рдПрдХ GCP рд╕рдВрд╕рд╛рдзрди рд╕реНрдХреИрдирд░ рд╣реИ рдЬреЛ GCP рдкрд░ рдХреБрдЫ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реА рдкреНрд░рдорд╛рдгрд┐рддрд╛ рдХрд┐рд╕реА рдЦрд╛рддреЗ рдкрд░ рд╣реИред
```bash
# Install
git clone https://github.com/google/gcp_scanner.git
cd gcp_scanner
virtualenv -p python3 venv
source venv/bin/activate
pip install -r requirements.txt
# Execute with gcloud creds
python3 __main__.py -o /tmp/output/ -g "$HOME/.config/gcloud"
```
* [**gcp\_enum**](https://gitlab.com/gitlab-com/gl-security/threatmanagement/redteam/redteam-public/gcp\_enum): рдПрдХ рдмреИрд╢ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЬреЛ gcloud cli рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ GCP environment рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рд╣реЗрдЬрддрд╛ рд╣реИред
* [**GCP-IAM-Privilege-Escalation**](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation): рдЙрдЪреНрдЪ IAM рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬрд╝ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ GCP рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (рдореИрдВрдиреЗ рдЬрд╛рдВрдЪ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЪрд▓рд╛рдиреЗ рдореЗрдВ рд╕рдлрд▓ рдирд╣реАрдВ рд╣реЛ рд╕рдХрд╛)ред

## gcloud config & debug
```bash
# Login so gcloud can use your credentials
gcloud auth login
gcloud config set project security-devbox
gcloud auth print-access-token

# Login so SDKs can use your user credentials
gcloud auth application-default login
gcloud auth application-default set-quota-project security-devbox
gcloud auth application-default print-access-token

# Update gcloud
gcloud components update
```
### рдЬреАрдХреНрд▓рд╛рдЙрдб, рдЬреАрдПрд╕рдпреВрдЯрд┐рд▓... рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдВ

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк **`gcloud`** рдХреНрд▓рд╛рдИ рдХреЗ рд╕рд╛рде **`--log-http`** **рдкреИрд░рд╛рдореАрдЯрд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреВрд▓ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ **рд░рд┐рдХреНрд╡реЗрд╕реНрдЯреНрд╕** рдХреЛ **рдкреНрд░рд┐рдВрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рд▓реЙрдЧ рдЯреЛрдХрди рдорд╛рди рдХреЛ рд░реЗрдбреИрдХреНрдЯ рди рдХрд░реЗрдВ, рддреЛ `gcloud config set log_http_redact_token false` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдВрдЪрд╛рд░ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:
```bash
gcloud config set proxy/address 127.0.0.1
gcloud config set proxy/port 8080
gcloud config set proxy/type http
gcloud config set auth/disable_ssl_validation True

# If you don't want to completely disable ssl_validation use:
gcloud config set core/custom_ca_certs_file cert.pem

# Back to normal
gcloud config unset proxy/address
gcloud config unset proxy/port
gcloud config unset proxy/type
gcloud config unset auth/disable_ssl_validation
gcloud config unset core/custom_ca_certs_file
```
## рд╕рдВрджрд░реНрдн

* [https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/](https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/)

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ рдкреАрдбреАрдПрдл рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХрд╛ рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**HackTricks**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред**

</details>
