# GCP - Απαρίθμηση Pub/Sub

<details>

<summary><strong>Μάθετε το hacking του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** με στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Μοιραστείτε τα hacking tricks σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Pub/Sub <a href="#reviewing-cloud-pubsub" id="reviewing-cloud-pubsub"></a>

Το [Google **Cloud Pub/Sub**](https://cloud.google.com/pubsub/) περιγράφεται ως ένας υπηρεσία που διευκολύνει την ανταλλαγή μηνυμάτων μεταξύ ανεξάρτητων εφαρμογών. Οι βασικές συστατικές περιλαμβάνουν **θέματα**, στα οποία οι εφαρμογές μπορούν να **εγγραφούν**. Οι εγγεγραμμένες εφαρμογές έχουν τη δυνατότητα να **στείλουν και να λάβουν μηνύματα**. Κάθε μήνυμα περιλαμβάνει το πραγματικό περιεχόμενο μαζί με τα σχετικά μεταδεδομένα.

Το **θέμα είναι η ουρά** στην οποία θα αποσταλούν τα μηνύματα, ενώ οι **εγγραφές** είναι τα **αντικείμενα** που οι χρήστες θα χρησιμοποιήσουν για να **έχουν πρόσβαση στα μηνύματα στα θέματα**. Μπορεί να υπάρχει περισσότερη από **1 εγγραφή ανά θέμα** και υπάρχουν 4 τύποι εγγραφών:

* **Pull**: Ο(ι) χρήστης(ες) αυτής της εγγραφής πρέπει να αναζητήσουν μηνύματα.
* **Push**: Υποδεικνύεται ένα URL endpoint και τα μηνύματα θα αποστέλλονται αμέσως σε αυτό.
* **Πίνακας Big query**: Όπως το push, αλλά τα μηνύματα τοποθετούνται μέσα σε έναν πίνακα Big query.
* **Cloud Storage**: Παράδοση μηνυμάτων απευθείας σε ένα υπάρχον κάδο αποθήκευσης.

Από προεπιλογή, μια εγγραφή λήγει μετά από 31 ημέρες, αν και μπορεί να οριστεί να μην λήγει ποτέ.

Από προεπιλογή, ένα μήνυμα διατηρείται για 7 ημέρες, αλλά αυτός ο χρόνος μπορεί να αυξηθεί έως και 31 ημέρες. Επίσης, εάν δεν γίνει **ACKed σε 10s**, επιστρέφεται στην ουρά. Μπορεί επίσης να οριστεί ότι τα ACKed μηνύματα πρέπει να συνεχίσουν να αποθηκεύονται.

Ένα θέμα κρυπτογραφείται από προεπιλογή χρησιμοποιώντας ένα **διαχειριζόμενο κλειδί κρυπτογράφησης της Google**. Ωστόσο, μπορεί επίσης να επιλεγεί ένα **CMEK** (Πελάτης Διαχειριζόμενο Κλειδί Κρυπτογράφησης) από το KMS.

**Νεκρό γράμμα**: Οι εγγραφές μπορούν να διαμορφώσουν ένα **μέγιστο αριθμό προσπαθειών παράδοσης**. Όταν ένα μήνυμα δεν μπορεί να παραδοθεί, επαναδημοσιεύεται στο καθορισμένο θέμα νεκρού γράμματος.

### Snapshots & Schemas

Ένα στιγμιότυπο είναι μια λειτουργία που **καταγράφει την κατάσταση μιας εγγραφής σε ένα συγκεκριμένο σημείο στο χρόνο**. Ουσιαστικά, είναι μια συνεπής **αντίγραφη ασφαλείας των μη αναγνωρισμένων μηνυμάτων σε μια εγγραφή**. Με τη δημιουργία ενός στιγμιότυπου, διατηρείτε την κατάσταση αναγνώρισης των μηνυμάτων της εγγραφής, επιτρέποντάς σας να συνεχίσετε την κατανάλωση μηνυμάτων από το σημείο που πραγματοποιήθηκε το στιγμιότυπο, ακόμη και αφού τα αρχικά μηνύματα θα είχαν διαγραφεί αλλιώς.\
Εάν έχετε πολύ τύχη, ένα στιγμιότυπο μπορεί να περιέχει **παλιές ευαίσθητες πληροφορίες** από τη στιγμή που πραγματοποιήθηκε το στιγμιότυπο.

Κατά τη δημιουργία ενός θέματος, μπορείτε να υποδείξετε ότι τα **μηνύματα του θέματος πρέπει να ακολουθούν ένα σχήμα**.

### Απαρίθμηση
```bash
# Get a list of topics in the project
gcloud pubsub topics list
gcloud pubsub topics describe <topic>
gcloud pubsub topics list-subscriptions <topic>
gcloud pubsub topics get-iam-policy <topic>

# Get a list of subscriptions across all topics
gcloud pubsub subscriptions list
gcloud pubsub subscriptions describe <subscription>
gcloud pubsub subscriptions get-iam-policy <subscription>

# Get list of schemas
gcloud pubsub schemas list
gcloud pubsub schemas describe <schema>
gcloud pubsub schemas list-revisions <schema>

# Get list of snapshots
gcloud pubsub snapshots list
gcloud pubsub snapshots describe <snapshot>
```
Ωστόσο, μπορείτε να έχετε καλύτερα αποτελέσματα [**ζητώντας ένα μεγαλύτερο σύνολο δεδομένων**](https://cloud.google.com/pubsub/docs/replay-overview), συμπεριλαμβανομένων παλαιότερων μηνυμάτων. Αυτό έχει ορισμένες προϋποθέσεις και μπορεί να επηρεάσει τις εφαρμογές, οπότε βεβαιωθείτε ότι πραγματικά ξέρετε τι κάνετε.

### Επέκταση Προνομίων & Μετά την Εκμετάλλευση

{% content-ref url="../gcp-post-exploitation/gcp-pub-sub-post-exploitation.md" %}
[gcp-pub-sub-post-exploitation.md](../gcp-post-exploitation/gcp-pub-sub-post-exploitation.md)
{% endcontent-ref %}

## Pub/Sub Lite

Το [**Pub/Sub Lite**](https://cloud.google.com/pubsub/docs/choosing-pubsub-or-lite) είναι ένα υπηρεσία ανταλλαγής μηνυμάτων με **ζωνική αποθήκευση**. Το Pub/Sub Lite **κοστίζει ένα κλάσμα** του Pub/Sub και προορίζεται για **υψηλό όγκο ροής** (έως 10 εκατομμύρια μηνύματα ανά δευτερόλεπτο) αγωγούς και συστήματα που λειτουργούν με βάση τα γεγονότα, όπου το χαμηλό κόστος είναι η κύρια σκέψη.

Στο Pub/Sub Lite υπάρχουν **θέματα** και **συνδρομές**, δεν υπάρχουν **αντίγραφα ασφαλείας** και **σχήματα** και υπάρχουν:

* **Κρατήσεις**: Οι Κρατήσεις του Pub/Sub Lite είναι μια δυνατότητα που επιτρέπει στους χρήστες να κρατούν χωρητικότητα σε μια συγκεκριμένη περιοχή για τα ροές των μηνυμάτων τους.
* **Λειτουργίες**: Αναφέρεται στις ενέργειες και τις εργασίες που συνδέονται με τη διαχείριση και τη διαχείριση του Pub/Sub Lite.

### Απαρίθμηση
```bash
# lite-topics
gcloud pubsub lite-topics list
gcloud pubsub lite-topics describe <topic>
gcloud pubsub lite-topics list-subscriptions <topic>

# lite-subscriptions
gcloud pubsub lite-subscriptions list
gcloud pubsub lite-subscriptions describe <subscription>

# lite-reservations
gcloud pubsub lite-reservations list
gcloud pubsub lite-reservations describe <topic>
gcloud pubsub lite-reservations list-topics <topic>

# lite-operations
gcloud pubsub lite-operations list
gcloud pubsub lite-operations describe <topic>
```
<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** με στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
