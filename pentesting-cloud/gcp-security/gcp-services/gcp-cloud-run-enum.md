# GCP - Enumerazione di Cloud Run

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team di HackTricks AWS)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**Gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run √® una piattaforma di calcolo gestita serverless che ti consente di **eseguire container** direttamente sull'infrastruttura scalabile di Google.

Puoi eseguire il tuo container o Se stai utilizzando Go, Node.js, Python, Java, .NET Core o Ruby, puoi utilizzare l'opzione di [deploy basata sul codice sorgente](https://cloud.google.com/run/docs/deploying-source-code) che **costruisce il container per te.**

Google ha sviluppato Cloud Run per **funzionare bene insieme ad altri servizi su Google Cloud**, quindi puoi costruire applicazioni complete.

### Servizi e lavori <a href="#services-and-jobs" id="services-and-jobs"></a>

Su Cloud Run, il tuo codice pu√≤ essere eseguito continuamente come un _**servizio**_ o come un _**lavoro**_. Sia i servizi che i lavori vengono eseguiti nello stesso ambiente e possono utilizzare le stesse integrazioni con altri servizi su Google Cloud.

* **Servizi Cloud Run.** Utilizzati per eseguire codice che risponde a richieste web o eventi.
* **Lavori Cloud Run.** Utilizzati per eseguire codice che svolge un lavoro e si interrompe quando il lavoro √® completato.

## Servizio Cloud Run

Google [Cloud Run](https://cloud.google.com/run) √® un'altra offerta serverless dove √® possibile cercare variabili d'ambiente. Cloud Run crea un piccolo server web, in esecuzione sulla porta 8080 all'interno del container per impostazione predefinita, che rimane in attesa di una richiesta HTTP GET. Quando la richiesta viene ricevuta, viene eseguito un lavoro e il log del lavoro viene restituito tramite una risposta HTTP.

### Dettagli rilevanti

* Per **default**, l'**accesso** al server web √® **pubblico**, ma pu√≤ anche essere **limitato al traffico interno** (VPC...)\
Inoltre, l'**autenticazione** per contattare il server web pu√≤ essere **consentita a tutti** o **richiedere l'autenticazione tramite IAM**.
* Per impostazione predefinita, la **crittografia** utilizza una **chiave gestita da Google**, ma pu√≤ anche essere scelta una **CMEK** (Chiave di Crittografia Gestita dal Cliente) da **KMS**.
* Per impostazione predefinita, l'**account di servizio** utilizzato √® quello **predefinito di Compute Engine** che ha accesso **Editor** sul progetto e ha lo **scope `cloud-platform`.**
* √à possibile definire **variabili d'ambiente in testo normale** per l'esecuzione e persino **montare segreti cloud** o **aggiungere segreti cloud alle variabili d'ambiente.**
* √à anche possibile **aggiungere connessioni con Cloud SQL** e **montare un file system.**
* Gli **URL** dei servizi distribuiti sono simili a **`https://<svc-name>-<random>.a.run.app`**
* Un Servizio Run pu√≤ avere **pi√π di 1 versione o revisione**, e **dividere il traffico** tra diverse revisioni.

### Enumerazione
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Lavori di Cloud Run

I lavori di Cloud Run sono pi√π adatti per **contenitori che vengono eseguiti fino al completamento e non gestiscono richieste**. I lavori non hanno la capacit√† di gestire richieste o ascoltare su una porta. Ci√≤ significa che, a differenza dei servizi di Cloud Run, i lavori non dovrebbero includere un server web. Invece, i contenitori dei lavori dovrebbero terminare quando hanno finito.

### Enumerazione
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Escalazione dei privilegi

Nella seguente pagina, puoi controllare come **abusare dei permessi di Cloud Run per escalare i privilegi**:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Accesso non autenticato

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Post Esploitation

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Persistenza

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Riferimenti

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

<details>

<summary><strong>Impara l'hacking su AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
