# GCP - Cloud Run Enum

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run ni jukwaa la kuhesabu lililosimamiwa kiserverless ambalo linakuruhusu **kuendesha makontena** moja kwa moja juu ya miundombinu inayoweza kupanuliwa ya Google.

Unaweza kuendesha kontena yako au Ikiwa unatumia Go, Node.js, Python, Java, .NET Core, au Ruby, unaweza kutumia chaguo la [kupeleka msingi wa chanzo](https://cloud.google.com/run/docs/deploying-source-code) ambayo **inajenga kontena kwako.**

Google imejenga Cloud Run ili **ifanye kazi vizuri pamoja na huduma zingine kwenye Google Cloud**, hivyo unaweza kujenga programu kamili zenye huduma nyingi.

### Huduma na kazi <a href="#services-and-jobs" id="services-and-jobs"></a>

Kwenye Cloud Run, namna yako ya kificho inaweza kuendeshwa kwa muda mrefu kama _**huduma**_ au kama _**kazi**_. Huduma na kazi zote zinaendeshwa kwenye mazingira sawa na zinaweza kutumia ushirikiano sawa na huduma zingine kwenye Google Cloud.

* **Huduma za Cloud Run.** Hutumiwa kuendesha kificho kinachojibu maombi ya wavuti, au matukio.
* **Kazi za Cloud Run.** Hutumiwa kuendesha kificho kinachotekeleza kazi (kazi) na kuacha wakati kazi imekamilika.

## Huduma ya Cloud Run

Google [Cloud Run](https://cloud.google.com/run) ni kutoa kinga nyingine ambapo unaweza kutafuta mazingira ya mazingira pia. Cloud Run inajenga seva ndogo ya wavuti, inayoendesha kwenye bandari 8080 kwa chaguo-msingi ndani ya kontena, ambayo inasubiri ombi la HTTP GET. Ombi linapopokelewa, kazi inatekelezwa na kumbukumbu ya kazi inatoa kupitia jibu la HTTP.

### Maelezo yanayofaa

* Kwa **chaguo-msingi**, **upatikanaji** wa seva ya wavuti ni **wa umma**, lakini pia unaweza kuwa **mdogo kwa trafiki ya ndani** (VPC...)\
Zaidi ya hayo, **uthibitisho** wa kuwasiliana na seva ya wavuti unaweza kuwa **kuruhusu wote** au **kuhitaji uthibitisho kupitia IAM**.
* Kwa chaguo-msingi, **enkripsi** hutumia **ufunguo uliosimamiwa na Google**, lakini **CMEK** (Ufunguo wa Ufundi wa Ufundi wa Mteja) kutoka **KMS** pia unaweza **kuchaguliwa**.
* Kwa **chaguo-msingi**, akaunti ya **huduma** inayotumiwa ni **ile ya kawaida ya Compute Engine** ambayo ina **upatikanaji wa Mhariri** juu ya mradi na ina **wigo `cloud-platform`.**
* Ni sawa kufafanua **mazingira ya maandishi wazi** kwa utekelezaji, na hata **kufunga siri za wingu** au **kuongeza siri za wingu kwa mazingira ya mazingira.**
* Pia ni sawa **kuongeza uhusiano na Cloud SQL** na **kufunga mfumo wa faili.**
* **URLs** za huduma zilizopelekwa ni sawa na **`https://<jina-la-huduma>-<random>.a.run.app`**
* Huduma ya Run inaweza kuwa na **zaidi ya toleo 1 au marekebisho**, na **kugawa trafiki** kati ya marekebisho kadhaa.

### Uchambuzi
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Kazi za Cloud Run

Kazi za Cloud Run zinafaa zaidi kwa **makontena ambayo hufanya kazi hadi kukamilika na hayahudumii maombi**. Kazi hazina uwezo wa kuhudumia maombi au kusikiliza kwenye bandari. Hii inamaanisha kwamba tofauti na huduma za Cloud Run, kazi hazipaswi kuwa na seva ya wavuti. Badala yake, makontena ya kazi yanapaswa kufunga wanapomaliza kazi zao.

### Uorodheshaji
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Upandishaji wa Mamlaka

Kwenye ukurasa ufuatao, unaweza kuangalia jinsi ya **kutumia ruhusa za cloud run kwa upandishaji wa mamlaka**:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Upatikanaji usiothibitishwa

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Baada ya Kudukuliwa

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Uthabiti

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Marejeo

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
