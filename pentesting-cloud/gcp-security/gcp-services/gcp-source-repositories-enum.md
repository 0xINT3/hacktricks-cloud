# GCP - Enumera√ß√£o de Reposit√≥rios de C√≥digo Fonte

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga**-me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informa√ß√µes B√°sicas <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

O Google Cloud Source Repositories √© um servi√ßo de reposit√≥rio Git privado, completo e escal√°vel. Ele foi projetado para **hospedar seu c√≥digo-fonte em um ambiente totalmente gerenciado**, integrando-se perfeitamente com outras ferramentas e servi√ßos do GCP. Oferece um local colaborativo e seguro para equipes armazenarem, gerenciarem e acompanharem seu c√≥digo.

Principais caracter√≠sticas dos Cloud Source Repositories incluem:

1. **Hospedagem Git Totalmente Gerenciada**: Oferece a funcionalidade familiar do Git, o que significa que voc√™ pode usar comandos e fluxos de trabalho regulares do Git.
2. **Integra√ß√£o com Servi√ßos GCP**: Integra-se com outros servi√ßos do GCP como Cloud Build, Pub/Sub e App Engine para rastreabilidade completa do c√≥digo at√© o deployment.
3. **Reposit√≥rios Privados**: Garante que seu c√≥digo seja armazenado de forma segura e privada. Voc√™ pode controlar o acesso usando pap√©is do Cloud Identity and Access Management (IAM).
4. **An√°lise de C√≥digo-Fonte**: Trabalha com outras ferramentas do GCP para fornecer an√°lise automatizada do seu c√≥digo-fonte, identificando problemas potenciais como bugs, vulnerabilidades ou pr√°ticas ruins de codifica√ß√£o.
5. **Ferramentas de Colabora√ß√£o**: Suporta codifica√ß√£o colaborativa com ferramentas como solicita√ß√µes de merge, coment√°rios e revis√µes.
6. **Suporte a Espelhamento**: Permite conectar os Cloud Source Repositories com reposit√≥rios hospedados no GitHub ou Bitbucket, possibilitando sincroniza√ß√£o autom√°tica e fornecendo uma vis√£o unificada de todos os seus reposit√≥rios.

### Informa√ß√µes de OffSec <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

* A configura√ß√£o dos reposit√≥rios de c√≥digo-fonte dentro de um projeto ter√° uma **Conta de Servi√ßo** usada para publicar mensagens do Cloud Pub/Sub. A padr√£o utilizada √© a **Compute SA**. No entanto, **n√£o acredito que seja poss√≠vel roubar seu token** dos Reposit√≥rios de C√≥digo-Fonte, pois ele √© executado em segundo plano.
* Para ver o c√≥digo dentro do console web do GCP Cloud Source Repositories ([https://source.cloud.google.com/](https://source.cloud.google.com/)), √© necess√°rio que o c√≥digo esteja **dentro da branch master por padr√£o**.
* Voc√™ tamb√©m pode **criar um reposit√≥rio Cloud espelho** apontando para um reposit√≥rio do **Github** ou **Bitbucket** (dando acesso a essas plataformas).
* √â poss√≠vel **codificar e depurar dentro do GCP**.
* Por padr√£o, os Reposit√≥rios de C√≥digo-Fonte **impedem que chaves privadas sejam enviadas em commits**, mas isso pode ser desativado.

### Abrir no Cloud Shell

√â poss√≠vel abrir o reposit√≥rio no Cloud Shell, um prompt como este aparecer√°:

<figure><img src="../../../.gitbook/assets/image (136).png" alt=""><figcaption></figcaption></figure>

Isso permitir√° que voc√™ codifique e depure no Cloud Shell (o que poderia comprometer o cloudshell).

### Enumera√ß√£o

{% code overflow="wrap" %}
```bash
# Repos enumeration
gcloud source repos list #Get names and URLs
gcloud source repos describe <repo_name>
gcloud source repos get-iam-policy <repo_name>

# gcloud repo clone
gcloud source repos clone <REPO NAME>
gcloud source repos get-iam-policy <REPO NAME>
... git add & git commit -m ...
git push --set-upstream origin master
git push -u origin master

# Access via git
## To add a SSH key go to https://source.cloud.google.com/user/ssh_keys (no gcloud command)
git clone ssh://username@domain.com@source.developers.google.com:2022/p/<proj-name>/r/<repo-name>
git add, commit, push...
```
```markdown
{% endcode %}

### Escalonamento de Privil√©gios & P√≥s-Explora√ß√£o

{% content-ref url="../../gcp-pentesting/gcp-privilege-escalation/gcp-sourcerepos-privesc.md" %}
[gcp-sourcerepos-privesc.md](../../gcp-pentesting/gcp-privilege-escalation/gcp-sourcerepos-privesc.md)
{% endcontent-ref %}

### Enumera√ß√£o N√£o Autenticada

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md" %}
[gcp-source-repositories-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md)
{% endcontent-ref %}

<details>

<summary><strong>Aprenda hacking em AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
```
