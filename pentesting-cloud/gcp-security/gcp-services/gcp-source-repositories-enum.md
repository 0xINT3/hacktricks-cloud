# GCP - Wyliczanie repozytoriów źródłowych

<details>

<summary><strong>Dowiedz się, jak hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** mnie na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Podstawowe informacje <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

Google Cloud Source Repositories to w pełni funkcjonalna, skalowalna **usługa prywatnego repozytorium Git**. Została zaprojektowana do **hostowania kodu źródłowego w w pełni zarządzanym środowisku**, łącząc się bezproblemowo z innymi narzędziami i usługami GCP. Oferuje współpracę i bezpieczne miejsce dla zespołów do przechowywania, zarządzania i śledzenia ich kodu.

Główne cechy Cloud Source Repositories to:

1. **Zarządzanie Git w pełni zarządzane**: Oferuje funkcjonalność znana z Git, co oznacza, że można używać standardowych poleceń i procesów Git.
2. **Integracja z usługami GCP**: Integruje się z innymi usługami GCP, takimi jak Cloud Build, Pub/Sub i App Engine, zapewniając pełne śledzenie od kodu do wdrożenia.
3. **Prywatne repozytoria**: Zapewnia bezpieczne i prywatne przechowywanie kodu. Można kontrolować dostęp za pomocą ról Cloud Identity and Access Management (IAM).
4. **Analiza kodu źródłowego**: Współpracuje z innymi narzędziami GCP, aby zapewnić automatyczną analizę kodu źródłowego, identyfikując potencjalne problemy, takie jak błędy, podatności lub złe praktyki kodowania.
5. **Narzędzia do współpracy**: Obsługuje współpracę w kodowaniu za pomocą narzędzi takich jak prośby o scalenie, komentarze i recenzje.
6. **Wsparcie dla lustrzanek**: Pozwala na połączenie Cloud Source Repositories z repozytoriami hostowanymi na GitHub lub Bitbucket, umożliwiając automatyczną synchronizację i zapewniając jednolite widoki wszystkich repozytoriów.

### Informacje OffSec <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

* Konfiguracja repozytoriów źródłowych wewnątrz projektu będzie miała **Konto usługi** używane do publikowania wiadomości Cloud Pub/Sub. Domyślnie używane jest **Konto usługi Compute**. Jednak **nie sądzę, że jest możliwe kradzież jego tokena** z repozytoriów źródłowych, ponieważ jest on wykonywany w tle.
* Aby zobaczyć kod w konsoli internetowej GCP Cloud Source Repositories ([https://source.cloud.google.com/](https://source.cloud.google.com/)), kod musi być **domyślnie w gałęzi master**.
* Można również **utworzyć lustrzane repozytorium Cloud** skierowane do repozytorium z **Githuba** lub **Bitbucketa** (umożliwiające dostęp do tych platform).
* Możliwe jest **kodowanie i debugowanie wewnątrz GCP**.
* Domyślnie, Source Repositories **zapobiega dodawaniu prywatnych kluczy do commitów**, ale można to wyłączyć.

### Otwórz w Cloud Shell

Możliwe jest otwarcie repozytorium w Cloud Shell, pojawi się taki monit:

<figure><img src="../../../.gitbook/assets/image (136).png" alt=""><figcaption></figcaption></figure>

Dzięki temu można kodować i debugować w Cloud Shell (co może prowadzić do kompromitacji cloudshell).

### Wyliczanie

{% code overflow="wrap" %}
```bash
# Repos enumeration
gcloud source repos list #Get names and URLs
gcloud source repos describe <repo_name>
gcloud source repos get-iam-policy <repo_name>

# gcloud repo clone
gcloud source repos clone <REPO NAME>
gcloud source repos get-iam-policy <REPO NAME>
... git add & git commit -m ...
git push --set-upstream origin master
git push -u origin master

# Access via git
## To add a SSH key go to https://source.cloud.google.com/user/ssh_keys (no gcloud command)
git clone ssh://username@domain.com@source.developers.google.com:2022/p/<proj-name>/r/<repo-name>
git add, commit, push...
```
### Eskalacja uprawnień i wykorzystanie po włamaniu

{% content-ref url="../../gcp-pentesting/gcp-privilege-escalation/gcp-sourcerepos-privesc.md" %}
[gcp-sourcerepos-privesc.md](../../gcp-pentesting/gcp-privilege-escalation/gcp-sourcerepos-privesc.md)
{% endcontent-ref %}

### Nieuwierzytelnione wyliczanie

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md" %}
[gcp-source-repositories-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md)
{% endcontent-ref %}

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** mnie na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
