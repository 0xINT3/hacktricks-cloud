# GCP - 소스 저장소 열거

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)을 **팔로우**하세요.
* **Hacking 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>

## 기본 정보 <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

Google Cloud Source Repositories는 완전한 기능을 갖춘 확장 가능한 **개인 Git 저장소 서비스**입니다. 이 서비스는 다른 GCP 도구와 서비스와 완벽하게 통합되어 **소스 코드를 완전히 관리되는 환경에 호스팅**할 수 있도록 설계되었습니다. 팀이 코드를 저장, 관리 및 추적할 수 있는 협업적이고 안전한 장소를 제공합니다.

Cloud Source Repositories의 주요 기능은 다음과 같습니다:

1. **완전 관리형 Git 호스팅**: 일반적인 Git 명령과 워크플로우를 사용할 수 있도록 Git의 익숙한 기능을 제공합니다.
2. **GCP 서비스와의 통합**: 코드에서 배포까지의 end-to-end 추적을 위해 Cloud Build, Pub/Sub 및 App Engine과 같은 다른 GCP 서비스와 통합됩니다.
3. **개인 저장소**: 코드가 안전하고 개인적으로 저장되도록 보장합니다. Cloud Identity 및 Access Management (IAM) 역할을 사용하여 액세스를 제어할 수 있습니다.
4. **소스 코드 분석**: 다른 GCP 도구와 함께 작동하여 소스 코드를 자동으로 분석하고 버그, 취약점 또는 잘못된 코딩 관행과 같은 잠재적인 문제를 식별합니다.
5. **협업 도구**: 병합 요청, 코멘트 및 리뷰와 같은 도구를 사용하여 협업적인 코딩을 지원합니다.
6. **미러 지원**: GitHub 또는 Bitbucket에 호스팅된 저장소와 Cloud Source Repositories를 연결하여 자동 동기화를 가능하게 하고 모든 저장소의 통합된 뷰를 제공할 수 있습니다.

### OffSec 정보 <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

* 프로젝트 내부의 소스 저장소 구성에는 Cloud Pub/Sub 메시지를 게시하는 데 사용되는 **서비스 계정**이 있습니다. 기본적으로 사용되는 것은 **Compute SA**입니다. 그러나 소스 저장소에서 토큰을 훔칠 수 있는지는 잘 모르겠습니다.
* GCP Cloud Source Repositories 웹 콘솔([https://source.cloud.google.com/](https://source.cloud.google.com/))에서 코드를 보려면 코드가 기본적으로 **마스터 브랜치에 있어야 합니다**.
* **Github** 또는 **Bitbucket**의 저장소를 가리키는 **미러 Cloud Repository**를 생성할 수도 있습니다(해당 플랫폼에 대한 액세스 권한이 필요합니다).
* GCP 내부에서 **코드 및 디버깅**이 가능합니다.
* 기본적으로 Source Repositories는 커밋에 개인 키를 푸시하는 것을 방지하지만, 이 기능을 비활성화할 수 있습니다.

### Cloud Shell에서 열기

Cloud Shell에서 저장소를 열 수 있으며, 다음과 같은 프롬프트가 나타납니다:

<figure><img src="../../../.gitbook/assets/image (136).png" alt=""><figcaption></figcaption></figure>

이를 통해 Cloud Shell에서 코드를 작성하고 디버깅할 수 있습니다(Cloud Shell이 침해될 수 있음).

### 열거

{% code overflow="wrap" %}
```bash
# Repos enumeration
gcloud source repos list #Get names and URLs
gcloud source repos describe <repo_name>
gcloud source repos get-iam-policy <repo_name>

# gcloud repo clone
gcloud source repos clone <REPO NAME>
gcloud source repos get-iam-policy <REPO NAME>
... git add & git commit -m ...
git push --set-upstream origin master
git push -u origin master

# Access via git
## To add a SSH key go to https://source.cloud.google.com/user/ssh_keys (no gcloud command)
git clone ssh://username@domain.com@source.developers.google.com:2022/p/<proj-name>/r/<repo-name>
git add, commit, push...
```
{% endcode %}

### 권한 상승 및 사후 침투

{% content-ref url="../../gcp-pentesting/gcp-privilege-escalation/gcp-sourcerepos-privesc.md" %}
[gcp-sourcerepos-privesc.md](../../gcp-pentesting/gcp-privilege-escalation/gcp-sourcerepos-privesc.md)
{% endcontent-ref %}

### 인증되지 않은 열거

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md" %}
[gcp-source-repositories-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md)
{% endcontent-ref %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**을** **팔로우**하세요.
* **HackTricks**와 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>
