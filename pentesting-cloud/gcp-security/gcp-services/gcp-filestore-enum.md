# GCP - Απαρίθμηση Filestore

<details>

<summary><strong>Μάθετε το hacking του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** με στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Μοιραστείτε τα hacking tricks σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Βασικές Πληροφορίες

Το Google Cloud Filestore περιγράφεται ως ένα **υπηρεσία διαχείρισης αποθήκευσης αρχείων** που προσαρμόζεται για εφαρμογές που χρειάζονται τόσο μια **διεπαφή αρχείου όσο και μια κοινόχρηστη αρχειοθήκη για δεδομένα**. Αυτή η υπηρεσία ξεχωρίζει προσφέροντας υψηλής απόδοσης κοινόχρηστες αρχειοθήκες, οι οποίες μπορούν να ενσωματωθούν με διάφορες υπηρεσίες GCP. Η χρησιμότητά της λάμπει σε σενάρια όπου οι παραδοσιακές διεπαφές αρχείου και σημασιολογία είναι κρίσιμες, όπως στην επεξεργασία πολυμέσων, τη διαχείριση περιεχομένου και το backup των βάσεων δεδομένων.

Μπορείτε να το σκεφτείτε όπως οποιαδήποτε άλλη **κοινόχρηστη αποθετήριο εγγράφων NFS** - ένας δυνητικός πηγή ευαίσθητων πληροφοριών.

### Συνδέσεις

Όταν δημιουργείτε μια περίπτωση Filestore είναι δυνατόν να **επιλέξετε το δίκτυο όπου θα είναι προσβάσιμο**.

Επιπλέον, **από προεπιλογή όλοι οι πελάτες στο επιλεγμένο δίκτυο VPC και περιοχή θα μπορούν να το προσπελάσουν**, ωστόσο, είναι δυνατόν να **περιοριστεί η πρόσβαση και από διευθύνσεις IP** ή εύρος και να υποδειχθεί το προνόμιο πρόσβασης (Διαχειριστής, Προβολέας Διαχειριστή, Επεξεργαστής, Προβολέας) που θα λάβει ο πελάτης **ανάλογα με τη διεύθυνση IP**.

Μπορεί επίσης να είναι προσβάσιμο μέσω μιας **Σύνδεσης Πρόσβασης Ιδιωτικής Υπηρεσίας:**

* Είναι ανά δίκτυο VPC και μπορούν να χρησιμοποιηθούν σε όλες τις διαχειριζόμενες υπηρεσίες, όπως η Memorystore, η Tensorflow και η SQL.
* Είναι **μεταξύ του δικτύου VPC σας και του δικτύου που ανήκει στη Google χρησιμοποιώντας μια διασύνδεση VPC peering**, επιτρέποντας στις περιπτώσεις και τις υπηρεσίες σας να επικοινωνούν αποκλειστικά με **εσωτερικές διευθύνσεις IP**.
* Δημιουργεί ένα απομονωμένο έργο για εσάς στην πλευρά του παραγωγού υπηρεσίας, πράγμα που σημαίνει ότι δεν το μοιράζεστε με άλλους πελάτες. Θα χρεωθείτε μόνο για τους πόρους που παρέχετε.
* Το VPC peering θα εισάγει νέες διαδρομές στο VPC σας

### Αντίγραφα Ασφαλείας

Είναι δυνατόν να δημιουργήσετε **αντίγραφα ασφαλείας των κοινόχρηστων αρχείων**. Αυτά μπορούν να αποκατασταθούν αργότερα στην αρχική νέα περίπτωση Fileshare ή σε **νέες περιπτώσεις**.

### Κρυπτογράφηση

Από προεπιλογή θα χρησιμοποιηθεί ένα **κλειδί κρυπτογράφησης που διαχειρίζεται η Google** για την κρυπτογράφηση των δεδομένων, αλλά είναι δυνατόν να επιλέξετε ένα **κλειδί κρυπτογράφησης που διαχειρίζεται ο πελάτης (CMEK)**.

### Απαρίθμηση

Εάν βρείτε ένα διαθέσιμο filestore στο έργο, μπορείτε να το **προσαρτήσετε** από τον περιορισμένο υπολογιστικό σας πόρο. Χρησιμοποιήστε την παρακάτω εντολή για να δείτε αν υπάρχει κάποιο. 

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
Σημειώστε ότι ένα υπηρεσία filestore μπορεί να βρίσκεται σε ένα **εντελώς νέο υποδίκτυο που δημιουργήθηκε για αυτό** (μέσα σε μια Σύνδεση Πρόσβασης Ιδιωτικής Υπηρεσίας, η οποία είναι μια **VPC peer**).\
Έτσι, μπορεί να χρειαστεί να **απαριθμήσετε τις VPC peers** για να εκτελέσετε επίσης το nmap σε αυτά τα εύρη δικτύου.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
{% endcode %}
{% endhint %}

### Επέκταση Προνομίων & Μετα-Εκμετάλλευση

Δεν υπάρχουν τρόποι για να επεκτείνετε τα προνόμια στο GCP απευθείας καταχρώντας αυτήν την υπηρεσία, αλλά χρησιμοποιώντας μερικά **κόλπα μετα-εκμετάλλευσης είναι δυνατόν να αποκτήσετε πρόσβαση στα δεδομένα** και ίσως να βρείτε κάποια διαπιστευτήρια για να επεκτείνετε τα προνόμια:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### Μόνιμη Παραμονή

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Μάθετε το hacking του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** με στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Μοιραστείτε τα κόλπα σας για το hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
