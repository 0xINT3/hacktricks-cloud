# GCP - Filestore Enum

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne informacije

Google Cloud Filestore je opisan kao **upravljana usluga za skladištenje fajlova** prilagođena aplikacijama koje zahtevaju i **interfejs fajl sistema i deljeni fajl sistem za podatke**. Ova usluga se ističe pružanjem visokoperformantnih deljenih fajlova, koji se mogu integrisati sa raznim GCP uslugama. Njegova korisnost dolazi do izražaja u scenarijima gde su tradicionalni interfejsi i semantika fajl sistema ključni, kao što su obrada medija, upravljanje sadržajem i bekapovanje baza podataka.

Možete razmišljati o ovome kao o bilo kojem drugom **NFS** **deljenom repozitorijumu dokumenata** - potencijalnom izvoru osetljivih informacija.

### Veze

Prilikom kreiranja Filestore instance moguće je **izabrati mrežu preko koje će biti dostupna**.

Osim toga, **podrazumevano će svi klijenti na izabranoj VPC mreži i regionu moći da joj pristupe**, međutim, moguće je **ograničiti pristup i po IP adresi** ili opsegu i naznačiti privilegiju pristupa (Admin, Admin Viewer, Editor, Viewer) koju će klijent dobiti **u zavisnosti od IP adrese**.

Takođe, može biti dostupna putem **Private Service Access Connection-a**:

* Određeni su po VPC mreži i mogu se koristiti sa svim upravljanim uslugama kao što su Memorystore, Tensorflow i SQL.
* Između vaše VPC mreže i mreže koju poseduje Google koristeći VPC peering, omogućavajući vašim instancama i uslugama da komuniciraju isključivo **koristeći interne IP adrese**.
* Kreiraju izolovan projekat za vas sa strane proizvođača usluge, što znači da ga ne delite sa drugim korisnicima. Bićete naplaćeni samo za resurse koje obezbedite.
* VPC peering će uvesti nove rute u vašu VPC

### Bekapovi

Moguće je kreirati **bekapove deljenih fajlova**. Oni se mogu kasnije **obnoviti na izvornom** novom Fileshare instancom ili na **novim instancama**.

### Enkripcija

Podrazumevano će se koristiti **Google-om upravljani ključ za enkripciju** podataka, ali moguće je izabrati **korisnički upravljani ključ za enkripciju (CMEK)**.

### Enumeracija

Ako pronađete dostupan filestore u projektu, možete ga **montirati** unutar kompromitovane Compute Instance. Koristite sledeću komandu da biste videli da li postoji neki.

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
Imajte na umu da bi usluga filestore mogla biti u **potpuno novoj podmreži koja je kreirana za nju** (unutar privatne veze za pristup usluzi, koja je **VPC peer**).\
Stoga možda ćete morati **izlistati VPC peere** kako biste takođe pokrenuli nmap nad tim mrežnim opsezima.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
{% endcode %}
{% endhint %}

### Eskalacija privilegija i post eksploatacija

Nema načina da se eskaliraju privilegije u GCP direktno zloupotrebljavajući ovu uslugu, ali korišćenjem nekih **trikova post eksploatacije moguće je dobiti pristup podacima** i možda pronaći neke akreditive za eskalaciju privilegija:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### Upornost

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini da podržite HackTricks:

* Ako želite da vidite **vašu kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
