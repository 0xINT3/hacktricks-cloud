# GCP - Filestore Enum

<details>

<summary><strong>Jifunze kuhack AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **fuata** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Taarifa Msingi

Google Cloud Filestore inaelezwa kama **huduma ya uhifadhi wa faili iliyosimamiwa** iliyoundwa kwa maombi yanayohitaji **interface ya mfumo wa faili na mfumo wa faili ulioshirikiwa kwa data**. Huduma hii ina faida kwa kutoa hisa za faili zenye utendaji wa hali ya juu, ambazo zinaweza kuingizwa na huduma mbalimbali za GCP. Matumizi yake yanang'aa katika hali ambapo interface za mfumo wa faili za jadi na semantiki ni muhimu, kama vile katika usindikaji wa media, usimamizi wa maudhui, na nakala rudufu za maktaba za data.

Unaweza kufikiria hii kama **hifadhi ya nyaraka iliyoshirikiwa ya NFS** nyingine - chanzo kinachowezekana cha habari nyeti.

### Mawasiliano

Unapounda kifaa cha Filestore ni **inawezekana kuchagua mtandao ambapo itapatikana**.

Zaidi ya hayo, kwa **kawaida wateja wote kwenye mtandao uliochaguliwa wa VPC na eneo wataweza kufikia**, hata hivyo, ni **inawezekana kuzuia upatikanaji pia kwa anwani ya IP** au eneo na kuonyesha haki ya upatikanaji (Msimamizi, Msimamizi Mwangalizi, Mhariri, Mwangalizi) ambayo mtumiaji atapata **kulingana na anwani ya IP**.

Inaweza pia kupatikana kupitia **Uunganisho wa Upatikanaji wa Huduma ya Kibinafsi:**

* Ni kwa mtandao wa VPC na inaweza kutumika kwenye huduma zote zilizosimamiwa kama Memorystore, Tensorflow na SQL.
* Ni **kati ya mtandao wako wa VPC na mtandao ulio milikiwa na Google kwa kutumia VPC peering**, kuruhusu mifano na huduma zako kuwasiliana kipekee kwa kutumia **anwani za IP za ndani**.
* Unda mradi uliojitenga kwako upande wa mtengenezaji wa huduma, maana wateja wengine hawashiriki. Utalipwa kwa rasilimali unazotumia tu.
* VPC peering itaingiza njia mpya kwenye VPC yako

### Nakala Rudufu

Inawezekana kuunda **nakala rudufu za hisa za faili**. Hizi zinaweza baadaye **kurejeshwa kwenye asili** kwenye kifaa kipya cha Fileshare au kwenye **vipya**.

### Ufichaji

Kwa kawaida **ufunguo wa kufichua uliosimamiwa na Google** utatumika kufichua data, lakini inawezekana kuchagua **ufunguo wa kufichua uliosimamiwa na Mteja (CMEK)**.

### Urambazaji

Ikiwa unapata filestore inayopatikana kwenye mradi, unaweza **kuimount** kutoka kwenye Kifaa chako cha Utekelezaji kilichoharibiwa. Tumia amri ifuatayo kuona ikiwa kuna yoyote.

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
Tafadhali kumbuka kuwa huduma ya hifadhi ya faili inaweza kuwa katika **mtandao mpya kabisa ulioanzishwa kwa ajili yake** (ndani ya Uunganisho wa Huduma ya Kibinafsi, ambao ni **Mshirika wa VPC**).\
Kwa hivyo unaweza kuhitaji **kuorodhesha washirika wa VPC** pia kukimbia nmap kwenye hizo anuwai za mtandao.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
### Upandishaji wa Mamlaka na Baada ya Kudukuliwa

Hakuna njia za kuongeza upendeleo moja kwa moja katika GCP kwa kudhuru huduma hii, lakini kwa kutumia **mbinu za Baada ya Kudukuliwa inawezekana kupata ufikiaji wa data** na labda unaweza kupata baadhi ya vibali vya kuongeza upendeleo:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### Uthabiti

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}
