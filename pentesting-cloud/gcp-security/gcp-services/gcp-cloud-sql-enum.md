# GCP - Cloud SQL Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) で AWS ハッキングをゼロからヒーローまで学ぶ</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks にあなたの会社を広告したい**、または **HackTricks を PDF でダウンロードしたい** 場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式 PEASS & HackTricks グッズ**](https://peass.creator-spring.com) を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を発見し、独占的な [**NFT**](https://opensea.io/collection/the-peass-family) コレクションをチェックする
* 💬 [**Discord グループ**](https://discord.gg/hRep4RUj7f) に **参加する** か、[**telegram グループ**](https://t.me/peass) に参加する、または **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) を **フォローする**。
* **HackTricks** に PR を提出してハッキングのコツを共有する [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)
*
*
* &#x20;github リポジトリ。

</details>

## 基本情報

Google Cloud SQL は、Google Cloud Platform 上で **リレーショナルデータベース** を簡単に設定、維持、管理、および管理するための **完全に管理されたデータベースサービス** です。ハードウェアのプロビジョニング、データベースのセットアップ、パッチ適用、バックアップなどの通常の運用タスクを処理することなく、おなじみの SQL データベース (**MySQL、PostgreSQL、SQL Server**) を使用する方法を提供します。

Google Cloud SQL の主な特徴には以下があります:

1. **完全に管理された**: Google Cloud SQL は完全に管理されたサービスで、Google がパッチ適用、アップデート、バックアップ、設定などのデータベースメンテナンスタスクを処理します。
2. **スケーラビリティ**: データベースのストレージ容量とコンピューティングリソースをスケールする能力を提供し、多くの場合ダウンタイムなしで行えます。
3. **高可用性**: 高可用性の設定を提供し、データベースサービスが信頼性が高く、ゾーンまたはインスタンスの障害に耐えられることを保証します。
4. **セキュリティ**: データ暗号化、Identity and Access Management (IAM) コントロール、プライベート IP と VPC を使用したネットワーク分離などの堅牢なセキュリティ機能を提供します。
5. **バックアップとリカバリ**: 自動バックアップとポイントインタイムリカバリをサポートし、データを保護し復元するのに役立ちます。
6. **統合**: 他の Google Cloud サービスとシームレスに統合し、アプリケーションの構築、デプロイ、および管理に関する包括的なソリューションを提供します。
7. **パフォーマンス**: パフォーマンスメトリックと診断を提供し、データベースのパフォーマンスを監視、トラブルシューティング、および改善することができます。

### パスワード

ウェブコンソールの Cloud SQL では、ユーザーがデータベースの **パスワードを設定** することができます。また、生成機能もありますが、最も重要なのは、**MySQL** が **空のパスワードを許可し、すべてのデータベースでパスワードとして単一文字 "a" を設定できる** ことです:

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

また、**長さ**、**複雑さ**、**再利用の無効化**、**パスワード内のユーザー名の無効化** を要求するパスワードポリシーを設定することも可能です。デフォルトではすべて無効になっています。

**SQL Server** は **Active Directory 認証** で設定することができます。

### ゾーン可用性

データベースは **1つのゾーンまたは複数のゾーンで利用可能** ですが、もちろん、重要なデータベースは複数のゾーンにあることが推奨されます。

### 暗号化

デフォルトでは Google 管理の暗号化キーが使用されますが、**Customer-managed encryption key (CMEK)** を選択することも **可能です**。

### 接続

* **プライベート IP**: VPC ネットワークを指定し、データベースはネットワーク内にプライベート IP を取得します
* **パブリック IP**: データベースはパブリック IP を取得しますが、デフォルトでは誰も接続できません
* **承認されたネットワーク**: データベースに接続を許可するべき **公開 IP 範囲** を指定します
* **プライベートパス**: DB がいくつかの VPC に接続されている場合、このオプションを有効にして **BigQuery などの他の GCP サービスにアクセスを許可** することが可能です

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### データ保護

* **毎日のバックアップ**: 自動的に毎日バックアップを実行し、維持したいバックアップの数を指定します。
* **ポイントインタイムリカバリ**: 特定の時点、1秒の一部までのデータを復元することができます。
* **削除保護**: 有効にすると、この機能が無効にされるまで DB を削除することはできません

### 列挙
```bash
# Get SQL instances
gcloud sql instances list
gcloud sql instances describe <inst-name> # get IPs, CACert, settings

# Get database names inside an instance (like information_schema, sys...)
gcloud sql databases list --instance <intance-name>
gcloud sql databases describe <db-name> --instance <intance-name>

# Get usernames inside the db instance
gcloud sql users list --instance <intance-name>

# Backups
gcloud sql backups list --instance <intance-name>
gcloud sql backups describe <backup-name> --instance <intance-name>
```
### 認証されていない列挙

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md" %}
[gcp-cloud-sql-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md)
{% endcontent-ref %}

### 攻撃後の活動

{% content-ref url="../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md" %}
[gcp-cloud-sql-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md)
{% endcontent-ref %}

### 持続性

{% content-ref url="../gcp-persistence/gcp-cloud-sql-persistence.md" %}
[gcp-cloud-sql-persistence.md](../gcp-persistence/gcp-cloud-sql-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) で AWS ハッキングをゼロからヒーローまで学ぶ</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks にあなたの会社を広告したい**、または **HackTricks を PDF でダウンロードしたい** 場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式の PEASS & HackTricks グッズ**](https://peass.creator-spring.com) を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を発見する、私たちの独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクション
* 💬 [**Discord グループ**](https://discord.gg/hRep4RUj7f) に**参加する**か、[**telegram グループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) を**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) の github リポジトリに PR を提出して、あなたのハッキングのコツを**共有する**。

</details>
