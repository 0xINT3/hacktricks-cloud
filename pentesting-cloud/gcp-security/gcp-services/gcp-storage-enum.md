# GCP - Berging Enum

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## Berging

Google Cloud Platform (GCP) Storage is 'n **wolksgebaseerde bergingsoplossing** wat hoogs duursame en beskikbare objekbergings bied vir ongestruktureerde data. Dit bied **verskeie bergingstipes** gebaseer op prestasie, beskikbaarheid en koste, insluitend Standaard, Nearline, Coldline en Archive. GCP Storage bied ook gevorderde funksies soos **lewensikluspolicies, weergawes en toegangsbeheer** om data doeltreffend te bestuur en te beveilig.

Die emmer kan in 'n streek, in 2 streke of **multi-streek (verstek)** gestoor word.

### Bergingstipes

* **Standaard Berging**: Dit is die verstek bergingsoptie wat **ho√´ prestasie, lae-latensie toegang tot gereeld benaderde data** bied. Dit is geskik vir 'n wye reeks gebruike, insluitend die bediening van webwerf-inhoud, die stroom van media en die gasheer van data-analitiese pyplyne.
* **Nearline Berging**: Hierdie bergingstipe bied **laer bergingskoste** en **effens ho√´r toegangskoste** as Standaard Berging. Dit is geoptimeer vir data wat selde benader word, met 'n minimum bergingsduur van 30 dae. Dit is ideaal vir rugsteun en argiefdoeleindes.
* **Coldline Berging**: Hierdie bergingstipe is geoptimeer vir **langtermynberging van selde benaderde data**, met 'n minimum bergingsduur van 90 dae. Dit bied die **laer bergingskoste** as Nearline Berging, maar met **ho√´r toegangskoste**.
* **Archive Berging**: Hierdie bergingstipe is ontwerp vir koue data wat **baie selde benader word**, met 'n minimum bergingsduur van 365 dae. Dit bied die **laagste bergingskoste van alle GCP-bergingsopties**, maar met die **hoogste toegangskoste**. Dit is geskik vir langtermynbewaring van data wat vir nakomings- of regulasie-redes gestoor moet word.
* **Autoclass**: As jy **nie weet hoeveel jy die data gaan benader nie**, kan jy Autoclass kies en GCP sal **outomaties die tipe berging vir jou verander om koste te verminder**.

### Toegangsbeheer

Dit word **standaard aanbeveel** om die toegang te beheer deur middel van **IAM**, maar dit is ook moontlik om die gebruik van ACL's te **aktiveer**.\
As jy kies om slegs IAM (verstek) te gebruik en **90 dae verloop**, sal jy **nie ACL's vir die emmer kan aktiveer nie**.

### Weergawes

Dit is moontlik om weergawes te aktiveer, dit sal **ou weergawes van die l√™er binne die emmer stoor**. Dit is moontlik om die **aantal weergawes wat jy wil behou** te konfigureer en selfs **hoe lank** jy **nie-huidige** weergawes (ou weergawes) wil behou nie. Dit word aanbeveel om **7 dae vir die Standaard-tipe** te gebruik.

Die **metadata van 'n nie-huidige weergawe word behou**. Verder word **ACL's van nie-huidige weergawes ook behou**, sodat ouer weergawes verskillende ACL's van die huidige weergawe kan h√™.

Leer meer in die [**dokumentasie**](https://cloud.google.com/storage/docs/object-versioning).

### Bewaringsbeleid

Dui aan hoe **lank** jy wil h√™ dat die **verwydering van voorwerpe binne die emmer verbied** moet word (baie nuttig vir nakoming ten minste).\
Slegs een van **weergawes of bewaringsbeleid kan terselfdertyd geaktiveer word**.

### Enkripsie

Standaard word voorwerpe **geenkripteer met behulp van deur Google bestuurde sleutels** nie, maar jy kan ook 'n **sleutel van KMS** gebruik.

### Openbare Toegang

Dit is moontlik om **eksterne gebruikers** (ingeteken by GCP of nie) **toegang tot emmerinhoud** te gee. \
Standaard, wanneer 'n emmer geskep word, sal dit **die opsie om die emmer openbaar bloot te stel, gedeaktiveer** h√™, maar met genoeg toestemmings kan dit verander word.

Die **formaat van 'n URL** om toegang tot 'n emmer te verkry is **`https://storage.googleapis.com/<emmer-naam>` of `https://<emmer-naam>.storage.googleapis.com`** (beide is geldig).

### HMAC-sleutels

'n HMAC-sleutel is 'n tipe _volmag_ en kan **geassosieer word met 'n diensrekening of 'n gebruikersrekening in Cloud Storage**. Jy gebruik 'n HMAC-sleutel om _handtekeninge_ te skep wat dan ingesluit word in versoek na Cloud Storage. Handtekeninge toon dat 'n **bepaalde versoek deur die gebruiker of diensrekening geoutoriseer is**.

HMAC-sleutels het twee prim√™re dele, 'n _toegangs-ID_ en 'n _geheim_.

*   **Toegangs-ID**: 'n Alfanumeriese string wat gekoppel is aan 'n spesifieke diens of gebruikersrekening. Wanneer dit gekoppel is aan 'n diensrekening, is die string 61 karakters lank, en wanneer dit gekoppel is aan 'n gebruikersrekening, is die string 24 karakters lank. Die volgende toon 'n voorbeeld van 'n toegangs-ID:

`GOOGTS7C7FUP3AIRVJTE2BCDKINBTES3HC2GY5CBFJDCQ2SYHV6A6XXVTJFSA`
*   **Geheim**: 'n 40-karakter Base-64 gekodeerde string wat gekoppel is aan 'n spesifieke toegangs-ID. 'n Geheim is 'n vooraf gedeelde sleutel wat slegs jy en Cloud Storage weet. Jy gebruik jou geheim om handtekeninge te skep as deel van die outentiseringsproses. Die volgende toon 'n voorbeeld van 'n geheim:

`bGoa+V7g/yqDXvKRqq+JTFn4uQZbPiQJo4pf9RzJ`

Beide die **toegangs-ID en geheim identifiseer 'n HMAC-sleutel uniek**, maar die geheim is baie sensitiewe inligting, omdat dit gebruik word om **handtekeninge te skep**.

### Enumerasie
```bash
# List all storage buckets in project
gsutil ls

# Get each bucket configuration (protections, CLs, times, configs...)
gsutil ls -L

# List contents of a specific bucket
gsutil ls gs://bucket-name/
gsutil ls -r gs://bucket-name/ # Recursive
gsutil ls -a gs://bucket-name/ # Get ALL versions of objects

# Cat the context of a file without copying it locally
gsutil cat 'gs://bucket-name/folder/object'
gsutil cat 'gs://bucket-name/folder/object#<num>' # cat specific version

# Copy an object from the bucket to your local storage for review
gsutil cp gs://bucket-name/folder/object ~/

# List using a raw OAuth token
## Useful because "CLOUDSDK_AUTH_ACCESS_TOKEN" and "gcloud config set auth/access_token_file" doesn't work with gsutil
curl -H "Authorization: Bearer $TOKEN" "https://storage.googleapis.com/storage/v1/b/<storage-name>/o"
# Download file content from bucket
curl -H "Authorization: Bearer $TOKEN" "https://storage.googleapis.com/storage/v1/b/supportstorage-58249/o/flag.txt?alt=media" --output -

# Enumerate HMAC keys
gsutil hmac list
```
As jy 'n toestemmingsfout kry wanneer jy emmers lys, mag jy steeds toegang tot die inhoud h√™. Nou dat jy bewus is van die naamkonvensie van die emmers, kan jy 'n lys moontlike name genereer en probeer om toegang tot hulle te verkry:
```bash
for i in $(cat wordlist.txt); do gsutil ls -r gs://"$i"; done
```
### Voorregverhoging

Op die volgende bladsy kan jy sien hoe om **stoorregte te misbruik om voorregte te verhoog**:

{% content-ref url="../gcp-privilege-escalation/gcp-storage-privesc.md" %}
[gcp-storage-privesc.md](../gcp-privilege-escalation/gcp-storage-privesc.md)
{% endcontent-ref %}

### Ongeagte Enum

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-storage-unauthenticated-enum/" %}
[gcp-storage-unauthenticated-enum](../gcp-unaunthenticated-enum-and-access/gcp-storage-unauthenticated-enum/)
{% endcontent-ref %}

### Na-uitbuiting

{% content-ref url="../gcp-post-exploitation/gcp-storage-post-exploitation.md" %}
[gcp-storage-post-exploitation.md](../gcp-post-exploitation/gcp-storage-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../gcp-persistence/gcp-storage-persistence.md" %}
[gcp-storage-persistence.md](../gcp-persistence/gcp-storage-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks-uitrusting**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
