# GCP - рд╕реНрдЯреЛрд░реЗрдЬ рдПрдирдо

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>

## рд╕реНрдЯреЛрд░реЗрдЬ

Google Cloud Platform (GCP) рд╕реНрдЯреЛрд░реЗрдЬ рдПрдХ **рдХреНрд▓рд╛рдЙрдб-рдЖрдзрд╛рд░рд┐рдд рд╕реНрдЯреЛрд░реЗрдЬ рд╕рдорд╛рдзрд╛рди** рд╣реИ рдЬреЛ рдЕрд╕рдВрд░рдЪрд┐рдд рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдЕрддреНрдпрдзрд┐рдХ рдЯрд┐рдХрд╛рдК рдФрд░ рдЙрдкрд▓рдмреНрдз рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реНрдЯреЛрд░реЗрдЬ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдкреНрд░рджрд░реНрд╢рди, рдЙрдкрд▓рдмреНрдзрддрд╛, рдФрд░ рд▓рд╛рдЧрдд рдХреЗ рдЖрдзрд╛рд░ рдкрд░ **рд╡рд┐рднрд┐рдиреНрди рд╕реНрдЯреЛрд░реЗрдЬ рд╡рд░реНрдЧ** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕реНрдЯреИрдВрдбрд░реНрдб, рдирд┐рдпрд░рд▓рд╛рдЗрди, рдХреЛрд▓реНрдбрд▓рд╛рдЗрди, рдФрд░ рдЖрд░реНрдХрд╛рдЗрд╡ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред GCP рд╕реНрдЯреЛрд░реЗрдЬ **рдЬреАрд╡рдирдЪрдХреНрд░ рдиреАрддрд┐рдпрд╛рдВ, рд╕рдВрд╕реНрдХрд░рдг рдирд┐рдпрдВрддреНрд░рдг, рдФрд░ рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг** рдЬреИрд╕реА рдЙрдиреНрдирдд рд╕реБрд╡рд┐рдзрд╛рдПрдБ рднреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

рдмрдХреЗрдЯ рдХреЛ рдПрдХ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ, 2 рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдпрд╛ **рдорд▓реНрдЯреА-рдХреНрд╖реЗрддреНрд░ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ)** рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рд╕реНрдЯреЛрд░реЗрдЬ рдкреНрд░рдХрд╛рд░

* **рд╕реНрдЯреИрдВрдбрд░реНрдб рд╕реНрдЯреЛрд░реЗрдЬ**: рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реНрдЯреЛрд░реЗрдЬ рд╡рд┐рдХрд▓реНрдк рд╣реИ рдЬреЛ **рдЙрдЪреНрдЪ-рдкреНрд░рджрд░реНрд╢рди, рдХрдо-рд╡рд┐рд▓рдВрдмрддрд╛ рдкрд╣реБрдВрдЪ рдХреЛ рдЕрдХреНрд╕рд░ рдкрд╣реБрдВрдЪрд╛рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ**ред рдпрд╣ рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕рд╛рдордЧреНрд░реА рд╕реЗрд╡рд╛, рдореАрдбрд┐рдпрд╛ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ, рдФрд░ рдбреЗрдЯрд╛ рдПрдирд╛рд▓рд┐рдЯрд┐рдХреНрд╕ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рд╣реЛрд╕реНрдЯрд┐рдВрдЧ рдЬреИрд╕реЗ рд╡рд┐рд╡рд┐рдз рдЙрдкрдпреЛрдЧ рдХреЗ рдорд╛рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред
* **рдирд┐рдпрд░рд▓рд╛рдЗрди рд╕реНрдЯреЛрд░реЗрдЬ**: рдпрд╣ рд╕реНрдЯреЛрд░реЗрдЬ рд╡рд░реНрдЧ **рдХрдо рд╕реНрдЯреЛрд░реЗрдЬ рд▓рд╛рдЧрдд** рдФрд░ рд╕реНрдЯреИрдВрдбрд░реНрдб рд╕реНрдЯреЛрд░реЗрдЬ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ **рдереЛрдбрд╝реА рдЕрдзрд┐рдХ рдкрд╣реБрдВрдЪ рд▓рд╛рдЧрдд** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдХрдо рдмрд╛рд░ рдкрд╣реБрдВрдЪрд╛рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд рд╣реИ, рдЬрд┐рд╕рдХреА рдиреНрдпреВрдирддрдо рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ 30 рджрд┐рди рд╣реИред рдпрд╣ рдмреИрдХрдЕрдк рдФрд░ рд╕рдВрдЧреНрд░рд╣рдг рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрджрд░реНрд╢ рд╣реИред
* **рдХреЛрд▓реНрдбрд▓рд╛рдЗрди рд╕реНрдЯреЛрд░реЗрдЬ**: рдпрд╣ рд╕реНрдЯреЛрд░реЗрдЬ рд╡рд░реНрдЧ **рдХрдо рдмрд╛рд░ рдкрд╣реБрдВрдЪрд╛рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЗ рджреАрд░реНрдШрдХрд╛рд▓рд┐рдХ рд╕реНрдЯреЛрд░реЗрдЬ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд рд╣реИ**, рдЬрд┐рд╕рдХреА рдиреНрдпреВрдирддрдо рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ 90 рджрд┐рди рд╣реИред рдпрд╣ рдирд┐рдпрд░рд▓рд╛рдЗрди рд╕реНрдЯреЛрд░реЗрдЬ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ **рдХрдо рд╕реНрдЯреЛрд░реЗрдЬ рд▓рд╛рдЧрдд** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди **рдЕрдзрд┐рдХ рдкрд╣реБрдВрдЪ рд▓рд╛рдЧрдд рдХреЗ рд╕рд╛рде**ред
* **рдЖрд░реНрдХрд╛рдЗрд╡ рд╕реНрдЯреЛрд░реЗрдЬ**: рдпрд╣ рд╕реНрдЯреЛрд░реЗрдЬ рд╡рд░реНрдЧ рдардВрдбреЗ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕реЗ **рдмрд╣реБрдд рдХрдо рдмрд╛рд░ рдкрд╣реБрдВрдЪрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рдЬрд┐рд╕рдХреА рдиреНрдпреВрдирддрдо рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ 365 рджрд┐рди рд╣реИред рдпрд╣ рд╕рднреА GCP рд╕реНрдЯреЛрд░реЗрдЬ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреА **рд╕рдмрд╕реЗ рдХрдо рд╕реНрдЯреЛрд░реЗрдЬ рд▓рд╛рдЧрдд** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди **рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдкрд╣реБрдВрдЪ рд▓рд╛рдЧрдд рдХреЗ рд╕рд╛рде**ред рдпрд╣ рдЕрдиреБрдкрд╛рд▓рди рдпрд╛ рдирд┐рдпрд╛рдордХреАрдп рдХрд╛рд░рдгреЛрдВ рд╕реЗ рдбреЗрдЯрд╛ рдХреЗ рджреАрд░реНрдШрдХрд╛рд▓рд┐рдХ рд╕рдВрд░рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред
* **рдСрдЯреЛрдХреНрд▓рд╛рд╕**: рдпрджрд┐ рдЖрдк **рдирд╣реАрдВ рдЬрд╛рдирддреЗ рдХрд┐ рдЖрдк рдХрд┐рддрдиреА рдмрд╛рд░ рдбреЗрдЯрд╛ рдХреЛ рдкрд╣реБрдВрдЪрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╣реИрдВ** рддреЛ рдЖрдк рдСрдЯреЛрдХреНрд▓рд╛рд╕ рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ GCP рдЖрдкрдХреЗ рд▓рд┐рдП **рд▓рд╛рдЧрдд рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдЯреЛрд░реЗрдЬ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрджрд▓ рджреЗрдЧрд╛**ред

### рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рд╕реЗ рдпрд╣ **рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдХрд┐ рдкрд╣реБрдВрдЪ рдХреЛ **IAM** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рд▓реЗрдХрд┐рди **ACLs рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ**ред\
рдпрджрд┐ рдЖрдк рдХреЗрд╡рд▓ IAM рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ) рдФрд░ **90 рджрд┐рди рдмреАрдд рдЬрд╛рддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк **рдмрдХреЗрдЯ рдХреЗ рд▓рд┐рдП ACLs рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ**ред

### рд╕рдВрд╕реНрдХрд░рдг рдирд┐рдпрдВрддреНрд░рдг

рд╕рдВрд╕реНрдХрд░рдг рдирд┐рдпрдВрддреНрд░рдг рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдпрд╣ **рдмрдХреЗрдЯ рдХреЗ рдЕрдВрджрд░ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рд╕рд╣реЗрдЬреЗрдЧрд╛**ред рдЖрдк рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдХрд┐рддрдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рд░рдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ **рдХрд┐рддрдиреЗ рд╕рдордп рддрдХ** рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ **рдЧреИрд░-рд╡рд░реНрддрдорд╛рди** рд╕рдВрд╕реНрдХрд░рдг (рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдг) рдЬреАрд╡рд┐рдд рд░рд╣реЗрдВред рд╕реНрдЯреИрдВрдбрд░реНрдб рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП **7 рджрд┐рдиреЛрдВ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ**ред

**рдЧреИрд░-рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рдХреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд░рдЦреА рдЬрд╛рддреА рд╣реИ**ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рдЧреИрд░-рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ ACLs рднреА рд░рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВ**, рдЗрд╕рд▓рд┐рдП рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ рдЕрд▓рдЧ ACLs рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

[**рдбреЙрдХреНрд╕**](https://cloud.google.com/storage/docs/object-versioning) рдореЗрдВ рдФрд░ рдЬрд╛рдиреЗрдВред

### рд╕рдВрд░рдХреНрд╖рдг рдиреАрддрд┐

рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк **рдХрд┐рддрдиреЗ рд╕рдордп рддрдХ** рдмрдХреЗрдЯ рдХреЗ рдЕрдВрджрд░ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд╡рд┐рд▓реЛрдкрди рдХреЛ **рд░реЛрдХрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** (рдХрдо рд╕реЗ рдХрдо рдЕрдиреБрдкрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА)ред\
**рд╕рдВрд╕реНрдХрд░рдг рдирд┐рдпрдВрддреНрд░рдг рдпрд╛ рд╕рдВрд░рдХреНрд╖рдг рдиреАрддрд┐ рдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рдХреЛ рдПрдХ рд╕рдордп рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

### рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ **Google рдкреНрд░рдмрдВрдзрд┐рдд рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ**, рд▓реЗрдХрд┐рди рдЖрдк KMS рд╕реЗ **рдХреБрдВрдЬреА рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

### HMAC рдХреБрдВрдЬрд┐рдпрд╛рдБ

HMAC рдХреБрдВрдЬреА рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреА _рдкреНрд░рдорд╛рдг-рдкрддреНрд░_ рд╣реИ рдФрд░ рдЗрд╕реЗ **Cloud Storage рдореЗрдВ рд╕реЗрд╡рд╛ рдЦрд╛рддреЗ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдЖрдк Cloud Storage рдХреЛ рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _рд╣рд╕реНрддрд╛рдХреНрд╖рд░_ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП HMAC рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ рдХрд┐ **рджрд┐рдпрд╛ рдЧрдпрд╛ рдЕрдиреБрд░реЛрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рд╕реЗрд╡рд╛ рдЦрд╛рддреЗ рджреНрд╡рд╛рд░рд╛ рдЕрдзрд┐рдХреГрдд рд╣реИ**ред

HMAC рдХреБрдВрдЬрд┐рдпреЛрдВ рдореЗрдВ рджреЛ рдкреНрд░рд╛рдердорд┐рдХ рднрд╛рдЧ рд╣реЛрддреЗ рд╣реИрдВ, рдПрдХ _рдкрд╣реБрдВрдЪ ID_ рдФрд░ рдПрдХ _рдЧреБрдкреНрдд_ред

*   **рдкрд╣реБрдВрдЪ ID**: рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реЗрд╡рд╛ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рд╕реЗ рдЬреБрдбрд╝реА рдПрдХ рдЕрд▓реНрдлрд╝рд╛рдиреНрдпреВрдореЗрд░рд┐рдХ рд╕реНрдЯреНрд░рд┐рдВрдЧред рдЬрдм рдпрд╣ рдПрдХ рд╕реЗрд╡рд╛ рдЦрд╛рддреЗ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рд▓рдВрдмрд╛рдИ 61 рдЕрдХреНрд╖рд░ рд╣реЛрддреА рд╣
```bash
# List all storage buckets in project
gsutil ls

# Get each bucket configuration (protections, CLs, times, configs...)
gsutil ls -L

# List contents of a specific bucket
gsutil ls gs://bucket-name/
gsutil ls -r gs://bucket-name/ # Recursive
gsutil ls -a gs://bucket-name/ # Get ALL versions of objects

# Cat the context of a file without copying it locally
gsutil cat 'gs://bucket-name/folder/object'
gsutil cat 'gs://bucket-name/folder/object#<num>' # cat specific version

# Copy an object from the bucket to your local storage for review
gsutil cp gs://bucket-name/folder/object ~/

# List using a raw OAuth token
## Useful because "CLOUDSDK_AUTH_ACCESS_TOKEN" and "gcloud config set auth/access_token_file" doesn't work with gsutil
curl -H "Authorization: Bearer $TOKEN" "https://storage.googleapis.com/storage/v1/b/<storage-name>/o"
# Download file content from bucket
curl -H "Authorization: Bearer $TOKEN" "https://storage.googleapis.com/storage/v1/b/supportstorage-58249/o/flag.txt?alt=media" --output -

# Enumerate HMAC keys
gsutil hmac list
```
рдпрджрд┐ рдЖрдкрдХреЛ рдмрдХреЗрдЯреНрд╕ рдХреА рд╕реВрдЪреА рдмрдирд╛рддреЗ рд╕рдордп рдЕрдиреБрдорддрд┐ рдЕрд╕реНрд╡реАрдХреГрдд рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рднреА рдЖрдкрдХреЗ рдкрд╛рд╕ рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдБрдЪ рд╣реЛ рд╕рдХрддреА рд╣реИред рддреЛ, рдЕрдм рдЬрдм рдЖрдк рдмрдХреЗрдЯреНрд╕ рдХреЗ рдирд╛рдо рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирддреЗ рд╣реИрдВ, рдЖрдк рд╕рдВрднрд╛рд╡рд┐рдд рдирд╛рдореЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рддреИрдпрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрди рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
for i in $(cat wordlist.txt); do gsutil ls -r gs://"$i"; done
```
### рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкрд╣реБрдБрдЪ

рдмрд╛рд╣рд░реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ (GCP рдореЗрдВ рд▓реЙрдЧ рдЗрди рд╣реЛ рдпрд╛ рди рд╣реЛ) рдмрдХреЗрдЯреНрд╕ рдХреА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдБрдЪ рджреЗрдирд╛ рд╕рдВрднрд╡ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдмрдХреЗрдЯ рдореЗрдВ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдмрдХреЗрдЯ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реЛрдЧрд╛:
```bash
# Disable public prevention
gcloud storage buckets update gs://BUCKET_NAME --no-public-access-prevention

# Make all objects in a bucket public
gcloud storage buckets add-iam-policy-binding gs://BUCKET_NAME --member=allUsers --role=roles/storage.objectViewer
## I don't think you can make specific objects public just with IAM

# Make a bucket or object public (via ACL)
gcloud storage buckets update gs://BUCKET_NAME --add-acl-grant=entity=AllUsers,role=READER
gcloud storage objects update gs://BUCKET_NAME/OBJECT_NAME --add-acl-grant=entity=AllUsers,role=READER
```
рдпрджрд┐ рдЖрдк **ACLs рдХреЛ рдПрдХ рдмрдХреЗрдЯ рдореЗрдВ рджреЗрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ ACLs рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЛ рдпрд╣ рддреНрд░реБрдЯрд┐ рдорд┐рд▓реЗрдЧреА: `ERROR: HTTPError 400: Cannot use ACL API to update bucket policy when uniform bucket-level access is enabled. рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП https://cloud.google.com/storage/docs/uniform-bucket-level-access рдкрд░ рдкрдврд╝реЗрдВ`

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦреБрд▓реЗ рдмрдХреЗрдЯреНрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, URL `https://<bucket_name>.storage.googleapis.com/` рдпрд╛ `https://<bucket_name>.storage.googleapis.com/<object_name>` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

### рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрд░ рдЖрдк рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ **рд╕реНрдЯреЛрд░реЗрдЬ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**:

{% content-ref url="../gcp-privilege-escalation/gcp-storage-privesc.md" %}
[gcp-storage-privesc.md](../gcp-privilege-escalation/gcp-storage-privesc.md)
{% endcontent-ref %}

### рд╡рд░реНрддрдорд╛рди рдЦрд╛рддреЗ рдореЗрдВ рдЦреБрд▓реЗ рдмрдХреЗрдЯреНрд╕ рдХреА рдЦреЛрдЬ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ [рдпрд╣рд╛рдБ рд╕реЗ рдПрдХрддреНрд░рд┐рдд](https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/gcp\_misc/-/blob/master/find\_open\_buckets.sh) рдХреЗ рд╕рд╛рде рдЖрдк рд╕рднреА рдЦреБрд▓реЗ рдмрдХреЗрдЯреНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
#!/bin/bash

############################
# Run this tool to find buckets that are open to the public anywhere
# in your GCP organization.
#
# Enjoy!
############################

for proj in $(gcloud projects list --format="get(projectId)"); do
echo "[*] scraping project $proj"
for bucket in $(gsutil ls -p $proj); do
echo "    $bucket"
ACL="$(gsutil iam get $bucket)"

all_users="$(echo $ACL | grep allUsers)"
all_auth="$(echo $ACL | grep allAuthenticatedUsers)"

if [ -z "$all_users" ]
then
:
else
echo "[!] Open to all users: $bucket"
fi

if [ -z "$all_auth" ]
then
:
else
echo "[!] Open to all authenticated users: $bucket"
fi
done
done
```
<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
