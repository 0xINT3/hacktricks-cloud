# GCP - Enumerasie van Artefak-Registrasie

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)
* &#x20;github repos.

</details>

## Basiese Inligting

Google Cloud Artefak-Registrasie is 'n ten volle bestuurde diens wat jou in staat stel om jou sagteware-artefakte te **bestuur, stoor en beveilig**. Dit is in wese 'n bewaarplek vir **stoorafhanklikhede**, soos **Docker**-beeldmateriaal, **Maven**, npm-pakkies en ander tipes artefakte. Dit word **gewoonlik gebruik in CI/CD-pyplyne** om die artefakte wat tydens die sagteware-ontwikkelingsproses geproduseer word, te stoor en te versieer.

Kernkenmerke van Artefak-Registrasie sluit in:

1. **Ge√Øntegreerde Bewaarplek**: Dit ondersteun **verskeie tipes artefakte**, wat jou in staat stel om 'n enkele bewaarplek vir Docker-beeldmateriaal, taalpakkies (soos Java se Maven, Node.js se npm) en ander tipes artefakte te h√™, wat konsekwente toegangskontroles en 'n ge√Øntegreerde siening oor al jou artefakte bied.
2. **Ten volle Bestuur**: As 'n bestuurde diens sorg dit vir die onderliggende infrastruktuur, skaalbaarheid en sekuriteit, wat die onderhoudslas vir gebruikers verminder.
3. **Fynkorrelige Toegangskontrole**: Dit integreer met Google Cloud se Identiteit- en Toegangsbestuur (IAM), wat jou in staat stel om te bepaal wie toegang kan verkry tot, artefakte kan oplaai of aflaai in jou bewaarplekke.
4. **Geo-replikasie**: Dit ondersteun die replikasie van artefakte oor verskeie streke, wat die aflaaispoed verbeter en beskikbaarheid verseker.
5. **Integrasie met Google Cloud-dienste**: Dit werk naadloos saam met **ander GCP-dienste soos Cloud Build, Kubernetes Engine en Compute Engine**, wat dit 'n gerieflike keuse maak vir spanne wat reeds binne die Google Cloud-ekosisteem werk.
6. **Sekuriteit**: Bied funksies soos **kwesbaarheidsskandering en houeranalise** om te help verseker dat die gestoorde artefakte veilig is en vry van bekende sekuriteitskwessies.

### Formate en Modi

Wanneer jy 'n nuwe bewaarplek skep, is dit moontlik om 'n **formaat/tipe** vir die bewaarplek te **kies** uit verskeie opsies soos Docker, Maven, npm, Python... en die modus wat gewoonlik een van die volgende kan wees:

* **Standaard Bewaarplek**: Standaardmodus vir die **stoor van jou eie artefakte** (soos Docker-beeldmateriaal, Maven-pakkies) direk in GCP. Dit is veilig, skaalbaar en integreer goed binne die Google Cloud-ekosisteem.
* **Afgele√´ Bewaarplek** (indien beskikbaar): Tree op as 'n proksi vir die **gekas van artefakte vanaf eksterne**, openbare bewaarplekke. Dit help om probleme te voorkom as gevolg van veranderende afhanklikhede stroomopwaarts en verminder latensie deur gereeld benaderde artefakte te kas.
* **Virtuele Bewaarplek** (indien beskikbaar): Verskaf 'n **ge√Øntegreerde koppelvlak om toegang te verkry tot verskeie (standaard of afgele√´) bewaarplekke** deur middel van 'n enkele eindpunt, wat die konfigurasie aan die kli√´ntkant en toegangsbestuur vir artefakte wat oor verskillende bewaarplekke versprei is, vereenvoudig.
* Vir 'n virtuele bewaarplek moet jy **bewaarplekke kies en hulle 'n prioriteit gee** (die bewaarplek met die hoogste prioriteit sal gebruik word).
* Jy kan **afgele√´ en standaard** bewaarplekke meng in 'n **virtuele** een, as die **prioriteit** van die **afgele√´** een **groter** as die standaard is, **sal pakkies van die afgele√´ bewaarplek (soos PyPi) gebruik word**. Dit kan lei tot 'n **Afhanklikheidsverwarring**.

Let daarop dat in die **Afgele√´ weergawe van Docker** dit moontlik is om 'n gebruikersnaam en token te gee om toegang tot Docker Hub te verkry. Die **token word dan in die Secret Manager gestoor**.

### Versleuteling

Soos verwag, word standaard 'n deur Google bestuurde sleutel gebruik, maar 'n deur die kli√´nt bestuurde sleutel kan aangedui word (CMEK).

### Opruimingsbeleide

* **Verwyder artefakte:** Artefakte sal **volgens die opruimingsbeleid**-kriteria verwyder word.
* **Dro√´ loop:** (Verstek een) Artefakte sal **nie verwyder word nie**. Opruimingsbeleide sal ge√´valueer word en toetsverwyderingsgebeure na Cloud Audit Logging gestuur word.

### Kwesbaarheidsskandering

Dit is moontlik om die **kwesbaarheidsskanner** te aktiveer wat sal ondersoek instel vir kwesbaarhede binne **houerbeeldmateriaal**.

### Enumerasie
```bash
# Get repositories
gcloud artifacts repositories list
gcloud artifacts repositories describe --location <location> <repo-name>
gcloud artifacts versions list --repository=<repo-name> -location <location> --package <package-name>

# Get settings of a repository (example using python but could be other)
gcloud artifacts print-settings python --repository <repo-name> --location <location>

# Get docker images
gcloud artifacts docker images list us-central1-docker.pkg.dev/<proj-name>/<repo-name>

# Get packages (like python and others...)
gcloud artifacts packages list --repository <repo-name> --location <location>

# Get SBOMB artifacts
gcloud artifacts sbom list

# Get vulnerabilities (docker images)
gcloud artifacts vulnerabilities list us-east1-docker.pkg.dev/project123/repository123/someimage@sha256:49765698074d6d7baa82f
gcloud artifacts docker images list-vulnerabilities projects/<proj-name>/locations/<location>/scans/<scan-uuid>
```
### Voorregverhoging

{% content-ref url="../gcp-privilege-escalation/gcp-artifact-registry-privesc.md" %}
[gcp-artifact-registry-privesc.md](../gcp-privilege-escalation/gcp-artifact-registry-privesc.md)
{% endcontent-ref %}

### Ongeagte Toegang

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md" %}
[gcp-artifact-registry-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md)
{% endcontent-ref %}

### Post-Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md" %}
[gcp-artifact-registry-post-exploitation.md](../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../gcp-persistence/gcp-artifact-registry-persistence.md" %}
[gcp-artifact-registry-persistence.md](../gcp-persistence/gcp-artifact-registry-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>
