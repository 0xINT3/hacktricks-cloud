# GCP - Rekenaarinstansies

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## Basiese Inligting

Google Cloud Rekenaarinstansies is **aanpasbare virtuele masjiene op Google se wolk-infrastruktuur**, wat skaalbare en op aanvraag rekenkrag bied vir 'n wye verskeidenheid toepassings. Dit bied funksies soos globale implementering, volgehoue stoor, buigsame bedryfstelselkeuses, en sterk netwerk- en sekuriteitsintegrasies, wat dit 'n veelsydige keuse maak vir die gasheer van webwerwe, die verwerking van data, en die doeltreffende uitvoering van toepassings in die wolk.

### Vertroulike VM

Vertroulike VM's maak gebruik van **hardeware-gebaseerde sekuriteitskenmerke** wat deur die nuutste generasie AMD EPYC-verwerkers aangebied word, wat geheueversleuteling en veilige versleutelde virtualisering insluit. Hierdie kenmerke maak dit vir die VM moontlik om die data wat daarin verwerk en gestoor word, selfs teen die gasbedryfstelsel en hipervisor te beskerm.

Om 'n Vertroulike VM te laat loop, mag dit nodig wees om dinge soos die **tipe** van die **masjien**, netwerk-**koppelvlak**, **opstartskyfbeeld** te **verander**.

### Skyf & Skyfversleuteling

Dit is moontlik om die skyf te **kies** wat gebruik moet word of 'n nuwe een te **skep**. As jy 'n nuwe een kies, kan jy:

* Die **grootte** van die skyf kies
* Die **bedryfstelsel** kies
* Aandui of jy die skyf wil **verwyder wanneer die instansie verwyder word**
* **Versleuteling**: Standaard sal 'n **Google-bestuurde sleutel** gebruik word, maar jy kan ook 'n sleutel uit KMS kies of 'n **rofsleutel aandui** wat gebruik moet word.

### Implementeer Houer

Dit is moontlik om 'n **houer** binne die virtuele masjien te implementeer.\
Dit is moontlik om die **beeld** wat gebruik moet word te konfigureer, die **opdrag** wat binne-in uitgevoer moet word, **argumente**, 'n **volume** te koppel, en **omgewingsveranderlikes** (sensitiewe inligting?) te konfigureer, en verskeie opsies vir hierdie houer te konfigureer, soos uitvoer as **bevoorreg**, stdin en pseudo TTY.

### Diensrekening

Standaard sal die **Rekenaar-enjin se verstekdiensrekening** gebruik word. Die e-pos van hierdie SA is soos volg: `<proj-num>-compute@developer.gserviceaccount.com`\
Hierdie diensrekening het **Redakteurrol oor die hele projek (ho√´ bevoegdhede).**

En die **verstektoegangsbereik** is as volg:

* **https://www.googleapis.com/auth/devstorage.read\_only** -- Leestoegang tot emmers :)
* https://www.googleapis.com/auth/logging.write
* https://www.googleapis.com/auth/monitoring.write
* https://www.googleapis.com/auth/servicecontrol
* https://www.googleapis.com/auth/service.management.readonly
* https://www.googleapis.com/auth/trace.append

Dit is egter moontlik om dit **`cloud-platform` toe te ken met 'n kliek** of **aangepaste eenhede** aan te dui.

<figure><img src="../../../../.gitbook/assets/image (138).png" alt=""><figcaption></figcaption></figure>

### Vuurmuur

Dit is moontlik om HTTP- en HTTPS-verkeer toe te laat.

<figure><img src="../../../../.gitbook/assets/image (137).png" alt=""><figcaption></figcaption></figure>

### Netwerking

* **IP-deurstuur**: Dit is moontlik om **IP-deurstuur** vanaf die skepping van die instansie te **aktiveer**.
* **Gasheernaam**: Dit is moontlik om die instansie 'n permanente gasheernaam te gee.
* **Koppelvlak**: Dit is moontlik om 'n netwerkkoppelvlak by te voeg.

### Ekstra Sekuriteit

Hierdie opsies sal die sekuriteit van die VM **verhoog** en word aanbeveel:

* **Veilige opstart**: Veilige opstart help om jou VM-instansies teen opstartvlak- en kernvlak-malware en rootkits te beskerm.
* **vTPM aktiveer**: Virtuele Trusted Platform Module (vTPM) valideer die vooraf-opstart- en opstartintegriteit van jou gas-VM en bied sleutelgenerering en -beskerming.
* **Integriteitstoeigening**: Integriteitsmonitering stel jou in staat om die uitvoerintegriteit van jou beskermde VM-instansies te monitor en te verifieer deur gebruik te maak van Stackdriver-rapporte. Vereis dat vTPM geaktiveer word.

### VM-toegang

Die algemene manier om toegang tot die VM moontlik te maak, is deur sekere SSH-publieke sleutels toe te laat om toegang tot die VM te verkry.\
Dit is egter ook moontlik om die toegang tot die VM via die `os-config`-diens met behulp van IAM te **aktiveer**. Dit is ook moontlik om 2FA te aktiveer om toegang tot die VM met behulp van hierdie diens te verkry.\
Wanneer hierdie **diens** **geaktiveer** is, is die toegang via **SSH-sleutels gedeaktiveer**.

<figure><img src="../../../../.gitbook/assets/image (139).png" alt=""><figcaption></figcaption></figure>

### Metadata

Dit is moontlik om **outomatisering** (userdata in AWS) te definieer, wat **skerminstrukte** is wat elke keer as die masjien aangeskakel of herlaai word, uitgevoer sal word.

Dit is ook moontlik om **ekstra metadata sleutel-waarde waardes** by te voeg wat toeganklik sal wees vanaf die metadata-eindpunt. Hierdie inligting word gewoonlik gebruik vir omgewingsveranderlikes en opstart-/afsluitingskripte. Dit kan verkry word deur die **`beskryf`-metode** van 'n opdrag in die opsporingsgedeelte te gebruik, maar dit kan ook van binne die instansie verkry word deur die metadata-eindpunt te benader.
```bash
# view project metadata
curl "http://metadata.google.internal/computeMetadata/v1/project/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"

# view instance metadata
curl "http://metadata.google.internal/computeMetadata/v1/instance/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"
```
Verder sal die **outentiseringsleutel vir die gekoppelde diensrekening** en **algemene inligting** oor die instansie, netwerk en projek beskikbaar wees vanaf die **metadata-eindpunt**. Vir meer inligting, kyk na:

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#6440" %}

### Versleuteling

'n Deur Google bestuurde versleutelingsleutel word standaard gebruik, maar 'n Kli√´ntbestuurde versleutelingsleutel (CMEK) kan gekonfigureer word. Jy kan ook konfigureer wat om te doen as die gebruikte CMEF herroep word: Niks of skakel die VM af.

<figure><img src="../../../../.gitbook/assets/image (140).png" alt=""><figcaption></figcaption></figure>

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSKRIPSIEPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks-uitrusting**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-opslagplekke.

</details>
