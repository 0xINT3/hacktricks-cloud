# GCP - Secrets Manager Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> から <strong>AWS hacking をゼロからヒーローまで学ぶ</strong>！</summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい** または **HackTricks を PDF でダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェック！
* [**公式 PEASS & HackTricks スワッグ**](https://peass.creator-spring.com) を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを見つける
* **💬 [Discord グループ](https://discord.gg/hRep4RUj7f)** に参加するか、[telegram グループ](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live) をフォローする
* **HackTricks** と **HackTricks Cloud** の github リポジトリに PR を提出して、あなたのハッキングテクニックを共有する

</details>

## Secret Manager

Google [**Secret Manager**](https://cloud.google.com/solutions/secrets-management/) は、パスワード、API キー、証明書、ファイル（最大 64KB）、およびその他の機密データを保存するためのボールトのようなソリューションです。

シークレットには、**異なるデータを保存する異なるバージョン**を持つことができます。

**デフォルト**では、シークレットは **Google が管理するキーを使用して暗号化**されますが、シークレットを暗号化するために **KMS からキーを選択することも可能**です。

**ローテーション**に関して、**一定の日数ごとに pub-sub にメッセージを送信するように構成**することが可能で、それらのメッセージを受信するコードが **シークレットをローテーション**できます。

**自動削除**の日を構成することが可能で、指定された日が **到達すると、シークレットは自動的に削除**されます。

### 列挙
```bash
# First, list the entries
gcloud secrets list
gcloud secrets get-iam-policy <secret_name>

# Then, pull the clear-text of any version of any secret
gcloud secrets versions list <secret_name>
gcloud secrets versions access 1 --secret="<secret_name>"
```
### 特権昇格

次のページでは、**シークレットマネージャーの権限を悪用して特権を昇格させる方法**を確認できます。

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-secretmanager-privesc.md" %}
[gcp-secretmanager-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-secretmanager-privesc.md)
{% endcontent-ref %}

### 攻撃後の利用

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-secretmanager-post-exploitation.md" %}
[gcp-secretmanager-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-secretmanager-post-exploitation.md)
{% endcontent-ref %}

### 永続化

{% content-ref url="../../gcp-security/gcp-persistence/gcp-secret-manager-persistence.md" %}
[gcp-secret-manager-persistence.md](../../gcp-security/gcp-persistence/gcp-secret-manager-persistence.md)
{% endcontent-ref %}

### ローテーションの誤用

攻撃者は、シークレットを更新して**ローテーションを停止**させることができます（変更されないように）、または**ローテーションをはるかに頻繁に行わないように**することができます（シークレットが変更されないように）、または**ローテーションメッセージを異なるパブ/サブに公開**するか、実行されるローテーションコードを変更することができます（これは異なるサービスで行われるため、おそらくClound Function内で行われます。したがって、攻撃者はCloud Functionまたは他のサービスに対する特権アクセスが必要です）
