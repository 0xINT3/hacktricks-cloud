# GCP - рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ **рдореБрдЭреЗ рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## **рд╕рдВрд╕рд╛рдзрди рдкрджрд╛рдиреБрдХреНрд░рдо**

Google Cloud рдПрдХ [рд╕рдВрд╕рд╛рдзрди рдкрджрд╛рдиреБрдХреНрд░рдо](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХрд┐ рд╕рдВрдХрд▓реНрдкрдирд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдПрдХ рдкрд╛рд░рдВрдкрд░рд┐рдХ рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рдорд╛рди рд╣реИред рдпрд╣ рдиреАрддрд┐рдпреЛрдВ рдФрд░ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдЯреИрдЪрдореЗрдВрдЯ рдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рддрд╛рд░реНрдХрд┐рдХ рдорд╛рддрд╛/рдкрд┐рддрд╛ рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

рдЙрдЪреНрдЪ рд╕реНрддрд░ рдкрд░, рдпрд╣ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ:
```
Organization
--> Folders
--> Projects
--> Resources
```
## **рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдорд╛рдЗрдЧреНрд░реЗрд╢рди**

рдмрд┐рдирд╛ рдХрд┐рд╕реА рд╕рдВрдЧрдарди рдХреЗ **рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рдорд╛рдЗрдЧреНрд░реЗрдЯ** рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ `roles/resourcemanager.projectCreator` рдФрд░ `roles/resourcemanager.projectMover` рдХреА рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реЛрдВред рдпрджрд┐ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕рдВрдЧрдарди рдХреЗ рдЕрдВрджрд░ рд╣реИ, рддреЛ рдЙрд╕реЗ рдкрд╣рд▓реЗ рд╕рдВрдЧрдарди рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП GCP рд╕рдкреЛрд░реНрдЯ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**рдпрд╣рд╛рдБ**](https://medium.com/google-cloud/migrating-a-project-from-one-organization-to-another-gcp-4b37a86dd9e6) рджреЗрдЦреЗрдВред

## **рд╕рдВрдЧрдарди рдиреАрддрд┐рдпрд╛рдВ**

рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ рдХреНрд▓рд╛рдЙрдб рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдкрд░ рдХреЗрдВрджреНрд░реАрдХреГрдд рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ:

* рдЖрдкрдХреЗ рд╕рдВрдЧрдарди рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕ рдкрд░ **рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрдВрджреНрд░реАрдХреГрдд рдирд┐рдпрдВрддреНрд░рдгред
* рдЕрдкрдиреА рд╡рд┐рдХрд╛рд╕ рдЯреАрдореЛрдВ рдХреЗ рд▓рд┐рдП **рдЧрд╛рд░реНрдбрд░реЗрд▓реНрд╕** рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рддрд╛рдХрд┐ рд╡реЗ рдЕрдиреБрдкрд╛рд▓рди рд╕реАрдорд╛рдУрдВ рдХреЗ рднреАрддрд░ рд░рд╣реЗрдВред
* рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдорд╛рд▓рд┐рдХреЛрдВ рдФрд░ рдЙрдирдХреА рдЯреАрдореЛрдВ рдХреЛ рдмрд┐рдирд╛ рдЕрдиреБрдкрд╛рд▓рди рддреЛрдбрд╝рдиреЗ рдХреА рдЪрд┐рдВрддрд╛ рдХреЗ рддреЗрдЬреА рд╕реЗ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдирд╛ред

рдпреЗ рдиреАрддрд┐рдпрд╛рдВ **рдкреВрд░реЗ рд╕рдВрдЧрдарди, рдлрд╝реЛрд▓реНрдбрд░(рд╕) рдпрд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ(рд╕)** рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рд▓рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди рдкрджрд╛рдиреБрдХреНрд░рдо рдиреЛрдб рдХреЗ рд╡рдВрд╢рдЬ **рд╕рдВрдЧрдарди рдиреАрддрд┐ рдХреЛ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ**ред

рд╕рдВрдЧрдарди рдиреАрддрд┐ **рдкрд░рд┐рднрд╛рд╖рд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдПрдХ [**рдкреНрд░рддрд┐рдмрдВрдз**](https://cloud.google.com/resource-manager/docs/organization-policy/overview#constraints) рдЪреБрдирддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдкреНрд░рддрд┐рдмрдВрдз рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдпрд╛ рддреЛ Google Cloud рд╕реЗрд╡рд╛ рдпрд╛ Google Cloud рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рдореВрд╣ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╣реЛрддрд╛ рд╣реИред рдЖрдк **рдЕрдкрдиреА рд╡рд╛рдВрдЫрд┐рдд рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рд╕рд╛рде рдЙрд╕ рдкреНрд░рддрд┐рдмрдВрдз рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ**ред

#### рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧ рдХреЗ рдорд╛рдорд▓реЗ <a href="#common_use_cases" id="common_use_cases"></a>

* рдбреЛрдореЗрди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рдВрд╕рд╛рдзрди рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреА рд╕реАрдорд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ред
* Identity and Access Management рд╕реЗрд╡рд╛ рдЦрд╛рддреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдирд╛ред
* рдирдП рдмрдирд╛рдП рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рднреМрддрд┐рдХ рд╕реНрдерд╛рди рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдирд╛ред
* рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдирд┐рд░реНрдорд╛рдг рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ред

## **IAM рднреВрдорд┐рдХрд╛рдПрдБ**

рдпреЗ AWS рдореЗрдВ IAM рдиреАрддрд┐рдпреЛрдВ рдХреА рддрд░рд╣ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ **рдкреНрд░рддреНрдпреЗрдХ рднреВрдорд┐рдХрд╛ рдореЗрдВ рдПрдХ рд╕реЗрдЯ рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реЛрддреА рд╣реИрдВред**

рд╣рд╛рд▓рд╛рдВрдХрд┐, AWS рдХреЗ рд╡рд┐рдкрд░реАрдд, рдпрд╣рд╛рдБ **рдХреЛрдИ рдХреЗрдВрджреНрд░реАрдХреГрдд рд░реЗрдкреЛ** рдирд╣реАрдВ рд╣реИред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, **рд╕рдВрд╕рд╛рдзрди Y рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ рдХреЛ X рдПрдХреНрд╕реЗрд╕ рднреВрдорд┐рдХрд╛рдПрдБ рджреЗрддреЗ рд╣реИрдВ**, рдФрд░ рдпрд╣ рдЬрд╛рдирдиреЗ рдХрд╛ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рдХрд┐ рдХрд┐рд╕реА рд╕рдВрд╕рд╛рдзрди рддрдХ рдХрд┐рд╕рдХреА рдкрд╣реБрдБрдЪ рд╣реИ, рд╡рд╣ рд╣реИ **рдЙрд╕ рд╕рдВрд╕рд╛рдзрди рдкрд░ `get-iam-policy` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛**ред\
рдпрд╣ рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ рдЬрд╛рдирдиреЗ рдХрд╛ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ **рдХрд┐ рдХрд┐рд╕реА рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдХреЗ рдкрд╛рд╕ рдХреМрди рд╕реА рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реИрдВ, рд╡рд╣ рд╣реИ рд╣рд░ рд╕рдВрд╕рд╛рдзрди рд╕реЗ рдкреВрдЫрдирд╛ рдХрд┐ рд╡рд╣ рдХрд┐рд╕реЗ рдЕрдиреБрдорддрд┐рдпрд╛рдВ рджреЗ рд░рд╣рд╛ рд╣реИ**, рдФрд░ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рд╕рднреА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рдЕрдиреБрдорддрд┐рдпрд╛рдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИред

IAM рдореЗрдВ **рддреАрди рдкреНрд░рдХрд╛рд░** рдХреА рднреВрдорд┐рдХрд╛рдПрдБ рд╣реЛрддреА рд╣реИрдВ:

* **рдмреЗрд╕рд┐рдХ/рдкреНрд░рд╛рдЗрдорд┐рдЯрд┐рд╡ рднреВрдорд┐рдХрд╛рдПрдБ**, рдЬрд┐рдирдореЗрдВ **рдорд╛рд▓рд┐рдХ**, **рд╕рдВрдкрд╛рджрдХ**, рдФрд░ **рджрд░реНрд╢рдХ** рднреВрдорд┐рдХрд╛рдПрдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ IAM рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдкрд╣рд▓реЗ рдореМрдЬреВрдж рдереАрдВред
* **рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рднреВрдорд┐рдХрд╛рдПрдБ**, рдЬреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддреГрдд рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ рдФрд░ Google Cloud рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред рдмрд╣реБрдд рд╕рд╛рд░реА рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рднреВрдорд┐рдХрд╛рдПрдБ рд╣реИрдВ, рдЖрдк рдЙрдиреНрд╣реЗрдВ рдФрд░ рдЙрдирдХреЗ рдкрд╛рд╕ рдореМрдЬреВрдж рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ [**рдпрд╣рд╛рдБ**](https://cloud.google.com/iam/docs/understanding-roles#predefined\_roles) рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХрд╕реНрдЯрдо рднреВрдорд┐рдХрд╛рдПрдБ**, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рд╕реВрдЪреА рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╡рд┐рд╕реНрддреГрдд рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВред

## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ <a href="#default-credentials" id="default-credentials"></a>

**GCP рдХрдВрд╕реЛрд▓** рдореЗрдВ **рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рд╕рдореВрд╣** рдкреНрд░рдмрдВрдзрди рдирд╣реАрдВ рд╣реИ, рдпрд╣ **Google Workspace** рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк Google Workspace рдореЗрдВ рдПрдХ рдЕрд▓рдЧ рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ рдХреЛ рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк Workspaces **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рд╕рдореВрд╣реЛрдВ рдХреЛ** [**https://admin.google.com**](https://admin.google.com/) рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**MFA** рдХреЛ Workspaces рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП **рдЕрдирд┐рд╡рд╛рд░реНрдп** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** GCP **рдХреНрд▓рд╛рдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣реБрдБрдЪ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ MFA рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛** (рдпрд╣ рдХреЗрд╡рд▓ рддрдм MFA рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реЛрдЧрд╛ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЙрдЧрд┐рди рдХрд░рддрд╛ рд╣реИ: `gcloud auth login`).
```
PROJECT_NUMBER-compute@developer.gserviceaccount.com
PROJECT_ID@appspot.gserviceaccount.com
```
рд╣рд╛рд▓рд╛рдВрдХрд┐, **custom service accounts** рдмрдирд╛рдирд╛ рдФрд░ рдЙрдирд╕реЗ рдЬреБрдбрд╝рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ, рдЬреЛ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдВрдЧреЗ:
```
SERVICE_ACCOUNT_NAME@PROJECT_NAME.iam.gserviceaccount.com
```
### **рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдкреНрд╕**

рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдк GCP API рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП **рдЬрдирд░реЗрдЯ рдХрд┐рдП рдЧрдП OAuth рдЯреЛрдХрдиреНрд╕ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВ**ред рд╡реЗ OAuth рдЯреЛрдХрди рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ **рд╕реАрдорд┐рдд рдХрд░рддреЗ рд╣реИрдВ**ред\
рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрдЧрд░ рдПрдХ рдЯреЛрдХрди рдХрд┐рд╕реА рд╕рдВрд╕рд╛рдзрди рдХреЗ рдорд╛рд▓рд┐рдХ рдХрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЙрд╕рдХреЗ рдкрд╛рд╕ рдЙрд╕ рд╕рдВрд╕рд╛рдзрди рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЛрдХрди рд╕реНрдХреЛрдк рдореЗрдВ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЯреЛрдХрди **рдЙрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХрд╛ (рджреБрд░реБрдкрдпреЛрдЧ) рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛**ред

Google рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ [рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░рддрд╛ рд╣реИ](https://cloud.google.com/compute/docs/access/service-accounts#service\_account\_permissions) рдХрд┐ **рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдкреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд┐рдпрд╛ рдЬрд╛рдП рдФрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ IAM рдкрд░ рдирд┐рд░реНрднрд░ рд░рд╣рд╛ рдЬрд╛рдП**ред рд╡реЗрдм рдореИрдиреЗрдЬрдореЗрдВрдЯ рдкреЛрд░реНрдЯрд▓ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдкреНрд╕ рдХреЛ рдЕрднреА рднреА рдХрд╕реНрдЯрдо рд╕рд░реНрд╡рд┐рд╕ рдЕрдХрд╛рдЙрдВрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрд╕ рдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЖрдк рдпрд╣ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕реЗ **рд╕реНрдХреЛрдкреНрд╕** **рдЕрд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВ** рдЗрд╕реЗ **рдкреВрдЫрддрд╛рдЫ рдХрд░рдХреЗ:**

{% code overflow="wrap" %}
```bash
curl 'https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=<access_token>'

{
"issued_to": "223044615559.apps.googleusercontent.com",
"audience": "223044615559.apps.googleusercontent.com",
"user_id": "139746512919298469201",
"scope": "openid https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/cloud-platform https://www.googleapis.com/auth/appengine.admin https://www.googleapis.com/auth/sqlservice.login https://www.googleapis.com/auth/compute https://www.googleapis.com/auth/accounts.reauth",
"expires_in": 2253,
"email": "username@testing.com",
"verified_email": true,
"access_type": "offline"
}
```
{% endcode %}

рдкрд┐рдЫрд▓реЗ **scopes** рд╡реЗ рд╣реИрдВ рдЬреЛ **`gcloud`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП **рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рдЖрдк **`gcloud`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдкрд╣рд▓реЗ рдПрдХ OAuth рдЯреЛрдХрди рдмрдирд╛рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рддреЗ рд╣реИрдВред

рдЙрдирдореЗрдВ рд╕реЗ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг scope **`cloud-platform`** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдореВрд▓ рд░реВрдк рд╕реЗ рдпрд╣ рдорддрд▓рдм рд╣реИ рдХрд┐ GCP рдореЗрдВ рдХрд┐рд╕реА рднреА рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдВрднрд╡ рд╣реИред

рдЖрдк [**рдпрд╣рд╛рдБ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд scopes рдХреА рд╕реВрдЪреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ**](https://developers.google.com/identity/protocols/googlescopes)**ред**

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **`gcloud`** рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рд╣реИрдВ, рддреЛ рдЕрдиреНрдп scopes рдХреЗ рд╕рд╛рде рдПрдХ рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЗрд╕ рддрд░рд╣ рдХреБрдЫ рдХрд░рдХреЗ:

{% code overflow="wrap" %}
```bash
# Maybe you can get a user token with other scopes changing the scopes array from ~/.config/gcloud/credentials.db

# Set new scopes for SDKs credentials
gcloud auth application-default login --scopes=https://www.googleapis.com/auth/userinfo.email,https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/sqlservice.login,https://www.googleapis.com/auth/appengine.admin,https://www.googleapis.com/auth/compute,https://www.googleapis.com/auth/accounts.reauth,https://www.googleapis.com/auth/admin.directory.user,https://www.googleapis.com/auth/admin.directory.group,https://www.googleapis.com/auth/admin.directory.domain

# Print new token
gcloud auth application-default print-access-token

# To use this token with some API you might need to use curl to indicate the project header with --header "X-Goog-User-Project: <project-name>"
```
{% endcode %}

## **Terraform IAM рдиреАрддрд┐рдпрд╛рдБ, рдмрд╛рдЗрдВрдбрд┐рдВрдЧреНрд╕ рдФрд░ рд╕рджрд╕реНрдпрддрд╛**

Terraform рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреЗ рдЕрдиреБрд╕рд╛рд░ [https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google\_project\_iam](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google\_project\_iam) рдореЗрдВ GCP рдХреЗ рд╕рд╛рде terraform рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рд╕рдВрд╕рд╛рдзрди рдкрд░ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдХреЛ рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ рд╣реИрдВ:

* **рд╕рджрд╕реНрдпрддрд╛**: рдЖрдк **рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рд╕рджрд╕реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ рдХреЛ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ** **рдмрд┐рдирд╛ рдХрд┐рд╕реА рдкреНрд░рддрд┐рдмрдВрдз рдХреЗ** рднреВрдорд┐рдХрд╛ рдпрд╛ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ рдкрд░ред рдЖрдк рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдПрдХ рднреВрдорд┐рдХрд╛ рдХрд╛ рд╕рджрд╕реНрдп рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдПрдХ рд╕рдореВрд╣ рдХреЛ рдЙрд╕реА рднреВрдорд┐рдХрд╛ рдХрд╛ рд╕рджрд╕реНрдп рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрди рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рд╕рдореВрд╣) рдХреЛ рдЕрдиреНрдп рднреВрдорд┐рдХрд╛рдУрдВ рдХрд╛ рд╕рджрд╕реНрдп рднреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдмрд╛рдЗрдВрдбрд┐рдВрдЧреНрд╕**: рдХрдИ **рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ рдХреЛ рдПрдХ рднреВрдорд┐рдХрд╛ рд╕реЗ рдмрд╛рдЗрдВрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рд╡реЗ **рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ рдЕрднреА рднреА рдЕрдиреНрдп рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рд╕рджрд╕реНрдп рдпрд╛ рдмрд╛рдЗрдВрдб рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд░ рдПрдХ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдЬреЛ рднреВрдорд┐рдХрд╛ рд╕реЗ рдмрд╛рдЗрдВрдб рдирд╣реАрдВ рд╣реИ, рдЙрд╕реЗ **рдмрд╛рдЗрдВрдб рднреВрдорд┐рдХрд╛ рдХрд╛ рд╕рджрд╕реНрдп рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рддреЛ рдЕрдЧрд▓реА рдмрд╛рд░ рдЬрдм **рдмрд╛рдЗрдВрдбрд┐рдВрдЧ рд▓рд╛рдЧреВ рдХреА рдЬрд╛рддреА рд╣реИ, рд╕рджрд╕реНрдпрддрд╛ рдЧрд╛рдпрдм рд╣реЛ рдЬрд╛рдПрдЧреА**ред
* **рдиреАрддрд┐рдпрд╛рдБ**: рдПрдХ рдиреАрддрд┐ **рдЖрдзрд┐рдХрд╛рд░рд┐рдХ** рд╣реЛрддреА рд╣реИ, рдпрд╣ рднреВрдорд┐рдХрд╛рдУрдВ рдФрд░ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИ рдФрд░ рдлрд┐рд░, **рдЙрди рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ рдХреЗ рдкрд╛рд╕ рдЕрдзрд┐рдХ рднреВрдорд┐рдХрд╛рдПрдБ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдФрд░ рдЙрди рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рдкрд╛рд╕ рдЕрдзрд┐рдХ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓реНрд╕ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрдм рддрдХ рдХрд┐ рдЙрд╕ рдиреАрддрд┐ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ (рдЕрдиреНрдп рдиреАрддрд┐рдпреЛрдВ, рдмрд╛рдЗрдВрдбрд┐рдВрдЧреНрд╕ рдпрд╛ рд╕рджрд╕реНрдпрддрд╛рдУрдВ рдореЗрдВ рднреА рдирд╣реАрдВ)ред рдЗрд╕рд▓рд┐рдП, рдЬрдм рдПрдХ рднреВрдорд┐рдХрд╛ рдпрд╛ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдХреЛ рдиреАрддрд┐ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдЙрд╕рдХреЗ рд╕рднреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ **рдЙрд╕ рдиреАрддрд┐ рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рд╣реЛрддреЗ рд╣реИрдВ**ред рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рддрдм рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдХреЛ рдиреАрддрд┐ рдпрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдирдпрд╛ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдмрдирд╛рдирд╛ рдФрд░ рдЙрд╕реЗ рдПрдХ рдирдИ рднреВрдорд┐рдХрд╛ рдмрд╛рдЗрдВрдб рдХрд░рдирд╛)ред

## рд╕рдВрджрд░реНрдн

* [https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/](https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдкрд░ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**ред
* **HackTricks** рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
