# GCP - Artifact Registry Kalıcılığı

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamını görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin.
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin.
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>

## Artifact Registry

Artifact Registry hakkında daha fazla bilgi için:

{% content-ref url="../gcp-services/gcp-artifact-registry-enum.md" %}
[gcp-artifact-registry-enum.md](../gcp-services/gcp-artifact-registry-enum.md)
{% endcontent-ref %}

### Bağımlılık Karışıklığı

* Sanal bir depoda **uzak ve standart** depolar **karıştırılırsa** ve bir paket her ikisinde de mevcutsa ne olur?
* Sanal depoda **en yüksek önceliğe sahip olan** kullanılır.
* Eğer **öncelik aynıysa**:
* Eğer **sürüm aynıysa**, sanal depoda alfabetik olarak ilk olan politika adı kullanılır.
* Değilse, **en yüksek sürüm** kullanılır.

{% hint style="danger" %}
Bu nedenle, uzak depo daha yüksek veya aynı önceliğe sahipse, bir kamu paket deposunda **en yüksek sürümü (bağımlılık karışıklığı)** kötüye kullanmak mümkündür.
{% endhint %}

Bu teknik, kalıcılık ve kimlik doğrulamasız erişim için kullanışlı olabilir, çünkü bunu kötüye kullanmak için Artifact Registry'de depolanan bir kütüphane adını bilmek ve aynı sürümle birlikte bu kütüphaneyi **genel depoya (örneğin Python için PyPi)** kaydetmek yeterlidir.

Kalıcılık için izlenmesi gereken adımlar şunlardır:

* **Gereksinimler**: Bir **sanal depo** olmalı ve kullanılmalı, **genel depoda** mevcut olmayan bir **isimli dahili paket** kullanılmalıdır.
* Uzak bir depo oluşturun (varsa)
* Uzak depoyu sanal depoya ekleyin
* Sanal kayıt defterinin politikalarını düzenleyerek uzak depoya daha yüksek bir öncelik (veya aynı) verin.\
Aşağıdakine benzer bir şey çalıştırın:
* [gcloud artifacts repositories update --upstream-policy-file ...](https://cloud.google.com/sdk/gcloud/reference/artifacts/repositories/update#--upstream-policy-file)
* Yasal paketi indirin, kötü amaçlı kodunuzu ekleyin ve aynı sürümle genel depoya kaydedin. Her bir geliştirici bunu yüklediğinde, sizinkini yükleyecektir!

Bağımlılık karışıklığı hakkında daha fazla bilgi için:

{% embed url="https://book.hacktricks.xyz/pentesting-web/dependency-confusion" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamını görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin.
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin.
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>
