# Bulut Test Metodolojisi

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin!</summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamını görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'i **takip edin**.
* Hacking hilelerinizi göndererek HackTricks ve HackTricks Cloud github depolarına **katkıda bulunun**.

</details>

<figure><img src="../.gitbook/assets/CLOUD-logo-letters.svg" alt=""><figcaption></figcaption></figure>

## Temel Metodoloji

Her bulutun kendine özgü özellikleri olsa da, genel olarak bir bulut ortamını test ederken bir pentester'ın kontrol etmesi gereken birkaç **ortak şey** vardır:

* **Benchmarks kontrolleri**
* Bu, ortamın **boyutunu** ve **kullanılan hizmetleri** anlamanıza yardımcı olur
* Ayrıca, bu testlerin çoğunu **otomatik araçlarla** gerçekleştirebileceğiniz için bazı **hızlı yanlı yapılandırmaları** bulmanıza olanak sağlar
* **Hizmetlerin Sıralaması**
* Eğer benchmark testlerini doğru bir şekilde gerçekleştirdiyseniz, burada çok fazla yanlı yapılandırma bulamayabilirsiniz, ancak benchmark testinde aranmayan bazı yanlı yapılandırmaları bulabilirsiniz.
* Bu, bulut ortamında **tam olarak neyin kullanıldığını** bilmenizi sağlar
* Bu, bir sonraki adımlarda çok yardımcı olacaktır
* **Açığa çıkarılan varlıkları kontrol edin**
* Bu, önceki bölümde yapılabilir, potansiyel olarak İnternet'e açık olan her şeyi ve nasıl erişilebileceğini **bulmanız gerekmektedir**.
* Burada, web sayfaları veya diğer portlarla açığa çıkarılan **manuel olarak açığa çıkarılan altyapıyı** ve ayrıca açığa çıkarılabilecek diğer **bulut yönetilen hizmetleri** (örneğin DB'ler veya kovalar) ele alıyorum.
* Ardından, **o kaynağın açığa çıkarılıp çıkarılamayacağını** kontrol etmelisiniz (gizli bilgi mi? zafiyetler mi? açığa çıkarılan hizmette yanlı yapılandırmalar mı?)
* **İzinleri kontrol edin**
* Burada, bulutta her bir rol/kullanıcının **tüm izinlerini bulmanız** ve nasıl kullanıldığını öğrenmeniz gerekmektedir
* Çok fazla **yüksek ayrıcalıklı** (her şeyi kontrol eden) hesap mı var? Kullanılmayan oluşturulmuş anahtarlar mı var?... Bu kontrollerin çoğu zaten benchmark testlerinde yapılmış olmalıdır
* İstemci OpenID veya SAML veya diğer **federasyon** kullanıyorsa, her bir rolün nasıl atanmış olduğu hakkında daha fazla **bilgi** istemeniz gerekebilir (admin rolünün 1 kullanıcıya mı yoksa 100 kullanıcıya mı atanmış olduğu aynı değildir)
* Sadece hangi kullanıcıların **admin** izinlerine sahip olduğunu bulmak yeterli değildir "\*:\*". Kullanılan hizmetlere bağlı olarak çok sayıda **diğer izin** vardır ve bunlar çok **duyarlı** olabilir.
* Dahası, izinleri kötüye kullanarak takip edilebilecek **potansiyel ayrıcalık yükseltme** yolları vardır. Tüm bu şeyler göz önünde bulundurulmalı ve mümkün olan **en fazla ayrıcalık yükseltme yolu** bildirilmelidir.
* **Entegrasyonları kontrol edin**
* Muhtemelen bulut ortamında **diğer bulutlar veya SaaS'larla entegrasyonlar** kullanılıyor.
* Denetlediğiniz bulutun **diğer platformlarla entegrasyonları** için, o entegrasyona **kimin erişimi olduğunu (kötüye kullanma)** bildirmeli ve yapılan işlemin **ne kadar duyarlı** olduğunu sormalısınız.\
Örneğin, GCP'nin veri aldığı bir AWS kovasına kimin yazabileceğini (GCP'nin o veriyi nasıl işlediğini sormalısınız).
* Dış platformlardan denetlediğiniz buluta **entegre olan entegrasyonlar** için, o entegrasyona **dışarıdan kimin erişimi olduğunu (kötüye kullanma)** sormalı ve o verinin nasıl kullanıldığını kontrol etmelisiniz.\
Örneğin, bir hizmetin GCR'de barındırılan bir Docker görüntüsünü kullandığı durumda, kimin bunu değiştirmeye erişimi olduğunu ve bu görüntünün bir AWS bulutunda çalıştırıldığında hangi hassas bilgilere ve erişime sahip olacağını sormalısınız.

## Çoklu Bulut Araçları

Farklı bulut ortamlarını test etmek için kullanılabilecek birkaç araç vardır. Kurulum adımları ve bağlantılar bu bölümde belirtilecektir.

### [PurplePanda](https://github.com/carlospolop/purplepanda)

Bulutlarda ve bulutlar/SaaS'lar arasında **yanlı yapılandırmaları ve ayrıcalık yükseltme yollarını belirlemek için bir araç.**

{% tabs %}
{% tab title="Kurulum" %}
```bash
# You need to install and run neo4j also
git clone https://github.com/carlospolop/PurplePanda
cd PurplePanda
python3 -m venv .
source bin/activate
python3 -m pip install -r requirements.txt
export PURPLEPANDA_NEO4J_URL="bolt://neo4j@localhost:7687"
export PURPLEPANDA_PWD="neo4j_pwd_4_purplepanda"
python3 main.py -h # Get help
```
{% endtab %}

{% tab title="GCP" %}GCP (Google Cloud Platform) Pentesting Methodology
=======================================

This section describes the methodology for performing penetration testing on Google Cloud Platform (GCP) environments.

1. **Reconnaissance**
   - Identify the target GCP environment and gather information about the target organization.
   - Enumerate GCP services and resources.
   - Identify potential attack vectors and vulnerabilities.

2. **Scanning and Enumeration**
   - Scan for open ports and services.
   - Enumerate GCP resources, such as instances, buckets, and databases.
   - Identify misconfigurations and security weaknesses.

3. **Vulnerability Assessment**
   - Conduct vulnerability scanning and assessment on GCP resources.
   - Identify and prioritize vulnerabilities based on severity.
   - Verify the existence of vulnerabilities through manual testing.

4. **Exploitation**
   - Exploit identified vulnerabilities to gain unauthorized access or escalate privileges.
   - Test for common misconfigurations and weak security controls.
   - Attempt to bypass security mechanisms and gain unauthorized access to sensitive data.

5. **Post-Exploitation**
   - Maintain access to compromised systems.
   - Conduct lateral movement and privilege escalation.
   - Gather and exfiltrate sensitive data.

6. **Reporting**
   - Document all findings, including vulnerabilities, exploits, and sensitive data accessed.
   - Provide recommendations for remediation and improving security posture.
   - Present the findings to the client in a clear and concise manner.

7. **Cleanup**
   - Remove any traces of the penetration testing activities.
   - Restore systems and configurations to their original state.
   - Ensure that no sensitive data is left behind.

It is important to note that penetration testing should only be performed with proper authorization and in a controlled environment to minimize the risk of causing harm or disruption to the target organization.
```bash
export GOOGLE_DISCOVERY=$(echo 'google:
- file_path: ""

- file_path: ""
service_account_id: "some-sa-email@sidentifier.iam.gserviceaccount.com"' | base64)

python3 main.py -a -p google #Get basic info of the account to check it's correctly configured
python3 main.py -e -p google #Enumerate the env
```
{% endtab %}
{% endtabs %}

### [Prowler](https://github.com/prowler-cloud/prowler)

AWS, GCP ve Azure'yi destekler. Her sağlayıcının nasıl yapılandırılacağını [https://docs.prowler.cloud/en/latest/#aws](https://docs.prowler.cloud/en/latest/#aws) adresinden kontrol edin.
```bash
# Install
pip install prowler
prowler -v

# Run
prowler <provider>
# Example
prowler aws --profile custom-profile [-M csv json json-asff html]

# Get info about checks & services
prowler <provider> --list-checks
prowler <provider> --list-services
```
### [CloudSploit](https://github.com/aquasecurity/cloudsploit)

AWS, Azure, Github, Google, Oracle, Alibaba

{% tabs %}
{% tab title="Kurulum" %}
```bash
# Install
git clone https://github.com/aquasecurity/cloudsploit.git
cd cloudsploit
npm install
./index.js -h
## Docker instructions in github
```
{% endtab %}

{% tab title="GCP" %}GCP (Google Cloud Platform) Pentesting Methodology
=======================================

This section describes the methodology for performing penetration testing on Google Cloud Platform (GCP) environments.

1. **Reconnaissance**
   - Identify the target GCP environment and gather information about the target organization.
   - Enumerate GCP services and resources.
   - Identify potential attack vectors and vulnerabilities.

2. **Scanning and Enumeration**
   - Scan for open ports and services.
   - Enumerate GCP resources, such as instances, buckets, and databases.
   - Identify misconfigurations and security weaknesses.

3. **Vulnerability Assessment**
   - Conduct vulnerability scanning and assessment on GCP resources.
   - Identify and prioritize vulnerabilities based on severity.
   - Verify the existence of vulnerabilities through manual testing.

4. **Exploitation**
   - Exploit identified vulnerabilities to gain unauthorized access or escalate privileges.
   - Test for common misconfigurations and weak security controls.
   - Attempt to bypass security mechanisms and gain unauthorized access to sensitive data.

5. **Post-Exploitation**
   - Maintain access to compromised systems.
   - Conduct lateral movement and privilege escalation.
   - Gather and exfiltrate sensitive data.

6. **Reporting**
   - Document all findings, including vulnerabilities, exploits, and sensitive data accessed.
   - Provide recommendations for remediation and improving security posture.
   - Present the findings to the client in a clear and concise manner.

7. **Cleanup**
   - Remove any traces of the penetration testing activities.
   - Restore systems and configurations to their original state.
   - Ensure that no sensitive data is left behind.

It is important to note that penetration testing should only be performed with proper authorization and in a controlled environment to minimize the risk of causing harm or disruption to the target organization.
```bash
## You need to have creds for a service account and set them in config.js file
./index.js --cloud google --config </abs/path/to/config.js>
```
{% endtab %}
{% endtabs %}

### [ScoutSuite](https://github.com/nccgroup/ScoutSuite)

AWS, Azure, GCP, Alibaba Cloud, Oracle Cloud Infrastructure

{% tabs %}
{% tab title="Kurulum" %}
```bash
mkdir scout; cd scout
virtualenv -p python3 venv
source venv/bin/activate
pip install scoutsuite
scout --help
## Using Docker: https://github.com/nccgroup/ScoutSuite/wiki/Docker-Image
```
{% endtab %}

{% tab title="GCP" %}GCP (Google Cloud Platform) bulut platformunda pentesting yaparken, aşağıdaki metodolojiyi takip etmek faydalı olabilir:

1. Bilgi Toplama: Hedef hakkında mümkün olduğunca çok bilgi toplayın. Hedefin IP adresleri, alt alanları, hedefin kullanıcıları ve hedefin kullandığı GCP hizmetleri gibi bilgileri belirlemeye çalışın.

2. Zayıf Noktaları Belirleme: Hedefteki zayıf noktaları tespit etmek için otomatik tarama araçları kullanın. Ayrıca, hedefin güvenlik yapılandırmalarını ve hizmetlerini inceleyerek potansiyel zayıf noktaları belirlemeye çalışın.

3. Kimlik Doğrulama ve Yetkilendirme: Hedefin kimlik doğrulama ve yetkilendirme mekanizmalarını test edin. Kullanıcı hesaplarının güçlü parolalarla korunduğunu ve gereksiz ayrıcalıkların olmadığını doğrulayın.

4. Veri Sızdırmazlık: Hedefteki veri sızıntılarını tespit etmek için hassas bilgileri içeren dosyaları arayın. Bu dosyaları hedef sistemlerden çalmak veya erişmek için yöntemler araştırın.

5. Ağ Keşfi: Hedefin ağ yapısını ve hedef sistemler arasındaki ilişkileri anlamak için ağ keşfi yapın. Ağdaki açık portları, hedef sistemlerin IP adreslerini ve hedef sistemler arasındaki iletişimi belirlemeye çalışın.

6. Zafiyet Taraması: Hedef sistemlerdeki zafiyetleri tespit etmek için otomatik zafiyet tarama araçları kullanın. Bu taramaları düzenli olarak tekrarlayarak yeni zafiyetlerin ortaya çıkmasını takip edin.

7. Sosyal Mühendislik: Hedefin çalışanlarını manipüle etmek veya yanıltmak için sosyal mühendislik tekniklerini kullanın. Bu, kullanıcıların kimlik bilgilerini ifşa etmelerini veya kötü amaçlı yazılımları açmalarını sağlamak için yapılabilir.

8. Uzaktan Erişim: Hedef sistemlere uzaktan erişim sağlamak için güvenlik açıklarını kullanın. Bu, hedef sistemlere yetkisiz erişim sağlamak veya hedef sistemlerde kötü amaçlı yazılımlar çalıştırmak için kullanılabilir.

9. İzleme ve Erişim Kontrolü: Hedef sistemlerdeki izleme ve erişim kontrol mekanizmalarını test edin. Bu, hedef sistemlerdeki güvenlik olaylarını izlemek ve yetkisiz erişimi engellemek için kullanılan mekanizmaları değerlendirmenizi sağlar.

10. Raporlama: Tüm bulgularınızı ve keşiflerinizi ayrıntılı bir rapor halinde sunun. Bu rapor, hedefin güvenlik açıklarını ve potansiyel riskleri anlamalarına yardımcı olacaktır.

Bu metodolojiyi takip ederek GCP üzerinde pentesting yaparken daha etkili ve sistematik bir yaklaşım benimseyebilirsiniz. Ancak, her zaman hedefin izni ve onayı olmadan pentesting yapmamalısınız.
```bash
scout gcp --report-dir /tmp/gcp --user-account --all-projects
## use "--service-account KEY_FILE" instead of "--user-account" to use a service account

SCOUT_FOLDER_REPORT="/tmp"
for pid in $(gcloud projects list --format="value(projectId)"); do
echo "================================================"
echo "Checking $pid"
mkdir "$SCOUT_FOLDER_REPORT/$pid"
scout gcp --report-dir "$SCOUT_FOLDER_REPORT/$pid" --no-browser --user-account --project-id "$pid"
done
```
{% endtab %}
{% endtabs %}

### [Steampipe](https://github.com/turbot)

{% tabs %}
{% tab title="Kurulum" %}
Steampipe'i indirin ve kurun ([https://steampipe.io/downloads](https://steampipe.io/downloads)). Veya Brew kullanın:
```
brew tap turbot/tap
brew install steampipe
```
{% endtab %}

{% tab title="GCP" %}GCP (Google Cloud Platform) Pentesting Methodology
=======================================

This section describes the methodology for performing penetration testing on Google Cloud Platform (GCP) environments.

1. **Reconnaissance**
   - Identify the target GCP environment and gather information about the target organization.
   - Enumerate GCP services and resources.
   - Identify potential attack vectors and vulnerabilities.

2. **Scanning and Enumeration**
   - Scan for open ports and services.
   - Enumerate GCP resources, such as instances, buckets, and databases.
   - Identify misconfigurations and security weaknesses.

3. **Vulnerability Assessment**
   - Conduct vulnerability scanning and assessment on GCP resources.
   - Identify and prioritize vulnerabilities based on severity.
   - Verify the existence of vulnerabilities through manual testing.

4. **Exploitation**
   - Exploit identified vulnerabilities to gain unauthorized access or escalate privileges.
   - Test for common misconfigurations and weak access controls.
   - Attempt to bypass security controls and gain unauthorized access to sensitive data.

5. **Post-Exploitation**
   - Maintain access to compromised systems.
   - Conduct lateral movement and privilege escalation.
   - Gather and exfiltrate sensitive data.

6. **Reporting**
   - Document all findings, including vulnerabilities, exploits, and sensitive data accessed.
   - Provide recommendations for remediation and improving security posture.
   - Present the findings to the client in a clear and concise manner.

It is important to note that penetration testing should only be performed with proper authorization and in a controlled environment to minimize the risk of causing harm or disruption to the target organization.
```bash
# Install gcp plugin
steampipe plugin install gcp

# Use https://github.com/turbot/steampipe-mod-gcp-compliance.git
git clone https://github.com/turbot/steampipe-mod-gcp-compliance.git
cd steampipe-mod-gcp-compliance
# To run all the checks from the dashboard
steampipe dashboard
# To run all the checks from rhe cli
steampipe check all
```
<details>

<summary>Tüm Projeleri Kontrol Et</summary>

Tüm projeleri kontrol etmek için test edilecek tüm projeleri belirten `gcp.spc` dosyasını oluşturmanız gerekmektedir. Aşağıdaki betikteki talimatları takip edebilirsiniz.
```bash
FILEPATH="/tmp/gcp.spc"
rm -rf "$FILEPATH" 2>/dev/null

# Generate a json like object for each project
for pid in $(gcloud projects list --format="value(projectId)"); do
echo "connection \"gcp_$(echo -n $pid | tr "-" "_" )\" {
plugin  = \"gcp\"
project = \"$pid\"
}" >> "$FILEPATH"
done

# Generate the aggragator to call
echo 'connection "gcp_all" {
plugin      = "gcp"
type        = "aggregator"
connections = ["gcp_*"]
}' >> "$FILEPATH"

echo "Copy $FILEPATH in ~/.steampipe/config/gcp.spc if it was correctly generated"
```
</details>

Diğer GCP bilgilerini kontrol etmek için (hizmetleri sıralamak için kullanışlı) şunu kullanın: [https://github.com/turbot/steampipe-mod-gcp-insights](https://github.com/turbot/steampipe-mod-gcp-insights)

Terraform GCP kodunu kontrol etmek için: [https://github.com/turbot/steampipe-mod-terraform-gcp-compliance](https://github.com/turbot/steampipe-mod-terraform-gcp-compliance)

Daha fazla GCP eklentisi için Steampipe: [https://github.com/turbot?q=gcp](https://github.com/turbot?q=gcp)
{% endtab %}

{% tab title="AWS" %}
```bash
# Install aws plugin
steampipe plugin install aws

# Modify the spec indicating in "profile" the profile name to use
nano ~/.steampipe/config/aws.spc

# Get some info on how the AWS account is being used
git clone https://github.com/turbot/steampipe-mod-aws-insights.git
cd steampipe-mod-aws-insights
steampipe dashboard

# Get the services exposed to the internet
git clone https://github.com/turbot/steampipe-mod-aws-perimeter.git
cd steampipe-mod-aws-perimeter
steampipe dashboard

# Run the benchmarks
git clone https://github.com/turbot/steampipe-mod-aws-compliance
cd steampipe-mod-aws-compliance
steampipe dashboard # To see results in browser
steampipe check all --export=/tmp/output4.json
```
Terraform AWS kodunu kontrol etmek için: [https://github.com/turbot/steampipe-mod-terraform-aws-compliance](https://github.com/turbot/steampipe-mod-terraform-aws-compliance)

Steampipe'nin diğer AWS eklentileri: [https://github.com/orgs/turbot/repositories?q=aws](https://github.com/orgs/turbot/repositories?q=aws)
{% endtab %}
{% endtabs %}

### [~~cs-suite~~](https://github.com/SecurityFTW/cs-suite)

AWS, GCP, Azure, DigitalOcean.\
Python2.7 gerektirir ve bakımsız görünüyor.

### Nessus

Nessus, AWS, Azure, Office 365, Rackspace, Salesforce'u destekleyen bir _**Audit Cloud Infrastructure**_ taramasına sahiptir. **Azure** için bazı ek yapılandırmalar bir **Client Id** elde etmek için gereklidir.

### [**cloudlist**](https://github.com/projectdiscovery/cloudlist)

Cloudlist, Bulut Sağlayıcılardan Varlıkları (Ana Bilgisayar Adları, IP Adresleri) almak için bir **çoklu bulut aracıdır**.
```bash
cd /tmp
wget https://github.com/projectdiscovery/cloudlist/releases/latest/download/cloudlist_1.0.1_macOS_arm64.zip
unzip cloudlist_1.0.1_macOS_arm64.zip
chmod +x cloudlist
sudo mv cloudlist /usr/local/bin
```
{% endtab %}

{% tab title="İkinci Sekme" %}
```bash
## For GCP it requires service account JSON credentials
cloudlist -config </path/to/config>
```
{% endtab %}
{% endtabs %}

### [**cartography**](https://github.com/lyft/cartography)

Cartography, bir Neo4j veritabanı tarafından desteklenen sezgisel bir graf görünümünde altyapı varlıklarını ve aralarındaki ilişkileri birleştiren bir Python aracıdır.

{% tabs %}
{% tab title="Kurulum" %}
```bash
# Installation
docker image pull ghcr.io/lyft/cartography
docker run --platform linux/amd64 ghcr.io/lyft/cartography cartography --help
## Install a Neo4j DB version 3.5.*
```
{% endtab %}

{% tab title="GCP" %}GCP (Google Cloud Platform) Pentesting Methodology
=======================================

This section describes the methodology for performing penetration testing on Google Cloud Platform (GCP) environments.

1. **Reconnaissance**
   - Identify the target GCP environment and gather information about the target organization.
   - Enumerate GCP services and resources.
   - Identify potential attack vectors and vulnerabilities.

2. **Scanning and Enumeration**
   - Scan for open ports and services.
   - Enumerate GCP resources, such as instances, buckets, and databases.
   - Identify misconfigurations and security weaknesses.

3. **Vulnerability Assessment**
   - Conduct vulnerability scanning and assessment on GCP resources.
   - Identify and prioritize vulnerabilities based on severity.
   - Verify the existence of vulnerabilities through manual testing.

4. **Exploitation**
   - Exploit identified vulnerabilities to gain unauthorized access or escalate privileges.
   - Test for common misconfigurations and weak access controls.
   - Attempt to bypass security controls and gain unauthorized access to sensitive data.

5. **Post-Exploitation**
   - Maintain access to compromised systems.
   - Conduct lateral movement and privilege escalation.
   - Gather and exfiltrate sensitive data.

6. **Reporting**
   - Document all findings, including vulnerabilities, exploits, and sensitive data accessed.
   - Provide recommendations for remediation and improving security posture.
   - Present the findings to the client in a clear and concise manner.

It is important to note that penetration testing should only be performed with proper authorization and in a controlled environment to minimize the risk of causing harm or disruption to the target organization.
```bash
docker run --platform linux/amd64 \
--volume "$HOME/.config/gcloud/application_default_credentials.json:/application_default_credentials.json" \
-e GOOGLE_APPLICATION_CREDENTIALS="/application_default_credentials.json" \
-e NEO4j_PASSWORD="s3cr3t" \
ghcr.io/lyft/cartography  \
--neo4j-uri bolt://host.docker.internal:7687 \
--neo4j-password-env-var NEO4j_PASSWORD \
--neo4j-user neo4j


# It only checks for a few services inside GCP (https://lyft.github.io/cartography/modules/gcp/index.html)
## Cloud Resource Manager
## Compute
## DNS
## Storage
## Google Kubernetes Engine
### If you can run starbase or purplepanda you will get more info
```
{% endtab %}
{% endtabs %}

### [**starbase**](https://github.com/JupiterOne/starbase)

Starbase, bulut altyapısı, SaaS uygulamaları, güvenlik kontrolleri ve daha fazlası gibi hizmetlerden ve sistemlerden varlıkları ve ilişkileri toplar ve Neo4j veritabanı tarafından desteklenen sezgisel bir grafik görünümüne dönüştürür.

{% tabs %}
{% tab title="Kurulum" %}
```bash
# You are going to need Node version 14, so install nvm following https://tecadmin.net/install-nvm-macos-with-homebrew/
npm install --global yarn
nvm install 14
git clone https://github.com/JupiterOne/starbase.git
cd starbase
nvm use 14
yarn install
yarn starbase --help
# Configure manually config.yaml depending on the env to analyze
yarn starbase setup
yarn starbase run

# Docker
git clone https://github.com/JupiterOne/starbase.git
cd starbase
cp config.yaml.example config.yaml
# Configure manually config.yaml depending on the env to analyze
docker build --no-cache -t starbase:latest .
docker-compose run starbase setup
docker-compose run starbase run
```
{% endtab %}

{% tab title="GCP" %}GCP (Google Cloud Platform) Pentesting Methodology
=======================================

This section describes the methodology for performing penetration testing on Google Cloud Platform (GCP) environments.

1. **Reconnaissance**
   - Identify the target GCP environment and gather information about the target organization.
   - Enumerate GCP services and resources.
   - Identify potential attack vectors and vulnerabilities.

2. **Scanning and Enumeration**
   - Scan for open ports and services.
   - Enumerate GCP resources, such as instances, buckets, and databases.
   - Identify misconfigurations and security weaknesses.

3. **Vulnerability Assessment**
   - Conduct vulnerability scanning and assessment on GCP resources.
   - Identify and prioritize vulnerabilities based on severity.
   - Verify the existence of vulnerabilities through manual testing.

4. **Exploitation**
   - Exploit identified vulnerabilities to gain unauthorized access or escalate privileges.
   - Test for common misconfigurations and weak security controls.
   - Attempt to bypass security mechanisms and gain unauthorized access to sensitive data.

5. **Post-Exploitation**
   - Maintain access to compromised systems.
   - Conduct lateral movement and privilege escalation.
   - Gather and exfiltrate sensitive data.

6. **Reporting**
   - Document all findings, including vulnerabilities, exploits, and sensitive data accessed.
   - Provide recommendations for remediation and improving security posture.
   - Present the findings to the client in a clear and concise manner.

7. **Cleanup**
   - Remove any traces of the penetration testing activities.
   - Restore systems and configurations to their original state.
   - Ensure that no sensitive data is left behind.

It is important to note that penetration testing should only be performed with proper authorization and in a controlled environment to minimize the risk of causing harm or disruption to the target organization.
```yaml
## Config for GCP
### Check out: https://github.com/JupiterOne/graph-google-cloud/blob/main/docs/development.md
### It requires service account credentials

integrations:
-
name: graph-google-cloud
instanceId: testInstanceId
directory: ./.integrations/graph-google-cloud
gitRemoteUrl: https://github.com/JupiterOne/graph-google-cloud.git
config:
SERVICE_ACCOUNT_KEY_FILE: '{Check https://github.com/JupiterOne/graph-google-cloud/blob/main/docs/development.md#service_account_key_file-string}'
PROJECT_ID: ""
FOLDER_ID: ""
ORGANIZATION_ID: ""
CONFIGURE_ORGANIZATION_PROJECTS: false

storage:
engine: neo4j
config:
username: neo4j
password: s3cr3t
uri: bolt://localhost:7687
#Consider using host.docker.internal if from docker
```
{% endtab %}
{% endtabs %}

### [**SkyArk**](https://github.com/cyberark/SkyArk)

Taranan AWS veya Azure ortamında en ayrıcalıklı kullanıcıları, AWS Shadow Admin'leri dahil olmak üzere keşfedin. PowerShell kullanır.
```powershell
Import-Module .\SkyArk.ps1 -force
Start-AzureStealth

# in the Cloud Console
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/cyberark/SkyArk/master/AzureStealth/AzureStealth.ps1')
Scan-AzureAdmins
```
### [Cloud Brute](https://github.com/0xsha/CloudBrute)

Bir şirketin (hedef) altyapısını, dosyalarını ve uygulamalarını en popüler bulut sağlayıcılarında (Amazon, Google, Microsoft, DigitalOcean, Alibaba, Vultr, Linode) bulmak için bir araç.

### [CloudFox](https://github.com/BishopFox/cloudfox)

* CloudFox, bulut altyapısında sömürülebilir saldırı yollarını bulmak için bir araçtır (şu anda yalnızca AWS ve Azure desteklenmektedir, GCP yakında gelecek).
* Bu, manuel pentesting'i tamamlayan bir numaralandırma aracıdır.
* Bulut ortamında herhangi bir veri oluşturmaz veya değiştirmez.

### Daha fazla bulut güvenlik aracı listesi

* [https://github.com/RyanJarv/awesome-cloud-sec](https://github.com/RyanJarv/awesome-cloud-sec)

## Google

### GCP

{% content-ref url="gcp-security/" %}
[gcp-security](gcp-security/)
{% endcontent-ref %}

### Workspace

{% content-ref url="workspace-security/" %}
[workspace-security](workspace-security/)
{% endcontent-ref %}

## AWS

{% content-ref url="aws-security/" %}
[aws-security](aws-security/)
{% endcontent-ref %}

## Azure

{% content-ref url="azure-security/" %}
[azure-security](azure-security/)
{% endcontent-ref %}

### Saldırı Grafiği

[**Stormspotter** ](https://github.com/Azure/Stormspotter), bir Azure aboneliğindeki kaynakların bir "saldırı grafiği" oluşturur. Kırmızı takımların ve pentesterların kiracı içindeki saldırı yüzeyini ve dönüşüm fırsatlarını görselleştirmesini sağlar ve savunucularını hızla yönlendirir ve olay yanıtı çalışmalarını önceliklendirir.

### Office365

**Global Admin** veya en azından **Global Admin Reader** gereklidir (ancak Global Admin Reader biraz sınırlıdır). Bununla birlikte, bu sınırlamalar bazı PS modüllerinde ortaya çıkar ve özelliklere **web uygulaması üzerinden** erişerek atlanabilir.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **tanıtmak veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi Twitter'da takip edin 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live).
* Hacking hilelerinizi göndererek HackTricks ve HackTricks Cloud github reposuna PR göndererek **hacking hilelerinizi paylaşın**.

</details>
