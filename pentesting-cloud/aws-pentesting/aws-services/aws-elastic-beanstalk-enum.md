# AWS - Ukaguzi wa Elastic Beanstalk

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka mwanzo hadi mtaalamu na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Elastic Beanstalk

Amazon Elastic Beanstalk hutoa jukwaa rahisi kwa **kuweka, kusimamia, na kukuza maombi na huduma za wavuti**. Inasaidia lugha na fremu mbalimbali za programu, kama vile Java, .NET, PHP, Node.js, Python, Ruby, na Go, pamoja na kontena za Docker. Huduma hii inalingana na seva zinazotumiwa sana ikiwa ni pamoja na Apache, Nginx, Passenger, na IIS.

Elastic Beanstalk hutoa njia rahisi na mpana ya **kuweka maombi yako kwenye wingu la AWS**, bila haja ya kuhangaika kuhusu miundombinu inayotumika. **Inashughulikia moja kwa moja** maelezo ya uwezo wa **utoaji**, usawa wa mzigo, **kukuza**, na ufuatiliaji wa afya ya maombi, kuruhusu wewe kuzingatia kuandika na kuweka kwenye vitendo nambari yako.

Miundombinu inayoundwa na Elastic Beanstalk inasimamiwa na Vikundi vya **Kupanua Kiotomatiki** katika **EC2** (pamoja na balansa ya mzigo). Hii inamaanisha kwamba mwishoni mwa siku, ikiwa **unahatarisha mwenyeji**, unapaswa kujua kuhusu EC2:

{% content-ref url="../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Zaidi ya hayo, ikiwa Docker inatumika, ni rahisi kutumia **ECS**.

{% content-ref url="../../aws-security/aws-services/aws-eks-enum.md" %}
[aws-eks-enum.md](../../aws-security/aws-services/aws-eks-enum.md)
{% endcontent-ref %}

### Maombi & Mazingira

Katika AWS Elastic Beanstalk, dhana ya "maombi" na "mazingira" hutoa madhumuni tofauti na majukumu tofauti katika mchakato wa kuweka.

#### Maombi

* Maombi katika Elastic Beanstalk ni **kontena la mantiki kwa nambari ya chanzo ya maombi yako, mazingira, na mipangilio**. Inakusanya pamoja toleo tofauti za nambari ya maombi yako na kuruhusu wewe kuzisimamia kama kipengele kimoja.
* Unapounda maombi, unatoa jina na maelezo, lakini hakuna rasilimali zinazotolewa wakati huu. ni njia tu ya kuandaa na kusimamia nambari yako na rasilimali zinazohusiana.
* Unaweza kuwa na **toleo nyingi za maombi** ndani ya maombi. Kila toleo linalingana na kutolewa maalum la nambari yako, ambayo inaweza kuwekwa kwenye mazingira moja au zaidi.

#### Mazingira

* Mazingira ni **mfano uliowekwa wa maombi yako** unaoendesha kwenye miundombinu ya AWS. Ni **mahali ambapo nambari ya maombi yako inawekwa na kutekelezwa**. Elastic Beanstalk inaweka rasilimali zinazohitajika (k.m., EC2 instances, balansa za mzigo, vikundi vya kukuza kiotomatiki, maktaba) kulingana na usanidi wa mazingira.
* **Kila mazingira hufanya toleo moja la maombi yako**, na unaweza kuwa na mazingira mengi kwa madhumuni tofauti, kama vile maendeleo, majaribio, hatua ya awali, na uzalishaji.
* Unapounda mazingira, unachagua jukwaa (k.m., Java, .NET, Node.js, nk.) na aina ya mazingira (k.m., mtandao wa wavuti au mfanyakazi). Unaweza pia kubinafsisha usanidi wa mazingira ili kudhibiti vipengele mbalimbali vya miundombinu na mipangilio ya maombi.

### Aina 2 za Mazingira

1. **Mazingira ya Mtandao wa Wavuti**: Imetengenezwa kwa **kuandaa na kutumikia maombi ya wavuti na APIs**. Maombi haya kwa kawaida yanashughulikia maombi ya HTTP/HTTPS yanayoingia. Mazingira ya mtandao wa wavuti hutoa rasilimali kama **EC2 instances, balansa za mzigo, na vikundi vya kukuza kiotomatiki** kushughulikia trafiki inayoingia, kusimamia uwezo, na kuhakikisha upatikanaji wa juu wa maombi.
2. **Mazingira ya Mfanyakazi**: Imetengenezwa kusindika **kazi za nyuma**, ambazo mara nyingi ni shughuli zenye kuchukua muda au zinazohitaji rasilimali nyingi ambazo hazihitaji majibu ya moja kwa moja kwa wateja. Mazingira ya mfanyakazi hutoa rasilimali kama **EC2 instances na vikundi vya kukuza kiotomatiki**, lakini **haina balansa ya mzigo** kwa sababu haitumii moja kwa moja maombi ya HTTP/HTTPS. Badala yake, inatumia kazi kutoka kwenye **Amazon Simple Queue Service (SQS) queue**, ambayo inafanya kama kiwango kati ya mazingira ya mfanyakazi na kazi inazoprocess.

### Usalama

Unapounda Programu kwenye Beanstalk kuna chaguo 3 muhimu sana za usalama za kuchagua:

* **Jozi ya funguo ya EC2**: Hii itakuwa **funguo ya SSH** ambayo itaweza kufikia mifano ya EC2 inayoendesha programu
* **Profaili ya mfano wa IAM**: Hii ni **profaili ya mfano** ambayo mifano itakuwa nayo (**mamlaka ya IAM**)
* Jukumu linalozalishwa kiotomatiki linaitwa **`aws-elasticbeanstalk-ec2-role`** na lina ufikivu wa kuvutia juu ya ECS zote, SQS zote, DynamoDB, elasticbeanstalk na elasticbeanstalk S3 kwa kutumia sera zilizosimamiwa na AWS: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Jukumu la huduma**: Hii ni **jukumu ambalo huduma ya AWS** itatumia kufanya vitendo vyote vinavyohitajika. Kwa kadri ninavyojua, mtumiaji wa kawaida wa AWS hawezi kupata jukumu hilo.
* Jukumu hili lililozalishwa na AWS linaitwa **`aws-elasticbeanstalk-service-role`** na hutumia sera zilizosimamiwa na AWS [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) na [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

Kwa chaguo-msingi **toleo la metadata 1 limelemazwa**:

<figure><img src="../../../.gitbook/assets/image (18) (1) (2).png" alt=""><figcaption></figcaption></figure>
### Kufichua

Data ya Beanstalk imehifadhiwa kwenye **S3 bucket** yenye jina lifuatalo: **`elasticbeanstalk-<region>-<acc-id>`** (ikiwa iliumbwa kwenye konsoli ya AWS). Ndani ya bucket hili utapata **msimbo wa chanzo wa programu** uliopakiwa.

**URL** ya ukurasa uliozinduliwa ni **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
Ikiwa unapata **upatikanaji wa kusoma** kwenye bucket, unaweza **kusoma msimbo wa chanzo** na hata kupata **vitambulisho nyeti** ndani yake.

Ikiwa unapata **upatikanaji wa kuandika** kwenye bucket, unaweza **kurekebisha msimbo wa chanzo** ili **kuathiri** **jukumu la IAM** linalotumiwa na programu wakati inatekelezwa tena.
{% endhint %}

### Uainishaji

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
### Upatikanaji usiothibitishwa

{% content-ref url="../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Uthabiti

{% content-ref url="../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Baada ya Uvamizi

{% content-ref url="../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
