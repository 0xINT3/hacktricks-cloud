# AWS - Elastic Beanstalk Enum

<details>

<summary><strong>ハックトリックをサポートして特典を得る！</strong></summary>

* **HackTricksで会社を宣伝したい**場合や、**PEASSの最新バージョンを見たい**場合、または**HackTricksをPDFでダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式のPEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけて、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションを見つけましょう
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローしましょう 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)
* **ハッキングのトリックを共有する**ために、[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>

## Elastic Beanstalk

**Amazon Elastic Beanstalk**は、Java、.NET、PHP、Node.js、Python、Ruby、Go、Docker、Tomcatなどで開発されたWebアプリケーションやサービスを**簡単にデプロイ、実行、スケーリング**するための完全に管理されたサービスです。Apache、Nginx、Passenger、IISなどのよく知られたサーバー上で実行されます。

Elastic Beanstalkは、**基盤となるインフラストラクチャを気にする必要がない**AWSクラウドへのアプリケーションのデプロイを簡単かつ柔軟に行う方法を提供します。それは、容量のプロビジョニング、負荷分散、スケーリング、アプリケーションのヘルスモニタリングの詳細を**自動的に**処理し、コードの記述とデプロイに集中できるようにします。

Elastic Beanstalkによって作成されるインフラストラクチャは、**EC2**の**Autoscaling**グループによって管理されます（ロードバランサーを使用）。つまり、最終的には、ホストを**侵害**する場合は、EC2について知っている必要があります。

{% content-ref url="../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

また、Dockerを使用している場合は、**ECS**を使用することもできます。

{% content-ref url="../../aws-security/aws-services/aws-eks-enum.md" %}
[aws-eks-enum.md](../../aws-security/aws-services/aws-eks-enum.md)
{% endcontent-ref %}

### アプリケーションと環境

AWS Elastic Beanstalkでは、「アプリケーション」と「環境」という概念が異なる目的で使用され、展開プロセスにおいて異なる役割を果たします。

#### アプリケーション

* Elastic Beanstalkのアプリケーションは、アプリケーションのソースコード、環境、設定の**論理的なコンテナ**です。異なるバージョンのアプリケーションコードをグループ化し、単一のエンティティとして管理することができます。
* アプリケーションを作成すると、名前と説明を提供しますが、この段階では**リソースはプロビジョニングされません**。単にコードと関連するリソースを整理して管理するための方法です。
* アプリケーション内には**複数のアプリケーションバージョン**を持つことができます。各バージョンは、1つ以上の環境にデプロイできるコードの特定のリリースに対応しています。

#### 環境

* 環境は、AWSインフラストラクチャ上で実行される、**アプリケーションのプロビジョンされたインスタンス**です。ここにアプリケーションコードがデプロイされ、実行されます。Elastic Beanstalkは、環境構成に基づいて必要なリソース（例：EC2インスタンス、ロードバランサー、自動スケーリンググループ、データベース）をプロビジョニングします。
* **各環境はアプリケーションの単一のバージョンを実行**し、開発、テスト、ステージング、本番などの異なる目的のために複数の環境を持つことができます。
* 環境を作成する際には、プラットフォーム（Java、.NET、Node.jsなど）と環境タイプ（Webサーバーまたはワーカーなど）を選択します。また、環境構成をカスタマイズして、インフラストラクチャとアプリケーションのさまざまな設定を制御することもできます。

### 2種類の環境

1. **Webサーバー環境**：WebアプリケーションやAPIを**ホストおよび提供**するために設計されています。これらのアプリケーションは通常、受信したHTTP/HTTPSリクエストを処理します。Webサーバー環境は、受信トラフィックの処理、容量の管理、アプリケーションの高可用性の確保などのために、**EC2インスタンス、ロードバランサー、自動スケーリング**グループなどのリソースをプロビジョニングします。
2. **ワーカー環境**：**バックグラウンドタスク**を処理するために設計されています。これらのタスクは通常、クライアントへの即時の応答を必要としない、時間のかかるまたはリソースを消費する操作です。ワーカー環境は、**EC2インスタンスと自動スケーリング**グループなどのリソースをプロビジョニングしますが、直接HTTP/HTTPSリクエストを処理しないため、ロードバランサーはありません。代わりに、ワーカー環境と処理するタスクの間にバッファとして機能する**Amazon Simple Queue Service (SQS)キュー**からタスクを消費します。

### セキュリティ

BeanstalkでAppを作成する際には、3つの非常に重要なセキュリティオプションを選択する必要があります。

* **EC2キーペア**：アプリを実行しているEC2インスタンスにアクセスできる**SSHキー**です。
* **IAMインスタンスプロファイル**：インスタンスが持つ**インスタンスプロファイル**（IAM権限）
* 自動生成されるロールは**`aws-elasticbeanstalk-ec2-role`**と呼ばれ、AWSの管理ポリシー[AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier)、[AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws
### 曝露

Beanstalkのデータは、次の名前の**S3バケット**に保存されます: **`elasticbeanstalk-<region>-<acc-id>`**（AWSコンソールで作成された場合）。このバケット内には、アップロードされた**アプリケーションのソースコード**が含まれています。

作成されたウェブページの**URL**は、**`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**です。

{% hint style="warning" %}
バケットに**読み取りアクセス**がある場合、ソースコードを**読み取る**ことができ、さらにそれに**機密情報**が含まれている可能性があります。

バケットに**書き込みアクセス**がある場合、ソースコードを**変更**して、次回実行時にアプリケーションが使用する**IAMロール**を**侵害**することができます。
{% endhint %}

### 列挙

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### 認証されていないアクセス

{% content-ref url="../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### 永続性

{% content-ref url="../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### 特権昇格

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### 攻撃後の活動

{% content-ref url="../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* もし **HackTricks で会社を宣伝したい** または **PEASS の最新バージョンにアクセスしたい** または **HackTricks を PDF でダウンロードしたい** 場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式の PEASS & HackTricks スワッグ**](https://peass.creator-spring.com) を手に入れましょう
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を見つけて、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションをご覧ください
* 💬 [**Discord グループ**](https://discord.gg/hRep4RUj7f) または [**telegram グループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm) をフォローしてください
* **HackTricks** と **HackTricks Cloud** の github リポジトリに **PR を提出** して、あなたのハッキングテクニックを共有してください

</details>
