# AWS - Elastic Beanstalk Enum

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Elastic Beanstalk

Amazon Elastic Beanstalk pruža pojednostavljenu platformu za **implementaciju, upravljanje i skaliranje veb aplikacija i servisa**. Podržava različite programske jezike i okvire, kao što su Java, .NET, PHP, Node.js, Python, Ruby i Go, kao i Docker kontejnere. Usluga je kompatibilna sa široko korišćenim serverima, uključujući Apache, Nginx, Passenger i IIS.

Elastic Beanstalk pruža jednostavan i fleksibilan način za **implementaciju vaših aplikacija u AWS oblaku**, bez potrebe za brigu o osnovnoj infrastrukturi. Automatski se bavi detaljima o kapacitetu **provisioninga**, ravnoteži opterećenja, skaliranju i praćenju zdravlja aplikacija, omogućavajući vam da se fokusirate na pisanje i implementaciju koda.

Infrastruktura koju stvara Elastic Beanstalk upravlja se grupama **Autoscaling** u **EC2** (sa balanserom opterećenja). To znači da, ako **ugrozite host**, trebali biste znati o EC2:

{% content-ref url="../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Osim toga, ako se koristi Docker, moguće je koristiti **ECS**.

{% content-ref url="../../aws-security/aws-services/aws-eks-enum.md" %}
[aws-eks-enum.md](../../aws-security/aws-services/aws-eks-enum.md)
{% endcontent-ref %}

### Aplikacija i okruženja

U AWS Elastic Beanstalk-u, koncepti "aplikacija" i "okruženje" imaju različite svrhe i imaju različite uloge u procesu implementacije.

#### Aplikacija

* Aplikacija u Elastic Beanstalk-u je **logički kontejner za izvorni kod vaše aplikacije, okruženja i konfiguracije**. Grupiše različite verzije koda vaše aplikacije i omogućava vam da ih upravljate kao jednu celinu.
* Kada kreirate aplikaciju, pružate ime i opis, ali u ovom trenutku **nijedan resurs nije obezbeđen**. To je jednostavno način organizovanja i upravljanja vašim kodom i povezanim resursima.
* Možete imati **više verzija aplikacije** unutar jedne aplikacije. Svaka verzija odgovara određenom izdanju vašeg koda, koje se može implementirati na jedno ili više okruženja.

#### Okruženje

* Okruženje je **provisionirana instanca vaše aplikacije** koja se izvršava na AWS infrastrukturi. To je mesto gde se implementira i izvršava vaš kod aplikacije. Elastic Beanstalk obezbeđuje neophodne resurse (npr. EC2 instance, balanseri opterećenja, grupe automatskog skaliranja, baze podataka) na osnovu konfiguracije okruženja.
* **Svako okruženje pokreće jednu verziju vaše aplikacije**, a možete imati više okruženja za različite svrhe, kao što su razvoj, testiranje, staging i produkcija.
* Prilikom kreiranja okruženja, birate platformu (npr. Java, .NET, Node.js, itd.) i tip okruženja (npr. veb server ili radnik). Takođe možete prilagoditi konfiguraciju okruženja kako biste kontrolisali različite aspekte infrastrukture i podešavanja aplikacije.

### 2 vrste okruženja

1. **Okruženje veb servera**: Namijenjeno je **hostovanju i pružanju veb aplikacija i API-ja**. Ove aplikacije obično obrađuju dolazne HTTP/HTTPS zahteve. Okruženje veb servera obezbeđuje resurse kao što su **EC2 instance, balanseri opterećenja i grupe automatskog skaliranja** za obradu dolaznog saobraćaja, upravljanje kapacitetom i obezbeđivanje visoke dostupnosti aplikacije.
2. **Okruženje radnika**: Namijenjeno je obradi **zadataka u pozadini**, koji su često vremenski zahtevni ili operacije koje zahtevaju mnogo resursa, a ne zahtevaju trenutne odgovore klijentima. Okruženje radnika obezbeđuje resurse poput **EC2 instanci i grupa automatskog skaliranja**, ali **nema balanser opterećenja** jer ne obrađuje HTTP/HTTPS zahteve direktno. Umesto toga, ono konzumira zadatke iz reda **Amazon Simple Queue Service (SQS)**, koji deluje kao bafer između okruženja radnika i zadataka koje obrađuje.

### Bezbednost

Prilikom kreiranja aplikacije u Beanstalk-u, postoje 3 veoma važne opcije za bezbednost koje treba odabrati:

* **EC2 par ključeva**: Ovo će biti **SSH ključ** koji će moći da pristupi EC2 instancama koje pokreću aplikaciju.
* **IAM instanca profila**: Ovo je **profil instance** koji će instance imati (**IAM privilegije**).
* Automatski generisana uloga se naziva **`aws-elasticbeanstalk-ec2-role`** i ima neke interesantne pristupe svim ECS, svim SQS, DynamoDB elasticbeanstalk i elasticbeanstalk S3 koristeći AWS upravljane politike: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Uloga servisa**: Ovo je **uloga koju će AWS servis** koristiti za izvršavanje svih potrebnih radnji. Koliko znam, običan AWS korisnik ne može pristupiti toj ulozi.
* Ova uloga generisana od strane AWS-a se naziva **`aws-elasticbeanstalk-service-role`** i koristi AWS upravljane politike [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) i [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

Podrazumevano je onemog
### Izloženost

Podaci Beanstalk-a se čuvaju u **S3 kanti** sa sledećim imenom: **`elasticbeanstalk-<region>-<acc-id>`** (ako je kreirana u AWS konzoli). U ovoj kanti ćete pronaći **uploadovani izvorni kod aplikacije**.

**URL** kreirane veb stranice je **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
Ako dobijete **pristup za čitanje** nad kantom, možete **pročitati izvorni kod** i čak pronaći **osetljive akreditive** na njemu.

Ako dobijete **pristup za pisanje** nad kantom, možete **izmeniti izvorni kod** da biste **ugrozili** IAM ulogu koju aplikacija koristi sledeći put kada se izvrši.
{% endhint %}

### Enumeracija

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### Neautentifikovan pristup

{% content-ref url="../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Upornost

{% content-ref url="../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Post Eksploatacija

{% content-ref url="../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
