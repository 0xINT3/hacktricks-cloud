# AWS - Wykorzystanie po eksploatacji AWS Secrets Manager

<details>

<summary><strong>Dowiedz się, jak hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Secrets Manager

Aby uzyskać więcej informacji, sprawdź:

{% content-ref url="../../aws-security/aws-services/aws-secrets-manager-enum.md" %}
[aws-secrets-manager-enum.md](../../aws-security/aws-services/aws-secrets-manager-enum.md)
{% endcontent-ref %}

### Odczytaj tajemnice

Same **tajemnice są wrażliwymi informacjami**, [sprawdź stronę privesc](../../aws-security/aws-privilege-escalation/aws-secrets-manager-privesc.md), aby dowiedzieć się, jak je odczytać.

### DoS - Zmiana wartości tajemnicy

Zmieniając wartość tajemnicy, możesz **spowodować DoS wszystkich systemów zależnych od tej wartości.**

{% hint style="warning" %}
Należy pamiętać, że wcześniejsze wartości są również przechowywane, więc łatwo jest wrócić do poprzedniej wartości.
{% endhint %}
```bash
# Requires permission secretsmanager:PutSecretValue
aws secretsmanager put-secret-value \
--secret-id MyTestSecret \
--secret-string "{\"user\":\"diegor\",\"password\":\"EXAMPLE-PASSWORD\"}"
```
### Zmiana klucza KMS w celu DoS

W przypadku ataku typu Denial of Service (DoS) na usługę AWS Secrets Manager, można zmienić klucz KMS (Key Management Service) powiązany z danym sekretem. 

Aby to zrobić, należy wykonać następujące kroki:

1. Zaloguj się do konsoli AWS i otwórz usługę Secrets Manager.
2. Wybierz sekret, którego klucz KMS chcesz zmienić.
3. Kliknij przycisk "Edit" (Edytuj) obok pola "Encryption Key" (Klucz szyfrowania).
4. Wybierz nowy klucz KMS z listy dostępnych kluczy.
5. Kliknij przycisk "Save" (Zapisz), aby zastosować zmiany.

Po zmianie klucza KMS, wszystkie operacje na tym sekrecie będą wykorzystywać nowy klucz. To może spowodować utratę dostępu do sekretu dla aplikacji, które nie zostały zaktualizowane w celu uwzględnienia nowego klucza.
```bash
aws secretsmanager update-secret \
--secret-id MyTestSecret \
--kms-key-id arn:aws:kms:us-west-2:123456789012:key/EXAMPLE1-90ab-cdef-fedc-ba987EXAMPLE
```
### Atak DoS poprzez usuwanie sekretu

Minimalna liczba dni potrzebna do usunięcia sekretu wynosi 7.
```bash
aws secretsmanager delete-secret \
--secret-id MyTestSecret \
--recovery-window-in-days 7
```
<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów github.

</details>
