# AWS - S3 Post Eksploatacija

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju oglašenu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## S3

Za više informacija proverite:

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### Osetljive informacije

Ponekad ćete moći da pronađete osetljive informacije koje su čitljive u kantama. Na primer, tajne stanja terraform-a.

### Pivoting

Različite platforme mogu koristiti S3 za skladištenje osetljivih resursa. Na primer, **airflow** može skladištiti **DAG-ove** **kod** tamo, ili **veb stranice** mogu direktno biti servirane iz S3. Napadač sa dozvolama za pisanje može **izmeniti kod** u kanti da bi se **prebacio** na druge platforme, ili **preuzeo naloge** izmenom JS fajlova.

### S3 Ransomware

U ovom scenariju, **napadač kreira KMS (Key Management Service) ključ u svom AWS nalogu** ili drugom kompromitovanom nalogu. Zatim čini ovaj **ključ dostupnim svima u svetu**, omogućavajući bilo kom AWS korisniku, ulozi ili nalogu da šifruje objekte koristeći ovaj ključ. Međutim, objekti ne mogu biti dešifrovani.

Napadač identifikuje ciljanu **S3 kantu i dobija pristup na nivou pisanja** koristeći različite metode. To može biti zbog loše konfiguracije kante koja je javno izložena ili napadač dobija pristup samom AWS okruženju. Napadač obično cilja kante koje sadrže osetljive informacije kao što su lično prepoznatljive informacije (PII), zaštićene zdravstvene informacije (PHI), logovi, rezervne kopije i još mnogo toga.

Da bi utvrdio da li se kanta može ciljati za ransomware, napadač proverava njenu konfiguraciju. To uključuje proveru da li je **S3 Object Versioning** omogućeno i da li je omogućeno **brisanje sa više faktora autentifikacije (MFA delete)**. Ako Object Versioning nije omogućen, napadač može nastaviti. Ako je Object Versioning omogućen, ali MFA delete je onemogućen, napadač može **onemogućiti Object Versioning**. Ako su i Object Versioning i MFA delete omogućeni, postaje teže napadaču da izvrši ransomware na toj određenoj kanti.

Koristeći AWS API, napadač **zamenjuje svaki objekat u kanti sa šifrovanom kopijom koristeći svoj KMS ključ**. Ovo efektivno šifruje podatke u kanti, čineći ih nedostupnim bez ključa.

Da bi dodatno izvršio pritisak, napadač zakazuje brisanje KMS ključa koji je korišćen u napadu. To daje cilju prozor od 7 dana da povrati svoje podatke pre nego što ključ bude obrisan i podaci postanu trajno izgubljeni.

Na kraju, napadač može otpremiti konačni fajl, obično nazvan "ransom-note.txt", koji sadrži instrukcije za cilj kako da povrati svoje fajlove. Ovaj fajl se otprema bez šifrovanja, verovatno da bi privukao pažnju cilja i obavestio ga o ransomware napadu.

**Za više informacija** [**proverite originalno istraživanje**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju oglašenu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
