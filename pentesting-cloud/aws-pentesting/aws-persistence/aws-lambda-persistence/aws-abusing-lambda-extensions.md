# AWS - Kudhuru Lambda Extensions

<details>

<summary><strong>Jifunze kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Lambda Extensions

Lambda extensions hufanya kazi kwa kuboresha kazi kwa kuingiliana na zana mbalimbali za **uchunguzi, uonekano, usalama, na utawala**. Vifaa hivi, vilivyotolewa kupitia [.zip archives kwa kutumia safu za Lambda](https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html) au vilivyojumuishwa katika [mizigo ya picha ya kontena](https://aws.amazon.com/blogs/compute/working-with-lambda-layers-and-extensions-in-container-images/), hufanya kazi katika njia mbili: **ndani** na **nje**.

* **Vifaa vya ndani** huchanganyika na mchakato wa runtime, kubadilisha kuanza kwake kwa kutumia **mazingira maalum ya lugha** na **scripti za pembetatu**. Kubinafsisha huku kunatumika kwa anuwai ya mifumo ya uendeshaji, ikiwa ni pamoja na **Java Correto 8 na 11, Node.js 10 na 12, na .NET Core 3.1**.

* **Vifaa vya nje** hufanya kazi kama michakato tofauti, kudumisha ushirikiano wa operesheni na mzunguko wa maisha wa kazi ya Lambda. Vinapatikana kwa mifumo mbalimbali ya uendeshaji kama **Node.js 10 na 12, Python 3.7 na 3.8, Ruby 2.5 na 2.7, Java Corretto 8 na 11, .NET Core 3.1**, na **mifumo ya uendeshaji ya desturi**.

Kwa habari zaidi kuhusu [**jinsi vifaa vya lambda extensions vinavyofanya kazi angalia nyaraka**](https://docs.aws.amazon.com/lambda/latest/dg/runtimes-extensions-api.html).

### Kifaa cha Nje cha Kudumu, Kuiba Maombi & Kubadilisha Maombi

**Hii itakuwa muhtasari wa mbinu iliyopendekezwa katika chapisho hili:** [**https://www.clearvector.com/blog/lambda-spy/**](https://www.clearvector.com/blog/lambda-spy/)

Watafiti waligundua kuwa kernel ya Linux ya msingi katika mazingira ya runtime ya Lambda imekamilishwa na "process\_vm\_readv" na "process\_vm\_writev" wito wa mfumo. Na michakato yote inaendeshwa na kitambulisho kimoja cha mtumiaji, hata mchakato mpya ulioundwa kwa ajili ya kifaa cha nje. **Hii inamaanisha kwamba kifaa cha nje kina ufikiaji kamili wa kusoma na kuandika kumbukumbu ya Rapid, kwa kubuni.**

Zaidi ya hayo, **extensions** za Lambda zinaweza **kujiandikisha** kwa **matukio ya wito**; hata hivyo, AWS haifunui data halisi kwa kifaa cha nje. Hivyo kifaa cha nje hakitaweza kukusanya habari nyeti zilizotumwa katika ombi la HTTP.

Mchakato wa **Init** (Rapid) unasikiliza maombi yote ya API kwenye **http://127.0.0.1:9001**. **Extensions** za Lambda zinaloading na **kutekelezwa** kabla ya msimbo wa runtime wowote, lakini **baada ya Rapid**.

<figure><img src="../../../../.gitbook/assets/image (90).png" alt=""><figcaption></figcaption></figure>

**Variable** iliyoitwa "**AWS\_LAMBDA\_RUNTIME\_API**" **inawajulisha** michakato ya runtime ya watoto na vifaa vingine vya **IP na nambari ya bandari ya API ya Rapid**.

{% hint style="warning" %}
**Kuandika upya** hii mazingira ya mazingira na **nambari ya bandari tunayoidhibiti** itaturuhusu **kati ya shughuli zote** ndani ya runtime ya Lambda.\
Na kwa sababu kernel imekamilishwa na wito hao wa mfumo na **kifaa cha nje** kinakimbia na **kitambulisho sawa la mtumiaji** kama Rapid Init, ni rahisi **kuandika upya** kumbukumbu ya mchakato na **kubadilisha bandari**.
{% endhint %}

Kwa kuwa **extensions zinatekelezwa kabla ya msimbo wa runtime wowote**, **mazingira yaliyosasishwa yataanza kutumika wakati mchakato wa runtime unatekelezwa** (Python, Java, Node, Ruby, n.k). Aidha, extensions zozote zilizopakiwa baada ya yetu, na kutumia hii variable, zitapitia kifaa chetu pia. Hii inaweza kuruhusu zisizo za programu hasidi **kulemaza kabisa bidhaa za usalama au extensions za kuingiza kumbukumbu kutoka ndani ya runtime yenyewe**.

<figure><img src="../../../../.gitbook/assets/image (3) (4).png" alt=""><figcaption></figcaption></figure>

Zana [**lambda-spy**](https://github.com/clearvector/lambda-spy) iliumbwa kufanya **kuandika kumbukumbu** hiyo na **kuiba habari nyeti** kutoka kwa maombi ya lambda, maombi mengine ya **extensions** na hata **kuyabadilisha**.

# Marejeo
* [https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/](https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/)

<details>

<summary><strong>Jifunze kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
