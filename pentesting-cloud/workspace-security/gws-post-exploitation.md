# GWS - 权限提升后的操作

<details>

<summary><strong>通过</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>从零开始学习 AWS 黑客攻击！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想在 **HackTricks** 中看到您的**公司广告**或**下载 HackTricks 的 PDF 版本**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方的 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 发现我们独家的[**NFTs 集合 - The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>

## Google Groups 权限提升

默认情况下，在 workspace 中，**群组**可以被组织中的任何成员**自由访问**。\
Workspace 还允许**授予群组权限**（甚至是 GCP 权限），所以如果群组可以加入并且它们有额外的权限，攻击者可能会**利用这一途径来提升权限**。

您可能需要访问控制台才能加入组织中任何人都可以加入的群组。在 [**https://groups.google.com/all-groups**](https://groups.google.com/all-groups) 检查群组信息。

### 访问群组邮件信息

如果您设法**攻破了 Google 用户会话**，从 [**https://groups.google.com/all-groups**](https://groups.google.com/all-groups) 您可以查看用户所在邮件群组的邮件历史记录，并且您可能会找到**凭据**或其他**敏感数据**。

## GCP <--> GWS 转换

{% content-ref url="../gcp-security/gcp-to-workspace-pivoting/" %}
[gcp-to-workspace-pivoting](../gcp-security/gcp-to-workspace-pivoting/)
{% endcontent-ref %}

## Takeout - 下载 Google 对一个账户所知的所有信息

如果您在**受害者的 Google 账户内有一个会话**，您可以从 [**https://takeout.google.com**](https://takeout.google.com/u/1/?pageId=none) 下载 Google 保存的该账户的所有信息。

## Vault - 下载用户的所有 Workspace 数据

如果一个组织启用了 **Google Vault**，您可能能够访问 [**https://vault.google.com**](https://vault.google.com/u/1/) 并**下载**所有的**信息**。

## 联系人下载

从 [**https://contacts.google.com**](https://contacts.google.com/u/1/?hl=es\&tab=mC) 您可以下载用户的所有**联系人**。

## Cloudsearch

在 [**https://cloudsearch.google.com/**](https://cloudsearch.google.com) 您可以搜索用户有权访问的所有 Workspace 内容（电子邮件、驱动器、网站等）。理想的是**快速找到敏感信息**。

## Google 聊天

在 [**https://mail.google.com/chat**](https://mail.google.com/chat) 您可以访问 Google **聊天**，并且您可能会在对话中找到敏感信息（如果有的话）。

## Google Drive 挖掘

在**共享**文档时，您可以**指定**可以访问它的**人员**，**与您的**整个公司**共享**（**或者**与某些特定的**群组**）通过**生成链接**。

在共享文档时，在高级设置中，您还可以**允许人们搜索**此文件（**默认情况下**这是**禁用的**）。但是，重要的是要注意，一旦用户查看了文档，他们就可以搜索它。

为了简单起见，大多数人会生成并共享链接，而不是逐个添加可以访问文档的人。

一些提出的查找所有文档的方法：

* 在内部聊天、论坛等中搜索...
* **爬取**已知的**文档**，搜索对其他文档的**引用**。您可以在 App Script 中使用 [**PaperChaser**](https://github.com/mandatoryprogrammer/PaperChaser) 来做这件事

## **Keep 笔记**

在 [**https://keep.google.com/**](https://keep.google.com) 您可以访问用户的笔记，可能会在这里保存**敏感**的**信息**。

### 修改 App 脚本

在 [**https://script.google.com/**](https://script.google.com/) 您可以找到用户的 APP 脚本。

## **管理 Workspace**

在 [**https://admin.google.com**/](https://admin.google.com)，如果您有足够的权限，您可能能够修改整个组织的 Workspace 设置。

您还可以通过搜索 [**https://admin.google.com/ac/emaillogsearch**](https://admin.google.com/ac/emaillogsearch) 中所有用户的发票来找到电子邮件。

## 参考资料

* [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - 黑客攻击 G Suite：暗黑 Apps Script 魔法的力量
* [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch 和 Beau Bullock - OK Google，我如何对 GSuite 进行红队测试？

<details>

<summary><strong>通过</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>从零开始学习 AWS 黑客攻击！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想在 **HackTricks** 中看到您的**公司广告**或**下载 HackTricks 的 PDF 版本**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方的 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 发现我们独家的[**NFTs 集合 - The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>
